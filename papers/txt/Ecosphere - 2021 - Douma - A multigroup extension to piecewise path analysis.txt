A multigroup extension to piecewise path analysis
JACOB C. DOUMA
1,2, AND BILL SHIPLEY
3
1Centre for Crop Systems Analysis, Wageningen University, Droevendaalsesteeg 1, Wageningen 6708PB The Netherlands
2Laboratory of Entomology, Wageningen University, Droevendaalsesteeg 1, Wageningen 6708PB The Netherlands
3D´epartement de Biologie, Universit´e de Sherbrooke, Sherbrooke, Quebec J1K R1 Canada
Citation: Douma, J. C., and B. Shipley. 2021. A multigroup extension to piecewise path analysis. Ecosphere 12(5):e03502.
10.1002/ecs2.3502
Abstract.
Path analysis allows one to test the consistency of data to hypothesized causal relationships
between variables. Often, interest lies in how the hypothesized dependencies differ between groups. Multi-
group comparisons can be made by imposing various constraints: constraints on the topology, the path
coefﬁcients, the residual variances, and more. To date, only classical path analysis and structural equa-
tion modeling can account for differences between groups. These techniques have assumptions that are
often not appropriate for ecological studies. The d-sep test and the recently developed generalized chi-
squared test relax many of these assumptions for path models that can be represented as directed acyclic
graphs (DAGs), but are currently lacking a multigroup test. In this paper, we develop a multigroup exten-
sion to the d-sep test. Furthermore, we show how a recently developed generalized chi-squared test and
AIC for DAGs can be used for multigroup testing. The approaches are illustrated by a worked example
and implemented in the commonly used statistical package, R. Practical recommendations for multigroup
modeling are made, and advantages and disadvantages of the multigroup d-sep and the chi-squared test
are discussed.
Key words:
d-separation; equality constraints; group comparison; hierarchical designs; nonnormal data; path analysis;
structural causal modeling; structural equation modeling.
Received 19 June 2020; revised 17 December 2020; accepted 8 January 2021; ﬁnal version received 25 February 2021.
Corresponding Editor: Debra P. C. Peters.
Copyright: © 2021 The Authors. This is an open access article under the terms of the Creative Commons Attribution
License, which permits use, distribution and reproduction in any medium, provided the original work is properly cited.
 E-mail: bob.douma@wur.nl
INTRODUCTION
Ecological studies often involve many measured
variables that are interrelated in one way or
another. The causal interdependencies between
such variables can be investigated through path
analysis, a type of structural equation modeling
(SEM; Kline 2005, Grace 2006, Shipley 2016). This
technique allows one to test, and potentially reject,
a multivariate hypothesis concerning the underly-
ing causal structure that generates the observed
values of a multivariate observation. An important
assumption of this technique is that all of the mul-
tivariate observations in the data set are generated
by the same causal structure (causal homogeneity),
in terms of both its topology and the quantitative
values of the free parameters linking the causal
parent–child pairs. When this assumption does
not hold, or when we wish to statistically test this
assumption in order to determine whether (and
where) the causal structure might differ between
groups of observations, one must conduct a multi-
group path analysis.
Group comparisons are an important part of
statistical inference and involve testing if groups
differ signiﬁcantly from each other with respect
to their mean, the degree of association between
two
variables,
or
their
variance.
Group
 v www.esajournals.org
1
May 2021 v Volume 12(5) v Article e03502

comparisons in a multivariate causal framework
are currently restricted to classical path analysis
and structural equation models (e.g., Kline 2005).
Classical path analysis assumes that the data
come from a multivariate normal distribution
observations are independent of each other, and
variables are linearly related (Kline 2012). Much
effort has gone into relaxing these assumptions.
For example, estimators have been developed
that are quite robust to multivariate non-normal-
ity unless your data are strongly kurtotic and
sample sizes are low (Shipley 2016). Further-
more, techniques are available to include simple
curvilinear relationships and relatively simple
hierarchical designs (Oberski 2014, Newsom
2015). Yet, standard SEM programs are quite lim-
ited in their ability to handle hierarchical designs
and curvilinear relationships, and other methods
are available that can more naturally accommo-
date nonlinearity, non-normality, small samples,
and complicated hierarchical designs.
Besides classical path analysis, two additional
methods are applicable to path models that only
contain directed arrows, and do not contain feed-
back loops, that is, information ﬂows in only one
direction (a so-called directed acyclic graph,
DAG), but multigroup extensions for these two
additional methods do not yet exist. The ﬁrst is
the method of d-separation (Shipley 2000, 2009).
Currently, multigroup comparison in the d-sep
framework is only possible by either imposing
no equality constraints on the groups or assum-
ing all coefﬁcients to be equal among groups
(Shipley 2016). The second method is a general-
ization of the chi-square statistic that is used in
classical maximum-likelihood SEM to DAGs
whose piecewise functional relationships can be
modeled in a maximum-likelihood context. In
this paper, we present extensions to multiple
group comparisons for both methods.
RATIONALE OF THE D-SEP TEST
The d-sep test is a general framework in which
multivariate causal hypotheses can be tested by
specifying how the variables are causally linked.
The causal links between variables are speciﬁed
in a directed acyclic graph (DAG; see Fig. 1a for
an example) with the variables representing the
nodes and the directional arrows representing
the edges. From the DAG, it follows which
variables are causally dependent or independent
of others, and how this causal dependence
changes when physically holding some of the
variables constant. If the observational data are
generated by the underlying causal structure of
the DAG, d-separation determines whether pairs
of variables in the DAG will, or will not, be statis-
tically independent upon conditioning in the sta-
tistical population (see for details Shipley 2016).
Given this, the null probabilities (pi) of indepen-
dence associated with the k d-separation claims
in the union basis set can be combined using the
C-statistic and tested with the chi-square distri-
bution (χ2) whose degrees of freedom are 2k:
C ¼ 2 ∑
k
i¼1
lnðpiÞ:
RATIONALE OF THE MULTIGROUP D-SEP TEST
A multigroup d-sep test tests whether the
topology and/or the free parameter(s) of the
model differs between groups. To do so, we con-
struct for each group a multivariate causal
hypothesis in the form of a DAG. The attribute
deﬁning group membership is not part of the
multivariate causal hypothesis itself. Since the C-
statistic follows a chi-square distribution with 2k
degrees of freedom, and since the sum of N inde-
pendent chi-square-distributed variables is itself
chi-square-distributed with degrees of freedom
equal to the sum of degrees of freedom of the N
variables, it holds that:
∑
N
j¼1
Cj ∼χ2
∑N
j12kj
ð
Þ
Thus, the sum of the C-statistics and the sum
of the degrees of freedom (2kj) for each DAG
result in an overall measure of agreement that
can be used to assess the consistency of the data
with the model.
From the above, it follows that the number of
independence claims does not change with the
number of constraints imposed on the parameters
of the structural equations, except when changing
the cause–effect structure of (one) the groups.
However, by adding constraints on the free
parameters, the statistical independence that was
implied by the d-separation claim may no longer
hold and this will negatively affect the C-statistic.
 v www.esajournals.org
2
May 2021 v Volume 12(5) v Article e03502
DOUMA AND SHIPLEY
 21508925, 2021, 5, Downloaded from https://esajournals.onlinelibrary.wiley.com/doi/10.1002/ecs2.3502, Wiley Online Library on [06/08/2025]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License

The steps to ﬁt and compare multigroup d-sep
models are as follows:
1)
Specify a causal hypothesis for each group in
the form of a DAG. The DAGs can be differ-
ent across groups provided that the causal
relationships between at least two variables
have the same direction in all groups.
2)
Deﬁne the union basis set for each group.
3)
Choose
the
appropriate
model
for
the
regressions that test the independence of a
pair of variables in each d-separation claim.
Apply constraints to the parameters of inter-
est—either by setting them to a predeﬁned
value, or by constraining them to be equal
across groups—and calculate the probabil-
ity that the pair of variables in the basis set
is not statistically associated. See Appendix
S1 how various constraints can be applied
in the software package R.
In case the union basis sets differ across
groups (Fig. 1) and constraints are imposed
on the parameters, the following procedure
should be used. Check whether the d-sep
claim for a given pair of variables is different
across groups. If so, add the variables to the
d-sep claim that are direct ancestors of this
pair in any of the other groups. Because the
path from those ancestors to the pair of vari-
ables is lacking in the group of interest, its
coefﬁcient should be forced to zero (see
Table 1).
4) Collect the C-statistic per group and number
of k independence claims in each group, and
calculate the overall chi-square value and
the degrees of freedom. See Appendix S1
for an illustration in R.
5) Repeat steps 1–4 with different parameters
constraints or ancestor–descendant relation-
ships. If multiple models are tested, one
runs the risk of erroneously rejecting a
model as being not consistent with the data.
To control for this problem, one could apply
a Bonferroni correction or the false discov-
ery rate (Benjamini and Hochberg 1995).
Note that some paths may not be part of the
basis set, and thus, adding constraints to
these paths will not affect the C-statistic.
6) After accepting the model as being consis-
tent with the data, ﬁt the regressions repre-
senting the individual paths. Some paths
may not be part of the basis set. For these,
ﬁt different levels of group constraints and
choose the most parsimonious model.
RATIONALE OF MULTIGROUP X2
ML TEST
In classical (covariance) SEM, the consistency
of the hypothesized causal structure with the
data is tested by measuring the deviance of the
model-implied covariance matrix to the observed
covariance matrix. If the causal structure is
underlying the data, any difference between the
b1
d1
c
a
X1
X2
X3
X4
X5
a)
b2
d2
c
e
a
X1
X2
X3
X
4
X
5
b)
Fig. 1. Directed acyclic graph of two groups: (a) group 1 and (b) group 2. Boxes indicate the variables, and the
arrows, the cause–effect relationships between the variables. The path coefﬁcients are represented by letters. If
both groups have the same letter without an index for group number, this implies that the path coefﬁcients are
equal across groups. For simplicity, the error variables are not shown.
 v www.esajournals.org
3
May 2021 v Volume 12(5) v Article e03502
DOUMA AND SHIPLEY
 21508925, 2021, 5, Downloaded from https://esajournals.onlinelibrary.wiley.com/doi/10.1002/ecs2.3502, Wiley Online Library on [06/08/2025]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License

observed and model-implied covariance matrix
would be due to random sampling variation,
and the maximum-likelihood chi-squared statis-
tic (X2
ML) will asymptotically follow a χ2 distribu-
tion with appropriate degrees of freedom. In this
procedure, the parameters of the model-implied
covariance matrix are optimized simultaneously
and are therefore referred as global estimation
(X2
G ML).
The above described method can be general-
ized to distributions other than normal, nonlin-
ear relationships and hierarchical data (Shipley
and Douma 2020) because the joint probability
distribution of n variables represented by a DAG
can be decomposed into n univariate probability
distributions through a local Markov decomposi-
tion. Thus, the joint log likelihood of n variables
can be obtained by summing the univariate log
likelihoods, both in the hypothesized model and
in the saturated model. The saturated model is a
path model that assumes no missing arrows
between the variables. If the hypothesized causal
structure could have generated the data, then
twice the difference between the likelihood of
both models will asymptotically follow a chi-
squared distribution with the degrees of freedom
equal to the difference in number of free parame-
ters between the hypothesized model and the
saturated model (Wilks 1938). When variables
are normally distributed and linearly related, this
gives identical results as the classical covariance
path analysis. Because the likelihood of both
models is calculated from the local regressions,
we refer to this X2
ML statistic as X2
L ML
Within this framework, one can test, identical
to classical SEM, the consistency of multigroup
path models by constraining some coefﬁcients to
be equal across groups, and a saturated model
that assumes that all estimated coefﬁcients to be
group-speciﬁc. For a multigroup X2
L ML, take the
following steps:
1. Specify a causal hypothesis for each group
in the form of a DAG.
2. Choose
the
appropriate
model
for
the
regressions representing the paths in the
DAG (i.e., not in the d-separation claims).
Apply constraints to the parameters of inter-
est—either by setting them to a predeﬁned
value, or by constraining them to be equal
across groups—and calculate the sum of the
log likelihoods of the variables.
3. Calculate the log likelihood of the saturated
model.
4. Use the X2
L ML
test to test whether the
hypothesized path model is signiﬁcantly dif-
ferent from the saturated model. We refer to
Shipley and Douma (2020) for details and to
Appendix S1 for an multigroup example in
R. Because a multigroup model is comparing
constraints
on
the
ﬁxed
effects,
models
should be ﬁtted by maximum likelihood and
not, in case of mixed-effects models, restricted
maximum likelihood (Zuur et al. 2009).
Table 1. The basis set of d-separation claims and the relationships to test for independence that follow from the
DAGs of two groups.
Claim number
Group 1
Group 2
d-sep claims
Relationship to test
d-sep claims
Relationship to test
1
X1 ⫫X2 | {}
X1 ~ (z1,z2)X2
X1 ⫫X2 | {}
X1 ~ (z1,z2)X2
2
X5 ⫫X2 | {X3}
X5 ~ (c,c)X3 + (0,e)X4 + (z1,z2)X2
X5 ⫫X2 | {X3, X4}
X5 ~ (c,c)X3 + (0,e)X4 + (z1,z2)X2
3
X4 ⫫X2 | {X3}
X4 ~ (d1,d2)X3 + (z1,z2)X2
X4 ⫫X2 | {X3}
X4 ~ (d1,d2)X3 + (z1,z2)X2
4
X1 ⫫X5 | {X3}
X5 ~ (c,c)X3 + (0,e)X4 + (z1,z2)X1
X1 ⫫X5 | {X3, X4}
X5 ~ (c,c)X3 + (0,e)X4 + (z1,z2)X1
5
X1 ⫫X4 | {X3}
X4 ~ (d1,d2)X3 + (z1,z2)X1
X1 ⫫X4 | {X3}
X4 ~ (d1,d2)X3 + (z1,z2)X1
6
X5 ⫫X4 | {X3}
X5 ~ (c,c)X3 + (z1,e)X4
Notes: The claims of independence are tested by regressing the pair of variables (e.g., X1 and X4) against each other while
holding the causal parents constant. The regression is written as X4 ~ (d1, d2)X3 + (z1, z2)X1 with the path coefﬁcients indicated
by letters. A letter with subscript implies the regression coefﬁcients are different across groups. If the data are consistent with
the model, the regression coefﬁcients z1 and z2 are not signiﬁcantly different from zero. When imposing parameter constraints
across groups, the d-sep claim may need to be expanded by variables that are causal ancestors of the pair of interest in of the
other groups. For example, to test the independence of X5 and X2 given X3 in group 1 while constraining the effect of X3 on X5
between groups, the effect of X4 on X5 in group 2 needs to be taken into account.
 v www.esajournals.org
4
May 2021 v Volume 12(5) v Article e03502
DOUMA AND SHIPLEY
 21508925, 2021, 5, Downloaded from https://esajournals.onlinelibrary.wiley.com/doi/10.1002/ecs2.3502, Wiley Online Library on [06/08/2025]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License

MODEL SELECTION ON MULTIGROUP MODELS
After having ﬁtted several models that are
each judged to be consistent with the data
based both on the above procedure and on
pre-existing causal knowledge, one may wish
to select the most parsimonious model. This
can be done through model selection criteria
such as Akaike’s information criterion (AIC;
Anderson 2008) or the likelihood ratio test that
assesses the ﬁt of nested models. Both take the
likelihood of the joint probability distribution
of the hypothesized path model as input (see
Rationale of multigroup X2
ML test). The AIC of
the full model can be obtained by summing
the AICs the piecewise structural equations.
The model with lowest overall AIC is the most
parsimonious model.
The C-statistic resulting from the d-sep test
cannot be used for model selection in this multi-
group context for two reasons. First, the number
of degrees of freedom does not increase with
increasing group constraints because the number
of independence claims in the union basis set
does not change when imposing group con-
straints. Second, depending on the topology,
some paths whose multigroup structure is of
interest may not be part of the union basis set.
Hence, testing for group differences on these
path coefﬁcients will neither affect the degrees of
freedom, nor (or only slightly) affect the C-statis-
tic. This implies that the AIC method based on
the C-statistic (Shipley 2013) cannot be used for
model selection in this multigroup context.
PRACTICAL SUGGESTIONS FOR MODEL INFERENCE
When the hypotheses concerning the multi-
group structure are speciﬁed a priori and are few
in number, then the appropriate test is the
change in the X2
L ML statistic. For post hoc testing,
adjustments to the signiﬁcance level need to be
made. Alternatively, one could use information
metrics such as AIC or BIC statistics when con-
ducting post hoc comparisons between compet-
ing multigroup models while insuring that the
models identiﬁed by the AIC or BIC statistic are
not rejected by the data. It may ease the multi-
group analysis to increase the number of con-
straints in a progressive fashion (Bollen 1989,
Grace 2006). First, assume the same causal
structure
among
groups.
Next,
successively
impose constraints on the functional form of the
regressions, the path coefﬁcients, the intercepts,
and the variances using a saturated model that is
least constrained. See Appendix S1 for how to
impose various constraints in R.
Multigroup comparisons should be performed
on unstandardized values (Grace 2006) since,
when the standard deviation of the values differ
among groups, the standardized path coefﬁcient
will become different as well. When constraining
a path coefﬁcient to be similar across groups, our
ability to detect signiﬁcant differences between
them will be affected by the number of observa-
tions in each group, like in ANOVA type of anal-
yses.
If the data in the groups have some nesting or
multilevel structure that does not, itself, deﬁne
the group structure (e.g., males/females in sites),
mixed-effects models can be applied. Multigroup
SEM could also be used for model testing. Split
the data in a training set and test set and check
whether the test set is consistent with the model
ﬁtted on the training set.
CASE STUDY
Bieber et al. (2018) applied path analysis to
study the effect of age on the timing and dura-
tion of hibernation of the Edible Dormouse (Glis
glis). They developed a path model for males and
females separately and showed that, both for
males and for females, age affects the onset of
hibernation differently along two different paths:
(1) Increasing age advances hibernation onset,
and (2) increasing age delays hibernation onset
through increasing the probability of reproduc-
tion, and the probability of reproduction in turn
delays hibernation onset.
Because reproduction was measured differ-
ently in males and females, the authors devel-
oped separate path models for each group.
However, as reproduction was measured as a
binary variable (yes/no) in both sexes, it is possi-
ble to test whether age impacts the reproduction,
hibernation onset, and hibernation duration in a
similar way for males and females. For this rea-
son, we employed a multigroup path model with
each group deﬁned by sex. We tested a slightly
modiﬁed path model compared with the one
tested in the original paper. Speciﬁcally, we (1)
 v www.esajournals.org
5
May 2021 v Volume 12(5) v Article e03502
DOUMA AND SHIPLEY
 21508925, 2021, 5, Downloaded from https://esajournals.onlinelibrary.wiley.com/doi/10.1002/ecs2.3502, Wiley Online Library on [06/08/2025]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License

left out the variable individual quality since this
was the maximum age that an animal reached
and it is thus not independent from age itself,
and (2) we removed the variable hibernation
end, since the end of the hibernation is fully
determined by the hibernation start and its dura-
tion. Finally, (3) we added a path from age to
body
mass
(i.e.,
body
mass
increases
with
increasing age) to get a model that was consistent
with the data.
To account for the additional dependencies
caused by repeated measurements per individ-
ual, year-to-year variation, and variation caused
by diet, we added all three variables as crossed
random effects. Reproductive success was mod-
eled with a binomial distribution, all other vari-
ables
with
a
normal
distribution.
As
the
packages in R that allow crossed random effects
(lme4, Bates et al. 2015, and glmmTMB, Brooks
et al. 2017) do not include options to model
heterogeneous residual variance among groups,
it was assumed that the residual variation did
not differ between groups. These data consisted
of 289 observations belonging to 75 individuals
consisting of 30 females and 45 males and sam-
pled over three different diets and 11 yr. We refer
to Data S1 for more details on the analysis.
The similarities between males and females
were tested with the d-sep test and with the gen-
eralized X2
L ML test. The list of independence
claims is given in Table 2. For the d-sep test, we
used
restricted
maximum-likelihood
(REML)
estimation to obtain the null probabilities of the
independence claims in the d-sep test since
REML provides better estimates for the ﬁxed
effects. For the X2
L ML test, we used maximum
(i.e., not restricted)-likelihood estimation in order
to compare the hypothesized model with the sat-
urated equivalent since ﬁxed effects in mixed-ef-
fects models should be compared by maximum
likelihood (Zuur et al. 2009). We compared four
models that varied in the level of constraints: (1)
ﬁxed path coefﬁcients, but free intercepts of start
of hibernation and hibernation duration across
groups; (2) free path coefﬁcients and free inter-
cepts of start of hibernation and hibernation
duration across groups; (3) ﬁxed path coefﬁcients
and ﬁxed intercepts of start of hibernation and
hibernation duration across groups; and (4) as 3,
but only the intercept start of hibernation con-
strained across groups.
The resulting C-statistic and X2
L ML statistics of
the four models are shown in Table 3, and the
path coefﬁcients of the most parsimonious model
of this series are shown in Fig. 2. The chi-squared
X2
L ML test and the d-sep test agreed that the only
model of this set that is not consistent with the
data is the one in which all path coefﬁcients and
the intercepts of start of hibernation and hiberna-
tion duration are constrained to be equal across
sexes. Two of the three remaining models were
essentially
equally
parsimonious
(ΔAIC
0.2)
according to the AIC statistic: (1) model 2 (AIC =
8,381.5), in which the path coefﬁcients are equal
between sexes but the intercepts are free, and (2)
model 4 (AIC = 8,381.7), in which the path coef-
ﬁcients are equal between sexes, as is the inter-
cept of the start of hibernation. The BIC statistics
gave a slightly stronger preference for model 4
(BIC = 8,488.1) compared with model 1 (BIC =
8,491.5). As the AIC and BIC are sample statis-
tics, and thus may change with the sample at
hand, we used bootstrapping to assess the uncer-
tainty in model ranks. As repeated measure-
ments were made on the same animals over time
and to preserve the within animal correlation
between variables, 500 bootstrapped datasets
were constructed by randomly selecting 75 ani-
mals with replacement after which the four path
models were ﬁtted. Across the 500 bootstrapped
datasets, model 4 was selected most often,
although the difference with model 1 was smaller
than 2 in 82% of the cases (20% with BIC). The
model allowing free path coefﬁcients between
Table 2. d-sep claims from the union basis set to test
for consistency of the path model with the data (x, y,
and z).
Claim
number
d-sep claims
Relationship to test
1
Bodymass ⫫
Reproduction |
{Age}
Bodymass ~ (a1,a2)Age +
(x1,x2)Repro
2
Bodymass ⫫Hibstart
| {Age, Repro}
Bodymass ~ (b1,b2)Age
+(c1,c2)Repro +(y1,y2)
Hibstart
3
Hibduration ⫫Repro
| {Age, Bodymass,
Hibstart}
Hibduration ~ (d1,d2)Age
+(e1,e2)Bodymass +(f1,f2)
Hibstart + (z1,z2)Repro
Note: No constraints are put on the path coefﬁcients in the
speciﬁed d-sep claims.
 v www.esajournals.org
6
May 2021 v Volume 12(5) v Article e03502
DOUMA AND SHIPLEY
 21508925, 2021, 5, Downloaded from https://esajournals.onlinelibrary.wiley.com/doi/10.1002/ecs2.3502, Wiley Online Library on [06/08/2025]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License

sexes was in 75% (99% BIC) cases worse than >8
AIC points compared with model 4.
Importantly, the study was set out to test how
sex affected the relationship of age on the chance
of
reproduction,
hibernation
onset,
and
the
hibernation duration, and with the multigroup
analysis, we showed that these effects did not
differ signiﬁcantly between sexes. This is a con-
clusion that could not have been reached without
an explicit multigroup analysis.
Table 3. Model ﬁt of four competing path models with different levels of group constraints
No.
Model description
No.
d-sep
claims
p1
p2
Coverall
poverall
X2
L ML
(df)
p X2
L ML
ð
Þ
k
AIC
BIC
1
All path coefﬁcients
constrained across groups
2 * 3
0.52
0.24
13.22
0.35
10.78
(13)
0.63
30
8,381.5
8,491.5
2
No path coefﬁcients
constrained across groups
2 * 3
0.34
0.13
16.7
0.16
8.40
(6)
0.21
37
8,393.1
8,528.8
3
All path coefﬁcients and
intercepts start of hibernation
and hibernation duration
constrained across groups
2 * 3
0.22
8.13e−07
46.88
4.89e−6
54.56
(15)
2.12e−06
28
8,421.3
8,523.9
4
All path coefﬁcients and
intercept of start of
hibernation constrained
across groups
2 * 3
0.23
0.19
16.85
0.16
13.04
(14)
0.52
29
8,381.7
8,488.1
Notes: The group-wide C-statistic (Coverall), and the overall p-value (poverall) and the p-values of each group are indicated (p1
and p2, respectively). k is the number of parameters used in the structural equations. The X2
L ML statistic results from twice the
difference in log likelihood between the hypothesized model and the saturated model with a df difference in degrees of free-
dom between the hypothesized and the saturated model; p X2
L ML
ð
Þ refers to the p-value associated with the X2
L ML statistic. Model
1 and 4 were most parsimonious according to the AIC statistic, while model 4 was most parsimonious according to the BIC
statistic.
(22.14)
(7.36)
(21.63)
Reproducon (yes/no)
Body mass
Age
Start Hibernaon
(-0.92)
Hibernaon
duraon
(0.14)
(-39.69)
(-39.69)
Fig. 2. Multigroup path model ﬁtted to data presented in Bieber et al. (2018) relating age of an individual to its
hibernation characteristics. A path model with path coefﬁcients similar for males and females appeared to be
consistent with data and most parsimonious according to AIC. See model statistics in Table 3. The variables in
path model are: age of Glis glis (log-transformed), reproduction represents whether the animal is sexually active
(binary yes/no), start of hibernation (Julian day), hibernation duration (days), and body mass prior to hibernation
(grams).
 v www.esajournals.org
7
May 2021 v Volume 12(5) v Article e03502
DOUMA AND SHIPLEY
 21508925, 2021, 5, Downloaded from https://esajournals.onlinelibrary.wiley.com/doi/10.1002/ecs2.3502, Wiley Online Library on [06/08/2025]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License

Even though this analysis was based on a
rather large sample size (289 observations), we
tested the robustness of this conclusion. We did
so by calculating the power (i.e., the probability
of rejecting the hypothesis of no difference
between sexes at a level of 0.05) assuming that
the estimated effect sizes of the three regressions
are the true effect sizes. We simulated 500 times
from the three ﬁtted univariate models and
tested how often log_age signiﬁcantly interacted
with sex on the three aforementioned variables.
The power of the estimated effect sizes was,
respectively, 0.12, 0.12, and 0.08. To obtain a
power of 80%, the effect of age on the three vari-
ables had to differ substantially between the sex
varying from a 50% to a 200% difference between
sexes. This suggests that the power of this study
was too low to be able to reject the null hypothe-
sis.
DISCUSSION
This paper presents two methods for multi-
group analysis for piecewise path models that
can be represented by directed acyclic graphs.
The ﬁrst method that we proposed is an exten-
sion of the d-sep method, while the second
method is an application of the generalized
X2
L ML statistic of Shipley and Douma (2020).
Having two methods that allows one to formally
test for differences between path models of dif-
ferent groups without requiring the restricted
assumptions of classical multigroup SEM is a big
step forward, and the case study illustrates its
utility. Until now, studies considering multiple
groups in path models could either resort to clas-
sical SEM with the risk of violating assumptions,
or use the d-sep test and test only two extremes:
a separate path model for every group or one
path model for all groups; examples are shown
in Ogilvie et al. (2017), Barel et al. (2018), Theo-
dorou et al. (2016), Vaz et al. (2019), Lefcheck
et al. (2018), and Gow et al. (2019).
The advantages and disadvantages of the
multigroup generalized X2
L ML test compared
with the multigroup d-sep test are similar to its
advantages with respect to standard path models
(Shipley and Douma 2020). However, one beneﬁt
of the generalized X2
L ML test, that is, it simulta-
neously tests the topology and estimates the path
coefﬁcients, has particular advantages in the
multigroup context. First, as the possible number
of models to test is large in the multigroup con-
text, it makes the procedure less prone to error
compared with the d-sep test where the con-
straints must be imposed both on the union basis
set and on the piecewise structural equations.
Second, not all paths in the multigroup d-sep test
are necessarily part of the union basis set, and
thus, constraints imposed on these paths are not
reﬂected in the C-statistic. One should therefore
carefully check which path constraints are not
tested in the basis set, and these should be tested
separately. Third, the degrees of freedom in the
X2
L ML test follows directly from the number of
constraints. This is not the case in the d-sep test
where the degrees of freedom is independent of
the number of constraints applied, except when
all parameters are assumed to be equal across
groups.
Given the large number of constraints that one
could impose on a multigroup path model in a
post hoc analysis, one runs the risk of (over)ﬁt-
ting the path model to the data. How to select
the optimal model is an active ﬁeld of research
(Lam and Bacchus 1994, Liu et al. 2012, Lubke
and Campbell 2016, Lin et al. 2017, Lubke et al.
2017), and we refer to Grace (2020) for a more
detailed discussion. Cross-validation, that is, the
testing of the model to an independent dataset or
to a subset of the data that was left out during
the ﬁtting, is needed and the preferred way to
test the validity of a model (Preacher and Merkle
2012). When using AIC and BIC, one has to bear
in mind that these are sample statistics, and thus,
they may produce different model rankings
when the same model would have been ﬁtted to
another data sample (Preacher and Merkle 2012,
Preacher et al. 2013).
To test the robustness of our conclusion of
no difference between sexes, we used two tech-
niques. We used bootstrapping to calculate the
variability
in
AIC
and
BIC
statistics
(see
Preacher and Merkle 2012 for a detailed discus-
sion),
which
conﬁrmed
that
model
1
and
model 4 do not differ greatly and thus cannot
be distinguished from each other, while the
model with no constraints on sex was almost
never
selected
as
best
model.
To
further
strengthen
our conclusions of no difference
between sexes, we performed a power analysis
on the variables that were considered the core
 v www.esajournals.org
8
May 2021 v Volume 12(5) v Article e03502
DOUMA AND SHIPLEY
 21508925, 2021, 5, Downloaded from https://esajournals.onlinelibrary.wiley.com/doi/10.1002/ecs2.3502, Wiley Online Library on [06/08/2025]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License

of the study aim. This showed that, for the
current sample size, the estimated power was
quite low, and substantially larger effect sizes
would have been needed to obtain a signiﬁcant
interaction between sex of age on the chance of
reproduction, start of hibernation, or hiberna-
tion duration.
ACKNOWLEDGMENTS
This work was supported by NWO Earth and Life
Sciences (NWO-ALW) through a VENI Grant (Project
No. 863.14.018 to JCD). We thank an anonymous
reviewer for constructive comments. JCD conceived
the methodology and wrote the ﬁrst draft. BS con-
tributed to developing the methodology and the writ-
ing of the manuscript.
LITERATURE CITED
Anderson, D. R. 2008. Model based inference in the life
sciences. A primer on evidence. Springer-Verlag
New York, New York, USA.
Barel, J. M., T. W. Kuyper, W. de Boer, J. C. Douma,
and G. B. De Deyn. 2018. Legacy effects of diversity
in space and time driven by winter cover crop bio-
mass
and
nitrogen
concentration.
Journal
of
Applied Ecology 55:299–310.
Bates, D., M. M¨achler, B. Bolker, and S. Walker. 2015.
Fitting linear mixed-effects models using lme4.
Journal of Statistical Software 67:48.
Benjamini, Y., and Y. Hochberg. 1995. Controlling the
false discovery rate: a practical and powerful
approach to multiple testing. Journal of the Royal
Statistical
Society.
Series
B
(Methodological)
57:289–300.
Bieber, C., C. Turbill, and T. Ruf. 2018. Effects of aging
on timing of hibernation and reproduction. Scien-
tiﬁc Reports 8:13881.
Bollen, K. A. 1989. Structural equations with latent
variables. John Wiley and Sons, New York, New
York, USA.
Brooks, M. E., et al. 2017. glmmTMB balances speed
and ﬂexibility among packages for zero-inﬂated
generalized linear mixed modeling. The R Journal
9:378–400.
Gow, E. A., et al. 2019. Effects of spring migration dis-
tance on tree swallow reproductive success within
and among ﬂyways. Frontiers in Ecology and Evo-
lution 7:380.
Grace, J. B. 2006. Structural equation modeling and
natural systems. Cambridge University Press, New
York, New York, USA.
Grace, J. B. 2020. A ‘Weight of Evidence’ approach to
evaluating
structural
equation
models.
One
Ecosystem 5:e50452.
Kline, R. B. 2005. Principles and practice of structural
equation modelling. Second edition. The Guilford
Press, New York, New York, USA.
Kline, R. B. 2012. Assumptions in structural equa-
tion modeling. Pages 111–125 in R. H. Hoyle, edi-
tor. Handbook of structural equation modeling.
Guilford Press, New York, New York, USA.
Lam, W., and F. Bacchus. 1994. Learning Bayesian
belief networks: an approach based on the mdl
principle. Computational Intelligence 10:269–293.
Lefcheck, J. S., et al. 2018. Long-term nutrient reduc-
tions lead to the unprecedented recovery of a tem-
perate coastal region. Proceedings of the National
Academy of Sciences of the United States of Amer-
ica 115:3658–3662.
Lin, L.-C., P.-H. Huang, and L.-J. Weng. 2017. Selecting
path models in SEM: a comparison of model selec-
tion criteria. Structural Equation Modeling: A Mul-
tidisciplinary Journal 24:855–869.
Liu, Z., B. Malone, and C. Yuan. 2012. Empirical
evaluation of scoring functions for Bayesian net-
work model selection. BMC Bioinformatics 13
(Suppl):15.
Lubke, G. H., and I. Campbell. 2016. Inference based
on the best-ﬁtting model can contribute to the repli-
cation crisis: assessing model selection uncertainty
using a bootstrap approach. Structural Equation
Modeling: A Multidisciplinary Journal 23:479–490.
Lubke, G. H., I. Campbell, D. McArtor, P. Miller, J.
Luningham, and S. M. van den Berg. 2017. Assess-
ing model selection uncertainty using a bootstrap
approach: an update. Structural Equation Model-
ing: A Multidisciplinary Journal 24:230–245.
Newsom, J. T. 2015. Longitudinal structural equa-
tion modeling - a comprehensive introduction. Tay-
lor & Francis, New York, New York, USA.
Oberski, D. 2014. lavaan.survey: an R Package for
Complex Survey Analysis of Structural Equation
Models. 2014 57:27.
Ogilvie, J. E., S. R. Grifﬁn, Z. J. Gezon, B. D. Inouye, N.
Underwood, D. W. Inouye, and R. E. Irwin. 2017.
Interannual bumble bee abundance is driven by
indirect climate effects on ﬂoral resource phenol-
ogy. Ecology Letters 20:1507–1515.
Preacher, K. J., and E. C. Merkle. 2012. The problem of
model selection uncertainty in structural equa-
tion modeling. Psychological Methods 17:1–14.
Preacher, K. J., G. Zhang, C. Kim, and G. Mels. 2013.
Choosing the optimal number of factors in explora-
tory factor analysis: a model selection perspective.
Multivariate Behavioral Research 48:28–56.
 v www.esajournals.org
9
May 2021 v Volume 12(5) v Article e03502
DOUMA AND SHIPLEY
 21508925, 2021, 5, Downloaded from https://esajournals.onlinelibrary.wiley.com/doi/10.1002/ecs2.3502, Wiley Online Library on [06/08/2025]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License

Shipley, B. 2000. A new inferential test for path models
based on directed acyclic graphs. Structural Equation
Modeling: A Multidisciplinary Journal 7:206–218.
Shipley, B. 2009. Conﬁrmatory path analysis in a gen-
eralized multilevel context. Ecology 90:363–368.
Shipley, B. 2013. The AIC model selection method
applied to path analytic models compared using a
d-separation test. Ecology 94:560–564.
Shipley, B. 2016. Cause and correlation in biology: a
user’s guide to path analysis, structural equations
and causal inference with R. Cambridge University
Press, Cambridge, UK.
Shipley, B., and J. C. Douma. 2020. Generalized AIC
and chi-squared statistics for path models consis-
tent with directed acyclic graphs. Ecology 101:
e02960.
Theodorou, P., R. Radzeviˇci¯ut_e, J. Settele, O. Sch-
weiger, T. E. Murray, and R. J. Paxton. 2016.
Pollination services enhanced with urbanization
despite increasing pollinator parasitism. Proceed-
ings of the Royal Society B: Biological Sciences
283:20160561.
Vaz, P. G., M. N. Bugalho, J. M. Fedriani, M.
Branco, X. Lecomte, C. Nogueira, and M. C.
Caldeira. 2019. Unravelling associations between
tree-seedling performance, herbivory, competition,
and facilitation in high nature value farmlands.
Journal
of
Environmental
Management
232:
1066–1074.
Wilks, S. S. 1938. The large-sample distribution of the
likelihood ratio for testing composite hypotheses.
The Annals of Mathematical Statistics 9:60–62.
Zuur, A. F., E. N. Ieno, N. Walker, A. A. Saveliev, and
G. M. Smith. 2009. Mixed effects models and exten-
sions in ecology with R. Springer-Verlag New
York, New York, USA.
DATA AVAILABILITY
Code is available from Zenodo: https://doi.org/10.5281/zenodo.4562002
SUPPORTING INFORMATION
Additional Supporting Information may be found online at: http://onlinelibrary.wiley.com/doi/10.1002/ecs2.
3502/full
 v www.esajournals.org
10
May 2021 v Volume 12(5) v Article e03502
DOUMA AND SHIPLEY
 21508925, 2021, 5, Downloaded from https://esajournals.onlinelibrary.wiley.com/doi/10.1002/ecs2.3502, Wiley Online Library on [06/08/2025]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License
