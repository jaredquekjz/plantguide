The medfate reference book
true
2024-04-10

2

Contents
Preface
9
How to use this book . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
9
An collaborative project . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
9
Funding . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
11
Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
11
I
Preliminaries
13
1
Introduction
15
1.1
Purpose . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
15
1.2
Installation
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
16
1.3
Main functions in medfate . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
17
1.4
Main functions in medfateland
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
20
2
Model inputs
23
2.1
Input structures
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
23
2.2
Latitude and topography
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
25
2.3
Soil description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
25
2.4
Vegetation description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
29
2.5
Metereological input . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
37
2.6
Simulation control
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
39
II
Basic water balance modelling
41
3
Basic water balance model
43
3.1
Design principles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
43
3.2
State variables
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
44
3.3
Water balance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
44
3.4
Process scheduling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
46
3

4
CONTENTS
3.5
Inputs and outputs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
47
3.6
Applications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
51
4
Leaf phenology and radiation extinction
53
4.1
Leaf phenology . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
53
4.2
Radiation extinction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
56
5
Forest hydrology
59
5.1
Snow and rainfall . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
59
5.2
Snow pack dynamics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
59
5.3
Rainfall interception loss . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
60
5.4
Bare soil evaporation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
63
5.5
Transpiration of the herbaceous layer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
63
5.6
Infiltration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
64
5.7
Soil water flows . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
66
6
Woody plant transpiration, photosynthesis and water status
75
6.1
Plant transpiration and photosynthesis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
75
6.2
Plant drought stress and cavitation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
80
III
Advanced water balance modelling
83
7
Advanced water balance model
85
7.1
About Sureau . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
85
7.2
Design principles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
86
7.3
State variables
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
87
7.4
Water and energy balances
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
88
7.5
Process scheduling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
89
7.6
Inputs and outputs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
90
8
Sub-daily atmospheric temperature and radiation variation
99
8.1
Above-canopy air temperature
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
99
8.2
Incoming diffuse and direct short-wave radiation
. . . . . . . . . . . . . . . . . . . . . . . . .
99
8.3
Incoming long-wave radiation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
99
9
Radiation transfer
101
9.1
Short-wave radiation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101
9.2
Long-wave radiation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 106

CONTENTS
5
10 Plant hydraulics
109
10.1 Hydraulic architecture . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109
10.2 Vulnerability curves
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110
10.3 Water content of plant tissues . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115
10.4 Sperry’s sub-model of plant hydraulics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119
10.5 Sureau’s sub-model of plant hydraulics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131
11 Leaf/canopy photosynthesis
133
11.1 Leaf energy balance, gas exchange and photosynthesis
. . . . . . . . . . . . . . . . . . . . . . 133
11.2 Crown/canopy photosynthesis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 138
12 Stomatal regulation, transpiration and photosynthesis
143
12.1 Stomatal regulation under Sperry’s sub-model . . . . . . . . . . . . . . . . . . . . . . . . . . . 143
12.2 Stomatal regulation and transpiration under Sureau’s sub-model
. . . . . . . . . . . . . . . . 147
12.3 Cohort-level transpiration and photosynthesis . . . . . . . . . . . . . . . . . . . . . . . . . . . 149
12.4 Cavitation and conduit refilling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 149
13 Closing energy balances
151
13.1 Single-layer canopy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 151
13.2 Multi-layer canopy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 153
14 Day-level results
157
14.1 Photosynthesis and transpiration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 157
14.2 Plant water potentials and relative water contents
. . . . . . . . . . . . . . . . . . . . . . . . 157
14.3 Plant drought stress
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 158
IV
Forest growth modelling
159
15 Forest growth model
161
15.1 Design principles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 161
15.2 State variables
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 171
15.3 Mass and energy balances . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 171
15.4 Process scheduling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 173
15.5 Inputs and outputs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 175
16 Carbon pools and components of the carbon balance
183
16.1 Size of carbon pools
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 183
16.2 Components of labile carbon balance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 185

6
CONTENTS
17 Growth, senescence and mortality
189
17.1 Growth
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 189
17.2 Senescence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 192
17.3 Update of plant traits and allocation targets . . . . . . . . . . . . . . . . . . . . . . . . . . . . 193
17.4 Plant mortality . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 195
17.5 Fire severity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 202
17.6 Update of structural variables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 203
V
Forest dynamics modelling
205
18 Forest dynamics model
207
18.1 Design principles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 207
18.2 State variables
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 209
18.3 Process scheduling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 209
18.4 Inputs and outputs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 209
18.5 Process details
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 212
VI
Landscape/regional modelling
215
19 Watershed hydrology
217
19.1 Design principles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 217
19.2 State variables
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 218
19.3 Water balance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 218
19.4 Process scheduling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 219
19.5 Inputs and outputs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 219
19.6 Process details
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 221
20 Seed dispersal
223
20.1 Design principles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 223
20.2 Process scheduling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 223
20.3 Process details
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 225
VII
Static modules
227
21 Allometric models
229
21.1 Input data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 229
21.2 Allometric relationships . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 230

CONTENTS
7
22 Post-simulation procedures
233
22.1 Water use efficiency
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 233
23 Wind extinction
235
23.1 Wind speed at the top of the canopy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 235
23.2 Wind extinction profile . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 235
24 Fuel characteristics and fire behaviour
237
24.1 Overview
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 237
24.2 Input data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 237
24.3 Fuel characteristics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 239
24.4 Surface fire behavior . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 247
24.5 Crown fire behavior
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 252
24.6 Fire potentials
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 254
24.7 Unit conversion of outputs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 255
A Inbuilt parameter estimation
257
A.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 257
A.2 Strict, scaled and imputable parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 257
A.3 Imputation of missing values
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 262
A.4 Scaling size-related parameters
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 278
B Symbols
287
B.1
Dimensions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 287
B.2
Soils . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 287
B.3
Plant/leaf classification
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 288
B.4
Vegetation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 288
B.5
Meteorology . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 289
B.6
Anatomy
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 290
B.7
Radiation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 291
B.8
Water balance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 291
B.9
Energy balance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 292
B.10 Forest hydrology . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 292
B.11 Plant hydraulics
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 293
B.12 Photosynthesis
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 294
B.13 Plant water content
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 295
B.14 Stomatal regulation
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 295
B.15 Carbon pools . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 295
B.16 Carbon balance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 296
B.17 Growth, senescence and mortality . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 297

8
CONTENTS

Preface
This is a reference book for the models implemented in medfate and medfateland, two R packages that
provide functions for the simulation of functioning and dynamics of Mediterranean forests and landscapes.
How to use this book
This reference book is meant to help you understand the static and dynamic models included in packages
medfate (ver. 4.1.0) and medfateland (ver. 2.2.0). Hands-on user guides to run simulation functions
and static functions can be found as package vignettes within the packages. As any reference book, you are
not expected to read the book linearly, but to jump to specific book sections whenever you have doubts
about the design or implementation of certain processes or calculations.
The first part of the book presents the main functions of the package and describes the soil, vegetation and
weather inputs that apply to all simulation models. After that, the book presents in detail each simulation
model using a set of chapters. The first of those provides an overview of the model design and the remaining
ones describe the details of formulations by groups of related processes.
Process formulations that are
common to more than one model are described only once, to avoid repeating material already presented,
but links are provided whenever needed. Static models and their corresponding R functions are presented
grouped at the end of the book, before the appendices, which include parameter estimation information and
a list of all symbols for reference.
In this book we use objectname or variablename to refer to an R objects or a variable within data frames,
and functionname() to refer to a package function. Whenever relevant, we indicate the correspondence
between mathematical symbols, their units and the names used within the R package.
Our aim is to continuously update this reference book along with package developments, so that users have
detailed and up-to-date information about the models at the time functions are run. Since the book evolves
with the package, after any model application we recommend users to store a PDF version of the reference
book to be sure it matches the version the package reported in their application report or article.
An collaborative project
You should look at medfate, medfateland and associated R packages as an ongoing research project for the
development of forest ecosystem modelling tools. The models included in the package may contain bugs, and
provide wrong predictions (all models are wrong, remember?). Package functions may evolve in the future,
so that you may have to modify your scripts after package updates (hopefully not too often). Nevertheless,
we feel the tool is mature enough to become useful for applications and that is why we made an effort to
document it thoroughly.
The set of R packages are developed and maintained by the Ecosystem Modelling Facility unit at CREAF
(in Spain), in close collaboration with researchers from URFM-INRAE (in France) and CTFC (in Spain):
9

10
CONTENTS
At the individual level, the R packages are the result of collaborative work between modelers and experts
in different disciplines. The following is a list of researchers that have contributed to the project with ideas,
data or code:
• Jordi Martínez-Vilalta (CREAF-UAB, Spain)
• Maurizio Mencuccini (CREAF-ICREA, Spain)
• Juli G. Pausas (CIDE-CSIC, Spain)
• Pilar Llorens (CSIC, Spain)
• Rafa Poyatos (CREAF, Spain)
• Lluís Brotons (CREAF-CSIC, Spain)
• Antoine Cabon (WSL, Switzerland)
• Roberto Molowny (EMF-CREAF, Spain)
• Victor Granda (EMF-CREAF, Spain)
• Adriana Tovar (EMF-CREAF, Spain)
• Alicia Forner (MNCN-CSIC, Spain)
• Lluís Coll (UdL, Spain)
• Pere Casals (CTFC, Spain)
• Mario Beltrán (CTFC, Spain)
• Jean-Marc Limousin (CEFE, France)
• Aitor Améztegui (UdL, Spain)
• Nicolas Martin-StPaul (INRAE, France)
• Hervé Cochard (INRAE, France)
• Julien Ruffault (INRAE, France)
• François Pimont (INRAE, France)
• Shengli Huang (USDA, USA)
• Enric Batllori (UB-CREAF, Spain)
• Santi Sabaté (UB-CREAF, Spain)
• Daniel Nadal-Sala (UB, Spain)
• Maria González Sanchis (UVA, Spain)
• Daniel Caviedes-Voullième (Forschungszentrum Julich, Germany)
• Mario Morales-Hernández (U Zaragoza, Spain)
• Mario Morales (UdZ, Spain)
• Raúl García Valdés (URJC, Spain)
• Josep Mª Espelta (CREAF, Spain)
• Francisco Lloret (CREAF, Spain)
• Teresa Valor (CTFC, Spain)
If your own expertise includes any of the processes that are modeled in the package and you feel that your
expertise could be helpful to improve the package, you are more than welcome to contact us!

CONTENTS
11
Funding
I have been intensively working on medfate since 2013, when I obtained a Ramon y Cajal research fellowship
from the Spanish government (Reference: RYC-2012-11109; Amount: 308.600 €). An investment on a long-
term modelling project could not have started with this initial financial help and that of the following
competitive research projects:
• Title: Forecasting of ecosystem services on forests: impacts and adaptation to extreme climate events
(FORESTCAST). Financial Entity: Ministerio de Economia y Competitividad (CGL2014-59742-C2-
2-R). Amount: 152.460 €. Duration from: 01/01/2015 to: 31/12/2017. PI: Lluís Brotons/Miquel
De Cáceres.
• Title: Modeling plant water use and drought resistance strategies across scales (DRESS). Financial
Entity: Ministerio de Economia y Competitividad (CGL2017-89149-C2-2-R). Amount: 93.170 €.
Duration from: 01/01/2018 to: 31/12/2021. PI: Miquel De Cáceres.
• Title: Boosting process-based models to project forest dynamics and associated ecosystem services
at stand-to-regional scales (BOMFORES). Financial Entity: Ministerio de Ciencia e Innovación
(PID2021-126679OB-I00). Amount: 75.020 €. Duration from: 01/09/2022 to: 31/08/2024. PI:
Miquel De Cáceres.
Besides this specific funding, this model developments could not have occurred without the institutional
support of the Forest Science and Technology Center of Catalonia (CTFC), where I worked until March
2021, and Center for Ecological Research and Forestry Applications (CREAF), where I currently coordinate
its Ecosystem Modelling Facility (EMF).
Acknowledgements
The idea of an R package devoted to Mediterranean vegetation evolved after a previous attempt at modelling
the dynamics of plant cohorts within a landscape model that tried to extend the MEDFIRE model. I made
these initial efforts when I was still a post-doc at CTFC under the supervision of Lluís Brotons, to whom I
am grateful for having greatly expanded my view of ecology and its applications. Undertaking this initial
endeavor made us contact two excellent researchers in fire and drought ecology respectively, Juli G. Pausas
(CIDE-CSIC, Spain) and Jordi Martínez-Vilalta (CREAF-UAB, Spain). While interacting with Juli was
rewarding and fostered my interest in wildfires and fire ecology, Jordi had a profound influence on the
project. Collaborating with him caused a slow but steady drift of my research interests towards the soil
water balance, plant hydraulics and physiological responses to drought. His influence on my work was not
so apparent when we published water balance model (and launched the R package) with the help of the
forest hydrologist Pilar Llorens (CSIC, Spain) and other researchers (Rafa Poyatos, Lluís Coll and Pere
Casals). However, it became undeniable when I started studying plant hydraulics, trying to understand and
implement Sperry’s model in the package. Jordi made me interact with people in his research group and
introduced me to Maurizio Mencuccini, another great ecophysiologist with whom he had been working for a
long time. I have to thank Maurizio and Jordi for encouraging me to continue working on this development
project and overcome the difficulty that entails learning scientific disciplines quite far from my previous
experience.
The development of the package has benefited from many colleagues who have provided me with ideas
or have struggled to use the models within it. Asaf Karavani was among the first package users besides
me.
Together, we used the package to predict soil moisture dynamics in forest plots where mushroom
production was being monitored. Antoine Cabon (CTFC, Spain) was also an early user of the package. I
have enjoyed endless discussions with him about several processes and how to implement them. While he
was the Ph.D. student and I one of his advisors, I felt we both learned together. Moreover, Antoine has
contributed with some functions to the package (and I hope he will contribute more!). Another key person
for the development of medfate was working with Victor Granda (Ecosystem Modelling Facility at CREAF,

12
CONTENTS
Spain), whose great programming skills and profound knowledge about R technologies has encouraged me
to embrace new programming habits and skills.
I owe the idea of separating packages meteoland and
medfate to Roberto Molowny (Ecosystem Modelling Facility at CREAF, Spain) an excellent modeller who
has also contributed to the design of dispersal in medfateland. More recently, collaboration with another
ecophysiologist, Nicolas Martin-StPaul (INRA, France), has stimulated improvements both in meteoland
and medfate.
In fact, Nicolas has became another key person in my research, with whom I share the
interest for one of the interfaces between fire and drought, namely fuel moisture dynamics. Thanks to him
and other colleagues (Julien Ruffault and François Pimont), since ver. 3.0 medfate includes an additional
sub-model of plant hydraulics, based on SurEau-ECOS. Collaboration with Shengli Huang (Forest Service,
US) on adapting the package for the US Forest Inventory and Analysis (FIA) program has expanded the
horizons of its application. Collaboration with Josep Maria Espelta (CREAF) and Francisco Lloret (UAB-
CREAF) has been key to the design of regeneration processes. The soil hydrology processes in the package,
as well as recent coupling developments would be not possible without María Gonzalez Sanchís (UPV,
Spain), Daniel Caviedes-Voullième (Forschungszentrum Jülich, Germany) and Mario Morales-Hernández (U.
Zaragoza, Spain). The package have also benefited from the feed back of other users, such as Francesco
d’Adamo (CREAF, Spain), Paula Martín (CTFC, Spain).
I would not like to finish the acknowledgements without thanking my former colleagues at CTFC (located
in the small town of Solsona, Catalonia, Spain), for their collaboration and support. Particularly, Lluís
Coll, Aitor Ameztegui and Pere Casals have been continuously supporting my efforts and finding new model
applications. Moreover, they have contributed to the knowledge within the package with their expertise
in forest dynamics, forest management, soils and fire issues. I also thank Mario Beltrán and Assu Gil for
teaching me the basics of forest management.
Finally, I would like to thank José Manuel, who takes care of me and has to endure my endless talking about
the package and its models, to my family for being there at difficult times, including my three nephews
(Aran, Jan and Nil) that constantly remind me the joy of life.

Part I
Preliminaries
13


Chapter 1
Introduction
This chapter provides an overview of the purpose of developing the medfate an medfateland R packages,
their main simulation functions and expected applications.
1.1
Purpose
Being able to anticipate the impact of global change on forest function and dynamics is one of the major
environmental challenges in contemporary societies. However, uncertainties in the mechanisms underpinning
forest function and practical constraints in how to integrate available information still hinder the availability
of robust and reliable predictive models. Despite the amount of knowledge accumulated about the function
and dynamics of forest ecosystems and the plethora of observations and modelling tools already available,
further efforts are necessary to achieve the challenge of integrating different global change drivers into sim-
ulation frameworks useful for research and applications.
1.1.1
Package medfate
The R package medfate has been designed as a platform to simulate the function and dynamics of individual
forest stands at temporal scales from days to years. Climate is the main environmental driver forcing model
predictions, and the ecological, biophysical, hydrological and physiological processes surrounding these are
fundamental for the simulation models included in the package.
In particular, the package allows the
simulation of daily energy, water and carbon balances within forest stands. It also allows simulating the
growth, mortality and regeneration processes of a set of woody plant cohorts competing for light and water
within a forest stand. Finally, additional package functions allow relating the amount of plant biomass and
the water status of plant live and dead tissues to fuel characteristics and, hence, fire hazard.
The version of the reference manual that you are reading is intended to reflect version 4.1.0 of the package.
1.1.2
Package medfateland
The R package medfateland has been designed to extend the capabilities of medfate to a spatial context,
most usually at the landscape or regional level. It allows running the stand-level models available in medfate
on a set of spatial units (normally points or cells) within a target area. The package allows coordinating the
dynamics of multiple stands via the evaluation of demand-based management scenarios. Additionally, the
package allows considering lateral water transfer processes of forested watersheds. Hence, medfateland can
also be used as a tool for eco-hydrological applications.
The version of the reference manual that you are reading is intended to reflect version 2.2.0 of the package.
15

16
CHAPTER 1. INTRODUCTION
1.1.3
Companion packages
Packages medfate and medfateland are more easily used in conjunction with two other packages, called
meteoland and medfateutils. Package meteoland assists the estimation of weather variables over land-
scapes, whereas medfateutils provides multiple functions to assist the creation of inputs and the parame-
terization of simulation models. Together the four R packages conform a modelling framework designed to
help simulating the function and dynamics of forest ecosystems, with a particular focus on drought impacts
under Mediterranean conditions (Fig. 1.1).
Figure 1.1: Set of packages conforming the medfate modelling framework
1.2
Installation
1.2.1
Requirements
Both medfate and medfateland have a user interface in R, but models have been coded in C++ language,
and the resulting simulation functions are linked to R via the Rcpp package. This means that whenever
installation is done from sources you will need a C++ compiler (i.e. Rtools in Windows). Note that compilers
will always be a requirement when installing packages from GitHub.
1.2.2
Installing medfate
Package medfate can be found at CRAN, where it is updated every few months. Hence, it can be installed
as any other R package using:
install.packages("medfate")
Users can also download and install the latest stable versions GitHub as follows (required package remotes
should be installed/updated first):

1.3. MAIN FUNCTIONS IN MEDFATE
17
remotes::install_github("emf-creaf/medfate")
Among other dependencies, installing medfate requires package meteoland, as it links to some of its C++
functions. Note that some package dependencies are only suggested, so that they are not automatically
installed when installing medfate.
1.2.3
Installing medfateland
Since both packages evolve together, installing medfateland normally requires an up-to-date version of
medfate. The package medfateland is currently only available at GitHub, and can be installed using:
remotes::install_github("emf-creaf/medfateland")
Among other dependencies, installing medfateland requires packages medfate and meteoland, as it links
to some of their C++ functions.
1.3
Main functions in medfate
1.3.1
Dynamic simulation functions
Dynamic simulation functions in medfate include three nested simulation levels (Fig. 1.2):
1. Forest water and energy balance can be studied for a given forest stand using function spwb() (soil-
plant-water-balance). The same function is used to run three different models (Granier, Sperry or
Sureau), that correspond to two levels of complexity (basic or advanced; see Fig. 1.2). The user should
choose one model or another depending on the intended application and data availability. Water bal-
ance simulations include hydrological processes (rainfall interception, soil infiltration, percolation and
evapotranspiration) and plant physiological processes related to transpiration (hydraulics, photosyn-
thesis and stomatal regulation). Most processes are implemented at the daily scale, although some
operate at subdaily time steps for advanced models. Function spwb() has a closely related function
spwb_day() that allows focusing on sub-daily processes. Finally, one can simulate plant physiological
processes only, while having soil moisture as a prescribed dynamic input like weather, using function
pwb() (plant-water-balance).
2. Changes in primary (leaf area) and secondary (sapwood) growth are key to evaluate the influence
of climatic conditions on plant and forest structure and function.
Function growth() extends the
previous models because it allows simulating carbon balance, tissue growth and mortality of a set of
plant cohorts competing for light and water in a given forest stand. Analogously to the simulation of
water balance, growth() has a closely related function growth_day() that allows focusing on sub-daily
processes (i.e. carbon balance).
3. Finally, function fordyn() complements growth and mortality processes with recruitment (from seeds)
and resprouting, thus completing the minimum set of demographic processes needed to simulate
Mediterranean forest dynamics. The function splits the period to be simulated by years and makes
internal calls to growth() for the simulation of growth and mortality. fordyn() is suited to simulate
the inter-annual variation in forest structure and composition, while accounting for the biophysical
and physiological processes provided by the former models. In addition, in allows simulating human
interventions (i.e. tree or shrub cuts) on forest stands.

18
CHAPTER 1. INTRODUCTION
Figure 1.2: Nested relationships between medfate simulation functions and processes included in each model

1.3. MAIN FUNCTIONS IN MEDFATE
19
1.3.2
Sub-model functions
Many of the sub-models included in medfate are implemented as C++ functions and internally called by the
simulation functions implementing top-level models. Most sub-models have, however, their corresponding R
function to made them directly available to the user. This facilitates understanding the different sub-models
and a more creative use of the package. However, most users will not normally use them in their simulation
workflows. Sub-model functions are grouped by subject, which is included in the name of the function. The
different sub-model functions are (by subject):
Group
Description
biophysics_*
Physics and biophysics
carbon_*
Carbon balance
fuel_*
Fuel properties
fire_*
Fire behaviour and severity
hydraulics_*
Plant hydraulics
hydrology_*
Canopy and soil hydrology
light_*
Light extinction and absortion
moisture_*
Live tissue moisture
pheno_*
Leaf phenology
photo_*
Leaf photosynthesis
root_*
Root distribution and conductance calculations
soil_*
Soil hydraulics and thermodynamics
transp_*
Stomatal regulation, transpiration and photosynthesis
wind_*
Canopy turbulence
1.3.3
Static functions
Package medfate includes a number of functions to examine static properties of plants conforming forest
stands, summary functions at the stand level or vertical profiles of several physical properties:
• plant_*: Cohort-level information (species name, id, leaf area, height. . . ).
• species_*: Cohort-level attributes aggregated by species (e.g. basal area).
• herb_*: Attributes of the herbaceous layer (e.g. fuel density or leaf area index).
• stand_*: Stand-level attributes (e.g. basal area).
• vprofile_*: Vertical profiles (light, wind, fuel density, leaf area density).
Vegetation functioning and dynamics have strong, but complex, effects on fire hazard. On one hand, growth
and death of organs and individuals changes the amount of standing live and dead fuels, as well as downed
dead fuels. On the other, day-to-day changes in soil and plant water content changes the physical properties
of fuel, notably moisture content of live and dead fuels. Package medfate provides functions to estimate fuel
properties and potential fire behaviour in forest stands. Specifically, fuel_FCCS() calculates fuel character-
istics for a set of fuel strata; and a fire behaviour model is implemented in function fire_FCCS() to calculate
the intensity of surface fire reaction and the rate of fire spread of surface fires assuming a steady-state fire.
Fuel and fire behavior functions allow obtaining the following:
1. Fuel characteristics by stratum.
2. Surface fire behavior (i.e. reaction intensity, rate of spread, fireline intensity and flame length).
3. Crown fire behavior.
4. Fire potential ratings of surface fire behavior and crown fire behavior.

20
CHAPTER 1. INTRODUCTION
1.4
Main functions in medfateland
Package medfateland allows simulating forest functioning and dynamics on sets forests stands distributed
across space, with or without spatial processes (Fig. 1.3).
When spatial processes are omitted, the package offers a set of simulation functions that are analogous to
those of package medfate but allow processing multiple forest stands sequentially or in parallel:
• Forest water and energy balance can be studied for a set of forest stands using functions
spwb_spatial() or spwb_spatial_day().
• Growth and mortality of a set of plant cohorts competing for light and water can be simulated for a
set of forest stands using functions growth_spatial() or growth_spatial_day().
• Forest dynamics arising from competition for light and water can be simulated for a set of forest stands
using function fordyn_spatial().
The package offers a simulation function where the dynamics of forest stands are related by management
decisions:
• Function fordyn_scenario() allows simulating fordyn() on forest stands, while applying a demand-
based forest management scenario. Simulations with this function also include seed dispersal among
forest stands.
Finally, there are three functions that are meant to simulate watersheds, including spatial processes:
• Functions spwb_land() and growth_land() include distributed hydrological models that allow simu-
lating daily water balance or growth processes on the cells of a watershed while accounting for overland
runoff, subsurface flow and groundwater flow between cells.
• Forest dynamics arising from competition for light and water can be simulated in a watershed using
function fordyn_land(). Simulations with this function also include seed dispersal among grid cells.

1.4. MAIN FUNCTIONS IN MEDFATELAND
21
Figure 1.3: Overview of simulation functions in medfateland and the processes available for each of them.
Colored squares below each simulation function indicate the processes included

22
CHAPTER 1. INTRODUCTION

Chapter 2
Model inputs
This chapter describes the inputs required by simulation models of medfate and medfateland packages.
First, we describe the R structures required for the two packages. Then, we provide the details for four
different kinds of inputs:
(1) Vegetation existing in the forest stand. This information should be available at a level of detail appro-
priate for the model design, which in our case includes not only species composition and/or structure,
but also functional parameters of woody plants. Vegetation structure is considered static in spwb()
calls, but becomes dynamic in calls to growth() or fordyn(). Hence, in these functions the input
vegetation describes the starting point.
(2) Information on the physical structure of soil. Soil information is also required but, unlike vegetation,
the soil physical structure is considered static.
(3) Climatic forcing. Daily weather series are always required, defining the temporal extent of the simula-
tion and the temporal variation of environmental conditions in which physical and biological processes
occur.
(4) Topographic information and geographic location. Topography and latitude are also required, because
internal calculations of some physical variables require them.
The last section (2.6) describes additional input parameters that are used to specify global options of simu-
lation functions.
Since preparing inputs for simulations can be daunting for most users, package medfateutils provides a
set of utility functions aimed at facilitating the preparation of vegetation and soil inputs, whereas package
meteoland provides functions to assess daily weather over landscapes.
2.1
Input structures
2.1.1
Input structures in medfate
Package medfate deals with simulations at stand level and, hence, the data structures defined in the package
are meant to encapsulate information about a target forest stands and the properties of the soil where it
grows:
• S3 class soil is a list that is initialized using soil physical properties, but the object includes also soil
parameters and state variables. Soil objects are described in subsection 2.3.3.
• S3 class forest is a list of forest inventory data (i.e. mainly tree and shrub measurements, but can
include herbaceous vegetation) corresponding to a single forest stand. Forest plot objects are described
in subsection 2.4.4.
23

24
CHAPTER 2. MODEL INPUTS
• S3 classes spwbInput and growthInput are lists containing all the vegetation parameters and state
variables necessary to run water-balance simulations (function spwb() and alike) and forest growth
simulations (function growth() and alike). Objects of classes spwbInput and growthInput are created
using functions whose input includes a forest object and a soil object.
The figure below (Fig. 2.1) can be used to illustrate the workflow of soil/forest input creation for the main
simulation functions in medfate. Note the different inputs in the case of fordyn().
Figure 2.1: Schematic workflow of input creation for simulation functions in medfate
2.1.2
Input structures in medfateland
Spatial information for medfateland needs to be provided in sf objects (i.e. data frames with geometry,
see package sf), whose actual columns required depend on the simulation function to be used, as described
in the following table.
Column
Description
Use
geom
Spatial geometries (points,
polygons, . . . )
Always required
id
Stand identifiers
Required for *_spatial(), *_spatial_day() and
fordyn_scenario()
elevation
Elevation values above sea level (in
m)
Always required
slope
Slope values (in degrees)
Always required
aspect
Aspect values (in degrees)
Always required
land_cover_type
Land cover type: wildland,
agriculture, rock, artificial or water
Required for *_land(), optional for *_spatial()
and *_spatial_day()
forest
Objects of class forest
Always required
soil
Objects of class soil
Always required
state
Objects of class spwbInput or
growthInput
Optional to recover the final state of a previous
simulation
meteo
Weather data frames (see 2.5)
Optional
crop_factor
Crop evapo-transpiration factor
Only required for agriculture land cover type
management_arguments
Management arguments for each
stand
Optional for fordyn_spatial()
management_unit
Management unit corresponding to
each stand
Required for fordyn_scenario()
represented_area_ha
Area represented by each stand, in
hectares
Required for fordyn_scenario()

2.2. LATITUDE AND TOPOGRAPHY
25
Column
Description
Use
channel
Logical values indicating whether
cells belong to the channel
network.
Required for *_land()
depth_to_bedrock
Depth to bedrock (mm).
Required for *_land()
bedrock_conductivity
Bedrock (saturated) conductivity
(in m·day-1).
Required for *_land()
bedrock_porosity
Bedrock porosity ([0-1]).
Required for *_land()
snowpack
Snow water equivalent content of
the snowpack (mm).
Required for *_land()
aquifer
Water content of the aquifer in
each cell.
Required for *_land()
2.2
Latitude and topography
Topography has a relatively small direct influence in medfate simulations, because most topographic effects
are assumed to be taken into account in the estimation of weather inputs. Nonetheless, elevation in meters is
needed to estimate atmospheric pressure and air density (see 2.5), whereas aspect (in degrees from North) and
slope (also in degrees) are needed in addition to latitude (also in degrees North) to estimate sunrise/sunset
hours and potential radiation. Topographic variables should be readily accessible for users having access to
a digital elevation model of the target area.
2.3
Soil description
Soils are described in medfate using S > 1 different soil layers (s ∈{1, 2, ..., S}). Here the word soil refers
to depths that plant rooting systems can reach (i.e., the critical zone), including cracks within the bedrock.
The number and size of soil layers may correspond to changes in soil properties along depth, but also can
be chosen to reflect differences in plant rooting depths. The physical properties of the soil are needed to
estimate soil hydraulic properties and are considered static soil parameters in simulations. In contrast,
soil moisture content, other variables that depend on moisture (e.g. soil water potential and soil conductivity)
and soil temperature, if the soil energy balance is considered, are all soil state variables.
2.3.1
Soil physical properties
Soil physical properties, such as texture (i.e. volume percent of sand, silt and clay), organic matter content,
bulk density or rock fragment content, can differ between soil layers, and this has important consequences for
soil water retention capacity and soil hydraulics. Specifying layers with an elevated rock fragment content
(e.g. layers of weathered rock where soil particles are scarce) may be important in seasonally-arid climates
like the Mediterranean, because plants often extend their roots into cracks existing in the parent rock to
access water during summer (Ruffault et al. 2013).
For each soil layer s, the following physical parameters are needed:
Symbol
Units
R
Description
ds
mm
widths
Width of soil layer s
Pclay,s
%
clay
Percent volume of clay (within soil particles fraction) in layer s
Psand,s
%
sand
Percent volume of sand (within soil particles fraction) in layer s
OMs
%
om
Percentage of organic mater per dry weight (can be missing) in
layer s

26
CHAPTER 2. MODEL INPUTS
Symbol
Units
R
Description
BDs
g · cm−3
bd
Bulk density in layer s
Procks,s
%
rfc
Rock fragment content as percent volume (within whole soil) in
layer s
The percent volume of silt is 100% minus the percent volume of clay and sand. Whenever possible, soil phys-
ical properties should be measured in soil profiles conducted at the target forest plot (although soil profiles
rarely reach rooting depths of deeply-rooted plants). Soil input data should be arranged in a data.frame
with soil layers in rows and physical variables in columns (see function defaultSoilParams()). The following
is an example with four soil layers:
soildf <- defaultSoilParams()
soildf
##
widths clay sand om
bd rfc
## 1
300
25
25 NA 1.5
25
## 2
700
25
25 NA 1.5
45
## 3
1000
25
25 NA 1.5
75
## 4
2000
25
25 NA 1.5
95
Package medfateutils includes a function soilgridsParams() to fetch soil information from SoilGrids.org,
a global soil database currently providing soil data at 250m scale. This can be helpful to users lacking local
soil measurements, but the uncertainty of SoilGrids estimates can be high for some areas and soil properties,
especially soil depth and rock fragment content.
The depth of a given soil layer s (Zs; in mm) is defined as the sum of layer widths from the surface to the
target layer:
Zs =
s
X
i=1
ds
(2.1)
And the overall soil depth (Zsoil; in mm) is the sum of widths across all soil layers. As the soil may include
deep rocky layers, the value of Zsoil may be larger than the soil depth reported in soil profiles.
2.3.2
Water retention curves
The water retention curve of a soil is the relationship between volumetric soil moisture content (θ, in
m3 · m−3 of soil, excluding rock fragments) and the corresponding soil water potential (Ψ, in MPa), i.e. the
amount of work that must be done per unit quantity of pure water in order to transport reversibly and
isothermally an infinitesimal quantity of water from a reference pool. The shape of the water retention curve
(also called the soil moisture characteristic curve) depends on physical properties (mainly texture and bulk
density, but also organic matter content). Since soil layers usually differ in their physical properties they
also normally have different water retention curves.
Two water retention curve models are available in medfate (fig. 2.2):
1. Saxton model: In this model, volumetric soil moisture θ(Ψ) corresponding to a given water potential
Ψ (in MPa) below field capacity (i.e., Ψ < Ψfc) is calculated using:
θ(Ψ) = (Ψ/A)(1/B)
(2.2)
where A and B depend on the texture and, if available, organic matter in the soil. If organic matter
is available, A and B are calculated from Pclay, Psand and OM following Saxton & Rawls (2006).
Otherwise, they are calculated from Pclay and Psand as indicated in Saxton et al. (1986). Volumetric
changes between field capacity and saturation (i.e., Ψfc ≤Ψ < 0) are estimated using a linear function.

2.3. SOIL DESCRIPTION
27
2. Van Genuchten model: The well known van Genuchten (1980) model is:
θ(Ψ) = θres +
θsat −θres
[1 + (α · Ψ)n]1−1/n
(2.3)
where θ(ψ) is the water retention, θsat is the saturated water content, θres is the residual water content,
α is related to the inverse of the air entry pressure, and n is a measure of the pore-size distribution.
20
40
60
80
100
0
2
4
6
Soil water potential (−MPa)
Moisture content (% saturation)
Saxton
Van Genuchten
Figure 2.2: Water retention curves under the Saxton and Van Genuchten models, for the same physical
attributes (25% sand, 25% clay, 50% silt and bulk density of 1.5g ·cm−3). Parameters of the Van Genuchten
curve have been estimated using pedotransfer functions given in Tóth et al. (2015).
Hydraulic conductivity governs the rate of water flow for a unit gradient in potential. It decreases sharply as
soil becomes dry, and the relationship also depends on soil texture. The Saxton and Van Genuchten models
also describe and parameterize the relationship between conductivity and soil water potential.
2.3.3
Soil initialization
Soil initialization is needed to estimate hydrological parameters for each soil layer s from its physical at-
tributes. Soil initialization is done using function soil(), which returns an object of a S3 class with the
same name (see 2.1.1). Simulation functions in medfate need an object of class soil to be run.
Function soil() adds the following information to the physical soil description:
Symbol
Units
R
Description
Pmacro
%
macro
Percentage of macroporosity corresponding to each soil layers
γsoil
mm·day−1
Gsoil
The maximum daily evaporation rate from soil (see 5.4)
θsat
m3 · m−3
VG_theta_sat
Volumetric soil moisture at saturation for each soil layer
θres
m3 · m−3
VG_theta_res
Residual volumetric soil moisture for each soil layer
n
VG_n
Parameter n of the Van Genuchten (1980) model for each soil layer
α
MPa−1
VG_alphaParameter α of the Van Genuchten (1980) model for each soil layer

28
CHAPTER 2. MODEL INPUTS
Symbol
Units
R
Description
Ksat
mmol ·
s−1 · m−2 ·
MPa−1
Ksat
Saturated soil conductivity for each soil layer
Macroporosity values are calculated using the equations given in Stolf et al. (2011), while γsoil is derived from
texture. Parameters of the van Genuchten model for each layer are estimated from the physical description
of the layer using one of two pedotransfer functions (see help for soil()):
1. Using the USDA texture classification and the average texture class parameters given by Carsel &
Parrish (1988).
2. Directly from the soil texture, organic matter and bulk density, using the pedotransfer functions in
Tóth et al. (2015).
Parameter α of the Van Genuchten model is given in MPa−1, but it can be transformed to cm−1 using the
relationship:
1 cm = 0.00009804139432 MPa,
(2.4)
which can also be applied to water potential units. Soil layer saturated conductivity (Ksat) is estimated
using Saxton & Rawls (2006) or Saxton et al. (1986), depending on whether an estimate of organic mater is
available. Ksat is given in physiological units mmol · s−1 · m−2 · MPa−1, but they can be transformed into
cm · day−1 using:
1 cm · day−1 = 655.2934 mmol · s−1 · m−2 · MPa−1
(2.5)
Besides defining soil parameters, function soil() also initializes soil state variables: soil moisture content,
soil temperature (although set to a missing value) and water table depth. Users can edit the soil object
manually (it is actually a list), for example to provide specific parameters of the Van Genuchten retention
curve calibrated from soil measurements.
Saturated conductivity (Ksat) is corrected for bulk density (BD) of the soil layer, because compact soils
have lower conductivity (Rahimi et al. 2011):
Ksat = Ksat,ref ·
 ρs −BD
ρs −BDref
3
(2.6)
where Ksat,ref is the reference conductivity according to soil texture, ρs = 2.73 g · cm−3 is density of soil
particles, BDref = 1.2 g · cm−3 is the reference bulk density.
2.3.4
Water content and depth to saturation
The volume of water (Vs in mm = l · m−2 of ground area) in a soil layer s is calculated from its water
potential (Ψs) and water retention curve using:
Vs(Ψs) = ds · ((100 −Procks,s)/100) · θs(Ψs)
(2.7)
where ds is the depth of the soil layer (in mm) and Procks,s is the percentage of rock fragments. The overall
volume of water in the soil (accessible by roots) is simply the sum of water content over soil layers:
Vsoil =
S
X
s=1
Vs(Ψs)
(2.8)
A number of fixed water volumes (and their corresponding moisture) are important to remember:

2.4. VEGETATION DESCRIPTION
29
• Water holding capacity (Vfc,s, in mm) of the soil layer s is defined as the volume of water at field
capacity, i.e. at Ψfc = −0.033 MPa, the amount of water held in the soil after gravitational water has
drained away:
Vfc,s = Vs(−0.033) = ds · ((100 −Procks,s)/100) · θfc,s
(2.9)
where θfc,s = θs(−0.033) is the corresponding moisture at field capacity.
• Water content at saturation (Vsat,s, in mm) is calculated anagolously, but replacing θfc,s by θsat,s =
θs(0), the moisture at saturation, the amount of soil moisture when all easily drained spaces between
soil particles (i.e. macropores) are also filled with water.
• Water content at wilting point (Vwp,s, in mm) is calculated replacing θfc,s by θwp,s = θs(−1.5), the
moisture at wilting point, i.e. at Ψfc = −1.5 MPa, a conventional amount of soil moisture beyond
which plants are assumed have problems extracting water and start to wilt. However, plants can often
extract water from much drier soils.
• The amount of extractable water (in mm) is the difference between water content at field capacity and
the water content at a conventional minimum water potential, which can be set at wilting point or
lower values (by default at -5 MPa in medfate).
The saturated water depth (Zsat, in mm) is not defined (i.e. missing) when all soil layers are below field
capacity.
When some layers are between field capacity and saturation, depth of the saturated water is
calculated as:
Zsat =
X
s
ds · min [1, (θsat,s −θ(Ψs))/(θsat,s −θfc,s)]
(2.10)
2.4
Vegetation description
The representation of vegetation within a target forest stand is done in medfate primarily by means of
cohorts of woody plants (i.e. trees and shrubs). A woody plant cohort represents a set of woody plants
that belong to the same species (or functional group) and are more or less of the same size. For example,
trees in a stand may be grouped by species and diameter class, whereas shrubs may be grouped by species
and height. In practice however, plant cohorts are entities that are treated separately when modeling the
forest stand. This representation in plant cohorts was chosen so that package functions can be easily applied
to forest inventory data, for example from national forest surveys. The description of woody plant cohorts
includes a measure of abundance of the cohort in the stand, which in the case of trees is density as stems per
hectare and for shrubs is percent cover (shrubs are often multi-stemmed). The difference in measurement
units for abundance is the main motivation for distinguishing between tree cohorts and shrub cohorts, rather
than their size or growth form. Additionally, the description of vegetation in the forest stand may include the
cover and mean height of a herbaceous layer. The presence or abundance of herbs is not always recorded
in forest inventory surveys, but may be relevant vegetation component in open habitats like shrublands.
Note that one limitation of the representation of vegetation in medfate is that it is not spatially-explicit
(i.e. plants cannot have explicit coordinates within forest stands) and hence spatial (horizontal) interactions
between plant cannot be taken into account explicitly (but see 2.4.8).
2.4.1
Structural attributes of woody plant cohorts
A woody plant cohort i is either a tree cohort or a shrub cohort, and is defined using a set of structural at-
tributes shown in the following table, where columns spwb, growth and fordyn indicate whether attributes
are required by simulation functions spwb()/pwb(), growth() and fordyn(), respectively:
Symbol
Units
R
Description
spwb
growth
fordyn
SPi
SpeciesSpecies identity
Y
Y
Y
Hi
cm
Height Average tree or shrub height
Y
Y
Y

30
CHAPTER 2. MODEL INPUTS
Symbol
Units
R
Description
spwb
growth
fordyn
CRi
CR
Crown ratio (i.e. ratio between crown length
and plant height)
Y
Y
N
Ni
indůha−1
N
Density of tree individuals
N
Y
Y
DBHi
cm
DBH
Tree diameter at breast height
N
Y
Y
Coveri
%
Cover
Shrub percent cover
N
Y
Y
LAIlive
i
m2 · m−2
LAI_live(Maximum) leaf area index
Y
Y
N
LAIdead
i
m2 · m−2
LAI_deadDead leaf area index
Y
Y
N
LAIϕ
i
m2 · m−2
LAI_expanded
Current expanded leaf area index
Y
Y
N
Z50,i
mm
Z50
Depth above which 50% of the fine root mass
is located
Y
Y
Y
Z95,i
mm
Z95
Depth above which 95% of the fine root mass
is located
Y
Y
Y
Height (H) values refer to average height of individuals included in the cohort, and the same for crown ratio
(CR) and diameter at breast height (DBH). While plant size (i.e. height or diameter) is relatively easy
to tally, other measurements are not usually made in the field. Package medfate includes utility functions
that provide estimates CR and LAI from forest inventory data (e.g. heights, DBH and density for measured
trees), using allometric relationships calibrated for Catalonia, Spain (see chapter 21).
Leaf area index
LAI variables refer to one-sided leaf area of plants per surface area of the stand. Leaves standing on branches
of woody plants can be alive or dead. We will call total leaf area index of a woody plant cohort i (LAIall
i )
to the sum of its dead and live (and unfolded) leaf area:
LAIall
i
= LAIϕ
i + LAIdead
i
(2.11)
For simulations not involving growth, winter-deciduous phenology is a prognosed variable, and the current
level of leaves unfolded may be lower than the maximum (live) amount of leaves. In simulations involving
growth, both LAIϕ and LAIlive can change, the former due to leaf phenology (unfolding is simulated
explicitly and has carbon costs) and the latter due to leaf allocation limits during plant development.
2.4.2
Structural attributes of herbaceous vegetation
The herbaceous layer of the stand is described collectively, without distinguishing among plant cohorts. Two
attributes, cover and height, are required:
Symbol
Units
R
Description
Hherb
cm
herbHeight
Average height of herbaceous vegetation
Coverherb
%
herbCoverPercent cover of herbaceous vegetation
LAIherb
m2 · m−2
LAI_herb Leaf area index of herbaceous vegetation
Leaf area index of herbaceous layer (LAIherb), is normally estimated from Hherb and Coverherb, but could be
directly prescribed by the user. Rooting depth parameters are not needed for herbaceous vegetation, which
is assumed to extract water from the topmost soil layer. Note that neither phenology or growth/senescence
processes are modelled in the case of herbaceous vegetation.

2.4. VEGETATION DESCRIPTION
31
2.4.3
Leaf area index of the forest stand
If there are c woody plant cohorts, the leaf area index corresponding to living leaves, unfolded leaves and
dead leaves can be aggregated across cohorts using:
LAIlive
woody
=
c
X
i=1
LAIlive
i
(2.12)
LAIϕ
woody
=
c
X
i=1
LAIϕ
i
(2.13)
LAIdead
woody
=
c
X
i=1
LAIdead
i
(2.14)
We can also estimate the overall leaf area index of woody plant cohorts (LAIall
woody):
LAIall
woody
=
c
X
i=1
LAIwoody
i
= LAIϕ
woody + LAIdead
woody
(2.15)
Finally, we can also estimate the overall leaf area index of the whole stand (LAIall
stand), which also takes into
account the herbaceous layer (LAIherb):
LAIall
stand
=
LAIall
woody + LAIherb = LAIϕ
woody + LAIdead
woody + LAIherb
(2.16)
2.4.4
Forest plot objects
While the previous section described the structural forest variables required to run simulations in medfate,
forest plot data input in the package is easier if one uses a format that follows closely forest inventory plot
descriptions. In this format, each forest plot is represented in an object of class forest, a list that contains
several elements. Here we use an example forest stand provided with the package:
data(exampleforest)
exampleforest
## $treeData
##
Species
N
DBH Height Z50
Z95
## 1 Pinus halepensis 168 37.55
800 100
600
## 2
Quercus ilex 384 14.60
660 300 1000
##
## $shrubData
##
Species Cover Height Z50
Z95
## 1 Quercus coccifera
3.75
80 200 1000
##
## $herbCover
## [1] 10
##
## $herbHeight
## [1] 20

32
CHAPTER 2. MODEL INPUTS
##
## $seedBank
## [1] Species Percent
## <0 rows> (or 0-length row.names)
##
## attr(,"class")
## [1] "forest" "list"
The most important items of forest are the two data frames describing woody vegetation, treeData (for
trees) and shrubData for shrubs, but the herbaceous layer can also be described using herbCover and
herbHeight. With the aim to help users in the task of constructing forest objects, package medfateutils
includes functions to map user data in into tables treeData and shrubData.
forest objects are a convenient format to start calculations with medfate, because there are many static
functions that take forest objects as input. For example, a summary.forest() function provides the basal
area, density, cover and leaf area index of the forest stand, and its different components:
summary(exampleforest, SpParamsMED)
## Tree BA (m2/ha): 25.0333016
adult trees: 25.0333016
saplings: 0
## Density (ind/ha) adult trees: 552
saplings: 0
shrubs (estimated): 749.4923076
## Cover (%) adult trees: 100
saplings: 0
shrubs: 3.75
herbs: 10
## LAI (m2/m2) total: 1.7585845
adult trees: 1.5543216
saplings: 0
shrubs: 0.030626
herbs: 0.1736369
## Fuel loading (kg/m2) total: 0.5588728
adult trees: 0.5255004
saplings: 0
shrubs: 0.0140795
herbs
## PAR ground (%): NA
SWR ground (%): NA
2.4.5
Single-cohort forests
Although medfate has been designed to perform simulations on multi-cohort forests, it can also handle sim-
ulations where vegetation is described using a single cohort. Functions tree2forest() and shrub2forest()
allow defining single-cohort forests from attributes. For example a holm oak (Quercus ilex) forest of 4-m
height and having a leaf area index of 2 m2 · m−2 can be defined using:
oak_forest <-tree2forest("Quercus ilex", Height= 400, LAI = 2)
The function will return a forest object where most attributes are empty:
oak_forest
## $treeData
##
Species DBH Height
N Z50 Z95 LAI
## 1 Quercus ilex
NA
400 NA
NA
NA
2
##
## $shrubData
## [1] Species Height
Cover
Z50
Z95
## <0 rows> (or 0-length row.names)
##
## $herbCover
## [1] NA
##
## $herbHeight
## [1] NA

2.4. VEGETATION DESCRIPTION
33
##
## $seedBank
## [1] Species Percent
## <0 rows> (or 0-length row.names)
##
## attr(,"class")
## [1] "forest" "list"
Nevertheless, the object is well defined, for example we can summarize it using:
summary(oak_forest, SpParamsMED)
## Tree BA (m2/ha): 0
adult trees: 0
saplings: 0
## Density (ind/ha) adult trees: 0
saplings: 0
shrubs (estimated): 0
## Cover (%) adult trees: 0
saplings: 0
shrubs: 0
herbs: 0
## LAI (m2/m2) total: 2
adult trees: 0
saplings: 0
shrubs: 0
herbs: 0
## Fuel loading (kg/m2) total: 0.5698237
adult trees: 0
saplings: 0
shrubs: 0
herbs: 0
## PAR ground (%): NA
SWR ground (%): NA
Since density and diameter have not been provided, simulations in this case will be restricted to function
spwb()/pwb(). Moreover, note that when defining single-cohort forests all possible interactions with func-
tionally distinct plants are neglected.
2.4.6
Vertical leaf distribution
The vegetation input structures allow the package to determine the vertical distribution of leaves in the
stand. The leaf area of any woody plant cohort is assumed to be distributed vertically following a truncated
Gaussian function whose standardized values -1.5 and 1.5 correspond to crown base height (Hcrown,i; in
cm) and total plant height (Hi), respectively. Crown base height is defined as the height corresponding to
the first living branch. It is calculated from the crown ratio of the cohort (CRi; a proportion between 0 and
1), which in turn can be estimated as explained in (21.11).
Simulation models in medfate divide the vertical dimension into vertical layers (by default are 100 cm
width, but see control parameter verticalLayerSize). Let us define LAIall
i,j = LAIϕ
i,j + LAIdead
i,j
as the leaf
area index of cohort i in layer j including both functional leaves and dead leaves standing on branches. The
truncated Gaussian distribution defines the LAIϕ
i,j and LAIdead
i,j
for all plant cohorts and vertical layers.
Dividing the leaf area of a given layer by its width, one obtains the leaf area density (LAD in m2 · m−3).
Figure 2.3 illustrates the leaf area density profile (see function vprofile_leafAreaDensity()) corresponding
to the forest stand described in the example forest object that we showed above.
The leaf area density profile determines the light extinction rates through the forest canopy. The same trun-
cated Gaussian distribution is used to distribute leaf and small branch biomass along the vertical dimension.
When present, we can include herbaceous vegetation (i.e. LAIherb) in the leaf area density profile. Its vertical
distribution is also assumed to follow a truncated Gaussian function:
2.4.7
Vertical root distribution
Roots can be distinguished functionally into two different organs: coarse roots are responsible for mechan-
ical support and transport of water and nutrients towards the stem, whereas fine roots are responsible for
absorbing water and nutrients.

34
CHAPTER 2. MODEL INPUTS
0
250
500
750
1000
0.00
0.05
0.10
0.15
0.20
0.25
Leaf Area Density (m2/m3)
Height (cm)
T1_148
T2_168
S1_165
0
250
500
750
1000
0.0
0.1
0.2
0.3
0.4
Leaf Area Density (m2/m3)
Height (cm)
Figure 2.3: Leaf area density distribution of woody vegetation in a forest stand. The left panel shows the
distribution for each plant cohort separately, whereas the right panel shows the overall density distribution.
0
250
500
750
1000
0.00
0.25
0.50
0.75
1.00
1.25
Leaf Area Density (m2/m3)
Height (cm)
T1_148
T2_168
S1_165
Herbaceous
0
250
500
750
1000
0.00
0.25
0.50
0.75
1.00
1.25
Leaf Area Density (m2/m3)
Height (cm)
Figure 2.4: Leaf area density distribution in a forest stand, including the herbaceous layer. The left panel
shows the distribution for each plant cohort separately, whereas the right panel shows the overall density
distribution.

2.4. VEGETATION DESCRIPTION
35
Analogously to the aboveground vegetation parameters, inputs describing depths corresponding to 50% and
95% of fine roots (Z50,i and Z95,i) are used to completely specify the distribution of roots across soil layers.
The root system of each plant cohort i is described using FRPi,s, the proportion of fine roots (with respect
to the whole plant) in each soil layer s. FRPi,s values are normally defined using the linear dose response
model (Schenk & Jackson 2002; Collins & Bras 2007):
FRPi,s
=
Yi(Zs) −Yi(Zs−1)
(2.17)
Yi(z)
=
1
1 + (z/Z50,i)ci
(2.18)
where Yi(z) is the cumulative fraction of fine root mass located between surface and depth z; Z50,i is the
depth (in mm) above which 50% of the root mass is located; and ci is a shape parameter related to Z50,i
and Z95,i as ci = 2.94/ ln(Z50,i/Z95,i).
The linear dose response model is quite flexible with respect to fine root distribution (see function
root_ldrDistribution()). The following figure shows the fine root distribution profile of the same cohorts
as in fig. 2.3 (see vprofile_rootDistribution()):
0
25
50
75
100
0
2
4
6
% of fine roots/cm
Depth (cm)
T1_148
T2_168
S1_165
Figure 2.5: Examples of root density profile according to the linear dose response model.
The actual input to simulation functions spwb(), growth() and alike, describes fine root distribution using
the matrix of FRPi,s values - not Z50,i and Z95,i -, which means that the proportions of fine roots can be
modified manually or be defined by another model. In fact, medfate also allows calculating FRPi,s values
assuming a conic distribution of fine roots (see root_conicDistribution()).
2.4.8
Water pools and root horizontal distribution
By default, models in medfate assume that soil moisture under all plant cohorts is the same (i.e. water
sources corresponding to vertical soil layers are shared among cohorts). Therefore, it neglects spatial variation
in soil moisture, against moisture variation patterns observed in mixed stands (Schume et al. 2004). However,

36
CHAPTER 2. MODEL INPUTS
variations in soil moisture beneath plant cohorts (and, implicitly, horizontal variation of soil moisture)
can also be simulated if required by the user (see parameter rhizosphereOverlap in 2.6). This involves
considering that a given plant cohort will perform water uptake from the water pool surrounding its roots,
whereas it may not have access to the water beneath other plants. However, there can exist some degree of
horizontal overlap between water pools exploited by different plants.
Considering water pools involves partitioning the stand area into fractions corresponding to the abundance of
each plant cohort. More specifically, the model defines as many water pools as plant cohorts, with proportions
defined by their LAI values:
fpool,i = LAIlive
i
LAIlive
stand
(2.19)
Models assume that the rhizosphere of each plant cohort occupies its own water pool but may extend into
the water pools under other plant cohorts. In other words, the root systems of different cohorts may overlap
horizontally. Moreover, the horizontal overlap of root systems will vary across soil layers. A given plant
cohort i will have its roots in layer s partitioned among different water pools. We thus need to define fri,s,j,
the (horizontal) proportion of fine roots of cohort i in layer s of the water pool j, with the restriction that:
X
j
fri,s,j = 1 ∀i, s
(2.20)
A simplifying assumption is to force a complete independence of water pools, which is equal to say
that fri,s,j = 1 for i = j and fri,s,j = 0 when i ̸= j (this is the simplification adopted when us-
ing rhizosphereOverlap = "none").
In the general case of partial overlap (rhizosphereOverlap =
"partial"), it is important to realize that proper estimation of fri,s,j is challenging when we do not have
explicit plant coordinates, root lateral widths, etc.
At this point, let us assume we have a reasonable
estimate of V oli, the soil volume explored by coarse roots of an individual of cohort i. Assuming that
the proportion of fine roots in each layer is proportional to the proportion of total soil volume explored by
coarse roots that corresponds to the same layer we have that V oli,s, the soil volume explored by coarse
roots in layer s is:
V oli,s = FRPi,s · V oli
(2.21)
In medfate, coarse roots are represented by axial and radial components. The length of axial component of
a given layer (Laxial,i,s) is simply equivalent to its bottom depth, whereas the radial component (Lradial,i,s)
is unknown. However, we can assume that the soil volume explored by coarse roots corresponds to a cylinder:
V oli,s = π · L2
radial,i,s · Laxial,i,s
(2.22)
and substituting the soil volume V oli,s in the equation above we can isolate Lradial,i,s (see function
root_coarseRootLengthsFromVolume()). Once we have the radial component we can estimate the area
(m2) covered by coarse roots of an individual of the cohort in a given layer s:
Areai,s = π · L2
radial,i,s
(2.23)
We can then compare Areai,s to the area of the water pool for an individual of cohort i, which in m2 is:
AreaPooli = 10000 · fpool,i/Ni
(2.24)
If Areai,s ≤AreaPooli, then the roots of the individual do not exceed the area of the pool, in other
words fri,s,i = 1 and fri,s,j = 0 for all j ̸= i.
If Areai,s > AreaPooli then the excess should be
counted as overlap with the other pools. Assuming that plants are randomly distributed (i.e. no clump-
ing) the probability of finding the pool of a cohort is equal to the proportion of its water pool (see function
root_horizontalProportions()). All these calculations were done assuming V oli were known. Estimation
of V oli depends on the complexity of the water balance model and is explained in A.4.6.

2.5. METEREOLOGICAL INPUT
37
2.4.9
Functional traits and vegetation initialization
Besides the physical representation of vegetation, forest ecosystem models require information regarding plant
functional traits, because this influences the outcome of physical, physiological and hydrological processes.
In the following chapters, we will indicate for each simulated process its required plant functional parameters.
A description of all parameters is provided in data frame SpParamsDefinition included in the package.
Normally, functional traits are described at the species level because infra-specific parameters are hard to
get. Even at the species level, many functional (e.g. physiological) traits are hard to obtain, so in medfate
we provide a default species parameter table for woody species found in Spain, with many of them occurring
elsewhere in the Mediterranean Basin (SpParamsMED). User can modify this data frame to account for intra-
specific trait variation (see function modifySpParams()).
The package provides functions forest2spwbInput() and forest2growthInput() that prepare the forest
vegetation input for simulation functions spwb() and growth(), respectively (see 2.1.1). This initialization
mostly consists in compiling the necessary functional traits from the species parameter table, following the
SPi attribute of woody plant cohorts. Some new model parameters are estimated from the initial ones,
while taking into account the structural attributes of cohorts (an example of these derived quantities is stem
conductance, which estimated from stem xylem conductivity, Huber value and plant height). Users can
take the output of these initialization functions and replace parameter values for specific plant cohorts (see
function modifyCohortParams()).
2.4.10
Update of structural variables during simulations
Vegetation characteristics stay constant during simulations using functions spwb() or pwb(), although the
actual (unfolded) leaf area and dead leaf area may vary depending on leaf phenology.
In contrast, growth simulation requires updating the structure of vegetation, i.e. plant heights, tree diameters,
tree density and shrub cover. Function growth() can modify any of the vegetation attributes. Finally,
function fordyn() modifies not only structural variables of the initial cohorts but also involves the removal
of dead (or cut) woody cohorts and recruitment of new woody cohorts during simulations.
2.5
Metereological input
Weather input data must include variables calculated at the daily scale. Weather data should be arranged
in a data frame with days in rows and variables in columns.
Since it allows producing data frames with appropriate variable units and row/column names, we recommend
meteorological input to be generated using package meteoland (De Cáceres et al. 2018), but other sources
are possible.
2.5.1
Date format
Dates are needed in medfate to estimate parameters like solar declination or the day of the year (DOY ).
Dates can be specified in the input data frame either:
• As data frame row names (in string format year-month-day)
• As Date elements in a column called "dates".

38
CHAPTER 2. MODEL INPUTS
2.5.2
Required weather variables
Some weather variables must be present always in the input data frame, whereas others are optional, meaning
that the package can estimate them if missing. The following table indicates the symbols, units, definitions
and the variable name in R of input weather variables that are always required:
Symbol
Units
R param
Description
Optional
Tmin
◦C
MinTemperatureMinimum temperature
No
Tmax
◦C
MaxTemperatureMaximum temperature
No
RHmin
%
MinRelativeHumidity
Minimum relative humidity
No
RHmax
%
MaxRelativeHumidity
Maximum relative humidity
No
P
L·m−2 =
mm
PrecipitationPrecipitation (either rainfall or snow).
No
Rad
MJ ·m−2
Radiation
Solar radiation after accounting for clouds
No
2.5.3
Optional weather variables
The following table lists the same attributes for input weather variables that are optional:
Symbol
Units
R param
Description
Optional
u
m · s−1
WindSpeed
Wind speed
Yes
Rint
mm · h−1
RainfallIntensity
Rainfall intensity
Yes
Catm
ppm
CO2
Atmospheric (above-canopy) CO2 concentration
Yes
Patm
kPa
Patm
Surface atmospheric pressure
Yes
Pfire
[0-1]
FireProbability
Probability of wildfire occurrence
Yes
Missing wind speed (u) and CO2 values will be replaced by defaults defined in control parameters. As an
alternative to providing daily atmospheric CO2 concentration values, simulation functions allow the user to
provide CO2 concentration values in annual time steps using a separate vector.
When missing, atmospheric pressure (Patm) is also derived from elevation using an utility function available
in meteoland.
Missing rainfall intensity (Rint) values will be estimated from the current month using function
hydrology_rainfallIntensity() and the seasonality of rainfall intensity given in control parameters (see
defaultRainfallIntensityPerMonth in 3.5.3).
2.5.4
Derived weather variables
While the weather variables listed in the tables above are provided as inputs, medfate derives other at-
mospheric variables from them, using also topographic information (see utility functions of the meteoland
reference manual):
Symbol
Units
R param
Description
ρair
kg · m−3
Air density
eatm
kPa
Atmospheric water vapor pressure
Tmean
◦C
MeanTemperatureMean daily temperature
PET
L · m−2 =
mm
PET
Potential evapotranspiration, calculated using Penman’s
(1948) equation

2.6. SIMULATION CONTROL
39
2.6
Simulation control
Simulation
control
parameters
are
a
list
of
global
parameter
values,
initialized
using
function
defaultControl(), that the user can modify to change the general behavior of simulation functions.
Here is the set of global control parameters currently accepted in medfate:
names(defaultControl())
##
[1] "fillMissingRootParams"
"fillMissingSpParams"
"fillMissingWithGenusPara
##
[4] "verbose"
"subdailyResults"
"standResults"
##
[7] "soilResults"
"plantResults"
"leafResults"
##
[10] "temperatureResults"
"fireHazardResults"
"fireHazardStandardWind"
##
[13] "fireHazardStandardDFMC"
"transpirationMode"
"soilFunctions"
##
[16] "ndailysteps"
"max_nsubsteps_soil"
"defaultWindSpeed"
##
[19] "defaultCO2"
"defaultRainfallIntensityPerMonth" "snowpack"
##
[22] "leafPhenology"
"bareSoilEvaporation"
"unlimitedSoilWater"
##
[25] "interceptionMode"
"infiltrationMode"
"soilDomains"
##
[28] "rhizosphereOverlap"
"unfoldingDD"
"verticalLayerSize"
##
[31] "windMeasurementHeight"
"segmentedXylemVulnerability"
"stemCavitationRecovery"
##
[34] "leafCavitationRecovery"
"hydraulicRedistributionFraction"
"nsubsteps_canopy"
##
[37] "taper"
"multiLayerBalance"
"sapFluidityVariation"
##
[40] "TPhase_gmin"
"Q10_1_gmin"
"Q10_2_gmin"
##
[43] "rootRadialConductance"
"averageFracRhizosphereResistance" "thermalCapacityLAI"
##
[46] "boundaryLayerSize"
"cavitationRecoveryMaximumRate"
"sunlitShade"
##
[49] "numericParams"
"leafCavitationEffects"
"stemCavitationEffects"
##
[52] "stomatalSubmodel"
"plantCapacitance"
"cavitationFlux"
##
[55] "soilDisconnection"
"leafCuticularTranspiration"
"stemCuticularTranspirati
##
[58] "C_SApoInit"
"C_LApoInit"
"k_SSym"
##
[61] "fractionLeafSymplasm"
"gs_NightFrac"
"JarvisPAR"
##
[64] "fTRBToLeaf"
"gCrown0"
"subdailyCarbonBalance"
##
[67] "allowDessication"
"allowStarvation"
"sinkLimitation"
##
[70] "shrubDynamics"
"herbDynamics"
"allocationStrategy"
##
[73] "phloemConductanceFactor"
"nonSugarConcentration"
"equilibriumOsmoticConcen
##
[76] "minimumRelativeStarchForGrowth"
"constructionCosts"
"senescenceRates"
##
[79] "maximumRelativeGrowthRates"
"mortalityMode"
"mortalityBaselineRate"
##
[82] "mortalityRelativeSugarThreshold"
"mortalityRWCThreshold"
"recrTreeDBH"
##
[85] "recrTreeDensity"
"ingrowthTreeDBH"
"ingrowthTreeDensity"
##
[88] "allowSeedBankDynamics"
"allowRecruitment"
"allowResprouting"
##
[91] "recruitmentMode"
"removeEmptyCohorts"
"minimumTreeCohortDensity
##
[94] "minimumShrubCohortCover"
"dynamicallyMergeCohorts"
"seedRain"
##
[97] "seedProductionTreeHeight"
"seedProductionShrubHeight"
"probRecr"
## [100] "minTempRecr"
"minMoistureRecr"
"minFPARRecr"
## [103] "recrTreeHeight"
"recrShrubCover"
"recrShrubHeight"
## [106] "recrTreeZ50"
"recrShrubZ50"
"recrTreeZ95"
## [109] "recrShrubZ95"
Control parameters are employed when initializing vegetation inputs and state variables using functions
forest2spwbInput() and forest2growthInput(), since they are needed also to make decisions at the
point of initialization. Control parameters are also stored in the result of these functions, so the user does
not need to specify again control parameters when calling simulation functions such as spwb() or growth().
Function fordyn() is different than the other simulation functions, because the list control parameters is
directly passed to the function (see 2.1.1).

40
CHAPTER 2. MODEL INPUTS
Even if the list of control parameters is long, not all control parameters are relevant to all simulation functions
(this will be indicated in the following chapters), and most of them should not be altered from their default
values. However, there are a set of parameters that are worth learning:
• verbose [=TRUE]: Whether extra console output is desired during simulations.
• transpirationMode [="Granier"] is an important control parameter, because it allows the user to
switch between the basic (i.e. "Granier") and advanced (i.e., either "Sperry" or "Sureau") water
balance models, corresponding to chapters 3 and 7, respectively.
• rhizosphereOverlap [="total"] is also a relevant parameter, since changing its default value allows
considering that plants extract soil water from partially or totally unrelated water pools, as explained
in 2.4.8.
Some parameters are only relevant for parameter estimation at the stage of initialization:
• fillMissingRootParams [= TRUE]: Boolean flag to indicate that initialization functions should
provide estimates for Z50 and Z95 if these are lacking in the forest data.
Note that if
fillMissingRootParams is set to FALSE then simulations may fail if the user does not provide
values for Z50 and Z95 in tree or shrub data.
• fillMissingSpParams [=TRUE]: Boolean flag to indicate that initialization functions should provide
estimates for functional parameters if these are lacking in the species parameter table SpParams. Note
that if fillMissingSpParams is set to FALSE then simulations may fail if the user does not provide
values for required parameters.
• fillMissingWithGenusParams [=TRUE]: Boolean flag to indicate that initializing functions should
provide estimates from genus value, if species-level values are missing in the species parameter table
SpParams but genus-level ones are not.

Part II
Basic water balance modelling
41


Chapter 3
Basic water balance model
This chapter provides an overview of the basic soil and plant water balance model included in medfate. The
model allows simulating vertical water fluxes in a forest stand, and performs soil and plant water balance on
a daily step basis for the period corresponding to input weather data.
The model is run using function spwb(), for a set of days, or function spwb_day(), for a single day. Alter-
natively, one can use function pwb() to evaluate plant transpiration and drought stress resulting from given
weather and soil moisture dynamics. The basic water balance model corresponds to the control variable
transpirationMode = "Granier".
The description of the model presented here conforms to a large extent to the description given in De
Cáceres et al. (2015), but includes several modifications that have been implemented since the publication
of this scientific article. The information provided in this chapter should be enough to understand what the
model does and when it can be useful, but the reading the following ones should provide a more detailed
understanding on how the different processes are formulated.
3.1
Design principles
The water balance model considers only the vertical spatial dimension of the stand and not the horizontal
distribution of plants within it. In other words, the model is not spatially explicit (i.e., plants do not have
horizontal coordinates nor interact for space explicitly).
Woody vegetation in the stand is divided into
groups, here referred to as plant cohorts of different species, height and leaf area index (LAI). Height and
LAI values determine competition for light. LAI values also drive competition for soil water, along with
fine root distribution. The model can also consider a layer herbaceous vegetation, which also has a height
value and LAI, but where plant cohorts are not distinguished and with fine roots confined to the topmost
layer.
The soil water balance initially followed mostly the design principles of SIERRA (Mouillot et al.
2001;
Ruffault et al. 2013, 2014) and BILJOU (Granier et al. 1999, 2007), although nowadays it has evolved
substantially. Hydrological processes include rainfall interception loss (Gash et al. 1995; Liu 2001), plant
transpiration, evaporation from bare soil (Ritchie 1972), snow melt, infiltration into the soil matrix (Green
& Ampt 1911; Boughton 1989) and vertical water movement within the soil, the latter following MACRO
(Jarvis et al. 1991; Larsbo et al. 2005), a dual-permeability model where total porosity is partitioned into
two separate flow regions (matrix and macropores), each with its own degree of saturation, conductivity
and flow rate. Potential evapo-transpiration (PET) determines maximum herbaceous and maximum canopy
transpiration (Trmax) using an empirical relationship between the LAI of the stand and the ratio Trmax/PET
(Granier et al. 1999). Actual plant transpiration is estimated using a function that depends not only on
Trmax but also on current soil moisture levels, cohort-specific drought resistance, fine root distribution and
the degree of shading of the target plant cohort. When soil water deficit progresses, transpiration rates are
43

44
CHAPTER 3. BASIC WATER BALANCE MODEL
consequently reduced, but minimum transpiration rates of woody vegetation are not zero, because of the
role of cuticular transpiration and imperfectly closed stomata (Duursma et al. 2018). Woody plant water
status (i.e. plant water potential and, hence, plant water content) follows variations of soil moisture in the
soil layers where fine roots are located.
By default, the model assumes that soil moisture under all plant cohorts is the same (i.e. water sources
corresponding to vertical soil layers are shared among cohorts). However, 3D variations in soil moisture
beneath plant cohorts can be simulated in spatially-explicit forest ecosystem models (Manoli et al. 2017;
Rötzer et al. 2017). The water balance model does not simulate horizontal spatial processes explicitly, but
allows considering more or less independent water pools for plant cohorts. If partial or completely indepen-
dent water pools are considered, hydrological processes are replicated for the fraction of soil corresponding
to each woody cohort. Transpiration of each plant cohort depends on the soil moisture beneath itself and,
depending on the degree of rhizosphere overlap, on the soil moisture beneath other plant cohorts.
3.2
State variables
The following are state variables in the model under all simulations:
• Cumulative degree days (a) to budburst, (b) to complete unfolding or (c) to senescence (Seco,d, Sunf,d
or Ssen,d; all in ◦C), are tracked by the model to determine leaf phenological status (see 4.1).
• Soil moisture content dynamics on each layer s are tracked daily using Ws = θs(Ψ)/θfc,s, the proportion
of soil moisture in relation to field capacity, where moisture at field capacity, θfc,s, is assumed to
correspond to Ψfc = −0.033 MPa. Note that Ws values larger than one are possible if the soil is
between field capacity and saturation (which can happen if deep drainage is not allowed).
• Plant water potential (Ψplant,i) of each plant cohort i are also tracked daily and follows the soil water
potential of layers (or water pools) where fine roots are located.
Additional state variables depend on the activation of specific control flags:
• If snow accumulation/melting is considered, the model tracks Ssnow, the snow water equivalent (in
mm) of the snow pack storage over the surface.
• If stem cavitation is not completely reversible, the model tracks PLCstem,i and PLCleaf,i, the propor-
tion of conductivity lost the stem and leaves, respectively, of plants of cohort i.
• If the degree of rhizosphere overlap between plant cohorts is not total (i.e. if rhizosphereOverlap
= "none" or rhizosphereOverlap = "partial"), the model also tracks Wi,s, the proportion of soil
moisture in relation to field capacity for layer s within the areal fraction of the stand covered by the
woody cohort i.
3.3
Water balance
Water balance is performed for both the snow pack and the soil (fig. 3.1). Precipitation (P) is considered
be snow precipitation (Ps) or rainfall (Pr), depending on temperature. Thus, we have:
P = Pr + Ps
(3.1)
The water balance of the snow pack (∆Ssnow in mm of snow water equivalents) is simply defined as:
∆Ssnow = Ps −Sm
(3.2)
where Ps is precipitation as snowfall and Sm is snow melt. Interception on canopy surfaces is only modelled
for liquid precipitation, which leads to a partioning of Pr into interception loss (In; i.e. water evaporated

3.3. WATER BALANCE
45
after being intercepted by the canopy surfaces) and net rainfall (Prnet; the sum of throughfall and stem
flow):
Pr = Prnet + In
(3.3)
Several water sources can contribute to soil infiltration, namely net rainfall (Prnet), surface runon from
nearby locations (Ro, if provided) and snowmelt (Sm). Given that not all water that reaches the soil surface
actually infiltrates, the amount of water entering the first soil layer via infiltration (If) is:
If = Prnet + Sm + Ro −Ie
(3.4)
where Ie is the infiltration excess that may occur. Other water inputs into the soil can come via capillarity
rise (Cr) from the water table (if present) or via lateral interflow from nearby locations (Lw; if provided,
assumed positive in the direction of entering the local soil). There are multiple ways water can leave the
soil. Regarding purely physical processes we have the evaporation from soil surface (Es), saturation excess
(Se) and deep drainage (Dd). Fluxes mediated by plants are the transpiration made by herbaceous plants
(Trherb) and the transpiration made by woody plants (Trwoody).
Figure 3.1: Schematic representation of soil and snow pack water balance components.
Subsurface lat-
eral source/sinks and surface runon are omitted for simplicity. Green and blue boxes represent outflows
corresponding to green and blue water respectively.
Taking all input and output terms, daily variations in soil water content (∆Vsoil in mm) are then summarized
as:
∆Vsoil = (If + Lw + Cr) −(Dd + Se + Es + Trherb + Trwoody)
(3.5)
The water leaving the soil via surface runoff (Ru) is defined as the sum of infiltration excess (Ie) and
saturation excess (Se):
Ru = Ie + Se
(3.6)
If we consider soil and snow pack altogether, the water balance of the whole forest becomes:
∆Vsoil + ∆Ssnow = (P + Ro + Lw + Cr) −(Dd + Ru + In + Es + Trherb + Trwoody)
(3.7)

46
CHAPTER 3. BASIC WATER BALANCE MODEL
Among inputs, precipitation (P) will the most relevant inflow on most instances. The liquid water fluxes
contributing to blue water outflow (i.e. entering river networks or leading to ground water) are runoff (Ru)
and deep drainage (Dd). Water vapor fluxes (Es, Trwoody, Trherb, In) contribute to total evapotranspiration,
or green water (i.e. water vapor returning to the atmosphere). These are represented in Fig. 3.1 using
blue/green boxes.
While the above describes the default water balance equations, variations can occur depending on specific
control flags:
a. If snow dynamics are considered [snowpack], evaporation from bare soil cannot occur if there is a snow
pack over the soil (i.e., if Ssnow > 0 then Es = 0).
b. If plant water pools are considered [rhizosphereOverlap], the soil water balance equation applies not
only to the soil of the overall stand but also to the soil beneath each woody plant cohort. The fraction
of stand area corresponding to the water pool of each cohort is used to keep the water balance at the
two scales aligned. Moreover, the water balances of soils beneath the different plant cohort are more
or less correlated depending on the degree of rhizosphere overlap.
c. If soil flows are simulated using a dual-permeability domain [soilDomains] there are water balance
equations for the soil matrix and the macropore domain. Moreover, it affects the infiltration amounts
(and hence runoff), in the latter including infiltration via macropores.
3.4
Process scheduling
For every day to be simulated, the model performs the following steps:
1. Update leaf area values according to the phenology of species and recalculate radiation extinction
(sections 4.1 and 4.2).
2. Determine rainfall interception loss (In) and net rainfall (Prnet) (section 5.3). The amount of water
reaching the soil surface from the rainfall event is the sum of net rainfall (Prnet) and surface runon
(Ro), if given. If snow dynamics are included, increase snow pack from snow precipitation (Ps) and
decrease it following snow melt (Sm) (section 5.2).
3. Determine bare soil evaporation (Es), if snow is not present (section 5.4), and herbaceous transpiration
(Trherb; section 5.5).
4. Determine woody plant transpiration (Trwoody), including hydraulic redistribution, and photosynthesis
(chapter 6). Update plant water potential (Ψplant) and plant drought stress for each plant cohort.
5. Determine rainfall infiltration (section 5.6) and vertical water movement within the soil (section 5.7),
while considering soil layer source/sinks from snow melt, bare soil evaporation and herbaceous transpi-
ration and woody plant extraction/redistribution. This updates soil moisture and returns infiltration
(If), runoff (Ru) and deep drainage (Dd).
6. If fire hazard calculations are requested, estimate live and dead fuel moisture and potential fire be-
haviour (chapter 24).
The set of steps corresponds to simulations if plant water pools are not considered, so that only the water
balance of the overall soil matters. If plant water pools are considered, steps 1, 2 and 6 are the same, because
they apply to the whole forest stand. However, steps 3 is performed for each water pool separately because it
depends on antecedent soil moisture. Step 4 also involves defining woody plant water uptake from different
plant water pools depending on the proportion of fine roots of each woody cohort in each pool (see 6.1.5).
Step 5 is also performed on the soil corresponding to each pool, and the resulting infiltration, runoff and
drainage estimates are averaged at the stand level. Finally, the soil moisture of the overall soil is estimated
by averaging the soil moisture of water pools.

3.5. INPUTS AND OUTPUTS
47
3.5
Inputs and outputs
3.5.1
Soil, vegetation and meteorology
Soil
Soil input requirements are fully described in section 2.3.
Vegetation
Vegetation input requirements are fully described in section 2.4.
Trees and shrubs do not need to be
characterized with different variables in soil water balance calculations, since both kinds of woody cohorts
have a LAI value. In most cases, users only need to estimate the leaf area index corresponding to live
leaves, i.e. LAIlive, because normally at the starting point all leaves are expanded (i.e. LAIϕ = LAIlive) and
one can assume no dead leaves in the canopy (i.e., LAIdead = 0). Vegetation characteristics stay constant
during simulations using function spwb(), although the actual expanded leaf area (LAIϕ) and dead leaf area
(LAIdead) may vary is the species is winter deciduous.
Meteorology
The minimum weather variables required to run the model are min/max temperatures (Tmin and Tmax),
min/max relative humidity (RHmin and RHmax), precipitation (P) and solar radiation (Rad). Wind speed
(u) is also needed, but the user may use missing values if not available (a default value will be used in this
case). Wind speed is assumed to have been measured at a specific height above the canopy (by default at 2
m). Atmospheric CO2 concentration (Catm) may also be specified, but if missing a default constant value is
assumed, which is taken from the control parameters. Definitions and units of these variables were given in
section 2.5.
3.5.2
Vegetation functional parameters
The following sets of functional parameters should be supplied for each woody plant cohort. In practice,
they are normally estimated from the species-specific parameter table and imputation of missing values (see
A). Functional attributes are filled for each cohort i by function forest2spwbInput() from species identity
(i.e. SPi). However, different parameters can be specified for different cohorts of the same species if desired
(see section 2.4.9).
A first set of functional parameters refers to leaf phenology (paramsPhenology):
Symbol
Units
R
Description
PhenologyType
Leaf phenology type (oneflush-evergreen, progressive-evergreen,
winter-deciduous, winter-semideciduous)
LD
years
LeafDuration
Average duration of leaves (in years).
t0,eco
days
t0gdd
Date to start the accumulation of degree days.
S∗
eco
◦C
Sgdd
Degree days corresponding to leaf budburst (see section 4.1.2).
Teco
◦C
Tbgdd
Base temperature for the calculation of degree days to leaf budburst
(see section 4.1.2).
S∗
sen
◦C
Ssen
Degree days corresponding to leaf senescence (see section 4.1.3).
Phsen
hours
Phsen
Photoperiod corresponding to start counting senescence degree-days
(see section 4.1.3).
Tsen
◦C
Tbsen
Base temperature for the calculation of degree days to leaf senescence
(see section 4.1.3).
xsen
{0,1,2}
xsen
Discrete values, to allow for any absent/proportional/more than
proportional effects of temperature on senescence (see section 4.1.3).
ysen
{0,1,2}
ysen
Discrete values, to allow for any absent/proportional/more than
proportional effects of photoperiod on senescence (see section 4.1.3).

48
CHAPTER 3. BASIC WATER BALANCE MODEL
A second set of parameters relate to light extinction and water interception (paramsInterception):
Symbol
Units
R
Description
kP AR
kPAR
PAR extinction coefficient (see section 4.2).
swater
mm H2OůLAI−1
g
Crown water storage capacity (i.e. depth of water that can be
retained by leaves and branches) per LAI unit (see section 5.3).
A third set includes parameters related to plant anatomic and morphological attributes (paramsAnatomy):
Symbol
Units
R param
Description
1/Hv
m2 · m−2
Al2As
Ratio of leaf area to sapwood area
RLR
m2 · m−2
Ar2Al
Fine root area to leaf area ratio
SLA
m2 · kg−1
SLA
Specific leaf area
ρleaf
g · cm−3
LeafDensity
Leaf tissue density
ρwood
g · cm−3
WoodDensity
Wood tissue density
ρfineroot
g · cm−3
FineRootDensityFine root tissue density
SRL
cm · g−1
SRL
Specific root length
RLD
cm · cm−3
RLD
Fine root length density (i.e. density of root length per soil
volume)
r6.35
r635
Ratio between the weight of leaves plus branches and the
weight of leaves alone for branches of 6.35 mm
A fourth set of parameters are related to transpiration and photosynthesis (paramsTranspiration):
Symbol
Units
R
Description
gswmin
mol H2O ·
s−1 · m−2
Gwmin
Minimum stomatal conductance to water vapour
Tmax,LAI
Tmax_LAIEmpirical coefficient relating LAI with the ratio of maximum
transpiration over potential evapotranspiration (see section 6.1.1).
Tmax,sqLAI
Tmax_LAIsq
Empirical coefficient relating squared LAI with the ratio of maximum
transpiration over potential evapotranspiration (see section 6.1.1).
Ψextract
MPa
Psi_Extract
The water potential at which plant transpiration is 50% of its
maximum (see section 6.1.2).
cextract
Exp_Extract
Parameter of the Weibull function regulating transpiration reduction
(see section 6.1.2).
cleaf, dleaf
(unitless),
MPa
VCleaf_c,
VCleaf_d
Parameters of the vulnerability curve for leaf xylem
cstem, dstem
(unitless),
MPa
VCstem_c,
VCstem_d
Parameters of the vulnerability curve for stem xylem
WUEmax
g C ·mm−1
WUE
Water use efficiency at VPD = 1kPa and without light or CO2
limitations (see section 6.1.6).
WUEP AR
WUE_par Coefficient describing the progressive decay of WUE with lower light
levels (see section 6.1.6).
WUECO2
WUE_co2 Coefficient for WUE dependency on atmospheric CO2 concentration
6.1.6).
WUEV P D
WUE_vpd Coefficient for WUE dependency on vapor pressure deficit 6.1.6).
A fifth (final) set of parameters are related to water storage and water relations in plant tissues
(paramsWaterStorage):

3.5. INPUTS AND OUTPUTS
49
Symbol
Units
R
Description
LFMCmax
%
maxFMC Maximum live fuel moisture content, corresponding to fine fuels (<
6.35 mm twigs and leaves).
ϵleaf
MPa
LeafEPS Modulus of elasticity of leaves
ϵstem
MPa
StemEPS Modulus of elasticity of symplastic xylem tissue
π0,leaf
MPa
LeafPI0 Osmotic potential at full turgor of leaves
π0,stem
MPa
StemPI0 Osmotic potential at full turgor of symplastic xylem tissue
fapo,leaf
[0-1]
LeafAF Apoplastic fraction in leaf tissues
fapo,stem
[0-1]
StemAF Apoplastic fraction in stem tissues
Vleaf
l · m−2
Vleaf
Leaf water capacity per leaf area unit
Vsapwood
l · m−2
VsapwoodSapwood water capacity per leaf area unit
3.5.3
Control parameters
Control parameters modulate the overall behaviour of water balance simulations (see section 2.6). Most
importantly, transpirationMode defines the transpiration model, which in turn defines the complexity of
the water balance model. If transpirationMode = "Granier" (the default value) then the basic water
balance model is used.
The other relevant control parameters for the basic water balance model are:
• soilFunctions [="SX"]: Soil water retention curve and conductivity functions, either ‘SX’ (for Sax-
ton) or ‘VG’ (for Van Genuchten).
• ndailysteps [= 24]: Number of steps into which each day is divided for determination of soil water
balance (24 equals 1-hour intervals).
• max_nsubsteps_soil [= 300]: Maximum number of substeps for soil water balance solving.
• defaultWindSpeed [= 2.5]: Default value for wind speed (in m·s−1) when this is missing (only used
for leaf fall, see section 4.1).
• defaultCO2 [=386]: Default atmospheric (abovecanopy) CO2 concentration (in micromol CO2·mol−1
= ppm). This value will be used whenever CO2 concentration is not specified in the weather input.
• defaultRainfallIntensityPerMonth [= c(1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 5.6, 5.6, 5.6,
5.6, 5.6, 1.5)]: A vector of twelve values indicating the rainfall intensity (mm/h) per month. By
default synoptic storms (1.5 mm/h) are assumed between December and June, and convective storms
(5.6 mm/h) are assumed between July and November (Miralles et al. 2010).
• snowpack [= TRUE]: Whether dynamics of snow pack are included (see section 5.2).
• leafPhenology [ = TRUE]: Whether leaf phenology is simulated (see section 4.1). If FALSE then all
species are assumed to be evergreen.
• bareSoilEvaporation [= TRUE]: Whether evaporation from the soil surface is simulated (see section
5.4).
• unlimitedSoilWater [=FALSE]: Boolean flag to indicate the simulation of plant transpiration assum-
ing that soil water is always at field capacity.
• unfoldingDD [= 300]: Degree-days for complete leaf unfolding after budburst has occurred (S∗
unf;
see section 4.1.2).
• interceptionMode [= "Gash1995"]: Infiltration model, either “Gash1995” or “Liu2001”; see section
5.3.
• infiltrationMode [= "GreenAmpt1911"]:
Infiltration
model,
either
“GreenAmpt1911”
or
“Boughton1989”; see section 5.6.
• soilDomains [= "single"]: Either “single” (for single domain) or “dual” (for dual-permeability) (see
section 5.7).
• fireHazardResults [= FALSE]: Boolean flag to force calculation of daily fire hazard.
• rhizosphereOverlap [="total]: A string indicating the degree of rhizosphere spatial overlap between
plant cohorts:

50
CHAPTER 3. BASIC WATER BALANCE MODEL
– "none" - no overlap (independent water pools).
– "partial" - partial overlap determined by coarse root volume.
– "total" - total overlap (plants extract from common soil pools).
• verticalLayerSize [= 100]: Size of vertical layers (in cm) for the calculation of light extinction (see
section 2.4.6).
• windMeasurementHeight [ = 200]: Height (in cm) over the canopy corresponding to wind measure-
ments.
• stemCavitationRecovery/leafCavitationRecovery [= "rate"]: A string indicating how to model
recovery of xylem conductance (see section 12.4). Allowed values are:
– "none" - no recovery.
– "annual" - complete recovery every first day of the year.
– "total" - instantaneous complete recovery.
– "rate" - following a rate of new leaf or sapwood formation.
3.5.4
Model output
Functions spwb() and pwb() return a list of a class with the same name. The first four elements of this
list (i.e., latitude, topography, weather and spwbInput) are simply copies of model inputs. The next
element is spwbOutput, which contains the state of the input object at the end of the simulation (this
can be used to perform further simulations starting with current values of state variables). The next five
elements correspond to water balance flows, soil state variables, stand-level variables, plant-level and fire
hazard results:
Element
Description
WaterBalance
Climatic input and water balance flows of eq.(3.5) (i.e. net precipitation, infiltration,
runoff, transpiration. . . ). All of them in mm = l · m−2.
Soil
Soil variables for each soil layer: Moisture relative to field capacity (Ws), water potential
(Ψs) and volumetric water content (Vs). Only returned if soilResults = TRUE.
Stand
Stand-level variables, such as LAIϕ
stand, LAIdead
stand, the water retention capacity of the
canopy (Scanopy) or the fraction of light reaching the ground (LP AR
ground and LSW R
ground). Only
returned if standResults = TRUE.
Plants
Variables defined at the level of woody plant cohort, such as expanded leaf area (LAIphi
i
),
transpiration, photosynthesis, water potential, etc. Only returned if plantResults =
TRUE.
FireHazard
Fire hazard variables (fuel moisture, rate of spread, fire potentials, etc). Only returned if
fireHazardResults = TRUE.
Elements WaterBalance, Soil, Stand and FireHazard are data frames with dates in rows and variables in
columns, whereas Plants is itself a list with several data frames, with dates in rows and woody plant cohorts
in columns:
Element
Symbol
Units
Description
LAI
LAIϕ
m2 · m−2
Leaf area index (expanded).
LAIlive
LAIlive
m2 · m−2
Leaf area index (live).
AbsorbedSWRFraction
fi
[0-1]
Fraction of shortwave radiation absorbed.
Transpiration Tr
mm
Transpiration per unit ground area.
GrossPhotosynthesis
Ag
g C · m−2
Gross photosynthesis per unit ground area.
PlantPsi
Ψplant
MPa
Plant water potential.
LeafPLC
PLCleaf
[0-1]
Degree of leaf embolisation.
StemPLC
PLCstem
[0-1]
Degree of stem embolisation.

3.6. APPLICATIONS
51
Element
Symbol
Units
Description
PlantWaterBalance
mm
Internal daily plant water balance (balance of soil extraction
and transpiration).
LeafRWC
RWCleaf
%
Mean leaf relative water content.
StemRWC
RWCstem
%
Mean stem relative water content.
LFMC
LFMC
%
Live fuel moisture content (as percent of dry weight),
corresponding to fine fuels (< 6.35 mm twigs and leaves).
PlantStress
DDS
[0-1]
Drought stress level suffered by each plant cohort (relative
whole-plant transpiration).
The output of simulations can be inspected using plot, shinyplot and summary functions specific to spwb
objects (examples are given in the corresponding package vignette).
As it simulates water balance for only one day, function spwb_day() returns a much more reduced output.
This function is most useful with advanced water balance modelling (chapter 7).
3.6
Applications
The basic water balance model is easier to parameterize and is faster the advanced water balance model.
These features make it appropriate for applications that do not seek a high predictive capacity of water
status at the plant level, but require robust estimates of water fluxes at the stand, landscape or regional
levels. In our opinion the basic water balance model may be useful for the following applications:
1. To monitor or forecast temporal variation in transpiration fluxes and soil water content in particular
stands or in multiple stands across a landscape or region.
2. Monitor or forecast temporal variation of plant drought stress in particular stands or in multiple stands
across a landscape or region (for example to anticipate mortality events).
For example, Karavani et al. (2018) employed the water balance to provide sound estimates of soil moisture
dynamics to predict mushroom production in a network forest stands. The model is particularly interesting
to test the relationship between forest structure/composition and the water balance at the stand level or the
drought stress suffered by plants, as done in Ameztegui et al. (2017). See also another application in Rolo
& Moreno (2019).

52
CHAPTER 3. BASIC WATER BALANCE MODEL

Chapter 4
Leaf phenology and radiation
extinction
Leaf phenology determines seasonal variations in the surface area of leaves, hence influencing the energy
and water exchange between plants and the atmosphere. Radiation extinction is an important process to
consider in a model where plants have different heights.
4.1
Leaf phenology
4.1.1
Phenological types and leaf expanded area
Plant species can have either progressive evergreen, one-flush evergreen, winter-deciduous, winter semi-
deciduous or drought-deciduous leaf phenology (see Fig. 4.1). Progressive evergreen plants are assumed
to shed old leaves at the same time as new leaves appear, so that the leaf area remains constant throughout
the year. One-flush evergreen plants concentrate leaf unfolding and leaf senescence during similar periods, so
that leaf area is also approximately constant year-round. In winter-deciduous plants, leaf shedding and leaf
bud formation occurs in autumn. Buds remain under dormancy until spring, when budburst and unfolding
occurs. The difference between semi-deciduous and deciduous plants is that the former retain dead leaves in
the plant until next season unfolding period, so that leaf fall is retarded. Finally, drought-deciduous plants
behave like progressive-evergreen plants except that they can shed their leaves in response to drought.
Evergreen plants thus maintain constant leaf area over the year, whereas in deciduous plants leaf-expanded
status is updated daily, represented by ϕi, the fraction of maximum leaf area:
LAIϕ
i = LAIlive
i
· ϕi
(4.1)
whereas for evergreen species LAIϕ
i = LAIlive
i
(or equivalently ϕi = 1 at all times).
The general structure of process based phenological models explained in Chuine et al. (2013). These models
aim determine, for a given phenological phase n (endodormancy, ecodormancy, maturation, etc), the day of
its finalisation dn, such that the following equation holds:
Sn,d =
dn
X
dn−1
Rn,d = S∗
n
(4.2)
where Sn,d is the state of development on day d in phase n, and dn−1 is the end of the previous phase. Rn,d
is the rate of development during phase n on day d, which depends on environmental variables (temperature,
photoperiod,. . . ) and S∗
n is the critical threshold to achieve the change of phase.
53

54
CHAPTER 4. LEAF PHENOLOGY AND RADIATION EXTINCTION
Figure 4.1: Schematic representation of leaf phenology types

4.1. LEAF PHENOLOGY
55
In the water balance model leaf area index (LAI) values of winter (semi-)deciduous plants are adjusted for
leaf phenology following a leaf development model in spring and a leaf senescence model in autumn. Function
pheno_updateLeaves() updates the status of expanded leaves and dead leaves in a simulation object.
4.1.2
Bud burst and leaf unfolding
Transition from ecodormancy to bud burst is estimated using a very simple one-phase ecodormancy model
(also called the spring warming model) implemented in function pheno_leafDevelopmentStatus(). Given
a base temperature (Teco, in ◦C), the rate of development during the ecodormancy phase (Reco, in ◦C) is
zero for those days where mean temperature Tmean is below Teco and Tmean −Teco) for those days where
temperatures become warmer than this threshold:
Reco,d(Td) =
(
0
Td ≤Teco
Td −Teco
Td > Teco
(4.3)
Degree accumulation starts after the year date surpasses parameter t0,eco. If DOY > t0,eco, daily Reco,d
values are added to the cumulative sum Seco,d and budburst occurs when Seco,d > S∗
eco. Both Teco and S∗
eco
are plant-specific parameters in spwbInput.
After budburst, we model progressive leaf unfolding in a similar manner, by accumulating degree days using
the same definition as for Reco,d:
Runf,d = Reco,d
(4.4)
and then defining an unfolding development status Sunf,d = Pd
d,eco Runf,d, which we use to determine ϕi,d,
the degree of leaf expansion of cohort i at day d:
ϕi,d = Sunf,d/S∗
unf
(4.5)
until Sunf,d ≥S∗
unf and the unfolding process ends, where S∗
unf is a simulation control parameter
unfoldingDD.
4.1.3
Leaf senescence
Leaf senescence follows the models developed by Delpierre et al. (2009). The daily rate of development of
senescence Rsen,d is defined on the basis of daily photoperiod (Phd, in hours) and temperature (Td, in ◦C):
Rsen,d(Phd, Td) =
(
0
Td ≥Tsen or Phd > Phsen
(Td −Tsen)xsen · (Phd/Phsen)ysen
Td < Tsen and Phd < Phsen
(4.6)
where Phsen is the maximum photoperiod to start counting the senescence; xsen and ysen are exponents
regulating the importance of temperature and photoperiod on leaf senescence. The state of development of
senescence Ssen,d is defined
Ssen,d =
X
Rsen,d
(4.7)
and when Ssen,d ≥S∗
sen then expanded leaves are assumed to suddenly die. This model is implemented
in function pheno_leafSenescenceStatus() and returns ϕi,d = 1 for all days until Ssen,d ≥S∗
sen when it
returns ϕi,d = 0. Parameters Tsen, Phsen and S∗
sen are plant-specific parameters in spwbInput.
4.1.4
Leaf abscission
The drop of ϕi causes live expanded leaves to become dead leaves. To avoid a sudden decrease of leaf area,
dead leaves are kept in the canopy and they are reduced daily using a negative exponential function of wind
speed:
LAIdead
i
= LAIdead
i
· e−u/10
(4.8)
where u is wind speed in (m · s−1).

56
CHAPTER 4. LEAF PHENOLOGY AND RADIATION EXTINCTION
4.2
Radiation extinction
The proportion of photosynthetically active radiation (PAR) and short-wave radiation (SWR; 400-3000 nm)
decreases through the canopy following the Beer-Lambert’s light extinction equation. LP AR
herb , the proportion
of PAR that reaches the herbaceous layer, is calculated as:
LP AR
herb = e−Pc
i=1 kP AR,i·LAIall
i
(4.9)
where kP AR,i is the PAR extinction coefficient of woody plant cohort i. If we add the extinction caused by
the herbaceous layer, we have that LP AR
ground, the proportion of PAR that reaches the ground, is calculated as:
LP AR
ground = LP AR
herb e−0.5·LAIherb
(4.10)
Where herbaceous vegetation is assumed to have a fixed extinction coefficient.
We can also define LP AR
i
as the proportion of PAR available for a given plant cohort i, which we associate
to the PAR available at a height corresponding to half of the cohort’s crown. This height will include some
self-shading of the target cohort.
The proportion of short-wave radiation (SWR) energy absorbed by each plant cohort needs to be calculated
to divide the transpiration of the stand among cohorts (chapter 6), and the radiation absorbed by the soil
is needed to calculate soil evaporation (section 5.4). Foliage absorbs a higher proportion of PAR than SWR;
thus, the extinction coefficient is higher for PAR than for SWR. However, values for the ratio of extinction
coefficients are rather constant. Following Friend et al. (1997) it is assumed that the extinction coefficient
for PAR is 1.35 times larger than that for SWR (i.e. kSW R,i = kP AR,i/1.35). Figure 4.2 shows the PAR
and SWR extinction profiles (see functions vprofile_PARExtinction() and vprofile_SWRExtinction())
corresponding to the leaf area density distribution of Fig. 2.4.
0
250
500
750
1000
0
25
50
75
100
Available PAR (%)
Height (cm)
0
250
500
750
1000
0
25
50
75
100
Available SWR (%)
Height (cm)
Figure 4.2: Light extinction in a forest stand. Note the sharper decrease of PAR (left panel) in comparison
to SWR (right panel)
To calculate radiation absorption, where the vertical dimension of the plot is divided into layers (as explained
in 2.4.6), and the SWR absorbed is calculated for each plant cohort in each layer. Let l be the number of
vertical layers. The fraction of radiation incident on layer j that is absorbed in the same layer is:
fj = 1 −e−Pc
i=1 kSW R,i·LAIall
i,j
(4.11)

4.2. RADIATION EXTINCTION
57
where LAIall
i,j is the leaf area index of cohort i in layer j. Hence, the fraction transmitted is (1 −fj). The
fraction of radiation incident on layer j that is absorbed by expanded leaves of plant cohort i in that layer
(fij) is calculated from the relative contribution of these leaves to the total absorption in the layer:
fij = fj ·
kSW R,i · LAIϕ
i,j
Pc
h=1 kSW R,h · LAIall
h,j
(4.12)
The fraction of canopy radiation absorbed by a plant cohort i across all layers is found by adding the fraction
absorbed in each layer:
fi =
l
X
j=1
fij ·
lY
h>j
(1 −fh)
(4.13)
where for each layer the fraction of the radiation incident in the canopy that reaches the layer is
found by multiplying the transmitted fractions across the layers above it.
For example, the fraction
of SWR absorbed by each of the three cohorts of the example in Fig.
2.3 would be (see function
light_cohortAbsorbedSWRFraction()):
##
T1_148
T2_168
S1_165
## 0.247978703 0.204200474 0.006792845

58
CHAPTER 4. LEAF PHENOLOGY AND RADIATION EXTINCTION

Chapter 5
Forest hydrology
Forest hydrological processes are key for soil and plant water balances. This chapter details the design and
implementation of most of the vertical hydrological processes included in package medfate. These processes
determine the value of the water flows mentioned in eq. (3.5). The only process that is not described here
is woody plant transpiration (Trw), as it will be covered in detail in chapter 6.
Although each process can be simulated in specific sub-model functions, function hydrology_verticalInputs()
allows simulating soil water input processes altogether, including canopy water interception, snow accumu-
lation/melt, soil infiltration and percolation.
5.1
Snow and rainfall
Precipitation (P) is considered be snow precipitation (Ps) when Tmean < 0, and is considered rainfall (Pr)
otherwise. Thus, we have:
P = Pr + Ps
(5.1)
Interception of snow by the canopy is neglected, and all snow is assumed to accumulate in a single storage
compartment Ssnow over the soil (i.e. canopy snow storage capacity is neglected). Rainfall interception is
described in section 5.3.
5.2
Snow pack dynamics
A very simple snow submodel is used for snow pack dynamics (accumulation and melt), taken from Kergoat
(1998). When mean air temperature is above 0 Celsius (Tmean > 0), a simple energy budget relates snow
melt, Sm (mm), to air temperature and soil-level radiation (see function hydrology_snowMelt()):
Sm =
Rad · LSW R
ground · (1 −αice) + τday · Tmean · ρair · Cp/rs
λice
(5.2)
where Rad is solar radiation (MJ · m−2), LSW R
ground is the fraction of (short-wave) radiation reaching the
ground, αice = 0.9 is the albedo of snow, τday = 86400 is the day duration in seconds, ρair is the air density
(kg · m−3), depending on temperature and elevation (see utility functions of the meteoland reference
manual), Cp = 1013.86 · 10−6 MJ · kg−1 · C−1 is the specific heat capacity of the air and rs = 100 s · m−1 is
the snow aerodynamic resistance and λice = 0.33355 MJ · kg−1 is the (latent) heat of fusion of snow.
59

60
CHAPTER 5. FOREST HYDROLOGY
5.3
Rainfall interception loss
As mentioned above, interception loss is only modelled for liquid precipitation (i.e. snow interception is not
modelled). Rainfall interception loss, In, is estimated using either the Gash et al. (1995) or Liu (2001)
models.
5.3.1
Gash (1995) model
In the Gash et al. (1995) analytical interception model for sparse canopies, rain is assumed to fall in a single
event during the day. First, the amount of rainfall needed to saturate the canopy is calculated:
PG = −Scanopy/Ccanopy
ERratio
· ln(1 −ERratio)
(5.3)
where Scanopy is the canopy water storage capacity (in mm) – i.e. the minimum amount of water needed to
saturate the canopy –, Ccanopy is the canopy cover and ERratio is the ratio of evaporation rate to rainfall
intensity during the rainfall event (Rint; in mm · h−1). Although interception models are normally applied
to single-canopy stands, we apply the sparse Gash model to the whole stand (including shrubs and the
herbaceous layer). Moreover, in our implementation stem interception is lumped with crown interception,
so that Scanopy represents both.
Following Watanabe & Mizutani (1996) we estimate Scanopy, the canopy water storage capacity, from ad-
justed LAI values:
Scanopy = LAIherb +
X
i
swater,i · LAIϕ
i
(5.4)
where swater,i is the depth of water that can be retained by leaves, branches and stems of cohort i per
unit of leaf area index (mm · LAI−1). To estimate the stand cover, Ccanopy, we use the complement of the
percentage of PAR that reaches the ground, i.e. Ccanopy = 1 −LP AR
ground (Deguchi et al. 2006).
The amount of water evaporated from interception (In, in mm), is calculated as:
In = Ccanopy · PG + Ccanopy · ERratio · (Pr −PG) if Pr > PG
(5.5)
In = Ccanopy · Pr if Pr ≤PG
(5.6)
where Pr is the daily gross rainfall (in mm). Net rainfall (Prnet, also in mm) includes throughfall and
stemflow, and is calculated as the difference between gross rainfall and interception loss. Fig. 5.1 below
shows examples of relative throughfall (including stemflow), calculated according to the Gash et al (1995)
interception model, under different situations (see function hydrology_rainInterception()).
5.3.2
Liu (2001) model
In the single-storm form of the Liu (2001) model is similar to the Gash et al. (1995) model in terms of its
inputs. Rainfall interception during a single storm can be predicted by gross rainfall amount PG, the ratio
of evaporation rate to rainfall rate during the rainfall event, ERratio, canopy gap fraction (Ccanopy) and
storage capacity (Scanopy):
In = Scanopy ·

1.0 −exp

−PG ·
Ccanopy
Scanopy

· (1.0 −(ER/Ccanopy)) + (ER · PG)
(5.7)
Fig. 5.2 below shows examples of relative throughfall (including stemflow), calculated according to the Liu
et al (2001) interception model, under different situations (see function hydrology_rainInterception()).

5.3. RAINFALL INTERCEPTION LOSS
61
0
10
20
30
40
50
0
20
40
60
80
100
Gross rainfall (mm)
Relative throughfall (%)
p = 0.2 E/R = 0.05
0
10
20
30
40
50
0
20
40
60
80
100
Gross rainfall (mm)
Relative throughfall (%)
p = 0.8 E/R = 0.05
0
10
20
30
40
50
0
20
40
60
80
100
Gross rainfall (mm)
Relative throughfall (%)
p = 0.2 E/R = 0.2
0
10
20
30
40
50
0
20
40
60
80
100
Gross rainfall (mm)
Relative throughfall (%)
p = 0.8 E/R = 0.2
S = 0.5
S = 1
S = 2
S = 3
S = 4
Figure 5.1: Examples of canopy interception with different Scanopy (canopy water storage capacity), ERratio
(ratio between evaporation and rainfall rates) and p (throughfall coefficient; p = 1−Ccanopy), using the Gash
(1995) model.

62
CHAPTER 5. FOREST HYDROLOGY
0
10
20
30
40
50
0
20
40
60
80
100
Gross rainfall (mm)
Relative throughfall (%)
p = 0.2 E/R = 0.05
0
10
20
30
40
50
0
20
40
60
80
100
Gross rainfall (mm)
Relative throughfall (%)
p = 0.8 E/R = 0.05
0
10
20
30
40
50
0
20
40
60
80
100
Gross rainfall (mm)
Relative throughfall (%)
p = 0.2 E/R = 0.2
0
10
20
30
40
50
0
20
40
60
80
100
Gross rainfall (mm)
Relative throughfall (%)
p = 0.8 E/R = 0.2
S = 0.5
S = 1
S = 2
S = 3
S = 4
Figure 5.2: Examples of canopy interception with different Scanopy (canopy water storage capacity), ERratio
(ratio between evaporation and rainfall rates) and p (throughfall coefficient; p = 1 −Ccanopy), using the Liu
(2001) model.

5.4. BARE SOIL EVAPORATION
63
5.4
Bare soil evaporation
Evaporation from the soil surface is the last component of the soil water balance to be calculated before
calculating plant transpiration. Bare soil evaporation cannot happen if there is snow over the soil surface
(i.e., if Ssnow > 0).
Potential evaporation from the soil (PEsoil; in mm · day−1) is defined as the product between PET and
LSW R
ground, the proportion of SWR absorbed by the ground:
PEsoil = PET · LSW R
ground
(5.8)
Actual evaporation from the soil surface is modeled as in Mouillot et al. (2001), who in turn followed Ritchie
(1972). First, the model determines tsoil, the time needed to evaporate the current water deficit (difference
between field capacity and current moisture) in the surface soil layer:
tsoil =
Vfc,1 · (1 −W1)
γsoil

(5.9)
where Vfc,1 is the water retention capacity of layer 1, W1 is the proportion of moisture in relation to field
capacity of layer 1 and γsoil is the maximum daily evaporation (mm · day−1). The calculated time is used
to determine the ‘supplied’ evaporation, SEsoil:
SEsoil = γsoil · (√tsoil + 1 −
√
1)
(5.10)
The amount of water actually evaporated from the soil, Es, is then calculated as the minimum between
supply, SEsoil, and demand (Federer 1982), i.e. PEsoil (see function hydrology_soilEvaporationAmount):
Es = min(PEsoil, SEsoil)
(5.11)
Figure 5.3 shows the cumulative evaporation from soils for different values of maximum evaporation rate.
5.5
Transpiration of the herbaceous layer
Transpiration of herbaceous layer is modelled analogously to the transpiration of woody plants.
First,
potential evapotranspiration from the herbaceous layer (PETherb; in mm · day−1) is defined as the product
between PET and LSW R
herb , the proportion of SWR reaching the herbaceous layer:
PETherb = PET · LSW R
herb
(5.12)
Thus, the more dense the woody plant canopy, the lower herbaceous transpiration will be. Maximum herba-
ceous transpiration Trherb,max depends on both PETherb and the amount of transpiring surface, i.e. LAIherb.
To estimate Trmax the model uses the empirical equation of Granier et al. (1999), as in section 6.1.1:
Trherb,max
PET
= −0.006 · (LAIherb)2 + 0.134 · LAIherb
(5.13)
Finally, actual herbaceous transpiration for a given soil layer s (Trherb,s) is reduced according to the soil
water potential (Ψs), assuming that transpiration reduction follows Weibull function with fixed coefficients:
Trherb,s = FRPherb,s · Trherb,max · exp
(
ln (0.5) ·
 Ψi
−1.5
2)
(5.14)
where FRPherb,s is the proportion of fine roots in layer s, defined using Z50 = 50mm and Z95 = 500mm
(see 2.4.7).

64
CHAPTER 5. FOREST HYDROLOGY
day
Cummulative soil evaporation (mm)
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
0
5
10
15
Gsoil = 1
Gsoil = 2
Gsoil = 3
Figure 5.3: Cumulative bare soil evaporation for different values of maximum evaporation rate (γsoil). Topsoil
layer (0 – 30 cm) is initialized at field capacity (V1 = 50mm). PEsoil was assumed not to be limiting.
5.6
Infiltration
The amount of rainfall event water that reaches the soil is the sum of net rainfall (Prnet) and runon (Ro,
in mm), if any. The amount of rainfall event water infiltrating into the soil matrix (If) is estimated using
either the Boughton (1989) or the Green & Ampt (1911) models.
5.6.1
Boughton (1989) model
Surface runoff Ru can be estimated using the USDA SCS curve number method, following Boughton (1989):
Ru = (Prnet + Ro −0.2 · Vfc,soil)2
(Prnet + Ro −0.8 · Vfc,soil)
(5.15)
where Vfc,soil (in mm) is the overall soil water retention capacity. The Boughton (1989) model is available in
function hydrology_infiltrationBoughton() and examples of its behavior are given in the figure below.
5.6.2
Green-Ampt (1911) model
The description of the Green & Ampt (1911) model has been adapted from chapter 9 of Bonan (2019).
The Green-Ampt equation uses the concept of a horizontal wetting front at some distance Lw into the soil.
The soil above Lw is saturated (i.e. θsat), whreas soil below the wetting front has a uniform content θdry
corresponding to conditions prior to the rainfall event. Darcy’s law provides the flux of water ic infiltrating
into the soil from the surface to the wetting front at depth z = −Lw:
ic = Ksat
|Ψw|
Lw
+ 1

(5.16)

5.6. INFILTRATION
65
0
10
20
30
40
50
60
0
10
20
30
40
50
60
Net rainfall (mm)
Infiltration (mm)
d = 200 Vsoil = 17 mm
d = 400 Vsoil = 23 mm
d = 800 Vsoil = 34 mm
d = 1200 Vsoil = 45 mm
d = 1500 Vsoil = 53 mm
0
10
20
30
40
50
60
0
10
20
30
40
50
60
Net rainfall (mm)
Runoff (mm)
d = 200 Vsoil = 17 mm
d = 400 Vsoil = 23 mm
d = 800 Vsoil = 34 mm
d = 1200 Vsoil = 45 mm
d = 1500 Vsoil = 53 mm
Figure 5.4: Examples of infiltration/runoff calculation using the Boughton (1989) model for different values
of net rainfall and overall retention capacity, Vsoil, calculated from different soil depths (topsoil+subsoil)
and assuming that soil texture is 15% clay and 25% sand. Rock fragment content was 25% and 40% for the
topsoil and subsoil, respectively.
where Ψw is the matric potential at the wetting front. The total cumulative infiltrated water Ic at time t is
the time integral of ic, and is also equal to the Lw multiplied by the change in water, i.e. ∆θ = θsat −θdry:
Ic = ∆θLw
(5.17)
The infiltration rate can also be expressed as the time derivative of Ic, i.e.:
ic = dIc
dt = ∆θdLw
dt
(5.18)
Combining the two equations for ic we obtain:
∆θdLw
dt
= Ksat
|Ψw|
Lw
+ 1

(5.19)
and substituting Ic/∆θ for Lw gives:
dIc
dt = Ksat
|Ψw|∆θ
Ic
+ 1

(5.20)
By rearranging terms and integrating we obtain an expression for Ic(t):
Ic(t) = Ksatt + |Ψw|∆θ ln

1 +
Ic(t)
|Ψw|∆θ

(5.21)
This equation defines the cumulative infiltration to time t as a function of Ksat, Ψw, θsat and θdry. Because
Ic appears on both sides of the equation, it must be found using numerical root-finding (the Newton-Raphson
method in our case). To estimate Ψw the following equation is used:
Ψw =
2b + 3
2b + 6

Ψsat
(5.22)

66
CHAPTER 5. FOREST HYDROLOGY
Parameter θdry is the volumetric content of the topmost soil layer (antecendent soil conditions), and param-
eters θsat, Ψsat, Ksat and b are estimated using Campbell’s water retention curves from the texture of the
topmost layer. The infiltration time t (in h) is estimated from the sum of net rainfall (Prnet) and runon
(Ro) (both in mm) using rainfall intensity of the rainfall event (Rint; in mm/h). The Green & Ampt (1911)
model is available in function hydrology_infiltrationGreenAmpt() and examples of its behavior are given
in the figure below.
0
10
20
30
40
50
60
0
10
20
30
40
50
60
Net rainfall (mm)
Infiltration (mm)
Loamy sand
Silt loam
Sandy clay loam
Silty clay
Sandy clay
0
10
20
30
40
50
60
0
10
20
30
40
50
60
Net rainfall (mm)
Infiltration (mm)
theta_dry = 0.1
theta_dry = 0.2
theta_dry = 0.3
theta_dry = 0.4
theta_dry = 0.5
Figure 5.5: Examples of infiltration using the Green-Ampt (1911) model for different values of net rainfall.
The left panel shows the infiltration for different soil textural types, assuming a θdry = 0.3. The right panel
shows the infiltration for different values of θdry, assuming a silt loam soil. In both cases rainfall intensity is
assumed Rint = 6 mm/h.
5.7
Soil water flows
5.7.1
Design of soil water flows
In this chapter we describe water movement into, out of, and within the soil. The water input to the soil is
the sum of net rainfall (Prnet, i.e. rainfall minus interception), snow melt (Sm) and (if simulations are done
in a spatially-explicit context) runon from an adjacent location (Ro). Water movement can be performed
using either the common single domain model (soilDomains = "single") or the dual permeability model
(soilDomains = "dual"), which follows with some modifications the MACRO model (Jarvis et al. 1991;
Larsbo et al. 2005).
In the single-domain model (panel A in Fig. 5.6), the water coming from rainfall events - i.e. sum of net
rainfall (Prnet) and run-on (Ro) - is divided between infiltration into the soil (If) and runoff (Ru), following
the models explained in 5.6. Rainfall infiltrating into the soil is divided among soil layers, in a crude attempt
to emulate the effect of preferential flows (but without accounting for the increase in infiltration caused by
macropores). The amount of water reaching each soil layer is modelled using an extinction function that
depends on macroporosity (see function hydrology_infiltrationRepartition). In contrast to water from
rainfall events, water from snow melt (Sm) is assumed to infiltrate slowly and completely into the first layer.
Water flows within the soil according to the Richards equation, assuming an homogenous porous media and
where fluxes are driven by both gravitational and matric potentials. Root water uptake/redistribution is
taken into account as source/sinks from/to the soil layers along with bare soil evaporation. Water leaving

5.7. SOIL WATER FLOWS
67
the bottom layer (as well as departures from the water balance) is assumed to drain beyond the soil limits
(i.e. deep drainage (Dd)). Saturation excess in the topmost layer leads to an increase in runoff (Ru) and a
corresponding decrease in infiltration (If).
In the dual-permeability model (panel B in Fig. 5.6), total porosity is partitioned into two separate flow
regions (matrix and macropores), each with its own degree of saturation, conductivity and flow rate. The
water coming from rainfall events - i.e. sum of net rainfall (Prnet) and run-on (Ro) - is divided between
infiltration into the soil matrix (If; following models in 5.6) and water infiltrating into the macropore domain.
Water from snow melt (Sm) is assumed to infiltrate slowly and completely into the soil matrix. Fluxes within
the soil matrix follow the Richards equation and is driven by both gravity and matric potentials, as in the
single-domain model. In contrast, fluxes in the macropore region are gravity-driven only. Saturation of
micropores of a given soil matrix layer leads to a water source into the corresponding macropore layer,
whereas water uptake by the soil matrix via capillarity from the corresponding macropore layer follows a
diffusion equation. Root water uptake/redistribution is taken into account as source/sinks in the soil matrix
along with bare soil evaporation. Deep drainage (Dd) can occur from both the soil matrix or the macropore
domain. Finally, saturation excess in the macropore domain leads to accumulation of water in the above
layer and, eventually, to surface runoff (Ru).
Figure 5.6: Schematic representation of the (A) single domain and (B) dual-permeability models of flows
into, out of and within the soil. Symbols are defined in the main text.
Function hydrology_soilWaterBalance() performs infiltration and vertical water movement flows, given
a soil, net rainfall, snowmelt and source/sink vector for each layer. Source/sink terms are defined as follows
for the first layer (i = 1):
S1 = −Es −Trherb,1 −Exwoody,1
(5.23)
and for 1 < i ≤N:
Si = −Trherb,i −Exwoody,i
(5.24)
where Es is bare soil evaporation, Trherb,i is herbaceous uptake from layer i and Exwoody is woody plant
uptake/redistribution from/to layer i. All right-hand terms are converted from mm/day to instantaneous
rates (m/s) for proper units in S. By default, 24 time steps of 1 hour are used for vertical water simulation
of each day, but the time step is modified if required to close the water balance of the matrix or macro-
pore domains. Function hydrology_soilWaterBalance() updates soil moisture and returns daily fluxes
corresponding to infiltration, runoff and deep drainage.

68
CHAPTER 5. FOREST HYDROLOGY
The following sections detail the formulation and numerical solving of soil flows, both under the single-domain
and the dual-permeability models.
5.7.2
Darcian flow and Richards equation
Water flows in the soil from high to low potential as described by Darcy’s law. In the soil matrix, the
total potential is used, i.e. the sum of the matric potential (Ψs, here expressed in m, see 2.3.3) and vertical
depth z (also in m). The vertical depth z is taken as positive in the upward direction, so that z = 0 is the
ground surface. In the vertical dimension the flux Q, i.e. rate of water movement (in ms−1), according to
Darcy’s law is:
Q = −K(θ) · δ(Ψ + z)
δz
= −K(θ) · δΨ
δz −K(θ)
(5.25)
where K(θ) is the hydraulic conductivity (in ms−1) that describes the ease with which water can move
through the porous media space, and depends on soil moisture (θ). In the macropore domain, only the
vertical depth (i.e. gravity potential) is considered, which leads to a unit gradient, and hence the flux Q is
simply:
Q = −Kma(θma)
(5.26)
where Kma is the macropore hydraulic conductivity (in ms−1), depending on the macropore water content
θma (in m3 · m−3).
Consider a volume of soil with horizontal area ∆x∆y, thickness ∆z and with non-rock proportion λ =
1−Procks. The mass flux entering the parcel from above is ρwQin∆x∆y and the flux out of it is ρwQout∆x∆y.
Conservation requires that the difference between fluxes and source/sinks equals the rate of change in water
storage. The mass of water in the soil volume is ρwθ∆x∆y∆zλ so the change in water over a time interval
∆t is:
ρw
∆θ
∆t ∆x∆y∆zλ = −ρw(Qin −Qout)∆x∆y
(5.27)
and gives the continuity equation:
∆θ
∆t λ = −(Qin −Qout)
∆z
(5.28)
which expressed in the notation of calculus is:
δθ
δt λ = −δQ
δz
(5.29)
Substituting Darcy’s law for Q, and accounting for (lateral) sources/sinks S, gives the Richards equation:
δθ
δt λ = δ
δz

K(θ)δΨ
δz + K(θ)

± S = K(θ)δ2Ψ
δ2z + δK
δz
δΨ
δz
δK
δz ± S
(5.30)
The former is known as the mixed-form Richards equation, because it includes θ on the left hand and the
vertical gradient in matric potential Ψ on the right hand. The head-based or Ψ-based form expresses the left
hand term using Ψ as dependent variable:
C(Ψ)δΨ
δt λ = K(Ψ)δ2Ψ
δ2z + δK
δz
δΨ
δz + δK
δz ± S
(5.31)
where C(Ψ) = δθ/δΨ is known as the specific moisture capacity, in m−1. In the macropore domain,
the use of the former equation is problematic; a major reason being the lack of information concerning the

5.7. SOIL WATER FLOWS
69
relationship between Ψ and θ close to saturation. If we assume capillarity to be negligible in the macropore
domain, then δΨ/δz = 0 and the corresponding governing equation becomes:
δθma
δt λ = δKma
δz
± S
(5.32)
where θma and Kma are the soil moisture and soil conductivity, respectively, in the macropore domain.
5.7.3
Hydraulic properties in the single-domain model
In single-domain simulations, the Van Genuchten (1980) model is used to represent the water retention curve
(see section 2.3.2):
θ(Ψ) = θres +
θsat −θres
[1 + |α · Ψ|n]m
(5.33)
where m = 1 −1/n is a shape parameter. It can be re-arranged into:
Se = θ(Ψ) −θres
θsat −θres
= (1 + |α · Ψ|n)−m
(5.34)
where Se is the degree of saturation. The specific moisture capacity, C(Ψ), is the derivative δθ/δΨ, i.e.:
C(Ψ) = α · m · n · (θsat −θres) ·
|α · Ψ|n−1
(1 + |α · Ψ|n)m+1
(5.35)
The hydraulic conductivity K(Ψ) for a given water potential Ψ is determined in the Van Genuchten model
as a function of Se using:
K(Ψ) = Ksat · Sl
e ·
h
1 −(1 −S1/m
e
)mi2
(5.36)
where Ksat is the saturated hydraulic conductivity and l = 0.5 is the tortuosity factor.
5.7.4
Hydraulic properties in the dual-permeability model
In MACRO (Jarvis et al. 1991; Larsbo et al. 2005), a “cut and join” approach is used to define the hydraulic
functions. A water potential Ψb = −0.1 m = −0.98 kPa partitions the total porosity into matrix pores and
macropores, while the corresponding water content, θb and hydraulic conductivity Kb represent the saturated
state of the soil matrix.
Matrix domain
Soil water retention in the matrix is calculated using a modified form of Van Genuchten’s (1980) equation:
Smi = θmi(Ψ) −θres
θfict
sat −θres
= (1 + |α · Ψ|n)−m
(5.37)
where θfict
sat = θsat−Pmacro is a fictious saturated content obtained subtracting the proportion of macropores.
θb is estimated as θmi(Ψb), whereas Kb is estimated with van Genuchten’s K equation but using Smi(Ψb)
instead of Se. The capacitance in the matrix domain (Cmi) is estimated using the same equation as the single
domain model, but replacing θsat by θfict
sat . Finally, the following form is used to describe the unsaturated
hydraulic conductivity function in the matrix, using Kb as the matching point:

70
CHAPTER 5. FOREST HYDROLOGY
Kmi = Kb ·

Smi
Smi(Ψb)
l
·
"
1 −(1 −S1/m
mi )m
1 −(1 −Smi(Ψb)1/m)m
#2
(5.38)
where l = 0.5 is the tortuosity factor. For water potentials less negative that Ψb the hydraulic conductivity
is set to Kb.
Macropore domain
In the macropore domain, the water potential is not defined and flow equations are expressed in θ-based
form. The degree of saturation in the macropores (Sma) is related to soil moisture in the macropores (θma)
via:
Sma = θma
ema
(5.39)
where ema = θsat −θb. The hydraulic conductivity function in the macropores (Kma) is given as a simple
power law of the degree of saturation:
Kma = (Ksat −Kb) · Snma
ma
(5.40)
where nma = 2.23 is a kinematic exponent reflecting macropore size distribution and tortuosity. Unlike in
MACRO (Jarvis et al. 1991), the fact that macroporosity and macropore maximum hydraulic conductivity
may not be constant but vary due to swelling and shrinkage is not taken into account.
Lateral flows
In the beginning, or at any given step, if θmi > θb, the excess of water is transferred from the matrix to the
macropore domain, i.e. it will be used as a source to increase θma. However, the macropores have a finite
storage capacity for water, Cma, equal to:
Cma = (1 −Sma) · (θsat −θb)
(5.41)
Hence, the flow to the macropore domain is limited by Cma. The reverse flow, i.e the water uptake by the
unsaturated matrix is treated as a first-order approximation to a diffusion equation, assuming a rectangular-
slab geometry for the aggregates:
Uw =
Gw · Dw · γw
d2

· (θb −θmi)
(5.42)
where d (in m) is an effective diffusion path length, Dw (in m2s−1) is an effective water diffusivity that
depends on Sma, Gw = 3 is a geometry factor and γw = 0.1 is a scaling factor. See details in (Larsbo et al.
2005). Water uptake by the unsaturated matrix is treated as a source for the matrix domain and as a sink
for the macropore domain.
5.7.5
Finite approximation to flows in the soil matrix
Water movement in the soil matrix was taken from chapter 8 of Bonan (2019), and much of the present text
has been summarized and adapted from this source, with modifications for the exchange with macropore
moisture. The finite difference approximation for the Richards equation represents the soil as a network of
N discrete nodal points that vary in space and time. The network is presented in Fig. 5.7.
For reasons of numerical stability, Richards equation is solved using an implicit time discretization win
which the spatial derivatives δK/δz, δΨ/δz and δ2Ψ/δ2z are written numerically using a central difference
approximation at time n + 1, and the time derivative uses a backward difference approximation at n + 1.
Soil layer i has a thickness ∆zi.
Water content θi, matric potential Ψi and hydraulic conductivity Ki
are defined at the center of the layer at depth zi and are uniform over the layer.
Here Ki values have
been corrected by λi, to account for the fact that the amount of stones in the soil reduce the conductivity,

5.7. SOIL WATER FLOWS
71
Figure 5.7: Schematic representation of network of soil nodes

72
CHAPTER 5. FOREST HYDROLOGY
which is expressed per soil area unit (so, in fact, all terms in the mass balance equations are multiplied
by λi, except the source/sinks). Water inputs/outputs from other processes (i.e. infiltration, snow melt,
bare soil evaporation, herbaceous transpiration and woody plant uptake/redistribution) are represented as a
source/sink term Si for each node i. If simulations are done in the dual-permeability model, Si can include
positive or negative terms due to saturation excess flow into the macropore domain or capillary imbibition
from the macropore domain.
For a given intermediate layer 1 < i < N, the outward flux Qi between layers i and i + 1 is defined using:
Qi = −Ki+1/2
∆zi+1/2
(Ψi −Ψi+1) −Ki+1/2
(5.43)
where zi+1/2 = zi −zi+1 and Ki+1/2 = 0.5(Ki + Ki+1) replaces the vertically varying hydraulic conductivity
within the two layers with an effective conductivity for an equivalent homogeneous medium. The inward
flux Qi−1 between layers i −1 and i is defined similarly:
Qi−1 = −Ki−1/2
∆zi−1/2
(Ψi−1 −Ψi) −Ki−1/2
(5.44)
where zi−1/2 = zi−1 −zi and Ki−1/2 = 0.5(Ki−1 +Ki). If we apply the fluxes to the water balance equation,
with fluxes and capacitance expressed for time n + 1, and considering the Si source/sink term (in ms−1),
we obtain the following Ψ-based form:
∆zi
∆t Cn+1
i
(Ψn+1
i
−Ψn
i )λi =
Kn+1
i−1/2
∆zi−1/2
(Ψn+1
i−1 −Ψn+1
i
)−
Kn+1
i+1/2
∆zi+1/2
(Ψn+1
i
−Ψn+1
i+1 )+Kn+1
i−1/2−Kn+1
i+1/2+Sn+1
i
(5.45)
For the first layer (i = 1) the boundary condition is defined so that there is no inward flux (but a source/sink
term is added), which yields the following Ψ-based form:
∆z1
∆t Cn+1
1
(Ψn+1
1
−Ψn
1)λ1 = −
Kn+1
1+1/2
∆z1+1/2
(Ψn+1
1
−Ψn+1
2
) −Kn+1
1+1/2 + Sn+1
1
(5.46)
Finally, for the last layer (i = N) a free drainage condition is specified as boundary condition, where
QN = KN, which yields the following Ψ-based form:
∆zN
∆t Cn+1
N
(Ψn+1
N
−Ψn
N)λN =
Kn+1
N−1/2
∆zN−1/2
(Ψn+1
N−1 −Ψn+1
N
) + Kn+1
N−1/2 −Kn+1
N
+ Sn+1
N
(5.47)
Alternatively, if a water table depth is supplied and is equal or shallower than soil depth, the model can
simulate capillarity rise by changing the lower boundary condition to that of a constant saturated layer
(i.e. ΨN+1 = 0).
∆zi
∆t Cn+1
N
(Ψn+1
N
−Ψn
N)λi =
Kn+1
N−1/2
∆zN−1/2
(Ψn+1
N−1−Ψn+1
N
)−
Kn+1
N+1/2
∆zN+1/2
(Ψn+1
N
−0)+Kn+1
N−1/2−Kn+1
N+1/2+Sn+1
N
(5.48)
where KN+1/2 = 0.5(KN + Ksat).
The numerical form of the Ψ-based Richards equation for a soil with N layers is a tridiagonal system of N
equations with N unknown values Ψ at time n +1. An additional complexity is that Ψ at n +1 also appears
through K and C. The solution requires linearizing with respect to Ψ through various methods. Here the

5.7. SOIL WATER FLOWS
73
predictor-corrector method is employed, a two-step solution that solves the equation twice (Haverkamp
et al. 1977). The predictor step uses explicit linearization to solve for Ψ over one-half of a full time step
(∆t/2) at time n + 1/2 with K and C from time n. The resulting values for Ψ are used to evaluate K and
C at n + 1/2. The corrector step uses these to obtain Ψ over the full time step (∆t) at n + 1. An implicit
solution is used for the predictor step and the Crank-Nicolson method is used for the corrector step.
5.7.6
Finite approximation to flows in the macropore domain
An implicit solution is used to discretize the local water balance in the macropores of a layer i, using:
θn+1
ma,i −θn
ma,i
∆t
· λi =
Kn+1
ma,i−1 −Kn+1
ma,i
∆zi
+ Sn+1
i
(5.49)
since θma is related to Sma, we can re-express the previous equation into:
Sn+1
ma,i = Sn
ma,i +
∆t
λi · ema,i
·
 
Kn+1
ma,i−1 −Kn+1
ma,i
∆zi
+ Sn+1
i
!
(5.50)
In this equation, Kn+1
ma,i−1 represents the conductivity of the layer above for the time step n + 1, whereas the
Kn+1
ma,i is the conductivity of the current layer for the same time step, hence depending on Sn+1
ma,i. The local
water balance is solved for each layer, in turn, from the soil surface downward, assuming a zero flow from
the surface Kn+1
ma,0 = 0 (infiltration into macropores is given by Sn+1
1
). Then for any given layer i, Kn+1
ma,i−1 is
already defined and a solution for Sn+1
ma,i can be found using a bisection method (i.e. internal halving). After
solving for all layers, if the capacity of macropores is exceeded in any given layer, the excess is added to the
macropore storage of the layer above. Excess of the topmost layer results in runoff via saturation excess.

74
CHAPTER 5. FOREST HYDROLOGY

Chapter 6
Woody plant transpiration,
photosynthesis and water status
This chapter describes how daily woody plant transpiration (Trwoody) is modelled in the basic water balance
model, completing the flows needed to evaluate eq. (3.5). The model uses the approach of BILJOU (Granier
et al. 1999) to estimate woody maximum transpiration, and then divides this value among the contribution of
plant cohorts and estimate actual transpiration depending on soil moisture and cohort functional parameters,
which determine plant drought. The chapter also describes how is daily photosynthesis estimated, a process
that in this model does not influence transpiration but is necessary for growth calculations (chapter 15).
6.1
Plant transpiration and photosynthesis
6.1.1
Maximum transpiration
Potential evapotranspiration (PET, in mm) is assumed to represent open water evaporation potential.
Maximum canopy transpiration Trwoody,max depends on both PET and the amount of transpirating surface,
i.e. the current cumulative LAI of the woody vegetation, LAIϕ
woody. To estimate Trwoody,max the model uses
the empirical equation of Granier et al. (1999), where Trwoody,max/PET is a function of LAIϕ
woody:
Trwoody,max
PET
= −0.006 · (LAIϕ
woody)2 + 0.134 · LAIϕ
woody + 0.036
(6.1)
This equation has already been adopted for Mediterranean biomes (Fyllas & Troumbis 2009; Ruffault et al.
2013).
Since medfate’s ver. 2.1, empirical coefficients can be species-specific and Granier et al. (1999) empirical
equation has been generalized to:
Trwoody,max
PET
= Tmax,LAI · LAIϕ
woody + Tmax,sqLAI · (LAIϕ
woody)2
(6.2)
where Tmax,LAI and Tmax,sqLAI are species-specific parameters (if missing, they are given default values
0.134 and -0.006, respectively).
The maximum transpiration for a given plant cohort i is calculated using the portion of Trmax defined by
fi the fraction of total absorbed SWR that is due to cohort i (see section 4.2):
Trmax,i = Trwoody,max ·
f 0.75
i
P
j f 0.75
j
(6.3)
75

76
CHAPTER 6. WOODY PLANT TRANSPIRATION, PHOTOSYNTHESIS AND WATER STATUS
0
2
4
6
8
10
0.0
0.2
0.4
0.6
0.8
1.0
LAIwoody
Tr_woody_max/PET
Figure 6.1: Empirical relationship between Trwoody,max/PET and LAIϕ
woody
Before ver 2.5.0 Trmax,i was linearly related to fi, but an exponent 0.75 is now used to decrease ad hoc the
proportion of transpiration corresponding to cohorts absorbing high SWR fractions with respect to those
absorbing low amounts of SWR, which has been found to better match the transpiration predicted using
the advanced transpiration model. Note that the actual amount of radiation energy absorbed by plants is
much more difficult to determine, involving diffuse and direct radiation, as well as net long-wave radiation
(see chapter 9).
6.1.2
Actual plant transpiration and plant water potential
Actual plant transpiration depends on soil moisture and is calculated for each plant cohort and each soil
layer separately. Tri,s (in mm) represents the transpiration made by cohort i from layer s. Actual plant
transpiration from a given layer is regulated by soil moisture and the resistance to water flow through the
plant. For each plant cohort i and soil layer s, the model first estimates the a whole-plant relative water
transpiration, Ki,s, which varies between 0 and 1 depending on Ψextract,i, the potential at which transpiration
is 50% of maximum, and Ψs, the water potential in layer s. This relationship is modelled using a Weibull
function (see function hydraulics_psi2K()):
Ki,s = Ki(Ψs) = exp

ln (0.5) ·

Ψs
Ψextract,i
cextract,i
(6.4)
where cextract,i is an exponent that modulates the steepness of the decrease in relative conductance when
soil potential becomes negative and ln(0.5) is used to ensure that Ki(Ψextract,i) = 0.5 (Fig. 6.2).
If cavitation has occurred in previous steps then the capacity of the plant to transport water is impaired.
Hence Ki,s from eq. (6.4) cannot be larger than the one-complement of the degree of conductance loss in
the stem (PLCstem,i), so that:
KP LC
i,s
= min{Ki,s, 1.0 −PLCstem,i}
(6.5)

6.1. PLANT TRANSPIRATION AND PHOTOSYNTHESIS
77
0
2
4
6
8
10
0.0
0.2
0.4
0.6
0.8
1.0
Soil water potential (−MPa)
K (relative conductance)
Psi_extract =  −2 MPa
Psi_extract =  −3 MPa
Psi_extract =  −4 MPa
Psi_extract =  −5 MPa
Figure 6.2: Whole-plant relative water conductance functions for different water potential values (cextract = 3
in all cases)
where PLCstem,i is the proportion of stem conductance lost for cohort i (see 6.2.2).
Until ver 2.5.0, actual transpiration of plant cohort i from a given soil layer s, Tri,s, was defined as the
product of (Mouillot et al. 2001): the maximum transpiration of the plant cohort (Trmax,i), the relative
whole-plant transpiration (KP LC
i,s
) corresponding to the species and water potential in layer s, and the
proportion of plant fine roots in layer s, FRPi,s:
Tri,s = Trmax,i · KP LC
i,s
· FRPi,s
(6.6)
Since ver 2.5.0, this equation has been slightly modified and is now:
Tri,s = Trmax,i · KP LC
i,s
·
K0.5
unsat,s · FRPi,s
P
r K0.5
unsat,r · FRPi,r
(6.7)
where Kunsat,s is the unsaturated soil conductivity of layer s. This modification was introduced to allow
the plant to increase the amount of water drawn from layers with higher levels of moisture in seasons where
the usual water pools are depleted. This formulation decreases the differences in soil moisture between soil
layers, which in the advanced model is achieved thanks to hydraulic redistribution process.
The total amount of water transpired by woody cohort i, Tri (in mm) is the sum of Tri,s values over all soil
layers:
Tri =
X
s
Tri,s
(6.8)
Analogously, the total amount of water transpired by woody plants, Trwoody (in mm), is the sum of Tri
values over all plant cohorts:
Trwoody =
X
i
Tri =
X
s
X
i
Tri,s
(6.9)

78
CHAPTER 6. WOODY PLANT TRANSPIRATION, PHOTOSYNTHESIS AND WATER STATUS
Assuming no water limitations (i.e. Ki,s = 1), we have that Trwoody = Trwoody,max and Tri = Trmax,i.
Cohort transpiration and stand transpiration will be lower than maximum values if soil water potential in
any layer is negative enough to cause a significant reduction in whole-plant conductance. At the plant level,
the transpiration of a given plant cohort will be lower than that of others if:
a. The cohort is under the shade (it reduces fi and hence Trmax,i)
b. The cohort has a lower amount of leaf area (it reduces fi and hence Trmax,i)
c. The soil layers exploited by the cohort have more negative water potentials (it reduces Ki,s and KP LC
i,s
).
6.1.3
Plant water potential
The basic water balance model does not allow estimating a water potential drop from soil to the leaf.
Moreover, in a multilayered soil it is difficult to know what would be the water potential of the plant.
Despite these limitations, a gross surrogate of ‘plant’ water potential (Ψplant,i; in MPa) may be obtained
averaging whole-plant relative conductance values across soil layers and inverting the whole-plant relative
transpiration function:
Ψplant,i = K−1
i
 X
s
Ki,s · FRPi,s
!
(6.10)
where K−1
i
is the inverse of the relative whole-plant transpiration eq. (6.4). The plant water potential is
used to determine plant stress levels and cavitation, as explained in 6.2.1 and 6.2.2.
Importantly, changes in Ψplant,i induce changes in plant water content (see section 10.3), which may induce
a release of water in the transpiration stream or an absorption of water from it, which leads to the cohort
transpiration, Tri, being different from its water extraction from the soil, Exi.
6.1.4
Minimum transpiration
The description of actual transpiration in the previous section incorporates the assumption that plants
can regulate water losses up to zero transpiration, neglecting water leaks through the leaf cuticule and/or
incomplete stomatal closure (Duursma et al. 2018). To avoid this assumption we can estimate minimum
transpiration for a given plant cohort, Trmin,i (in mm), and prevent Tri < Trmin,i.
Minimum transpiration flow per leaf area Emin in mol H2O · s−1 · m−2) can be calculated if we know (1)
the minimum leaf conductance to water vapor (gsw,min; in mol H2O · s−1 · m−2); (2) the leaf vapor pressure
deficit (V PDleaf; in kPa); and (3) atmospheric pressure (Patm; also in kPa):
Emin = gsw,min · V PDleaf
Patm
(6.11)
In turn, the vapor pressure deficit in the leaf (V PDleaf) is calculated as:
V PDleaf = eleaf −eair
(6.12)
Where eair is the water vapor pressure of the air surrounding the leaf (but beyond the leaf boundary layer)
and eleaf is the vapor pressure inside the leaf. While eair can be derived from the weather input, eleaf should
be calculated from leaf temperature (Tleaf) and leaf water potential (Ψleaf):
eleaf(Tleaf, Ψleaf) = esat(Tleaf) · exp
 2.17 · Ψleaf
Tleaf + 273.15

(6.13)
where esat(T) is a function giving the saturated vapor pressure for temperature T (see utility functions of
the meteoland reference manual). Given the simplicity of the basic water balance model, here we make
the assumption that Ψleaf = Ψplant (from the previous time step).
Furthermore, we assume that leaf

6.1. PLANT TRANSPIRATION AND PHOTOSYNTHESIS
79
temperature is coupled with the temperature of the surrounding air. Given the non-linearity of eleaf we
average the wapor pressure values provided by eleaf(Tmin, Ψplant) and eleaf(Tmax, Ψplant).
Once the leaf level Emin is known for a give cohort i, we can scale this instantaneous rate to daily transpiration
(in mm) at the cohort level using:
Trmin,i = Emin,i · 24 · 3600 · LAIϕ
i · 0.018
(6.14)
6.1.5
Transpiration with water pools
Considering water pools (i.e. setting rhizosphereOverlap = "partial" or rhizosphereOverlap =
"total" in the control parameters) involves partitioning the stand area into fractions corresponding to the
abundance of each plant cohort. More specifically, the model defines as many plant water pools as plant
cohorts, with proportions defined by their LAI values. For example, the fraction corresponding to plant
cohort j would be:
fpool,j = LAIlive
j
LAIlive
stand
(6.15)
Overall soil moisture is then related to moisture of plant water pools by the following equation, that is
fulfilled for each soil layer s:
Ws =
X
j
fpool,j · Wj,s
(6.16)
where Wj,s is the soil moisture (relative to field capacity) of layer s in the water pool of cohort j, i.e. under
the area of the stand attributed to cohort j.
When transpiration occurs and water pools are considered, the model assumes that the rhizosphere of each
plant cohort occupies its own water pool, but may enter into the water pools under other plant cohorts if the
overlap is partial. In other words, the root systems of different cohorts may overlap horizontally. A given
plant cohort i will have its roots in layer s partitioned among different water pools. Let us assume that we
know fri,s,j, the (horizontal) proportion of fine roots of cohort i in layer s of the water pool j (see section
2.4.8). These proportions sum one when summed across water pools:
X
j
fri,s,j = 1 ∀i, s
(6.17)
The proportion of fine roots in a given water pool, with respect to the whole root system, will then be equal
to:
FRPi,s,j = fri,s,j · FRPi,s
(6.18)
Estimating transpiration with water pools is analogous to estimating transpiration without them, but re-
placing the role of FRPi,s by FRPi,s,j, and Ki,s by Ki,s,j, in eq. (6.7), which leads to the estimation of
Tri,s,j. Analogous replacements have to be made when estimating the plant water potential in eq. (6.10).
Finally, note that the amount of water extracted from the soil layer s of given water pool j (i.e. from Wj,s)
will not be Tri,s,j (whose units are referred to the overall stand) but Tri,s,j/fpool,j.
6.1.6
Plant photosynthesis
Because it is useful for growth, and for compatibility with the ‘Sperry’ transpiration mode (chapter 7), the
water balance model using ‘Granier’ transpiration mode also calculates gross assimilated carbon. Gross
photosynthesis for a given plant cohort i (in g C · m−2) is estimated as a function of transpiration:
Ag,i = Tri · WUEmax,i · (LP AR
i
)W UEP AR,i · (1 −eW UECO2,i·Cair) · V PDW UEV P D
(6.19)
where Tri is the transpiration of plant cohort i, WUEmax,i is the maximum water use efficiency of the
cohort (in g C · mm−1) - a species-specific parameter where WUE assumed to be estimated under conditions

80
CHAPTER 6. WOODY PLANT TRANSPIRATION, PHOTOSYNTHESIS AND WATER STATUS
of V PD = 1kPa, no atmospheric CO2 limitations and maximum light availability -; LP AR
i
is the proportion
of photosynthetically-active radiation available at the mid-crown of cohort i, according to the Beer-Lambert
extinction model; Cair is the atmospheric CO2 concentration (in ppm); V PD is the vapor pressure deficit
(in kPa); WUECO2,i and WUEV P D,i are species-specific coefficients regulating the influence of CO2 con-
centration and VPD on WUE, respectively; and WUEP AR,i is a species-specific exponent indicating how
relative WUE decreases with lower light levels.
Different effects are taken into account in the estimation of gross photosynthesis (eq. (6.19)). The depen-
dency of photosynthesis on drought stress is represented in the Tri term, whereas the dependency on CO2
concentration is given by the negative exponential term and the progressive reduction of photosynthesis
under higher V PD (assuming a reduction of stomatal conductance but the same water flow) is modelled
using negative WUEV P D,i exponents. Finally, the reduction of photosynthesis due to low light availability
(for cohorts in the understory) is represented by the reduction of relative WUE given by low values of LP AR
i
:
Figure 6.3: Relationship between the percentage of PAR available to a cohort and the water use efficiency
(left) or the water use efficiency relative to the maximum value observed in the stand for the same species
(right). WUE values were estimated using the advanced water balance model and a non-linear regression
was fitted.
6.2
Plant drought stress and cavitation
6.2.1
Daily drought stress
Similarly to Mouillot et al. (2002), daily drought stress of a given plant cohort i, DDSi, is defined as the
one-complement of relative whole-plant transpiration (see eq. (6.4)) estimated from its plant water potential
(Ψplant,i):
DDSi = ϕi · (1 −Ki(Ψplant,i))
(6.20)
Leaf-phenological status is included to prevent winter deciduous plants from suffering drought stress during
winter. Daily drought stress values can be later used to define other drought stress indices for larger temporal
scales.

6.2. PLANT DROUGHT STRESS AND CAVITATION
81
6.2.2
Cavitation and hydraulic recovery
The water balance model is normally run assuming that although soil drought may reduce transpira-
tion, embolized xylem conduits are automatically refilled when soil moisture recovers (in other words,
cavitation is reversible and stemCavitationRecovery = "total"). It is possible to simulate irreversible
cavitation
by
setting
stemCavitationRecovery = "none",
stemCavitationRecovery = "rate"
or
stemCavitationRecovery = "annual" in the control parameters. Any of these options cause the model to
keep track of the maximum value of cavitation so far experienced using the proportion of of lost conductance
for leaves and the stem the plant cohort i (PLCleaf,i and PLCstem,i), which are modelled from Ψplant using
Weibull functions:
PLCleaf,i
=
max

PLCleaf,i, 1 −exp
Ψplant,i
dleaf
cleaf 
(6.21)
PLCstem,i
=
max

PLCstem,i, 1 −exp
Ψplant,i
dstem
cstem
(6.22)
For simulations of less than one year one can use stemCavitationRecovery = "none" to keep track of the
maximum cavitation. However, for simulations of several years, it is normally advisable to allow recovery.
If stemCavitationRecovery = "annual", PLCleaf,i and PLCstem,i values are set to zero at the beginning
of each year, assuming that embolized plants overcome the conductance loss by creating new xylem tissue.
Finally, if stemCavitationRecovery = "rate" the model simulates stem refilling at daily steps as a function
of symplasmic water potential. First, a daily recovery rate (rrefill; in cm2 · m−2 · day−1) is estimated as a
function of Ψplant,i:
rrefill(Ψplant,i) = rmax,refill · max{0.0, (Ψplant,i + 1.5)/1.5}
(6.23)
Where rmax,refill is the control parameter cavitationRecoveryMaximumRate indicating a maximum refill
rate. The right part of the equation normalizes the water potential, so that rrefill = rrefill,max if Ψplant,i = 0
and rrefill = 0 if Ψplant,i <= −1.5MPa. The proportion of conductance lost in stems and leaves is then
updated using:
PLCleaf,i
=
max{0.0, PLCleaf,i −(rrefill/Hv)}
(6.24)
PLCstem,i
=
max{0.0, PLCstem,i −(rrefill/Hv)}
(6.25)
where Hv is the Huber value (sapwood area to leaf area ratio) in units of cm2 · m−2.

82
CHAPTER 6. WOODY PLANT TRANSPIRATION, PHOTOSYNTHESIS AND WATER STATUS

Part III
Advanced water balance modelling
83


Chapter 7
Advanced water balance model
This chapter provides an overview of the advanced water and energy balance model available in medfate.
It shares some characteristics with the basic water balance model described in previous chapters. Like the
previous one, the model is run using function spwb(), for a set of days, or function spwb_day(), for a single
day. Compared to the basic model, the advanced water balance model adds more detail in some processes
(radiation transfer, plant hydraulics and photosynthesis) and incorporates other processes that were missing
(canopy/soil energy balances and plant water balance). Importantly, two alternative approaches are possible
regarding plant hydraulics and stomatal conductance sub-models:
• If transpirationMode = "Sperry", the sub-models of plant hydraulics and stomatal conductance
follow Sperry et al. (2017) and were described in detail in De Cáceres et al. (2021).
• If transpirationMode = "Sureau", the sub-models of plant hydraulics and stomatal conductance
follow SurEau-ECOS and were described in Ruffault et al. (2022).
The following model overview is structured as in chapter 3. Process formulations shared with the basic
water balance model were presented in previous chapters and will not be repeated. The chapters following
this one provide a detailed description of those sub-modules that are exclusive of the advanced model.
Whenever necessary, we will detail the difference between the two sub-models of plant hydraulics and stomatal
conductance corresponding to De Cáceres et al. (2021) and Ruffault et al. (2022). We recommend readers to
familiarize themselves with basic water balance modelling processes before reading this and the subsequent
chapters. In addition, users of this model should have a background on the processes implemented to fully
understand and exploit model outputs. Since the scope of this book is focused on the model, interested
readers should address relevant eco-physiological bibliography complement the material exposed here.
7.1
About Sureau
SurEau is a comprehensive plant hydraulic model that already knows different versions. The first and most
detailed version was developed in C by Hervé Cochard (Sureau.c, Cochard et al. (2021)), which follows a
preliminary version coded in Excell and in R that has been used to understand the stomatal functioning of
plants around the world (Martin-StPaul et al. 2017).
In Sureau.c , the plant is relatively well detailed (large roots, trunk, branches, leaves, buds and even flowers).
The numerical resolution of the calculations is done according to an explicit scheme, where the elementary
transfers of water between each compartment must be calculated at very small time-steps to avoid numerical
instabilities known as the Courant–Friedrichs–Lewy condition (for a tree time step must be around 0.001s).
This complexity is an advantage for exploring questions about the physiological functioning of the tree.
However, the computational demand is also a limit for large-scale application of the model and for integration
in dynamic vegetation or land surface models.
85

86
CHAPTER 7. ADVANCED WATER BALANCE MODEL
Researchers from INRAE-URFM (François Pimont, Julien Ruffault, Nicolas Martin-StPaul at Avignon) and
INRAE-PIAF (Hervé Cochard, at Clermont-Ferrand) therefore joined forces to develop a new version, coded
in R native, where the numerical scheme for solving water transport calculations was improved (SurEau-Ecos,
Ruffault et al. (2022)). They implemented two alternative resolution schemes (the so called semi-implicit
and implicit) allowing to solves the water transport accounting for capacitance and cavitation at much larger
time steps (of the order of 10 to 30 minutes). In this version the authors also used a tree simplified to only
two organs: leaves and stems (and therefore four compartments with an apoplasm and a symplasm for
each organ) to facilitate parameterization. This advance has been decisive for medfate because it made
the model compatible in terms of plant structure and and computational demand. In medfate we refer to
Sureau when this model is used for the computation of transpiration and plant water related processes.
7.2
Design principles
The model performs soil/plant water balance and soil/canopy energy balance for a given forest stand and
for the period corresponding to input weather data. Soil water balance is calculated on a daily step basis
whereas energy balances and plant transpiration are determined at subdaily steps (typically 1h steps). The
model considers only the vertical spatial dimension of the stand, and not the horizontal distribution of
plants within it. Still, the forest stand is divided into: (a) canopy vertical layers; (b) woody plant cohorts of
different species and a herbaceous layer.
Hydrological processes are the same as in chapter 3.
Thus, the model includes water interception loss
(Gash et al. 1995; Liu 2001), plant transpiration, evaporation from soil (Ritchie 1972), transpiration of the
herbaceous layer, infiltration into the soil matrix (Green & Ampt 1911; Boughton 1989) and vertical water
movement within the soil (Jarvis et al. 1991; Larsbo et al. 2005).
A great deal of the complexity of the advanced model concerns the estimation of woody plant transpiration
and photosynthesis.
The model simulates stomatal regulation of gas exchange separately for sunlit and
shade leaves at sub-daily steps, involving detailed calculations of plant hydraulics, leaf energy balance and
photosynthesis. Compared to the basic water balance model of chapter 3, the higher level of complexity of
the advanced model allows a more precise estimation of carbon and water flows, as well as a more nuanced
evaluation of plant water status.
To calculate radiation balance and incident PAR at the leaf level, the leaf area of each plant cohort is divided
into vertical layers according to its crown limits. Photosynthesis and transpiration of sunlit and shade leaves
are treated separately (De Pury & Farquhar 1997). Given an input direct and diffuse short-wave irradiance
at the top of the canopy, the amount of light absorbed by sunlit leaves, shade leaves and the soil follows the
model of Anten & Bastiaans (2016). The scheme for long-wave radiation transfer between the atmosphere,
the different canopy layers and the soil follows the SHAW model (Flerchinger et al. 2009).
Energy balances are conducted at two levels: the canopy (or canopy layers) level and the leaf level. The model
keeps track of temperature variation within the canopy (i.e. canopy energy balance) and in the uppermost soil
surface (i.e. soil energy balance) as the result of energy exchanges between them and with the atmosphere.
Heat conduction also occurs among soil layers. Energy balance can be performed assuming a single canopy
layer, with soil and canopy energy balance equations being similar to those of Best et al. (2011) for JULES.
Alternatively, energy balance can be conducted for each vertical layer following Bonan et al. (2014). In this
case, the model allows considering within-canopy gradients in temperature, water vapor pressure, and CO2
as well as the turbulent transport of heat, water vapor and CO2 between canopy layers (Ma & Liu 2019),
determined using a canopy turbulence model by Katul et al. (2004).
The model also performs the energy balance at the leaf level to determine transpiration. At this scale,
radiation inputs include shortwave radiation from the atmosphere absorbed by the leaf and the net balance
of long-wave radiation. Leaf temperature is determined assuming that the temperature of the surrounding
air is that of the canopy (or canopy layer). After determining stomatal regulation, the model up-scales
the transpiration flux to the canopy (or canopy layer) scale and the corresponding latent heat is used to
complete the calculation of the energy balance at the canopy (or canopy layer) level. Latent heat fluxes from

7.3. STATE VARIABLES
87
evaporation from the soil and evaporation of intercepted rainfall are also included in the canopy/soil energy
balances.
Plant hydraulics and stomatal regulation follow different designs depending on the sub-model employed:
• If transpirationMode = "Sperry", plant hydraulics follows the steady-state approach of Sperry et
al. (1998) model, and stomatal regulation follows the profit maximization approach of Sperry et al.
(2017).
• If transpirationMode = "Sureau", plant water compartments are always included, and water flows
follow Darcy’s law, as described in Ruffault et al. (2022). In this case, stomatal regulation follows a
Jarvis-type model.
Like in the basic water model, the advanced model assumes by default that soil moisture under all plant
cohorts is the same (i.e. water sources corresponding to vertical soil layers are shared among cohorts). How-
ever, variations in soil moisture beneath plant cohorts (and, implicitly, horizontal variation of soil moisture)
can be simulated. In this case, hydrological processes are replicated for the fraction of soil corresponding to
each cohort. Transpiration of each plant cohort depends on the soil moisture beneath itself and, depending
on root overlap, on the soil moisture beneath other plant cohorts.
7.3
State variables
The following are state variables in the model under all simulations:
• Cumulative degree days (a) to budburst, (b) to complete unfolding or (c) to senescence (Seco,d, Sunf,d
or Ssen,d; all in ◦C), are tracked by the model to determine leaf phenological status (see 4.1).
• Daily soil moisture content dynamics on each layer s are tracked using Ws = θs(Ψs)/θfc,s, the pro-
portion of soil moisture in relation to field capacity, where moisture at field capacity, θfc,s, is assumed
to correspond to Ψfc = −0.033 MPa. Note that Ws values larger than one are possible if the soil is
between field capacity and saturation (which can happen if deep drainage is not allowed).
• The air temperature within the canopy (Tcan; ºC) and the temperature of each soil layer s (Tsoil,s; ºC)
are tracked for every subdaily step.
Additional state variables depend on the activation of specific control flags (see subsection 7.6.3):
• If transpirationMode = "Sureau", the model also tracks Ψapo,stem,i, the water potential of the stem
apoplastic compartment, as well as the water potential of stem and leaf symplastic compartments,
Ψsymp,stem,i and Ψsymp,leaf,i respectively.
• If stem cavitation is not completely reversible, the model tracks PLCstem,i and PLCleaf,i, the propor-
tion of conductivity lost the stem and leaves, respectively, of plants of cohort i.
• If plant water pools are considered, the model also tracks Wi,s, the proportion of soil moisture in
relation to field capacity for layer s within the areal fraction of stand covered by cohort i.
• If multi-layer canopy energy balance is activated, the model tracks for each vertical layer j ∈{1, l}:
a. Air temperature, Tair,j
b. Water vapor pressure, eair,j
c. CO2 concentration, Cair,j.

88
CHAPTER 7. ADVANCED WATER BALANCE MODEL
7.4
Water and energy balances
7.4.1
Water balance
The water balance equations for the soil and snowpack of the advanced model are essentially the same as
introduced in section 3.3, with some minor modifications.
Although the advanced water balance model
includes hydraulic redistribution, this does not change the total amount of water in the soil, so the water
balance equation is is very similar to that of the basic water balance model (eq.(3.5)), but where woody
plant water uptake (Exwoody) is used instead of woody transpiration (Trwoody).
∆Vsoil = (If + Lw + Cr) −(Dd + Se + Es + Trherb + Exwoody)
(7.1)
where all the other terms were defined in 3.3.
Soil water extraction (Exwoody) and plant transpiration
(Trwoody) will be equal if capacitance effects are not considered. Otherwise the amount of water stored in
the woody plant tissues changes according to:
∆Vplant = Exwoody −Trwoody
(7.2)
Variations can occur depending on specific control flags, as explained in section 3.3.
Unlike the basic
water balance, in this model water balance components contributing to latent heat of vaporization (plant
transpiration, evaporation from soil surface and rainfall intercepted by canopy surfaces) or latent heat of
fusion (snow melt) are included in the energy balance equations of the canopy and soil, therefore coupling
water and energy balances.
7.4.2
Single-layer canopy energy balance
For the sake of performing energy balance, the canopy can be considered a single layer that exchanges
energy with the soil and the atmosphere (Best et al. 2011). First, it absorbs shortwave radiation from the
atmosphere (Kabs,can) and long-wave radiation resulting from net radiation balance (Lnet,can). Other energy
fluxes considered are convective exchanges between the canopy and atmosphere (Hcan,atm) and between the
canopy and the soil (Hcan,soil). Energy is absorbed from the canopy through latent heat of vaporization
(LEvap,can) produced via transpiration (Tr) and evaporation of water intercepted by the canopy (In); or via
latent heat of fusion due to snow melt (LEfus,snow). Combining all energy flows (all of them in W · m−2),
the instantaneous energy balance equation for the canopy is:
TCcan · δTcan
δt
= Kabs,can + Lnet,can −LEvap,can −LEfus,snow −Hcan,atm −Hcan,soil
(7.3)
where TCcan is the canopy thermal capacitance (in J · m−2 · K−1).
7.4.3
Multiple-layer canopy energy balance
Alternatively, the model allows performing an energy balance for each vertical layer in the canopy, including
its heat storage capacity (Ma & Liu 2019). The energy balance equation for canopy layer j is:
TCj · δTair,j
δt
= Kabs,j + Lnet,j −LEvap,j + Hj
(7.4)
where Kabs,j is the short-wave radiation absorbed by leaves in the layer, Lnet,j is the net long-wave radiation
balance of the layer, LEvap,j is the latent heat flux and Hj is the sensible heat flux, which includes heat
coming from leaves or soil surfaces as well as turbulent heat transport from adjacent layers. Latent heat of
fusion (LEfus,snow) needs to be subtracted from the bottom layer. Finally, TCj is the thermal capacitance
(in J · m−2 · K−1) of canopy layer j.

7.5. PROCESS SCHEDULING
89
7.4.4
Soil energy balance
Like the canopy, the uppermost soil layer absorbs short-wave radiation from the atmosphere (Kabs,soil) and
has a net long-wave radiation balance (Lnet,soil). The uppermost soil layer also exchanges heat with the
canopy (Hcan,soil) and releases energy in the form of latent heat of vaporisation due to evaporation from the
soil surface (LEvap,soil). Finally, the soil layer exchanges thermal energy by conduction with the layer below
(G1,2) The energy balance equation for the uppermost soil layer is:
TCsoil,1 · δTsoil,1
δt
= Kabs,soil + Lnet,soil + Hcan,soil −LEvap,soil −G1,2
(7.5)
where TCsoil,1 is the thermal capacitance of soil layer 1 (the uppermost layer).
Instantaneous soil temperature changes on each soil layer depend on the balance between upward and
downward energy flows.
The downward energy flow for the uppermost soil layer depends on its energy
exchanges with the canopy and the atmosphere, as shown in eq. (7.5), whereas the remaining energy flows
are generated by heat conduction and depend on the temperature gradients between soil layers. The energy
balance for a soil layer s > 1 is:
TCsoil,s · δTsoil,s
δt
= Gs−1,s −Gs,s+1
(7.6)
where Gs−1,s is the energy inflow from layers above, Gs,s+1 is the energy outflow towards layers below and
TCsoil,s is the thermal capacitance of soil layer s (in J · m−2 · K−1).
Unlike Best et al. (2011), the model considers the snow pack and the uppermost soil layer as a single layer
in terms of energy exchange, but treats this layer differently depending on whether snow is present or not.
The snow pack absorbs shortwave radiation (section 5.2) and snow melt is included as latent heat in the
energy balance, but the snow layer does not exchange long-wave radiation with the soil nor the atmosphere.
Kabs,soil is set to zero when snow pack is present (because shortwave radiation is absorbed by snow), but the
soil layer still exchanges long-wave radiation and convective energy with the canopy and the atmosphere. In
addition, remember that bare soil evaporation does not occur when the snow pack is present (section 5.4).
7.5
Process scheduling
For every day to be simulated, the model performs the following steps:
1. Update leaf area values according to the phenology of species and recalculate radiation extinction
(sections 4.1 and 4.2).
2. Determine rainfall interception loss (In) and net rainfall (Prnet) (section 5.3). The amount of water
reaching the soil surface from the rainfall event is the sum of net rainfall (Prnet) and surface runon
(Ro), if given. If snow dynamics are included, increase snow pack from snow precipitation (Ps) and
decrease it following snow melt (Sm) (section 5.2).
3. Determine bare soil evaporation (Es), if snow is not present (section 5.4), and herbaceous transpiration
(Trherb; section 5.5).
4. Determine sub-daily air temperature and direct/diffuse irradiance variations (chapter 8).
5. Determine the proportion of sunlit/shade leaves (section 9.1.2), the shortwave radiation absorbed by
plant cohorts (sections 9.1.3 and the soil (section 9.1.4) at sub-daily steps.
6. If transpirationMode = "Sperry", update the water supply function of each plant cohort, according
to the hydraulic model and the current soil water potential (chapter 10).
7. Determine instantaneous plant cohort transpiration, photosynthesis rates and close soil/canopy energy
balance at sub-daily steps (chapters 12 and 13). This involves the following actions for each sub-daily
step:
a. Determine long-wave radiation exchange between soil, canopy layers and atmosphere (section 9.2).

90
CHAPTER 7. ADVANCED WATER BALANCE MODEL
b. If transpirationMode = "Sperry", for each woody cohort:
i. Calculate leaf energy balance and photosynthesis (for shade and sunlit leaves of each plant co-
hort) corresponding to each transpiration value of the supply function (section 11.1). If plant
capacitance effects are considered this concerns the stem-to-leaf hydraulic supply function.
ii. Determine stomatal conductance, transpiration and photosynthesis on shade and sunlit leaves
of each plant cohort according to Sperry’s (2017) profit maximization strategy (section 12.1.2).
c. If transpirationMode = "Sureau", for each plant cohort repeat the following in small sub-steps
(e.g. 10 min):
i. Perform energy balance of sunlit and shade leaves (section 11.1), according to the current
transpiration flow.
ii. Re-estimate leaf and stem cuticular transpiration.
iii. Re-estimate stomatal regulation, transpiration and photosynthesis for sunlit and shade leaves.
iv. Update water potentials, flows and conductances across the hydraulic network.
d. Scale transpiration (Trwoody) and net photosynthesis (An) from sunlit/shade leaves to the plant
cohort level (section 12.3).
e. Scale water extraction from soil layers (Exwoody) to the woody plant cohort level.
f. Complete energy balance of the canopy and the soil, after translating plant transpiration, evap-
oration from bare soil, snow melt and interception loss to latent heat and calculating convective
heat exchange for both the canopy and the soil. Alternatively, perform energy balance for indi-
vidual canopy layers, while including turbulent heat exchange and turbulent transport of water
vapor and CO2 between layers (chapter 13).
8. Determine day-level photosynthesis and transpiration from instantaneous rates and update soil mois-
ture (section 14.1). Determine drought stress for each woody plant cohort (section 14.3).
9. Determine rainfall infiltration (section 5.6) and vertical water movement within the soil, while consid-
ering soil layer source/sinks from infiltration, bare soil evaporation and herbaceous transpiration and
woody plant extraction/redistribution (section 5.7). This updates soil moisture and lower boundary
condition of water movement corresponds to deep drainage (Dd).
10. If fire hazard calculations are requested, estimate live and dead fuel moisture and potential fire be-
haviour (chapter 24).
Steps 1-3 are the same as described in the basic model, and steps 9-10 here correspond to steps 5-6 in the
basic model. The set of steps corresponds to simulations if plant water pools are not considered, so that
only the water balance of the overall soil matters. If plant water pools are considered, steps 1, 2 and 10 are
the same, because they apply to the whole forest stand (note that at present infiltration does not depend
on antecedent conditions). However, steps 3 is performed for each water pool separately because it depends
on antecedent soil moisture. Steps 6-8 also involve defining woody plant water uptake from different plant
water pools depending on the proportion of fine roots of each woody cohort in each pool (see 6.1.5). Soil
water flows from these three steps are then averaged at the stand level. After that, Step 9 is performed on
the soil corresponding to each pool, and the resulting drainage estimates are also averaged. Finally, the soil
moisture of the overall soil is estimated by averaging the soil moisture of water pools.
7.6
Inputs and outputs
7.6.1
Soil, vegetation and meteorology
Soil
Soil input requirements are the same as for the basic water balance model and were fully described in section
2.3. Genuchten (1980) water retention curves are forced for this model, because rhizosphere conductance is
modelled using van Genuchten hydraulic equations (see subsection 10.2).

7.6. INPUTS AND OUTPUTS
91
Vegetation
Vegetation input requirements were fully described in section 2.4.
Trees and shrubs do not need to be
characterized with different variables in soil water balance calculations, since both kinds of cohort have a
LAI value. In most cases, users only need to estimate the leaf area index corresponding to live leaves,
i.e. LAIlive, because normally at the starting point all leaves are expanded (i.e. LAIϕ = LAIlive) and one
can assume no dead leaves in the canopy (i.e., LAIdead = 0). Vegetation characteristics stay constant during
simulations using function spwb(), although the actual expanded leaf area (LAIϕ) and dead leaf area may
vary if the species is winter deciduous.
Meteorology
The minimum weather variables required to run the model are min/max temperatures (Tmin and Tmax),
min/max relative humidity (RHmin and RHmax), precipitation (P) and solar radiation (Rad). Wind speed
(u) is also needed, but the user may use missing values if not available (a default value will be used in this
case). Wind speed is assumed to have been measured at a specific height above the canopy (by default at 2
m). Atmospheric CO2 concentration (Catm) may also be specified, but if missing a default constant value is
assumed, which is taken from the control parameters. Definitions and units of these variables were given in
section 2.5.
7.6.2
Vegetation functional parameters
The advanced water balance model requires many functional parameters to be specified for plant cohorts. A
first set of parameters refers to leaf phenology (paramsPhenology):
Symbol
Units
R
Description
PhenologyType
Leaf phenology type (oneflush-evergreen, progressive-evergreen,
winter-deciduous, winter-semideciduous)
LD
years
LeafDuration
Average duration of leaves (in years).
S∗
eco
◦C
Sgdd
Degree days corresponding to leaf budburst (see section 4.1.2).
Teco
◦C
Tbgdd
Base temperature for the calculation of degree days to leaf budburst
(see section 4.1.2).
S∗
sen
◦C
Ssen
Degree days corresponding to leaf senescence (see section 4.1.3).
Phsen
hours
Phsen
Photoperiod corresponding to start counting senescence degree-days
(see section 4.1.3).
Tsen
◦C
Tbsen
Base temperature for the calculation of degree days to leaf senescence
(see section 4.1.3).
A second set of functional parameters relate to light extinction and water interception (paramsInterception):
Symbol
Units
R
Description
λleaf
degrees
LeafAngle
The (average) angle between the leaf plane and the horizontal plane
(i.e. leaf zenith angle)
kP AR
(unitless)
kPAR
Extinction coefficient for diffuse PAR
αSW R
[0-1]
alphaSWRShort-wave radiation leaf absorbance coefficient
γSW R
[0-1]
gammaSWRShort-wave radiation leaf reflectance (albedo)
swater
mm H2OůLAI−1
g
Crown water storage capacity (i.e. depth of water that can be
retained by leaves and branches) per LAI unit
A third set includes parameters related to plant anatomic and morphological attributes (paramsAnatomy):

92
CHAPTER 7. ADVANCED WATER BALANCE MODEL
Symbol
Units
R param
Description
Hmed
cm
Hmed
Median plant height
1/Hv
m2 · m−2
Al2As
Ratio of leaf area to sapwood area
LW
cm
LeafWidth
Leaf width
SLA
m2 · kg−1
SLA
Specific leaf area
ρleaf
g · cm−3
LeafDensity
Leaf tissue density
ρwood
g · cm−3
WoodDensity
Wood tissue density
ρfineroot
g · cm−3
FineRootDensityFine root tissue density
SRL
cm · g−1
SRL
Specific root length
RLD
cm · cm−3
RLD
Fine root length density (i.e. density of root length per soil
volume)
r6.35
r635
Ratio between the weight of leaves plus branches and the
weight of leaves alone for branches of 6.35 mm
A fourth set of parameters are related to transpiration and photosynthesis (paramsTranspiration):
Symbol
Units
R param
Description
gswmin
mol H2O ·
s−1 · m−2
Gwmin
Minimum stomatal conductance to water vapour
gswmax
mol H2O ·
s−1 · m−2
Gwmax
Maximum stomatal conductance to water vapour
Jmax,298
µmol e ·
m−2 · s−1
Jmax298
Maximum rate of electron transport at 298K
Vmax,298
µmol CO2·
s−1 · m−2
Vmax298
Rubisco’s maximum carboxylation rate at 298K
Kstem,max,ref kg · s−1 ·
m−1 ·
MPa−1
Kmax_stemxylemMaximum stem sapwood reference conductivity per leaf area
unit
Kroot,max,ref
kg · s−1 ·
m−1 ·
MPa−1
Kmax_rootxylemMaximum root sapwood reference conductivity per leaf area
unit
kleaf,max
mmol ·
s−1 · m−2 ·
MPa−1
VCleaf_kmax
Maximum leaf conductance (per leaf area unit)
kstem,max
mmol ·
s−1 · m−2 ·
MPa−1
VCstem_kmax
Maximum stem conductance (per leaf area unit)
kroot,max,s
mmol ·
s−1 · m−2 ·
MPa−1
VCroot_kmax
Maximum root conductance (per leaf area unit) for each soil
layer
krhizo,max,s
mmol ·
s−1 · m−2 ·
MPa−1
VGrhizo_kmax
Maximum hydraulic conductance of the rhizosphere for each
soil layer
cleaf, dleaf
(unitless),
MPa
VCleaf_c,
VCleaf_d
Parameters of the vulnerability curve for leaves (Weibull)
Ψ50,leaf,
slopeleaf
MPa,
%/MPa
VCleaf_P50,
VCleaf_slope
Parameters of the vulnerability curve for leaves (Sigmoid)
cstem, dstem
(unitless),
MPa
VCstem_c,
VCstem_d
Parameters of the vulnerability curve for stem xylem (Weibull)
Ψ50,stem,
slopestem
MPa,
%/MPa
VCstem_P50,
VCstem_slope
Parameters of the vulnerability curve for stem xylem
(Sigmoid)

7.6. INPUTS AND OUTPUTS
93
Symbol
Units
R param
Description
croot, droot
(unitless),
MPa
VCroot_c,
VCroot_d
Parameters of the vulnerability curve for root xylem (Weibull)
Ψ50,root,
sloperoot
MPa,
%/MPa
VCroot_P50,
VCroot_slope
Parameters of the vulnerability curve for root xylem (Sigmoid)
Tgs,optim
◦C
Gs_Toptim
Temperature corresponding to maximal stomatal conductance
(Sureau sub-model)
Tgs,sens
Gs_Tsens
Stomatal sensitivity to temperature (Sureau sub-model)
Ψ50,gs
MPa
Gs_P50
Water potential causing 50% reduction in stomatal
conductance (Sureau sub-model)
slopegs
%/MPa
Gs_slope
Rate of decrease in stomatal conductance at Ψ50,gs (Sureau
sub-model)
It is important to mention that stem- and root-level hydraulic conductances (i.e. kstem,max and kroot,max)
are not given as inputs by the user, but are the result from scaling tissue-level conductivity parameters
(i.e. Kstem,max,ref and Kroot,max,ref) according to plant size (see A.4.1 and A.4.3 for details). Similarly,
parameters of Weibull vulnerability curves are estimated from the input in form of Ψ50, Ψ12 and Ψ88 available
in SpParams. The slope of the Sigmoid vulnerability curves can also be estimated from the same values, or
provided by the user directly as a column in SpParams.
A fifth (final) set of parameters are related to water storage and water relations in plant tissues
(paramsWaterStorage):
Symbol
Units
R
Description
LFMCmax
%
maxFMC Maximum live fuel moisture content, corresponding to fine fuels (<
6.35 mm twigs and leaves).
ϵleaf
MPa
LeafEPS Modulus of elasticity of leaves
ϵstem
MPa
StemEPS Modulus of elasticity of symplastic xylem tissue
π0,leaf
MPa
LeafPI0 Osmotic potential at full turgor of leaves
π0,stem
MPa
StemPI0 Osmotic potential at full turgor of symplastic xylem tissue
fapo,leaf
[0-1]
LeafAF Apoplastic fraction in leaf tissues
fapo,stem
[0-1]
StemAF Apoplastic fraction in stem tissues
Vleaf
l · m−2
Vleaf
Leaf water capacity per leaf area unit
Vsapwood
l · m−2
VsapwoodSapwood water capacity per leaf area unit
Vegetation functional attributes are normally filled for each cohort by function spwbInput() or
forest2spwbInput() from species identity.
However, different parameters can be specified for differ-
ent cohorts of the same species if desired (see section 2.4.9).
7.6.3
Control parameters
Control parameters modulate the overall behaviour of water balance simulations (see section 2.6). There are
three key control parameters:
1. transpirationMode defines the transpiration model.
If
transpirationMode = "Sperry" or
transpirationMode = "Sureau" then the advanced water balance model is run with the correspond-
ing plant hydraulics and stomatal regulation sub-models.
In advanced water balance models, the
water retention curve model is forced to be that of Van Genuchten, i.e. soilFunctions = "VG" (see
section 2.3.2).
2. multiLayerBalance is a boolean flag to indicate that multi-layer energy balance is desired (by default
multiLayerBalance = FALSE).

94
CHAPTER 7. ADVANCED WATER BALANCE MODEL
Other relevant control parameters relevant for the advanced water balance model are:
• ndailysteps [= 24]: Number of steps into which each day is divided for determination of soil water
balance, stomatal conductance, transpiration and photosynthesis (24 equals 1-hour intervals).
• nsubsteps_canopy [= 3600]: Defines the number of substeps for multi-layer energy balance calcula-
tions. By default, substeps are 1 sec if ndailysteps = 24.
• soilDomains [= "single"]: Either “single” (for single domain) or “dual” (for dual-permeability) (see
section 5.7).
• max_nsubsteps_soil [= 300]: Maximum number of substeps for soil water balance solving.
• defaultWindSpeed [= 2.5]: Default value for wind speed (in m·s−1) when this is missing (only used
for leaf fall, see section 4.1).
• defaultCO2 [=386]: Default atmospheric (abovecanopy) CO2 concentration (in micromol CO2·mol−1
= ppm). This value will be used whenever CO2 concentration is not specified in the weather input.
• defaultRainfallIntensityPerMonth [= c(1.5, 1.5, 1.5, 1.5, 1.5, 1.5, 5.6, 5.6, 5.6,
5.6, 5.6, 1.5)]: A vector of twelve values indicating the rainfall intensity (mm/h) per month. By
default synoptic storms (1.5 mm/h) are assumed between December and June, and convective storms
(5.6 mm/h) are assumed between July and November (Miralles et al. 2010).
• snowpack [= TRUE]: Whether dynamics of snow pack are included (see section 5.2).
• leafPhenology [= TRUE]: Whether leaf phenology is simulated for winter-deciduous species (see sec-
tion 4.1). If FALSE then all species are assumed to be evergreen.
• bareSoilEvaporation [= TRUE]: Whether evaporation from the soil surface is simulated (see section
5.4).
• interceptionMode [= "Gash1995"]: Infiltration model, either “Gash1995” or “Liu2001”; see section
5.3.
• infiltrationMode [= "GreenAmpt1911"]:
Infiltration
model,
either
“GreenAmpt1911”
or
“Boughton1989”; see section 5.6.
• sapFluidityVariation [= TRUE]: Flag to indicate that temperature affects sap fluidity (see 10.2.3).
• windMeasurementHeight [= 200]: Distance (in cm) above the top of the canopy corresponding to
the measurement of wind speed.
• boundaryLayerSize [= 2000]: Size of the canopy boundary layer (in cm). The boundary layer causes
the model to define vertical layers above the top of the canopy. The parameter is only relevant when
multi-layer canopy energy balance is performed.
• unlimitedSoilWater [=FALSE]: Boolean flag to indicate the simulation of plant transpiration assum-
ing that soil water is always at field capacity.
• interceptionMode [= "Gash1995"]: Infiltration model, either “Gash1995” or “Liu2001”.
• infiltrationMode [= "Green-Ampt"]: Infiltration model, either “Green-Ampt” or “Boughton”.
• rhizosphereOverlap [="total]: A string indicating the degree of rhizosphere spatial overlap between
plant cohorts:
– "none" - no overlap (independent water pools).
– "partial" - partial overlap determined by coarse root volume.
– "total" - total overlap (plants extract from common soil pools).
• thermalCapacityLAI [= 1000000]: Canopy thermal capacitance per LAI unit (see section 13.1.3).
• verticalLayerSize [= 100]: The size of vertical layers (in cm) for leaf area distribution and light
extinction calculations (see section 2.4.6).
• segmentedXylemVulnerability [=TRUE]: If FALSE leaf and root vulnerability curves will be equal to
those of stem.
• leafCavitationRecovery / stemCavitationRecovery [= "rate"]:
A string indicating how to
model recovery of xylem conductance (see section 12.4). Allowed values are:
– "none" - no recovery.
– "annual" - complete recovery every first day of the year.
– "total" - instantaneous complete recovery.
– "rate" - following a rate of new leaf or sapwood formation.

7.6. INPUTS AND OUTPUTS
95
• cavitationRecoveryMaximumRate [= 0.05]: Maximum rate of conductance recovery (see section
12.4).
A set of parameters is only relevant for transpirationMode = "Sperry":
• leafCavitationEffects / stemCavitationEffects [= FALSE/TRUE]: A flag indicating whether
cavitation effects on conductance of leaves and stem are applied.
• numericParams: A list with parameters for numerical approximation routines:
– maxNsteps [= 400] - Maximum number of steps in supply function.
– ntrial [= 200] - Number of iteration trials when finding root of equation system.
– psiTol [= 0.0001] - Tolerance value for water potential.
– ETol [= 0.0001] - Tolerance value for flow.
whereas another set is only relevant for transpirationMode = "Sureau":
• plantCapacitance [= TRUE]: Whether the effect of (symplasmic or apoplasmic) plant water com-
partments is considered in simulations.
• leafCuticularTranspiration [= TRUE]: Whether the effect of leaf cuticular transpiration is consid-
ered in simulations.
• stemCuticularTranspiration [= TRUE]: Whether the effect of stem cuticular transpiration is con-
sidered in simulations.
• C_SApoInit [= 2.0e-5]: Maximum capacitance of the stem apoplasm (mmol·m-2).
• C_LApoInit [= 1.0e-5]: Maximum capacitance of the leaf apoplasm (mmol·m-2).
• k_SSym [= 0.26]: Conductance from stem apoplasm to stem symplasm (mmol·s-1·m-2).
• k_LSym [= 2.0]: Conductance from leaf apoplasm to leaf symplasm (mmol·s-1·m-2).
• gs_NightFrac [= 0.05]: Stomatal conductance at night as fraction of maximum stomatal conduc-
tance ([0-1]).
• stomatalSubmodel [= "Baldocchi"]: Stomatal regulation sub-model, either “Jarvis” or “Baldocchi”.
• JarvisPAR [= 0.003]: Parameter regulating the response of stomatal conductance to light (PAR) in
the Jarvis model.
• gCrown0 [= 0.150]: Reference crown conductance (mol·s-1·m-2).
• fTRBToLeaf [= 0.8]: Fraction of surface of bark exposed to air per leaf area.
Finally, a number of control parameters are used to modify how hydraulic parameters are estimated when
calling function spwbInput():
• taper [= TRUE]: Whether taper of xylem conduits is accounted for when estimating aboveground
stem conductance from xylem conductivity.
• fracRootResistance [= 0.40]: Fraction of plant total resistance (leaf+stem+root) that corresponds
to root system.
• averageFracRhizosphereResistance [= 0.15]: Fraction to total continuum (stem+root+rhizosphere)
resistance that corresponds to rhizosphere (averaged across soil water potential values).
7.6.4
Model output
7.6.4.1
Daily output
Functions spwb() and pwb() with transpirationMode = "Sperry" or transpirationMode = "Sureau"
return a list of a class with the same name. The first four elements of this list (i.e., latitude, topography,
weather and spwbInput) are simply copies of model inputs. The next element is spwbOutput, which contains
the state of the input object at the end of the simulation (this can be used to perform further simulations
starting with current values of state variables). The remainng elements are:

96
CHAPTER 7. ADVANCED WATER BALANCE MODEL
Element
Description
WaterBalance
Climatic input and water balance flows (i.e. net precipitation, infiltration, runoff,
transpiration. . . ). All of them in mm = l · m−2.
EnergyBalance Energy balance components (instantaneous values) for the soil and the canopy
Temperature
Minimum and maximum temperature values for topsoil, canopy and atmosphere. Only
returned if temperatureResults = TRUE.
Soil
Soil variables for each soil layer: Moisture relative to field capacity (Ws), water potential
(Ψs) and volumetric water content (Vs). Only returned if soilResults = TRUE.
Stand
Stand-level variables, such as LAIϕ
stand, LAIdead
stand, the water retention capacity of the
canopy (Scanopy) or the fraction of light reaching the ground (LP AR
ground and LSW R
ground). Only
returned if standResults = TRUE.
Plants
Plant-level variables, such as LAIphi
i
, plant transpiration, plant water potential, etc. Only
returned if plantResults = TRUE.
SunlitLeaves
Leaf-level output variables for sunlit leaves. Only returned if leafResults = TRUE.
ShadeLeaves
Leaf-level output variables for shade leaves. Only returned if leafResults = TRUE.
FireHazard
Fire hazard variables (fuel moisture, rate of spread, fire potentials, etc). Only returned if
fireHazardResults = TRUE.
Compared to the output of the basic water balance 3.5.4, new output elements are produced. Many results
are given as sub-elements of Plants, each of them a data frame with dates in rows and plant cohorts in
columns:
Element
Symbol
Units
Description
LAI
LAIϕ
m2 · m−2
Leaf area index (expanded).
LAIlive
LAIlive
m2 · m−2
Leaf area index (live).
AbsorbedSWR
MJ
Shortwave radiation absorbed per ground area.
AbsorbedLWR
MJ
Longwave radiation absorbed per ground area.
TranspirationTr
mm
Transpiration per ground area.
GrossPhotosynthesis
Ag
g C · m−2
Gross photosynthesis per ground area.
NetPhotosynthesis
An
g C · m−2
Net photosynthesis per ground area.
dEdP
dE/dΨleaf
mmol ·
s−1·m−2·
MPa−1
Derivative of the (aboveground) supply function.
PlantWaterBalance
mm
Internal daily plant water balance (balance of soil extraction
and transpiration).
LeafPsiMin
Ψmd
MPa
Minimum (midday) ‘average leaf’ water potential.
LeafPsiMax
Ψpd
MPa
Maximum (predawn) ‘average leaf’ water potential.
StemPsi
Ψstem
MPa
Minimum stem water potential.
RootPsi
Ψrootcrown
MPa
Minimum root-crown water potential.
RhizoPsi
Ψrootsurf,s
MPa
Minimum root surface water potential for each soil layer.
LeafPLC
PLCleaf
MPa
Proportion of leaf conductance loss.
StemPLC
PLCstem
MPa
Proportion of stem conductance loss.
LeafRWC
RWCleaf
%
Mean leaf relative water content.
StemRWC
RWCstem
%
Mean stem relative water content.
LFMC
LFMC
%
Live fuel moisture content (as percent of dry weight),
corresponding to fine fuels (< 6.35 mm twigs and leaves).
PlantStress
DDS
[0-1]
Drought stress level suffered by each plant cohort (relative
whole-plant conductance).
The following table describes the child elements of SunlitLeaves and ShadeLeaves, each of them a data
frame with dates in rows and plant cohorts in columns:

7.6. INPUTS AND OUTPUTS
97
Element
Symbol
Units
Description
LeafPsiMin
Ψsunlit
md,i ,
Ψshade
md,i
MPa
Minimum (midday) (sunlit or shade) leaf water potential.
LeafPsiMax
Ψsunlit
pd,i
,
Ψshade
pd,i
MPa
Maximum (predawn) (sunlit or shade) leaf water potential.
TempMin
T sunlit
leaf,min,
T shade
leaf,min
◦C
Minimum leaf temperature.
TempMax
T sunlit
leaf,max,
T shade
leaf,max
◦C
Maximum leaf temperature.
GSWMin
gsunlit
w,i
,
gshade
w,i
mol · s−1 ·
m−2
Minimum stomatal conductance to water vapour.
GSWMax
gsunlit
w,i
,
gshade
w,i
mol · s−1 ·
m−2
Maximum stomatal conductance to water vapour.
The output of simulations can be inspected using plot, shinyplot and summary functions specific to spwb
objects (examples are given in the corresponding package vignette).
7.6.4.2
Sub-daily output
Calling function spwb_day() with the advanced water balance model results in sub-daily results for the
simulated date. When running the advanced water balance model with function spwb() one can request
sub-daily results to be included with the function output. This is done via setting subdailyResults = TRUE
in the control parameter list. In that case, the output list of spwb() will include an element subdaily, whose
sub-elements correspond to the results of spwb_day() for each date simulated. Refer to the documentation of
functions spwb_day() and transp_transpirationSperry() or transp_transpirationSureau() for details
of sub-daily output.

98
CHAPTER 7. ADVANCED WATER BALANCE MODEL

Chapter 8
Sub-daily atmospheric temperature
and radiation variation
After estimating leaf phenology (chapter 4) and simulating the main hydrological processes (chapter 5),
the advanced water balance model (chapter 7) starts simulating subdaily processes, which include energy
balances and photosynthesis/transpiration. In order to properly simulate these processes it is important
to consider sub-daily variations in temperature and radiation. Here we detail how sub-daily estimates of
above-canopy air temperature and atmospheric incoming radiation are derived from daily input values.
8.1
Above-canopy air temperature
Above-canopy air temperature (Tatm, in ◦C) diurnal variations are modeled assuming a sinusoidal pattern
with Tatm = Tmin at sunrise and Tatm = (Tmin + Tmax)/2 at sunset. Air temperature varies linearly between
sunset and sunrise (McMurtrie et al. 1990). Sunrise and sunset hours are determined from latitude and sun
declination (see section 4.2 of the reference manual for package meteoland).
8.2
Incoming diffuse and direct short-wave radiation
Daily global radiation (Rad, in MJ · m−2 · d−1) is assumed to include both direct and diffuse short-wave
radiation (SWR). Using latitude information and whether is a rainy day, this quantity is partitioned into
instantaneous direct and diffuse SWR and PAR for different daily substeps. Values of instantaneous direct
and diffuse SWR and PAR above the canopy (Ibeam and Idif, in W · m−2) are calculated using the methods
described in Spitters et al.
(1986), which involve comparing daily global radiation with daily potential
radiation. All these calculations are performed using routines in package meteoland (see details in section
4.6 of the reference manual for this package).
8.3
Incoming long-wave radiation
Once the above-canopy air temperature for a given time step is known, instantaneous long-wave radiation
(LWR) coming from the atmosphere (Latm, in W · m−2) can be calculated following Campbell & Norman
(1998):
Latm = ϵa · σ · (Tatm + 273.16)4.0
(8.1)
99

100
CHAPTER 8. SUB-DAILY ATMOSPHERIC TEMPERATURE AND RADIATION VARIATION
where Tatm is air temperature, σ = 5.67 · 10−8.0 W · K−4 · m−2 is the Stephan-Boltzmann constant and ϵa
is the emmissivity of the atmosphere, calculated using:
ϵa
=
(1 −0.84 · c) · ϵac + 0.84 · c
(8.2)
ϵac
=
1.72 ·

eatm
Tatm + 273.16
1/7
(8.3)
where eatm is the average daily water vapor pressure (in kPa; see 2.5) and c is the proportion of clouds (c = 1
in rainy days and c = 0 otherwise).

Chapter 9
Radiation transfer
Radiation transfer is not the same throughout the day, but changes with solar hour. This is represented
using β, the solar elevation angle (see section 4.3 of the reference manual for package meteoland).
In the previous chapter we detailed sub-daily variation in temperature, direct radiation and diffuse short-wave
radiation. Here we deal with the absorption of diffuse and direct shortwave radiation through the canopy as
well as the long-wave radiation balance for canopy layers and the soil layer. These are necessary to estimate
the different components of the canopy and soil energy balances (see eqs. (7.3), (7.4) and (7.5)) as well as to
determine leaf energy balance, transpiration and photosynthesis (chapters 11 and 12). Short-wave radiation
transfer can be determined for all sub-daily steps once the variation of atmospheric inputs are known. In
contrast, the long-wave radiation (LWR) balance for any surface depends on its temperature and therefore,
net LWR for canopy and soil layers need to be determined at each sub-daily step after closing the energy
balance of the previous step (see chapter 13).
The vertical distribution of leaves in the stand is a key element of radiation transfer. As explained in sec-
tion 2.4.6, the canopy is divided into vertical layers (whose size is determined by the control parameter
verticalLayerSize), and the expanded and dead leaf area index of each cohort within each layer is deter-
mined. Let l be the number of canopy layers, c the number of plant cohorts, and LAIall
i,j = LAIϕ
i,j +LAIdead
i,j
be the leaf area index of cohort i in layer j.
9.1
Short-wave radiation
In section 8.2 we explained how the model estimates instantaneous and direct/diffuse SWR and PAR at the
top of the canopy. Given an input direct and diffuse short-wave irradiance at the top of the canopy, the
amount of light absorbed by sunlit leaves, shade leaves and the soil follows the model of Anten & Bastiaans
(2016), which we detail in the following subsections.
9.1.1
Direct and diffuse irradiance across the canopy
The average irradiance reaching the top of each canopy layer j is calculated separately for direct beam and
diffuse radiation (the same equations are valid for SWR or PAR, but with different coefficients):
Ibeam,j
=
(1 −γi) · Ibeam · exp


l
X
h=j+1
c
X
i
−kb,i · α0.5
i
· LAIall
i,h


(9.1)
Idif,j
=
(1 −γi) · Idif · exp


l
X
h=j+1
c
X
i
−kd,i · α0.5
i
· LAIall
i,h


(9.2)
101

102
CHAPTER 9. RADIATION TRANSFER
where Ibeam and Idif are the direct and diffuse irradiance at the top of the canopy (in W ·m−2), γi is the leaf
reflectance (γSW R,i is an input parameter, whereas γP AR,i = 0.8 · γSW R,i), kb,i is the extinction coefficient
of cohort i for direct light, kd,i is the extinction coefficient of cohort i for diffuse light (i.e. kP AR,i or kSW R,i)
and αi is the absorbance coefficient (αSW R,i is an input parameter, whereas αP AR,i = αSW R,i · 1.35).
Plant leaves are not disposed horizontally but have an inclination (i.e. a leaf angle λleaf) which may change
from one species to the other and determines radiation extinction along with solar elevation. The extinction
coefficient for direct light, kb, depends on the leaf angle (λleaf) and the solar elevation angle (β), as described
in Sellers (1985). First λleaf is used to determine χleaf, a parameter describing the departure of leaf angle
distribution from the spherical distribution (which assumes all angles as equally probable):
χleaf(λleaf) = 2.0 · cos(λleaf) −1.0
(9.3)
χleaf equals 0 for +1 for horizontal leaves (i.e. for λleaf = 0 degrees), 0 for random leaves (i.e. for λleaf = 60
degrees) and -1 for vertical leaves (i.e. for λleaf = 90 degrees). χleaf and β are then used to estimate Gb the
relative projected area of leaves in the direction of the solar beam:
Gb(λleaf, β) = ϕ1 + ϕ2 · sin(β);
(9.4)
where ϕ1 = 0.5 −0.633 · χleaf −0.33 · χ2
leaf and ϕ2 = 0.877 · (1 −2 · ϕ1) for −0.4 ≤χleaf ≤0.6. Finally, kb
is estimated as:
kb = Gb(λleaf, β)
sin(β)
(9.5)
The calculations can be illustrated with function light_directionalExtinctionCoefficient():
solarElevation <- 40 # in degrees
meanLeafAngle <- 60 # in degrees
sdLeafAngle <- 20
## Parameters of the beta distribution
beta <- light_leafAngleBetaParameters(meanLeafAngle*(pi/180), sdLeafAngle*(pi/180))
beta
##
p
q
## 2.333333 1.166667
## Direct beam extinction coefficient for solar elevation
kb <- light_directionalExtinctionCoefficient(beta["p"], beta["q"], solarElevation*(pi/180))
kb
## [1] 0.7696812
9.1.2
Sunlit and shade leaves
It is generally accepted that sunlit and shade leaves need to be treated separately for photosynthesis calcu-
lations (De Pury & Farquhar 1997). This separation is necessary because photosynthesis of shade leaves has
an essentially linear response to irradiance, while photosynthesis of leaves in sunflecks is often light saturated
and independent of irradiance. The proportion of sunlit leaves, i.e. leaves in a canopy layer j that the direct
light beams (sunflecks) reach is:
fSL,j = exp


l
X
k>j
c
X
i
−kb,i · LAIall
i,k

· exp
 c
X
i
−kb,j · 0.5 · LAIall
i,j
!
(9.6)

9.1. SHORT-WAVE RADIATION
103
where it is assumed that only half the leaf area of layer j contributes self-shading. Note that since kb depends
on the time of the day, also fSLj may be different depending on the solar hour. From fraction fSL,j we can
derive the (expanded) leaf area of each layer that is affected by direct light beams (i.e. the amount of sunlit
and shade leaves):
LAIsunlit
i,j
=
fSL,j · LAIϕ
i,j
(9.7)
LAIshade
i,j
=
(1 −fSL,j) · LAIϕ
i,j
(9.8)
As an example we will consider a canopy of one species of LAI = 2, divided into ten layers with constant
leaf density:
LAI = 2
nlayer = 10
LAIlayerlive = matrix(rep(LAI/nlayer,nlayer),nlayer,1)
LAIlayermax = matrix(rep(LAI/nlayer,nlayer),nlayer,1)
LAIlayerdead = matrix(0,nlayer,1)
We will also define the coefficients of diffuse extinction, leaf absorbance and leaf reflection for PAR and
SWR:
alpha_PAR <- 0.9
alpha_SWR <- 0.7
gamma_PAR <- 0.04
gamma_SWR <- 0.05
clumping <- 0.75
These definitions, and that of direct extinction coefficient, lead to a percentage of the above-canopy irradiance
reaching each layer (Anten & Bastiaans 2016). Extinction of direct radiation also defines the proportion of
leaves of each layer that are affected by sunflecks (i.e. the proportion of sunlit leaves). Both outcomes are
illustrated in the figure below:
9.1.3
Short-wave radiation absorbed by canopy elements
The amount of absorbed diffuse radiation per leaf area unit of cohort i within a given canopy layer j is
calculated as:
Φdif,i,j = Idif,j · kd,i · α0.5
i
exp
" c
X
h
−kd,h · α0.5
i
· 0.5 · LAIall
h,j
#
(9.9)
The amount of absorbed scattered beam radiation per leaf area unit of cohort i within a given canopy layer
j is calculated as:
Φsca,i,j
=
Ib,j · kb,j · (A −B)
(9.10)
A
=
α0.5
i
· exp
 c
X
h
−kb,i · αi · 0.5 · LAIall
h,i
!
(9.11)
B
=
αi
(1 −γi) · exp
 c
X
h
−kb,i · 0.5 · LAIall
h,i
!
(9.12)
Finally, the direct radiation absorbed by a unit of sunlit leaf area of cohort i in a canopy layer j does not
depend on the position of the canopy layer and is:
Φdir,i,j = Ibeam · αi · kb,i
(9.13)

104
CHAPTER 9. RADIATION TRANSFER
0
20
40
60
80
100
2
4
6
8
10
Percentage of irradiance
Layer
direct PAR
direct SWR
0
20
40
60
80
100
2
4
6
8
10
Percentage of leaves
Layer
sunlit
shade
Figure 9.1:
The left panel shows irradiance per layer of diffuse and direct PAR and SWR assuming
a LAI of 2 equally distributed among layers (see function light_layerIrradianceFraction()).
The
right panel shows the corresponding proportions of sunlit and shade leaves in each layer (see function
light_layerSunlitFraction()).
Once these components are known, the amount of light absorbed by sunlit/shaded foliage of cohort i in layer
j per leaf area unit (Φsunlit
i,j
and Φshade
i,j
, respectively) is:
Φsunlit
i,j
=
Φdif,i,j + Φsca,i,j + Φdir,i,j
(9.14)
Φshade
i,j
=
Φdif,i,j + Φsca,i,j
(9.15)
Let us show how all this works in an example. Regarding incoming light, we assume the following direct and
diffuse irradiance at the top of the canopy:
solarElevation = 0.67
SWR_direct = 1100
SWR_diffuse = 300
PAR_direct = 550
PAR_diffuse = 150
Solar elevation is the angle between the sun and the horizon (i.e. the complement of the zenith angle). Under
these conditions, and for the same canopy used for fig. 9.1, the amount of PAR and SWR absorbed per unit
of leaf area at each canopy layer is (Anten & Bastiaans 2016):
ZF <- c(0.178, 0.514, 0.308) ##Standard overcast sky
Zangles <- c(15.0, 45.0, 75.0);
KDIFF <- matrix(NA, 3, 1);
for(k in 1:3){
KDIFF[k,1] <- light_directionalExtinctionCoefficient(beta["p"], beta["q"], Zangles[k]*(pi/180.0));
}
KDIFF
##
[,1]

9.1. SHORT-WAVE RADIATION
105
## [1,] 1.9888914
## [2,] 0.6926432
## [3,] 0.4853480
0
100
200
300
400
500
2
4
6
8
10
Absorbed PAR per leaf area (W/m2)
Layer
sunlit
shade
0
200
400
600
800
2
4
6
8
10
Absorbed SWR per leaf area (W/m2)
Layer
sunlit
shade
Figure 9.2: PAR (left) and SWR (right) absorbed per unit of sunlit/shade leaf area at each canopy layer
(Isunlit
i,j
and Ishade
i,j
, respectively;see function light_cohortSunlitShadeAbsorbedRadiation()).
The SWR absorbed per ground area unit by sunlit and shade foliage of cohort i in canopy layer j is:
Ksunlit
abs,i,j
=
Φsunlit
i,j
· LAIsunlit
i,j
(9.16)
Kshade
abs,i,j
=
Φshade
i,j
· LAIshade
i,j
(9.17)
The previous quantities can be aggregated across cohorts or layers. The SWR absorbed per ground area
unit by cohort i (Kabs,i) is found using:
Kabs,i =
l
X
j
Ksunlit
abs,i,j + Kshade
abs,i,j = Ksunlit
abs,i
+ Kshade
abs,i
(9.18)
where Ksunlit
abs,i
and Kshade
abs,i
are the SWR absorbed per ground area unit by sunlit and shade foliage, respec-
tively, of cohort i. Similarly, the SWR absorbed by canopy layer j (Kabs,j) is found using:
Kabs,j =
c
X
i
Ksunlit
abs,i,j + Kshade
abs,i,j
(9.19)
and the SWR absorbed by the whole canopy (Kabs,ca) is:
Kabs,ca =
l
X
j
Kabs,j =
c
X
i
Kabs,i =
c
X
i
l
X
j
Ksunlit
abs,i,j + Kshade
abs,i,j
(9.20)

106
CHAPTER 9. RADIATION TRANSFER
9.1.4
Short-wave radiation absorbed by the soil
The instantaneous shortwave radiation reaching the soil is calculated separately for direct beam and diffuse
radiation:
Ibeam,soil
=
Ibeam · exp


l
X
h=j+1
c
X
i
−kb,i · α0.5
i
· LAIall
i,h


(9.21)
Idif,soil
=
Idif · exp


l
X
h=j+1
c
X
i
−kd,i · LAIall
i,h


(9.22)
where Ibeam and Idif are the direct and diffuse irrradiance at the top of the canopy, kb,i is the extinction
coefficient of cohort i for direct light and kd,i is the extinction coefficient of cohort i for diffuse SWR. From
these, the SWR absorbed by the soil (Kabs,soil) is found by:
Kabs,soil = (1 −γSW R,soil) · (Ibeam,soil + Idif,soil)
(9.23)
where γSW R,soil = 0.10 is the SWR reflectance (10% albedo) of the soil.
9.2
Long-wave radiation
Long-wave radiation (LWR) transfer within the canopy is based on the SHAW model (Flerchinger et al.
2009).
9.2.1
Long-wave radiation balance by canopy layers
Assume canopy layers are ordered from j = 1 (in contact with the soil) to j = l (in contact with the
atmosphere above the boundary layer). The procedure first calculates downward LWR below each canopy
layer, Ldown,j, from j = l to j = 1. The downward LWR below layer j is calculated as:
Ldown,j = τj · Ldown,j+1 + (1 −τj) · ϵcan · σ · (Tair,j + 273.16)4
(9.24)
where Ldown,j+1 is the downward LWR of the layer above (Latm in the case of j = l), Tair,j is the air
temperature of layer j, τj is the diffuse transmissivity of layer j, σ = 5.67 · 10−8 W · K−4 · m−2 is the
Stephan-Boltzmann constant and ϵcan = 0.97 is the canopy emmissivity. Diffuse transmissivity values are
defined by cohort i and layer j using:
τi,j = exp (−kLW R · LAIall
i,j )
(9.25)
where kLW R = 0.7815 is the extinction coefficient for LWR. The transmissivity of layer j is simply τj =
Pc
i τi,j. Once we know Ldown,1 we can calculate the upwards LWR from the soil (Lup,s) using:
Lup,soil = (1 −ϵsoil) · Ldown,1 + ϵsoil · σ · (Tsoil,1 + 273.16)4
(9.26)
where Tsoil,1 is the temperature of the topmost soil layer and ϵsoil = 0.97 is the soil emmissivity. Now we
calculate upward LWR from j = 1 to j = J:
Lup,j = τj · Lup,j−1 + (1 −τj) · ϵcan · σ · (Tair,j + 273.16)4
(9.27)
where Lup,j−1 is the downward LWR of the layer below (Lup,soil in the case of j = 1).
Once we have
downward and upward LWR fluxes, we can estimate the net LWR absorbed within canopy layer j using:
Lnet,j = ϵcan · (1 −τj) · (Ldown,j + Lup,j −σ · (Tair,j + 273.16)4)
(9.28)

9.2. LONG-WAVE RADIATION
107
9.2.2
Net long-wave radiation of the whole canopy and the soil
Net LWR can be aggregated at the scale of the whole canopy. The net LWR of the whole canopy (Lnet,can)
is simply the sum across layers of net LWR:
Lnet,can =
l
X
j
Lnet,j
(9.29)
whereas the net LWR of the soil (Lnet,soil) is:
Lnet,soil = ϵsoil · (Ldown,1 −σ · (Tsoil,1 + 273.16)4)
(9.30)
9.2.3
Long-wave radiation balance by plant cohorts
The net LWR per leaf area unit absorbed within canopy layer j can also be decomposed among plant cohorts.
The net LWR of cohort i in layer j is found using the relative proportion of light absorbed by the cohort
(i.e. the complement of its diffuse transmissivity):
Lnet,i,j = Lnet,j ·
1 −τi,j
P
h 1 −τh,j
(9.31)
from which we can estimate Lsunlit
net,i
and Lshade
net,i , the average net LWR per leaf area unit for sunlit and shade
leaves of cohort i, respectively:
Lsunlit
net,i
=
Pl
j Lnet,i,j · LAIsunlit
i,j
Pl
j LAIsunlit
i,j
Lshade
net,i =
Pl
j Lnet,i,j · LAIshade
i,j
Pl
j LAIshade
i,j
(9.32)

108
CHAPTER 9. RADIATION TRANSFER

Chapter 10
Plant hydraulics
We devote this chapter to describe the background necessary to understand how plant hydraulics is
implemented in the advanced water balance model of medfate.
Section 10.1 introduces the hydraulic
networks from which to choose, depending on the sub-model of plant hydraulics employed (i.e. either
transpirationMode = "Sperry" or transpirationMode = "Sureau").
After that, in sections 10.2 and
10.3 we present the building blocks of models of plant hydraulics, i.e. how to represent in a model the water
content of plant tissues and the water flow through vascular elements. In section 10.4 we describe in detail
the plant hydraulic sub-model presented in De Cáceres et al. (2021) (without water compartments), and in
10.5 we describe the sub-model of plant hydraulics that was presented in Ruffault et al. (2022) and was
added to medfate.
10.1
Hydraulic architecture
The hydraulic architecture of a model describes the set of water compartments and resistances to water
flow that are explicitly considered, often implying a simplification and discretization of real plant hydraulic
pathways.
The advanced water balance model of medfate implements different hydraulic architectures
depending on the transpiration sub-model:
• If transpirationMode = "Sperry", the hydraulic network is described using (S ×2+1+1) resistance
elements, with soil being represented in S different soil layers. For each soil layer there is a rhizosphere
element in series with a root xylem element. The S soil layers are in parallel up to the root crown.
From there there is one stem xylem segment and a final leaf xylem segment in series (Fig. 10.1). When
considered (via control parameter stemCavitationEffects), stem cavitation affects the resistance
between the root crown (Ψrootcrown) and the stem (Ψstem). Similarly, when considered (via control
parameter leafCavitationEffects) leaf cavitation affects the resistance between the stem (Ψstem)
and the leaf (Ψleaf)
• If transpirationMode = "Sureau", the soil–plant system in SurEau-ECOS (Ruffault et al. 2022) is
discretized into three soil layers and two plant compartments (Fig. 10.2): a leaf and a stem. Each of
the two plant organs contains an apoplasm and a symplasm. The stem apoplasm and symplasm include
water volumes of all non-leaf compartments, i.e., trunk, root and branches. Symplasmic capacitances
(i.e. CLSym and CSSym) mostly buffer water fluxes during well-watered conditions, whereas apoplasm
capacitances (i.e. CLApo and CSApo) come into play when cavitation occurs. Water can leaf the plant
via three flows, through stomata (Estom), leaf cuticules (Ecuti,leaf) and stem cuticules (Ecuti,stem).
The architecture is completed with nodes for the fine root surface of each soil layer (Ψrootsurf) and for
109

110
CHAPTER 10. PLANT HYDRAULICS
Soil layer 1
Soil layer 2
Soil layer S
Stem
Roots
Rhizosphere
rootsurf, 1
rootsurf, 2
rootsurf, S
rootcrown
soil, 1
soil, 2
soil, S
Leaf
…
…
E
stem, 2
stem, 1
leaf
Figure 10.1: Schematic representation of hydraulics in a whole-plant network
the root crown (Ψrootcrown), but these elements do not correspond to water compartments. Stem cav-
itation affects the conductances of the pathways between root surfaces (Ψrootsurf) and the root crown
(Ψrootcrown), as well as the conductance between the root crown and the stem apoplasm (Ψstem,apo).
Leaf cavitation affects the conductance between the stem apoplasm (Ψstem,apo) and the leaf apoplasms
(Ψleaf,apo).
The two architectures share as common elements the nodes corresponding to bulk soil (Ψsoil) and root
surface (Ψrootsurf) for each soil layer, as well as the water potential at the root crown (Ψrootcrown). Since
the architecture of transpirationModel = "Sperry" considers plant xylem elements only, the stem water
potential (Ψstem) can be considered analogous to the apoplasmic stem water potential of Sureau-ECOS
(Ψstem,apo). Similarly its leaf water potential (Ψleaf) can be considered equivalent to the apoplasmic stem
water potential of Sureau-ECOS (Ψleaf,apo). Symplasmic compartments of Sureau-ECOS do not have equiv-
alents in the Sperry architecture, but the water potential of symplasmic compartments can be assumed to
be equal to those of their corresponding apoplasmic compartments. Important differences between the two
architectures include the additional consideration of (i) plant capacitance effects, (ii) cavitation flows and
(iii) cuticular transpiration flows that are only available in Sureau-ECOS (Fig. 10.1). The two models also
differ in how stomatal regulation, water flows and water potentials are solved. These differences are described
in the following sub-sections as well as in chapter 12.
10.2
Vulnerability curves
Vulnerability curves form the basis of hydraulic calculations. Let us use k to denote hydraulic conductance,
i.e. instantaneous flow rate per leaf surface unit and per pressure drop (in mmol · s−1 · m−2 · MPa−1).
Each element of the hydraulic network has a vulnerability curve k(Ψ) that starts at maximum hydraulic
conductance (kmax = k(0)) and declines as water pressure (Ψ) becomes more negative.

10.2. VULNERABILITY CURVES
111
Figure 10.2: Schematic representation of hydraulics in a network with water storage compartments according
to the design of SurEau-ECOS

112
CHAPTER 10. PLANT HYDRAULICS
10.2.1
Xylem vulnerability curves
Xylem vulnerability curves are modelled using different functions, depending on the transpiration sub-model.
10.2.1.1
Weibull vulnerability curves
When transpirationMode = "Sperry", xylem tissues are assigned a two-parameter Weibull function as
the vulnerability curve k(Ψ):
k(Ψ) = kmax · e−((Ψ/d)c)
(10.1)
where kmax is the maximum hydraulic conductance, and c and d are species-specific and tissue-specific
parameters. Note that parameter d is the water potential (in MPa) at which k(Ψ)/kmax = e−1 = 0.367,
i.e. the water potential at which hydraulic conductance is 36.7% of its maximum value. Parameter c controls
the shape of the vulnerability curve (exponential shape with no threshold has c ≤1; and sigmoidal shape
with threshold occurs when c > 1).
The concept of vulnerability curve can be used to specify the relationship between pressure and conductance
in any portion of the flow path. For example, we define the following parameter values for a stem xylem
(kstem,max and parameters cstem and dstem of the vulnerability curve):
kstemmax = 5.0 # mmol·m-2·s-1·MPa-1
stemc = 3
stemd = -3.0 # MPa
For root xylem (kroot,max), we may assume a higher conductance (i.e. higher efficiency) but also higher
vulnerability to cavitation (defined by parameters croot and droot):
krootmax = 6.6 # mmol·m-2·s-1·MPa-1
rootc = 2
rootd = -2.5 #MPa
For leaf xylem kleaf(Ψ), we may specify higher conductance than in stems but also higher vulnerability:
kleafmax = 10
leafc = 2
leafd = -2
With these parameter values, the vulnerability curves for root, stem and leaf are (see hydraulics_xylemConductance()
and hydraulics_vulnerabilityCurvePlot()):
The dash-dot line between 0 and Ψcav = −2.5 MPa indicates the modification of the stem xylem vulnerability
curve when cavitation has occurred (i.e., previous embolism limits the maximum conductance value), as
indicated in Sperry et al. (2017). The corresponding proportion of stem conductance loss (PLCstem) can
be found using the stem vulnerability curve. Similarly, PLCleaf can limit conductance in leaves. Although
root xylem are more vulnerable to the formation of emboli for a given potential, it is generally accepted that
the less negative potentials of root xylem compared to the stem lead to cavitation occurring more often in
the stem. The constrain created by cavitation has an effect on the calculation of the flow rates and derived
quantities (see below).
10.2.1.2
Sigmoid vulnerability curves
When transpirationMode = "Sureau", xylem tissues are assigned a two-parameter sigmoid function as
the vulnerability curve k(Ψ):
k(Ψ) =
kmax
1 + e(slope/25)·(Ψ−Ψ50)
(10.2)

10.2. VULNERABILITY CURVES
113
0
1
2
3
4
5
6
7
0
2
4
6
8
10
Canopy pressure (−MPa)
Xylem K (mmol·m−2·s−1·MPa−1)
leaf
stem xylem (original)
stem xylem (cavitated)
root xylem
Figure 10.3: Example vulnerability curves corresponding to the parameters defined above for stem, root and
leaf segments.

114
CHAPTER 10. PLANT HYDRAULICS
where Ψ50 is the water potential corresponding to 50% of conductance, and slope is the slope of the curve in
percent at that point. The two parameters need to be specified for each plant segment under consideration,
analogously to the Weibull functions.
10.2.2
Rhizosphere vulnerability curve
The rhizosphere conductance function krhizo(Ψ) is modelled as a van Genuchten function (Genuchten 1980)
(this choice is the reason why the water retention curve also needs to be modelled with van Genuchten):
krhizo(Ψ)
=
krhizo,max · v(n−1)/(2·n) · ((1 −v)(n−1)/n −1)2
(10.3)
v
=
[(αΨ)n + 1]−1
(10.4)
where krhizo,max is the maximum rhizosphere conductance, and n and α are texture-specific parameters
(Carsel & Parrish 1988; Leij et al. 1996). These are automatically set by function soil() when initializing
soil objects (see section 2.3.3), but we can use function soil_vanGenuchtenParamsCarsel() to derive them
from texture types:
textures = c("Sandy loam","Silt loam", "Clay")
#Textural parameters
#Sandy clay loam
p1 = soil_vanGenuchtenParamsCarsel(textures[1])
p1
##
alpha
n theta_res theta_sat
Ks
##
764.983
1.890
0.065
0.410 69513.524
alpha1 = p1[1]
n1 = p1[2]
#Silt loam
p2 = soil_vanGenuchtenParamsCarsel(textures[2])
p2
##
alpha
n theta_res theta_sat
Ks
##
203.9955
1.4100
0.0670
0.4500 7077.1687
alpha2 =
p2[1]
n2 = p2[2]
#Silty clay
p3 = soil_vanGenuchtenParamsCarsel(textures[3])
p3
##
alpha
n
theta_res
theta_sat
Ks
##
81.59819
1.09000
0.06800
0.38000 3145.40832
alpha3 =
p3[1]
n3 = p3[2]
We can estimate maximum rhizosphere conductance values assuming that they account for an average per-
centage of the resistance (e.g. 15%) across the continuum (see functions hydraulics_averageRhizosphereResistancePercent
and hydraulics_findRhizosphereMaximumConductance()):

10.3. WATER CONTENT OF PLANT TISSUES
115
percentResistance = 15
#Sandy clay loam
krmax1 =hydraulics_findRhizosphereMaximumConductance(percentResistance,
n1,alpha1, krootmax, rootc,rootd, kstemmax, stemc, stemd,
kleafmax, leafc, leafd)
krmax1
## [1] 7.375648e+14
#Silt loam
krmax2 =hydraulics_findRhizosphereMaximumConductance(percentResistance,
n2,alpha2, krootmax, rootc,rootd, kstemmax, stemc, stemd,
kleafmax, leafc, leafd)
krmax2
## [1] 3420747735
#Silty clay
krmax3 =hydraulics_findRhizosphereMaximumConductance(percentResistance,
n3,alpha3, krootmax, rootc,rootd, kstemmax, stemc, stemd,
kleafmax, leafc, leafd)
krmax3
## [1] 36831905
With
these
parameters,
the
resulting
krhizo(Ψ)
functions
can
be
displayed
using
the
function
hydraulics_vanGenuchtenConductance():
10.2.3
Xylem sap viscosity
The ease of water flow (i.e. hydraulic conductance or resistance) is dependent on water viscosity, which
fluctuates as a function of temperature and dissolved substances. Xylem sap can be considered to have
negligible amounts of solutes, but temperature is still rellevant factor of viscosity. The dynamic viscosity of
water Vw varies with temperature (relative to its viscosity at 20ºC) according to the Vogel equation:
Vw(T) = exp

−3.7188 +
578.919
−137.546 + T

(10.5)
where T is the temperature of the medium in Kelvin. Temperature of segments (roots, stem, leaves) is used
to correct maximum conductances simply as follows:
kmax,T = kmax
Vw(T)
(10.6)
where kmax is the maximum conductance describing the vulnerability curve, assumed to be determined at
20ºC.
10.3
Water content of plant tissues
Following Martin-StPaul et al. (2017), we consider two kind of tissues in (leaf and stem) plant segments
(Tyree & Yang 1990). The first are conduits (tracheids or vessels), which will release water due to cavitation
and may be refilled with water from adjacent living tissue or upstream segments. The second source of water
is formed by more elastic living cells (i.e. parenchyma) and can potentially be a large source of water. This
source can be described using the relative water content of a symplasmic tissue.

116
CHAPTER 10. PLANT HYDRAULICS
0
1
2
3
4
5
6
7
0
20
40
60
80
100
Soil hydraulic pressure (−MPa)
Rhizosphere K (mmol·m−2·s−1·MPa−1)
Sandy loam
Silt loam
Clay
Figure 10.4: Example rhizosphere vulnerability curves (i.e. Van Genuchten functions) for three different soil
textures.
10.3.1
Relative water content of symplasmic tissues
A pressure-volume curve of a tissue relates its water potential against its relative water content (RWC;
kg H2O · kg−1 H2O at saturation). Pressure-volume theory is usually applied to leaf tissues (Bartlett et al.
2012), but it can also be applied to other tissues such as sapwood or cambium cells.
For living cells, the relationship between Ψ and RWC of the symplasmic fraction (RWCsym) is achieved by
separating Ψ into osmotic (solute) potential (ΨS) and the turgor potential (ΨP ):
Ψ = ΨS + ΨP
(10.7)
The relationship for ΨP is:
ΨP = −π0 −ϵ · (1.0 −RWCsym)
(10.8)
where π0 (MPa) is the osmotic potential at full turgor (i.e. when RWCsym = 1), and ϵ is the modulus of
elasticity (i.e. the slope of the relationship). Assuming constant solute content, the relationship for ΨS is:
ΨS =
−π0
RWCsym
(10.9)
When Ψ ≤Ψtlp, the water potential at turgor loss point, then ΨP = 0 and Ψ = ΨS. If Ψ > Ψtlp then the
two components are needed. The water potential at turgor loss point (Ψtlp) can be found by (Bartlett et al.
2012):
Ψtlp = π0 · ϵ
π0 + ϵ
(10.10)
As an example, the following figure draws the pressure-volume curve for a tissue with ϵ = 12 and π0 =
−3.0MPa:

10.3. WATER CONTENT OF PLANT TISSUES
117
−10
−8
−6
−4
−2
0
0.3
0.5
0.7
0.9
Water potential (MPa)
Symplasmic RWC
To calculate RWCsym from the water potential of a tissue, the previous equations need to be combined and,
after isolating RWCsym, a quadratic relationship is obtained (Martin-StPaul et al. 2017).
10.3.2
Relative water content of apoplastic tissues
In medfate it is assumed that apoplastic water fraction of an organ corresponds to the water in its xylem
conduits. Xylem conduits consist of inelastic cells that have very small changes of water volume in relation
to changes in water potential.
However, xylem conduits release their water to the transpiration stream
following the formation of emboli. As in Hölttä et al. (2009), we equate the relative water content of the
apoplastic reservoir of a segment (leaves or stem) to the proportion of conductance lost (relative to the
maximum conductance) for a given water potential (see (10.1)):
RWCapo(Ψapo) = k(Ψapo)
kmax
= e−((Ψapo/d)c)
(10.11)
Hence we assume that the relationship between Ψapo and the relative water content follows the same function
as the relationship between Ψapo and the proportion of conductance loss (i.e. the hydraulic vulnerability
curve, see (ref?)(vulnerabilitycurves)).

118
CHAPTER 10. PLANT HYDRAULICS
−7
−6
−5
−4
−3
−2
−1
0
0.0
0.2
0.4
0.6
0.8
1.0
Water potential (MPa)
Apoplastic RWC
10.3.3
Average relative water content of a compartment
The average relative water content in a given segment or organ (RWC) can be obtained by calculating
RWCapo and RWCsym followed by assuming a constant apoplastic fraction fapo:
RWC = RWCapo · fapo + RWCsym · (1 −fapo)
(10.12)
Normally the apoplastic fraction is large (~80%) in the stem and small (~15%) in leaves. Hence, the relative
water content in stems will be mostly dictated by the level of cavitation, whereas that of leaves will mostly
follow leaf symplastic water potential and the symplastic pressure-volume curve.
10.3.4
Live fuel moisture content
Given an average relative water content (RWC) of a plant organ, its live fuel moisture content (LFMC in
gH2O · g−1 of dry tissue) can be calculated using:
LFMC = RWC · Θ · ρH2O
ρ
= RWC · LFMCmax
(10.13)
where Θ is the tissue porosity (cm3 of water per cm3 of tissue), ρ is the density of the tissue and ρH2O
is the density of water. In practice estimates of maximum fuel moisture content LFMCmax are easier to
obtain than porosity estimates, so it is more straightforward to estimate LFMC as the product of RWC
and LFMCmax.
In medfate, LFMC estimates are assumed to correspond to fine fuels (i.e. leaves and twigs of < 6.5 mm)
and are estimated from stem and leaf water content:
LFMC = (RWCleaf · (1.0/r6.35) + RWCstem · (1.0 −(1.0/r6.35))) · LFMCmax
(10.14)
where r6.35 is the ratio between the weight of leaves plus branches and the weight of leaves alone for branches
of 6.35 mm; RWCleaf is the relative water content of in leaves and RWCstem is the relative water content
of in stem, respectively (already averaging symplasmic and apoplasmic tissues).

10.4. SPERRY’S SUB-MODEL OF PLANT HYDRAULICS
119
10.4
Sperry’s sub-model of plant hydraulics
The supply-loss theory of plant hydraulics, presented by Sperry & Love (2015) and used in Sperry et al.
(2017), uses the physics of flow through soil and xylem to quantify how steady-state canopy water supply
declines with drought and ceases by hydraulic failure. The theory builds on the hydraulic model of Sperry
et al. (1998) and can be applied to different segmentations of the soil-plant continuum.
The supply function describes the steady-state rate of water supply (i.e. flow) for transpiration (E) as a
function of water potential drop. The steady-state flow rate Ei through any i element of the continuum
is related to the flow-induced drop in pressure across that element (∆Ψi = Ψdown −Ψup) by the integral
transform of the element’s vulnerability curve ki(Ψ) (Sperry & Love 2015):
Ei =
Z Ψdown
Ψup
ki(Ψ)dΨ
(10.15)
where Ψup and Ψdown are the upstream and downstream water potential values, respectively. The integral
transform assumes infinite discretization of the flow path.
The supply function can be defined for individual elements of the continuum or for the whole soil-plant
continuum using different hydraulic networks.
Supply functions are used in the Sperry’s sub-model to
determine photosynthesis, stomatal conductance and transpiration (see chapters 11 and 12).
In the following subsections we illustrate the supply function for different cases.
10.4.1
Supply function for a single xylem element
In the case of a single xylem element, the supply function describes the steady-state flow rate as a function
of pressure at the stem top (Ψcanopy). It can be calculated by numerical integration or aproximated using
an incomplete gamma function. The shape of the supply function starting at different root crown water
potential values (Ψrootcrown) is (see function hydraulics_EXylem()):
0
1
2
3
4
5
6
7
0
2
4
6
8
10
12
original
Canopy pressure (−MPa)
Xylem flow rate (mmol·m−2·s−1)
0
1
2
3
4
5
6
7
0
2
4
6
8
10
12
after cavitation
Canopy pressure (−MPa)
Xylem flow rate (mmol·m−2·s−1)
Figure 10.5: Supply function of a single xylem element starting at different root crown water potential
values. Left pane shows the uncavitated supply functions and right pane shows the supply functions that are
obtained in the case of a cavitated xylem (i.e. without refilling), assuming that the minimum water potential
experienced so far was -2.5 MPa. Note the linear part of the flow rate between Ψrootcrown and this limit.
The supply function of a rhizosphere element relates the steady-state flow rate to the pressure inside the
roots (Ψroot). It is calculated by numerical integration of the van Genuchten function, for which we use

120
CHAPTER 10. PLANT HYDRAULICS
the analytical approximation of Van Lier et al. (2009) (see function hydraulics_EVanGenuchten()). In
the figure below, we draw examples of the supply function for the rhizosphere. The nearly vertical lines
indicate that for many values of Ei the corresponding drop in water potential through the rhizosphere will
be negligible.
Only for increasingly negative soil water potential values the decrease in water potential
through the rhizosphere becomes relevant. Both in the case of a xylem element or a rhyzosphere element
the derivative dEi/dΨ of the supply function is equal to the corresponding vulnerability curve.
0
1
2
3
4
5
6
7
0.0
0.5
1.0
1.5
2.0
Root pressure (−MPa)
Rhizosphere flow rate (mmol·m−2·s−1)
Sandy loam
Silt loam
Clay
Figure 10.6: Supply functions of the rhizosphere starting at the four different values of bulk soil pressure
(Ψsoil) and for the same three texture types used for vulnerability curves.
10.4.2
Supply function of two elements in series
Let us describe the soil-plant continuum is represented using two elements in series (rhizosphere + stem
xylem).
In this case, the supply function has to be calculated by using the previous supply functions
sequentially. The Ei is identical for each element and equal to the canopy E. Since Ψsoil is known, one first
inverts the supply function of the rhizosphere to find Ψroot (see function hydraulics_E2psiVanGenuchten())
and then inverts the supply function of the xylem to find Ψcanopy (see function hydraulics_E2psiXylem()).
The two operations can be summarized in a single supply function describing the potential rate of water
supply for transpiration (E) as function of the canopy xylem pressure (Ψcanopy), starting from different bulk
soil (Ψsoil) values (see function hydraulics_supplyFunctionTwoElements()):
The supply function for the whole continuum contains much information. The Ψ intercept at E = 0 represents
the (predawn) canopy sap pressure which integrates the rooted soil moisture profile. As E increments from
zero, the disproportionately greater drop in Ψcanopy results from the loss of conductance. As the soil dries
the differences in flow due to soil texture become more apparent.
The derivative of the whole continuum supply function, dE/dΨ, is not equal to either of the vulnerability
curves and it has to be obtained numerically. The derivative functions corresponding to the supply functions
shown in the previous figure are:

10.4. SPERRY’S SUB-MODEL OF PLANT HYDRAULICS
121
0
1
2
3
4
5
6
7
0
2
4
6
8
10
12
original
Canopy pressure (−MPa)
Flow rate (mmol·m−2·s−1)
Sandy loam
Silt loam
Clay
0
1
2
3
4
5
6
7
0
2
4
6
8
10
12
after cavitation
Canopy pressure (−MPa)
Flow rate (mmol·m−2·s−1)
Sandy loam
Silt loam
Clay
Figure 10.7: Example of two-element supply functions describing the potential rate of water supply for
transpiration (E) as function of the canopy xylem pressure (Ψcanopy), starting from different bulk soil (Ψsoil)
values and for different soil textures. Left/right panel shows uncavitated/cavitated supply functions.
0
1
2
3
4
5
6
7
0
1
2
3
4
5
original
Canopy pressure (−MPa)
dE/dP (mmol·m−2·s−1·MPa−1)
Sandy loam
Silt loam
Clay
0
1
2
3
4
5
6
7
0
1
2
3
4
5
after cavitation
Canopy pressure (−MPa)
dE/dP (mmol·m−2·s−1·MPa−1)
Sandy loam
Silt loam
Clay
Figure 10.8: Derivatives of two-element supply functions corresponding to figure 10.7. Left/right panel shows
the derivatives of uncavitated/cavitated supply functions.

122
CHAPTER 10. PLANT HYDRAULICS
The derivative dE/dΨcanopy is the conductance if the entire continuum was exposed to Ψcanopy (Sperry &
Love 2015). It corresponds to the local loss of hydraulic conductance at the downstream end of the flow
path. It falls towards zero for asymptotic critical values (Ecrit). For a cavitated system dE/dΨcanopy can
be rather flat, in accordance with the close to linear part of the supply function.
10.4.3
Supply function of three elements in series
If the soil-plant continuum is represented using three elements in series (rhizosphere + stem xylem + leaf),
the resulting overall conductance and resistance fractions (under wet conditions) are:
rstemmin = 1/kstemmax
rleafmin = 1/kleafmax
#Percentages of minimum resistance
rvec = c(rstemmin,rleafmin)
100*rvec/sum(rvec)
## [1] 66.66667 33.33333
#Maximum overall conductance
1/sum(rvec)
## [1] 3.333333
As before, the supply function has to be calculated sequentially, knowing that Ei is identical through each
element. Since Ψsoil is known, one first inverts the supply function of the rhizosphere to find Ψroot and
then inverts the supply function of the xylem to find Ψstem. Finally, one inverts the supply function of the
leaf element to find Ψleaf. As before, the three operations can be summarized in a single supply function
describing the potential rate of water supply for transpiration (E) as function of the leaf pressure (Ψleaf),
starting from different bulk soil (Ψsoil) values (see function hydraulics_supplyFunctionThreeElements()):
Note that overall conductance and the maximum flow of the supply function are smaller in this case than
in the representation using two elements in series, because we added a new resistance (leaves). While the
rhizosphere component only adds a significant resistance when the soil dries, considering the leaf segment (or
a root xylem segment) substantially increases the overall resistance of the continuum. Higher vulnerability
of leaves also makes the curve to saturate for less negative soil water potentials. The derivative functions
corresponding to the supply functions shown in the previous figure are (note the highest value being equal
to the overall maximum conductance):
10.4.4
Supply function of a root system
So far we considered supply functions of elements in series, but resistance elements will be in parallel if the
soil is represented using S > 1 different layers. For each soil layer there is a rhizosphere element in series
with a root xylem element. The S soil layers are in parallel up to the root crown.
Network of S rhizosphere components and root layers in parallel there are S + 1 unknown pressures: the S
root surface pressures (Ψrootsurf,1, . . . , Ψrootsurf,S) and the root crown pressure at the downstream junction
for all root components (Ψrootcrown). The unknown pressures are solved, for each specified total flow value
E, using multidimensional Newton-Raphson on a set of equations for steady-state flow (Sperry et al. 2016):
Erhizo,s −Eroot,s
=
0
(10.16)
S
X
s=1
Eroot,s −E
=
0
(10.17)

10.4. SPERRY’S SUB-MODEL OF PLANT HYDRAULICS
123
0
1
2
3
4
5
6
7
0
1
2
3
4
5
6
original
Leaf pressure (−MPa)
Flow rate (mmol·m−2·s−1)
Sandy loam
Silt loam
Clay
0
1
2
3
4
5
6
7
0
1
2
3
4
5
6
after cavitation
Leaf pressure (−MPa)
Flow rate (mmol·m−2·s−1)
Sandy loam
Silt loam
Clay
Figure 10.9: Example of three-element supply functions describing the potential rate of water supply for
transpiration (E) as function of the leaf pressure (Ψleaf), starting from different bulk soil (Ψsoil) values and
for different soil textures. Left/right panel shows uncavitated/cavitated supply functions.
0
1
2
3
4
5
6
7
0.0
0.5
1.0
1.5
2.0
2.5
3.0
original
Leaf pressure (−MPa)
dE/dP (mmol·m−2·s−1·MPa−1)
Sandy loam
Silt loam
Clay
0
1
2
3
4
5
6
7
0.0
0.5
1.0
1.5
2.0
2.5
3.0
after cavitation
Leaf pressure (−MPa)
dE/dP (mmol·m−2·s−1·MPa−1)
Sandy loam
Silt loam
Clay
Figure 10.10: Derivatives of three-element supply functions corresponding to figure 10.9. Left/right panel
shows the derivatives of uncavitated/cavitated supply functions.

124
CHAPTER 10. PLANT HYDRAULICS
where Erhizo,s and Eroot,s are steady-state supply flows calculated using the integrals of either van Genuchten
or Weibull function as vulnerability curves, respectively. In the case of rhizosphere elements, Ψup = Ψsoil,s
and in the case of root elements Ψup = Ψrootsurf,s. Solving the steady-state equations also provides values
for flow across each of the parallel paths Erhizo,s = Eroot,s.
Soil layer 1
Soil layer 2
Soil layer S
Roots
Rhizosphere
rootsurf, 1
rootsurf, 2
rootsurf, S
rootcrown
soil, 1
soil, 2
soil, S
…
…
E
Figure 10.11: Schematic representation of hydraulics in a root network
As an example, we start by defining the water potential of three soil layers corresponding to four situations
(analogously with the soil water potentials defined above):
psiSoilLayers1 = c(-0.3,-0.2,-0.1)
psiSoilLayers2 = c(-1.3,-1.2,-1.1)
psiSoilLayers3 = c(-2.3,-2.2,-2.1)
psiSoilLayers4 = c(-3.3,-3.2,-3.1)
In a network of several soil layers, one has to divide the total rhizosphere and root xylem conductances
among layers. Let layer widths (ds) be:
d = c(300,700,3000) #Soil layer widths in mm
Now let FRP1, FRP2 and FRP3 be the proportion of fine root biomass in each soil layer (see section 2.4.7),
which can be calculated using:
Z50 = 200 #Parameter of LDR root distribution
Z95 = 1200 #Parameter of LDR root distribution
FRP = root_ldrDistribution(Z50, Z95, d)
FRP
##
[,1]
[,2]
[,3]
## [1,] 0.6652935 0.2749944 0.05971209

10.4. SPERRY’S SUB-MODEL OF PLANT HYDRAULICS
125
In the case of the rhizosphere conductances, we can simply define them (for each soil texture type) as:
krhizomaxvec1 = krmax1*FRP
krhizomaxvec2 = krmax2*FRP
krhizomaxvec3 = krmax3*FRP
To divide maximum root xylem conductance among soil layers we need weights inversely proportional to the
length of transport distances (Sperry et al. 2016). Vertical transport lengths can be calculated from soil
depths and radial spread can be calculated assuming cylinders with volume that has to be in accordance
with the xylem root conductance (TO BE DESCRIBED). The whole process can be done using functions
root_coarseRootSoilVolumeFromConductance() and root_coarseRootLengthsFromVolume():
rfc = c(20,50,70)
Vol = root_coarseRootSoilVolumeFromConductance(1.0, 2500,krootmax,
FRP,d, rfc)
lengths = root_coarseRootLengthsFromVolume(Vol, FRP, d, rfc)
lengths
## [1] 3621.093 2768.105 4513.795
weights = lengths/sum(lengths)
Transport weights are quite different than the fine root biomass proportions. This is because radial lengths
are largest for the first (top) layer and vertical lengths are largest for the third (bottom) layer. The root
xylem conductances are (in this case they do not depend on soil texture):
krootmaxvec = krootmax*weights
krootmaxvec
## [1] 2.191987 1.675640 2.732373
Having all these maximum conductances, we can now build the supply functions for each soil texture and
starting from the different soil water potential configurations (see function hydraulics_supplyFunctionBelowground()):
The derivative of dE/dΨrootcrown for the supply function of the root system is again obtained numerically.
Solving the previous system of equations provides the water potentials in different points of the root system.
Here we plot them for the results of silt loam texture and the first and last soil potential vectors defined
above:
Note that when soil is not dry (first situation) pressure drop in the rhizosphere is negligible, but not the
pressure drop in the root xylem. For drier soils rhizosphere becomes more relevant.
We can also plot the flow rates across each of the parallel paths (again corresponding to the results of silt
loam texture and for the four soil potential vectors):
Note that the contribution of each soil layer depends on the soil conditions and the total amount of flow.
For a low total flow rate some layers may have negative flows if their potential is lower than others, which
in a dynamic context will cause hydraulic redistribution of water among soil layers.
10.4.5
Supply function of the soil-plant continuum
As mentioned above, medfate uses a hydraulic network of (S × 2 + 2 + 1) resistance elements to represent
the soil-plant continuum, with soil being represented in S different layers. As before, the S soil layers are in

126
CHAPTER 10. PLANT HYDRAULICS
0
1
2
3
4
5
6
7
0
2
4
6
8
10
12
E
Root crown pressure (−MPa)
Flow rate  (mmol·m−2·s−1)
Sandy loam
Silt loam
Clay
0
1
2
3
4
5
6
7
0
1
2
3
4
5
6
dE/dP
Root crown pressure (−MPa)
dE/dP  (mmol·m−2·s−1·MPa−1)
Sandy loam
Silt loam
Clay
Figure 10.12: Example of supply function for a root system (left) and its derivative (right) under different
soil textures and starting from different soil water potential vectors.
parallel up to the root crown and each soil layer requires at least a rhizosphere and a root segment. From
the root crown there are two stem xylem elements in series and a final leaf element (Fig. 10.1).
To build the supply function for the whole hydraulic network, we proceed by calculating water potentials in
the network for each value of flow. For any given E value we start by calculating flows and potentials within
the root system. After that, the water potential at the mid of the stem (Ψstem,1) is obtained using the inverse
of the stem supply function and setting Ψup = Ψrootcrown, and the water potential at the upper end of the
stem, Ψstem,2, is obtained similarly but setting Ψup = Ψstem,1. In both cases the maximum conductance for
segments equal to 2 · kstem,max,i. Leaf water potential (Ψleaf) is finaly obtained using the inverse of the leaf
supply function and setting Ψup = Ψstem,2 and assuming a steady-state flow E. The whole supply function
E(Ψleaf) is obtained repeating these operations from E = 0 to a critical value Ecrit.
The following figure shows network supply functions for each soil texture and starting from the different soil
water potential configurations (see function hydraulics_supplyFunctionNetwork()):
As with previous representations of the soil-plant continuum, the derivative of dE/dΨleaf for the network
topology is obtained numerically:
As with the root system, we can know the water potentials in different points of the continuum. Here we
plot them for the results of silt loam texture and the first and last soil potential vectors defined above:
A supply function of the soil-plant hydraulic network defines a set steady-state flows and corresponding
water potentials given fixed values of soil moisture. Hence, supply functions need to be updated whenever
soil moisture is updated, i.e. once a day in the water balance model (see subsection 7.5). This frequency
should be enough in most cases, since soil water potentials change more slowly than plant water potentials.

10.4. SPERRY’S SUB-MODEL OF PLANT HYDRAULICS
127
0
2
4
6
8
10
12
0
1
2
3
4
5
Soil potentials 1 (original)
Total flow rate
Pressure (−MPa)
Root crown
Rhizo 1
Rhizo 2
Rhizo 3
0
1
2
3
0
1
2
3
4
5
Soil potentials 2 (original)
Total flow rate
Pressure (−MPa)
Root crown
Rhizo 1
Rhizo 2
Rhizo 3
0.0
0.2
0.4
0.6
0.8
1.0
0
1
2
3
4
5
Soil potentials 3 (original)
Total flow rate
Pressure (−MPa)
Root crown
Rhizo 1
Rhizo 2
Rhizo 3
0.00
0.05
0.10
0.15
0.20
0.25
0.30
0.35
0
1
2
3
4
5
Soil potentials 4 (original)
Total flow rate
Pressure (−MPa)
Root crown
Rhizo 1
Rhizo 2
Rhizo 3
Figure 10.13: Water potentials inside fine roots and at the root crown, for overall flow rates corresponding
to fig. 10.12.

128
CHAPTER 10. PLANT HYDRAULICS
0
1
2
3
4
−1
0
1
2
3
4
Soil potentials 1
Total flow rate
Path flow rate
Layer 1
Layer 2
Layer 3
0.0
0.5
1.0
1.5
2.0
−0.5
0.0
0.5
1.0
1.5
2.0
Soil potentials 2
Total flow rate
Path flow rate
Layer 1
Layer 2
Layer 3
0.0
0.1
0.2
0.3
0.4
−0.2
0.0
0.1
0.2
0.3
0.4
Soil potentials 3
Total flow rate
Path flow rate
Layer 1
Layer 2
Layer 3
0.00
0.01
0.02
0.03
0.04
0.05
−0.04
0.00
0.02
0.04
Soil potentials 4
Total flow rate
Path flow rate
Layer 1
Layer 2
Layer 3
Figure 10.14: Flow rates inside roots corresponding to each soil layer, for overall flow rates corresponding to
fig. 10.12.

10.4. SPERRY’S SUB-MODEL OF PLANT HYDRAULICS
129
0
1
2
3
4
5
6
7
0
1
2
3
4
original
Leaf pressure (−MPa)
Flow rate  (mmol·m−2·s−1)
Sandy loam
Silt loam
Clay
0
1
2
3
4
5
6
7
0
1
2
3
4
after cavitation
Leaf pressure (−MPa)
Flow rate  (mmol·m−2·s−1)
Sandy loam
Silt loam
Clay
Figure 10.15: Examples of supply functions for a hydraulic network describing the potential rate of water
supply for transpiration (E) as function of the leaf pressure (Ψleaf), starting from different bulk soil (Ψsoil)
values and for different soil textures. Left/right panel shows uncavitated/cavitated supply functions.
0
1
2
3
4
5
6
7
0.0
0.5
1.0
1.5
2.0
original
Leaf pressure (−MPa)
dE/dP  (mmol·m−2·s−1·MPa−1)
Sandy loam
Silt loam
Clay
0
1
2
3
4
5
6
7
0.0
0.5
1.0
1.5
2.0
after cavitation
Leaf pressure (−MPa)
dE/dP  (mmol·m−2·s−1·MPa−1)
Sandy loam
Silt loam
Clay
Figure 10.16: Derivatives of supply functions corresponding to figure 10.15.
Left/right panel shows the
derivatives of uncavitated/cavitated supply functions.

130
CHAPTER 10. PLANT HYDRAULICS
0
1
2
3
4
0
1
2
3
4
5
Soil potentials 1 (original)
Total flow rate
Pressure (−MPa)
Leaf
Stem
Root crown
Rhizo 1
Rhizo 2
Rhizo 3
0
1
2
3
4
0
1
2
3
4
5
Soil potentials 1 (cavitation)
Total flow rate
Pressure (−MPa)
Leaf
Stem
Root crown
Rhizo 1
Rhizo 2
Rhizo 3
0.00
0.02
0.04
0.06
0.08
0.10
0.12
0
1
2
3
4
5
Soil potentials 4 (original)
Total flow rate
Pressure (−MPa)
Leaf
Stem
Root crown
Rhizo 1
Rhizo 2
Rhizo 3
0.00
0.02
0.04
0.06
0.08
0.10
0.12
0
1
2
3
4
5
Soil potentials 4 (cavitation)
Total flow rate
Pressure (−MPa)
Leaf
Stem
Root crown
Rhizo 1
Rhizo 2
Rhizo 3
Figure 10.17:
Water potential in network elements corresponding to overall flow rates of figure 10.15.
Left/right panel shows the derivatives of uncavitated/cavitated supply functions.

10.5. SUREAU’S SUB-MODEL OF PLANT HYDRAULICS
131
10.5
Sureau’s sub-model of plant hydraulics
10.5.1
Constitutive equations
Water dynamics of the SPA system in SurEau-Ecos (Ruffault et al. 2022) are governed by partial differential
equations for water mass conservation.
The water balance of each of the four plant compartments (symplasm and apoplasm for leaf and stem,
respectively) is determined according to a generic equation. For a given plant compartment i, the water
balance differential equation is:
Ci · dΨi
dt +
X
j
kij · (Ψi −Ψj) −S = 0
(10.18)
and solved at each time step. In the above equation Ψi and Ψj would be the water potential of compartments
i and j, respectively (i.e. Ψleaf,symp, Ψleaf,apo, Ψstem,symp or Ψstem,apo; see Fig. 10.2); Ci is the capacitance
associated to the compartment i and defined generically as:
Ci = Qi
Ψi
(10.19)
where Qi is the water volume content of the compartment; kij is the conductance between the two com-
partments and S represents an outflow of the target compartment.
Flows in/out of compartments are
stem cuticular transpiration (Ecuti,stem), leaf cuticular transpiration (Ecuti,leaf), leaf stomatal transpiration
(Estom), stem cavitation flux (Fcav,stem) and leaf cavitation flux (Fcav,leaf).
10.5.2
Plant and soil conductances
Overall plant conductance kplant is defined as the sum of resistances across the hydraulic network Fig. 10.2:
kplant =
 
1
PS
s=1 kroot,s
+
1
kstem,apo
+
1
kleaf,apo
+
1
kleaf,symp
!−1
(10.20)
Whenever needed, for each soil layer s, the conductance from the root surface to the root crown is updated
using the current level of PLCstem:
kroot,s = kroot,max,s · (1.0 −PLCstem)
(10.21)
whereas the conductance from the root crown to the stem apoplasm is updated similarly:
kstem,apo = kstem,apo,max · (1.0 −PLCstem)
(10.22)
and the conductance from the stem apoplasm to the leaf apoplasm is updated using the current level of
PLCleaf:
kleaf,apo = kleaf,apo,max · (1.0 −PLCleaf)
(10.23)
Unlike plant conductances, which are updated at short time steps, the conductance in the bulk soil for each
soil layer (ksoil,s) is updated once per day, from Ψsoil,s and using Van Genuchten equations.
10.5.3
Plant capacitances
Symplasmic reservoirs behave as variable plant capacitances related to the pressure volume curve, which
corresponds to the water quantity (Q) changes in symplasmic cells, i.e.:
dQ/dt = C · (dΨ/dt)
(10.24)

132
CHAPTER 10. PLANT HYDRAULICS
from which we get an expression to update C:
C = dQ
dΨ = Qsat · dRWC
dΨ
(10.25)
where Qsat is the water volume of the compartment at saturation. From the former general equation, the
capacitance of the leaf symplasm (CLSym; in mmol · MPa−1 · m−2) is updated using the derivative of the
leaf symplasmic pressure-volume curve (RWCleaf
sym) with respect to Ψleaf,sym (Ruffault et al. 2022):
CLSym = Qsat
LSym · dRWCleaf
sym(Ψleaf,sym)
dΨleaf,sym
(10.26)
and the capacitance of the stem symplasm (CSSym; in mmol · MPa−1 · m−2) is updated analogously:
CSSym = Qsat
SSym · dRWCstem
sym (Ψstem,sym)
dΨstem,sym
(10.27)
Equations for derivatives of the relative water content are given in Ruffault et al. (2022).
10.5.4
Cavitation flows
SurEau-Ecos also considers the capacitance effect of xylem cavitation (Hölttä et al. 2009), i.e., the water
released to the streamflow when cavitation occurs (Ruffault et al. 2022). The non-cavitated part of the
xylem receives a water flux from the cavitated part and is then transferred to adjacent compartments. The
amount of water corresponding to a new cavitation event (Fcav) is derived from the quantity of water in the
apoplasm at saturation (Qsat
apo) and the temporal variations in PLC as follows:
Fcav = Qsat · max
dPLC
dt
, 0

(10.28)
This flux is linearized in temporal variations in Ψ in order to express this flux in the form of a Darcy’s law.
For that purpose an equivalent conductance kcav is introduced as follows:
Fcav
=
Qsat · max
dPLC
dΨ
· dΨ
dt , 0

(10.29)
≈
kcav · max(Ψcav −Ψ, 0)
(10.30)
where Ψcav is the minimum value of Ψ reached for the apoplasmic compartment, dPLC/dΨ is the derivative
of PLC with respect to Ψ and kcav is:
kcav = −Qsat · (dPLC/dΨ)
dt
(10.31)
The equation for dPLC/dΨ is given in Ruffault et al. (2022).
10.5.5
Transpiration flows
Stem cuticular transpiration (Ecuti,stem), leaf cuticular transpiration (Ecuti,leaf) and leaf stomatal transpi-
ration (Estom) are described in section 12.2.
10.5.6
Numerical scheme
Three numerical schemes were presented and compared in Ruffault et al. (2022) to solve the system of
differential equations, but only the semi-implicit solving approach has been implemented in medfate.

Chapter 11
Leaf/canopy photosynthesis
In chapter 10 we introduced the necessary concepts of steady-state plant hydraulics to define the hydraulic
supply function for the soil-plant continuum. The supply function specifies the flow rate, as per leaf area,
for values of leaf water potential and given a soil moisture status. In the first section of this chapter we
describe leaf photosynthesis functions, which define leaf gas exchange, photosynthesis and energy balance
for values of leaf water potential. This requires knowing wind, water vapor and temperature conditions of
the air surrounding leaves (section 13.1.3), the short-wave radiation absorbed by leaf elements (section 9.1.3)
and the leaf long-wave radiation balance (section 9.2). In the second section of this chapter we discuss how
to upscale photosynthesis values to the crown level.
11.1
Leaf energy balance, gas exchange and photosynthesis
The supply function specifies the transpiration flow rate E for values of leaf water potential Ψleaf. If we
know air temperature, water vapor pressure and the light conditions in which leaves are, we can translate
the supply function into a leaf photosynthesis function (Sperry et al. 2017). In a nutshell, E from the
supply function is first used to calculate leaf temperature from an evaluation of the leaf energy balance.
The diffusive conductances of the leaf to H2O and CO2 are obtained from water supply and leaf water
vapor deficit. Finally, the gross/net assimilation rate is then obtained from the diffusive conductance and a
modelled curve between assimilation and leaf internal CO2 concentration. The following subsections detail
each of these steps separately.
11.1.1
Leaf temperature
Leaf temperature (Tleaf; in ◦C) can be calculated for any given flow rate E using an energy balance equation
(Campbell & Norman 1998):
Tleaf = Tair + Φleaf
SW R + Lleaf
net −λv(Tair) · Etwo−sided
Cp · (gr + gHa)
(11.1)
where Φleaf
SW R (in W · m−2) is the instantaneous shortwave radiation absorbed per leaf area unit, Lleaf
net
is
the instantaneous net long-wave radiation per leaf area unit, Etwo−sided is the flow rate E converted to
mol · s−1 · m−2 per two-sided leaf area basis, ϵ is longwave radiation emissivity (0.97), σ is the Stephan-
Boltzman constant, Tair is the temperature of the air surrounding the leaf (in ◦C), Cp = 29.3 J ·mol−1·žC−1
is the specific heat capacity of dry air at constant pressure and λv(Tair) is the latent heat of vaporization
(in J · mol−1) corresponding to Tair (see utility functions in the meteoland reference manual). If canopy
energy balance is performed assuming a single canopy layer Tair corresponds to Tcan, the whole-canopy air
133

134
CHAPTER 11. LEAF/CANOPY PHOTOSYNTHESIS
temperature resulting from the energy balance of the previous step (see section 13.1.3). If a multi-layer
canopy energy balance is used, Tair corresponds to Tair,j, the air temperature of the canopy layer j that
contains the leaf. Finally, gr and gHa are the radiative and heat conductance values (in mol · m−2 · s−1),
respectively (Campbell & Norman 1998):
gr
=
4 · ϵ · σ · (Tair + 273.15)3
Cp
(11.2)
gHa
=
0.189 · (uleaf/d)0.5
(11.3)
where uleaf is the leaf-level wind speed (in m · s−1) and d is 0.72 times the leaf width (species parameter
LeafWidth in cm). As before, uleaf corresponds to uj, the wind-speed at the canopy layer j where the leaf
is located (see 23.2).
By inspecting eq.
(11.1), we can conclude that transpiration flow decreases leaf temperature, whereas
radiation increases it and wind speed makes it more similar to the temperature of the surrounding air. The
following figures illustrate the effect of varying wind speed and flow rate on Tleaf for two contrasted leaf
widths (see function biophysics_leafTemperature):
Wide leaf (10 cm) temperature (ºC)
Wind speed (m/s)
Flow rate (mmol·s−1·m−2)
 28 
 30 
 32 
 34 
 36 
 38 
 40  42  44 
0
1
2
3
4
5
0
2
4
6
8
Narrow leaf (0.1 cm) temperature (ºC)
Wind speed (m/s)
Flow rate (mmol·s−1·m−2)
 24.5 
 25 
 25.5 
 26 
 26.5 
 27 
 27.5 
 28 
0
1
2
3
4
5
0
2
4
6
8
Figure 11.1: Values of Tleaf for two leaf widths and varying values of wind speed and flow rate, calculated
for 24ºC air temperature and 740 W · m−2 instantaneous absorbed radiation (including SWR and LWR).
Let us now fix wind speed at the leaf leavel to uleaf = 2 m/s. The application of the above equations to the
E(Ψleaf) curves corresponding to the complete hydraulic network (10.4.5) yields the following Tleaf(Ψleaf)
curves:
11.1.2
Leaf vapor pressure deficit
Vapor pressure deficit in the leaf (V PDleaf, in kPa) is calculated as:
V PDleaf = eleaf −eair
(11.4)
Where eair is the water vapor pressure of the air surrounding the leaf (but beyond the leaf boundary layer)
and eleaf is the leaf vapor pressure, which can be calculated from leaf temperature (Tleaf) and leaf water
potential (Ψleaf):
eleaf = esat(Tleaf) · exp
 2.17 · Ψleaf
Tleaf + 273.15

(11.5)

11.1. LEAF ENERGY BALANCE, GAS EXCHANGE AND PHOTOSYNTHESIS
135
0
1
2
3
4
5
6
7
26.0
26.5
27.0
27.5
original
Leaf pressure (−MPa)
Leaf temperature (ºC)
Sandy loam
Silt loam
Clay
0
1
2
3
4
5
6
7
26.0
26.5
27.0
27.5
after cavitation
Leaf pressure (−MPa)
Leaf temperature (ºC)
Sandy loam
Silt loam
Clay
Figure 11.2: Examples of leaf temperature functions for a hydraulic network, corresponding to fig. 10.15 and
for different soil textures. Left/right panel shows values for uncavitated/cavitated supply functions.
where esat(T) is a function giving the saturated vapor pressure for temperature T (see utility functions
of the meteoland reference manual).
If a single-canopy energy balance is considered, the water vapor
pressure of the air surrounding the leaf is taken as the average atmospheric water vapor pressure of the day,
i.e. eair = eatm. When a multi-layer canopy energy balance is simulated, eair will correspond to the water
vapor pressure eair,j of the canopy layer j where the leaf is located.
Since eleaf decreases when leaf temperature decreases in eq. (11.5), increasing transpiration decreases leaf
VPD as a result of decreasing leaf temperature. To illustrate this effect, let us assume the following values
of relative humidity, yielding a eair = eatm = 1.91 kPa:
RHmin = 60
RHmax = 75
VPatm = meteoland::utils_averageDailyVP(Tmin, Tmax, RHmin, RHmax)
VPatm
## [1] 1.912181
The application of the above equation to the Tleaf(Ψleaf) curves of fig. 11.2 yields the following
V PDleaf(Ψleaf) curves:
Note that the VPD decreasing curves do not start at the same V PDleaf value despite corresponding to the
same Tleaf value, because of the effect of Ψleaf on eleaf in eq. (11.5).
11.1.3
Leaf gas exchange
Leaf diffusive conductance to water vapor (gw; in mol H2O · s−1 · m−2) and to carbon dioxide (gc; in
mol CO2·s−1·m−2) are obtained for each value of transpiration flow E (here expressed in mol H2O·s−1·m−2)

136
CHAPTER 11. LEAF/CANOPY PHOTOSYNTHESIS
0
1
2
3
4
5
6
7
1.3
1.4
1.5
1.6
1.7
original
Leaf pressure (−MPa)
Leaf VPD (kPa)
Sandy loam
Silt loam
Clay
0
1
2
3
4
5
6
7
1.3
1.4
1.5
1.6
1.7
after cavitation
Leaf pressure (−MPa)
Leaf VPD (kPa)
Sandy loam
Silt loam
Clay
Figure 11.3: Examples of leaf vapour pressure deficit (V PDleaf) functions for a hydraulic network, corre-
sponding to fig. 10.15 and for different soil textures. Left/right panel shows values for uncavitated/cavitated
supply functions.
and V PDleaf using:
gw
=
E ·
Patm
V PDleaf
(11.6)
gc
=
gw/1.6
(11.7)
Diffusive conductance to water vapour is assumed to be result of stomatal (gsw) and boundary layer (gbw)
conductances (both in mol H2O · s−1 · m−2). If we estimate gbw using:
gbw = 0.397 · (uleaf/d)0.5
(11.8)
then, stomatal conductance is:
g−1
sw = g−1
w −g−1
bw
(11.9)
Ensuring here that gw ≤gbw so that g−1
w
≥g−1
bw . The application of equations for gw, gbw and gsw to the
V PDleaf(Ψleaf) curves yields the following stomatal conductance gsw(Ψleaf) curves:
In the previous figure we have indicated the thresholds of gsw,min and gsw,max, the species-specific minimum
and maximum water vapour conductances (i.e. conductances when stomata are fully closed and fully open,
respectively; see parameters Gswmin and Gswmax in SpParamsMED). gsw cannot exceed gsw,max so that some
flow rates may not be possible (see stomatal regulation below). However, gsw,max should quickly become
non-limiting as soil dries (i.e. reducing E) or V PDleaf increases (Sperry et al. 2017).
11.1.4
Leaf photosynthesis
Rubisco-limited photosynthesis rate Ac (in µmol CO2 · s−1 · m−2) is modelled using (Collatz et al. 1991;
Medlyn et al. 2002):
Ac =
Vmax · (Ci −Γ∗)
Ci + Kc · (1 + Oa/Ko)
(11.10)
where Vmax is Rubisco’s maximum carboxylation rate (in µmol CO2 · s−1 · m−2), Ci is the internal carbon
dioxide concentration (in µmol·mol−1), Γ∗is the compensation point (in µmol·mol−1), Kc (in µmol·mol−1)
and Ko (in mmol · mol−1) are Michaelis-Menten constants for carboxylation and oxygenation, respectively,

11.1. LEAF ENERGY BALANCE, GAS EXCHANGE AND PHOTOSYNTHESIS
137
0
1
2
3
4
5
6
7
0.0
0.1
0.2
0.3
0.4
0.5
original
Leaf pressure (−MPa)
Leaf stomatal conductance
0
1
2
3
4
5
6
7
0.0
0.1
0.2
0.3
0.4
0.5
after cavitation
Leaf pressure (−MPa)
Leaf stomatal conductance
Sandy loam
Silt loam
Clay
Figure 11.4: Examples of stomatal conductance to water vapour (gsw) functions for a hydraulic network, cor-
responding to fig. 10.15 and for different soil textures. Left/right panel shows values for uncavitated/cavitated
supply functions. Minimum and maximum conductance values (gsw,min = 0.0045 and gsw,max = 0.3) are
indicated using dashed lines.
and Oa is the atmospheric oxygen concentration (i.e. 209 mmol · mol−1). Γ∗, Kc and Ko depend on leaf
temperature (Tleaf, in ◦C) (Bernacchi et al. 2001):
Γ∗
=
42.75 · e
37830·(Tleaf −25)
298·R·(Tleaf −273)
(11.11)
Kc
=
404.9 · e
79430·(Tleaf −25)
298·R·(Tleaf −273)
(11.12)
Ko
=
278.4 · e
36380·(Tleaf −25)
298·R·(Tleaf −273)
(11.13)
Electron transport-limited photosynthesis Ae (in µmol CO2 · s−1 · m−2) was obtained from Medlyn et al.
(2002):
Ae
=
J
4 ·
Ci −Γ∗
Ci + 2 · Γ∗
(11.14)
J
=
(α · Qleaf
P AR + Jmax) −
q
(α · Qleaf
P AR + Jmax)2 −4.0 · c · α · Qleaf
P AR · Jmax
2 · c
(11.15)
where α = 0.3 mol e · mol photon−1 is the quantum yield of electron transport, Qleaf
P AR is the absorbed PAR
photon flux density per leaf area (µmol photon · m−2 · s−1), which is calculated from absorbed PAR per leaf
area (Φleaf
P AR; in W · m−2):
Qleaf
P AR = Φleaf
P AR · 546 · 0.836 · 10−2
(11.16)
where 546 is the wavelength in nm. Jmax and J are the maximum and actual rate of electron transport (both
in µmol e · m−2 · s−1) and c = 0.9 defines the curvature of the light-response curve. The gross assimilation
rate A at a given Ci is the minimum of Ae and Ac. To obtain a smooth A-vs-Ci curve we used (Collatz et
al. 1991):
A = (Ac + Ae) −
p
(Ac + Ae)2 −4.0 · c′ · Ae · Ac
2 · c′
(11.17)
where c′ = 0.98 is a curvature factor. The temperature dependence of Jmax and Vmax relative to 25ºC
(i.e., relative to input parameters Jmax,298 and Vmax,298) is modelled using Leuning (2002) (his eq. 1 with

138
CHAPTER 11. LEAF/CANOPY PHOTOSYNTHESIS
parameters from his Table 2).
The internal CO2 concentration, Ci, needs to be known to calculate A
using the previous equations. Sperry et al. (2016) use a second equation for A which uses gc, the diffusive
conductance to CO2 (which includes both the stomatal conductance and boundary layer conductance):
A = gc · (Cair −Ci)
(11.18)
where Cair is the CO2 concentration (in µmol · mol−1) in the air surrounding the leaf (beyond the leaf
boundary layer). If a single-layer canopy energy balance is used then Cair = Catm, the atmospheric CO2
concentration (see weather input and parameter Catm in function defaultControl()), whereas if a multi-
layer canopy energy balance is used Cair corresponds to Cair,j, the CO2 concentration in the canopy layer
j where the leaf occurs, analogously to Tair and eair. Combining the two equations for A and finding the
root of the resulting equation using Newton-Raphson method allows determining Ci and therefore A. Thus,
after defining PAR photon flux density, atmosphere CO2 concentration and maximum rate parameters:
Q = 2000
Catm = 386
Vmax298 = 100
Jmax298 = 1.67*Vmax298
one can obtain the following A(Ψleaf) curves from Tleaf(Ψleaf) and gsw(Ψleaf):
0
1
2
3
4
5
6
7
0
5
10
15
20
25
original
Leaf sap pressure (−MPa)
Gross assimilation rate
Sandy loam
Silt loam
Clay
0
1
2
3
4
5
6
7
0
5
10
15
20
after cavitation
Leaf sap pressure (−MPa)
Gross assimilation rate
Sandy loam
Silt loam
Clay
Figure 11.5: Examples of gross photosynthesis (A) functions for a hydraulic network, corresponding to
fig. 10.15 and for different soil textures. Left/right panel shows values for uncavitated/cavitated supply
functions.
Finally, leaf net photosynthesis (An; i.e. accounting for autotrophic respiration) is calculated as:
An = A −0.015 · Vmax
(11.19)
11.2
Crown/canopy photosynthesis
In the previous subsection we showed how to calculate photosynthesis at the leaf level, but gross or net
assimilation needs to be up-scaled to the crown or canopy levels, while accounting for the variation of
leaf photosynthetic conditions across canopies. In this section, we briefly describe different alternatives for
canopy/crown photosynthesis and justify our modelling choice.

11.2. CROWN/CANOPY PHOTOSYNTHESIS
139
11.2.1
Multi-layer canopy photosynthesis model
Ideally, crown or canopy photosynthesis requires repeating the calculations of leaf temperature, leaf VPD, leaf
gas conductance and photosynthesis for every leaf. Multi-layer canopy models, however, divide the canopy
into vertical layers and determine photosynthesis for each one (and each plant species or plant cohort, if
required). Multi-layer models can account for the fact that environmental variables usually vary across the
crown, including direct/diffuse absorbed radiation, air temperature, wind speed, water vapor pressure and
CO2 concentration. The amount of SWR and PAR absorbed per unit of leaf area at each canopy layer was
shown in fig. 9.2.
Not only environmental factors, but leaves themselves may be different across canopy layers. Importantly, it
is generally accepted that sunlit and shade leaves need to be treated separately (De Pury & Farquhar 1997).
Separating the two kinds of leaves acknowledges that they operate at different parts of the light-saturation
curve. Following De Pury & Farquhar (1997), we further assume that maximum carboxylation and electron
transport rates are highest for leaves at the top of the canopy and there is a exponential decrease from there
towards the bottom, where maximum rates are 50% of those at the top:
Vmax,298,i,j
=
Vmax,298,i · exp(−0.713 ·
X
h>i
LAIϕ
h,j/LAIϕ
i )
(11.20)
Jmax,298,i,j
=
Jmax,298,i · exp(−0.713 ·
X
h>i
LAIϕ
h,j/LAIϕ
i )
(11.21)
where LAIϕ
i,j is the LAI value of the plant cohort i at a given canopy layer j and LAIϕ
i is the expanded
LAI of the plant cohort. The following figure illustrate this decrease for the single-species canopy example
of section 9.1.3:
80
90
100
110
120
130
140
2
4
6
8
10
Maximum carboxylation rate
Layer
Figure 11.6: Decrease of Rubisco maximum carboxilation rate across the canopy
In a multi-layer canopy photosynthesis model, gross and net photosynthesis values (i.e. A and An) are deter-
mined for sunlit and shade leaves of each cohort in each canopy layer. Then, sunlit and shade photosynthesis
values should be averaged across the crown for each plant cohort. Assuming that Ψleaf is equal for all leaves
across the crown, the function A(Ψleaf) would be obtained for each plant cohort.

140
CHAPTER 11. LEAF/CANOPY PHOTOSYNTHESIS
11.2.2
Big-leaf canopy photosynthesis model
Multi-layer canopy photosynthesis models allow evaluating leaf conditions, stomatal conductance and photo-
synthesis for different points of the canopy. However, this comes at high computational cost. For this reason,
many models implement what is called the big-leaf approximation. Assuming that wind speed, temperature,
water vapor pressure and CO2 concentration are similar for all leaves and that the distribution of photo-
synthetic capacity between leaves is in proportion to the profile of absorbed irradiance then the equation
describing leaf photosynthesis will also represent canopy photosynthesis (Sellers et al. 1992).
11.2.3
Sun-shade canopy photosynthesis model
An alternative between multi-layer and big-leaf canopy photosynthesis models is to collapse variation of
photosynthetic conditions into two leaf classes: sunlit and shade leaves.
While big-leaf canopy models
are known to be unaccurate under some situations, sun-shade canopy models (De Pury & Farquhar 1997)
provide estimates that are close to multiple layer models (Hikosaka et al. 2016). The sun-shade canopy
photosynthesis model was adopted here. Assuming that wind speed, temperature, water vapor pressure and
and CO2 concentration are similar for all leaves, sun-shade models involve the following steps:
a. Aggregate the leaf area of sunlit/shade leaves across layers:
LAIsunlit
i
=
l
X
j=1
LAIsunlit
i,j
(11.22)
LAIshade
i
=
l
X
j=1
LAIshade
i,j
(11.23)
where LAIsunlit
i,j
and LAIshade
i,j
are the leaf area index of sunlit and shade leaves for cohort i in canopy
layer j, from eq. (9.8).
b. Average the SWR/PAR absorbed by leaves of each kind across layers. The average light absorbed by
sunlit/shaded foliage of cohort i per ground area unit is found using:
Φsunlit
abs,i
=
Pl
j=1 Ksunlit
abs,i,j
LAIsunlit
i
(11.24)
Φshade
abs,i
=
Pl
j=1 Kshade
abs,i,j
LAIshade
i
(11.25)
where Ksunlit
abs,i,j and Kshade
abs,i,j are the light absorbed per ground area unit by sunlit/shade leaves of cohort
i at layer j (see section 9.1.3). Analogous equations were already given for the net long-wave radiation
balance of sunlit leaves (Lsunlit
net,i ) and shade leaves (Lshade
net,i ) in section 9.2.3.
c. Average the maximum carboxylation (respectively, electron transport) rates across layers, again sepa-
rating sunlit and shade leaves:
V sunlit
max,298,i
=
Pl
j=1 Vmax,298,i,j · LAIsunlit
i,j
LAIsunlit
i
(11.26)
V shade
max,298,i
=
Pl
j=1 Vmax,298,i,j · LAIshade
i,j
LAIshade
i
(11.27)
d. Use V sunlit
max,298,i as Vmax,298 in Leuning (2002) to obtain Vmax for eq. (11.10); Φsunlit
SW R,i as Φleaf
SW R and
Lsunlit
net,i
as Lleaf
net in eq. (11.1); and Φsunlit
P AR,i as Φleaf
P AR in eq. (11.16) to estimate sunlit leaf photosynthesis,
which can be up-scaled to the crown level multiplying by LAIsunlit
i
. The same would be done for shade
leaves. In a sun-shade canopy model one then calls the photosynthesis function twice (i.e. once for
shade leaves and once for sunlit leaves) for each plant cohort i.

11.2. CROWN/CANOPY PHOTOSYNTHESIS
141
11.2.4
Comparison of big-leaf, sun-shade and multi-canopy photosynthesis
models
The figure below provides the canopy photosynthesis functions obtained using the multi-layer canopy
photosynthesis model (top), a sunshade canopy photosynthesis model (center) or a big-leaf photosynthesis
model (bottom).
These were generated using functions photo_multilayerPhotosynthesisFunction(),
photo_sunshadePhotosynthesisFunction() and photo_leafPhotosynthesisFunction(), respectively,
and assuming homogeneous wind, temperature and water vapor pressure through the canopy. Thus, only
absorbed radiation varied across layers and leaf types. Note the coincidence between the multi-layer and
the sun-shade models.
11.2.5
Within-canopy variation in environmental conditions
When presenting the sun-shade photosynthesis model, we assumed constant wind, temperature, water vapor
pressure and CO2 concentration values through the canopy.
If a single-layer canopy energy balance is
used, CO2 concentration and vapor pressure are assumed equal to the atmosphere (i.e., eair = eatm and
Cair = Catm), whereas air temperature is that of the canopy (i.e., Tair = Tcan), but leaf-level wind speed
(uleaf) can still be different for different canopy layers. If a multi-layer canopy energy balance is used, all four
environmental variables can differ between canopy layers (i.e. Tair,j, eair,j, Cair,j and uj). In the sun-shade
photosynthesis model, the question arises on how to determine layer j for sunlit or shade leaves of a given
cohort i. The choice is done by calculating the height corresponding to the mass center of sunlit leaves or
shade leaves of each cohort i. The canopy layer j where this mass center height is contained is chosen as
the layer from which environmental conditions will be taken. For any given plant cohort i, sunlit leaves will
take their environmental conditions from layers above (or equal to) those corresponding to shade leaves.

142
CHAPTER 11. LEAF/CANOPY PHOTOSYNTHESIS
0
1
2
3
4
5
6
7
0
5
10
15
20
original
Leaf pressure (−MPa)
Multilayer photosynthesis
Sandy loam
Silt loam
Clay
0
1
2
3
4
5
6
7
0
5
10
15
20
after cavitation
Leaf pressure (−MPa)
Multilayer photosynthesis
Sandy loam
Silt loam
Clay
0
1
2
3
4
5
6
7
0
5
10
15
20
original
Leaf pressure (−MPa)
Sun−shade photosynthesis
Sandy loam
Silt loam
Clay
0
1
2
3
4
5
6
7
0
5
10
15
20
after cavitation
Leaf pressure (−MPa)
Sun−shade photosynthesis
Sandy loam
Silt loam
Clay
0
1
2
3
4
5
6
7
0
2
4
6
8
10
12
original
Leaf pressure (−MPa)
Big−leaf photosynthesis
Sandy loam
Silt loam
Clay
0
1
2
3
4
5
6
7
0
2
4
6
8
10
12
after cavitation
Leaf pressure (−MPa)
Big−leaf photosynthesis
Sandy loam
Silt loam
Clay
Figure 11.7: Whole-canopy photosynthesis functions obtained for a hydraulic network, corresponding to
fig. 10.15 and different soil textures, using the multi-layer canopy photosynthesis model (top), a sunshade
canopy photosynthesis model (center) or a big-leaf photosynthesis model (bottom). Left/right panel shows
values for uncavitated/cavitated supply functions.

Chapter 12
Stomatal regulation, transpiration
and photosynthesis
Plants must open their stomata to acquire CO2 and perform photosynthesis, but doing so promotes water loss.
This trade-off has resulted in a tight coordination between capacity to supply and transpire water (hydraulic
conductance and diffusive conductance to water vapor) and the maximum capacity for photosynthesis (car-
boxylation rate and electron-transport rate). For modelling purposes, this carbon-for-water trade-off means
that hydraulics, stomatal conductance, transpiration and photosynthesis need to be estimated simultane-
ously. In chapters 10 and 11 we introduced plant hydraulics and photosynthesis, respectively, but we did not
explain how are actual transpiration and photosynthesis values determined. This depends on the sub-model
chosen and is the subject of the present chapter.
12.1
Stomatal regulation under Sperry’s sub-model
The framework of Sperry et al. (2017) suggests estimating stomatal conductance from the instantaneous
maximization of profit, defined as the difference between photosynthesis gain and hydraulic cost (both
normalized for comparability). First, transpiration and photosynthesis is estimated separately for sunlit and
shade leaves according to this framework. An average transpiration rate is then determined depending on
sunlit/shade transpiration rates and their leaf area contributions. Finally, the instantaneous transpiration
and assimilation rates of each time step are scaled to the duration of the time step and to the leaf area of
the plant cohort. The following sections provide details for all these steps.
12.1.1
Water supply and sunlit/shade photosynthesis functions
Let us start by summarizing the concepts introduced in the last two chapters.
The supply function
described in chapter 10 describes the rate of transpiration flow as a function of the pressure drop between
the soil and the leaf, and incorporates both soil, xylem and leaf hydraulic constrains (Sperry et al. 1998,
2016; Sperry & Love 2015). Here we assume that hydraulic conductance k is in mmol H2O·s−1·m−2·MPa−1
of leaf area, transpiration rate Eleaf in mmol H2O · s−1 · m−2 of leaf area and leaf water potential Ψleaf is
in MPa.
According to section 11.1, each Eleaf value implies an energy balance at the leaf level, stomatal conductance
to water vapour and a particular value of leaf photosynthesis.
More specifically, for each pair of Eleaf
and Ψleaf values, we have a corresponding leaf temperature (Tleaf; in ºC), leaf-to-air vapor pressure deficit
(V PDleaf; in kPa), leaf water vapor conductance (gsw; in mol H2Oůs−1ům−2) and, finally the leaf gross
and net (i.e. after accounting for autotrophic respiration) photosynthesis assimilation rates (Ag and An;
143

144
CHAPTER 12. STOMATAL REGULATION, TRANSPIRATION AND PHOTOSYNTHESIS
both in µmol CO2ůs−1ům−2). In short, the supply function generates a photosynthesis function. Since
the model deals with canopies and not single leaves, however, different parts of the crowns of plant cohorts
may be in different canopy positions. Calculating photosynthesis at the canopy level requires dividing the
canopy into vertical layers, differentiating between sunlit and shade leaves and determining photosynthesis
functions for sunlit and shade leaves separately, as explained in section 11.2.
12.1.2
Leaf stomatal regulation by profit maximization
Wolf et al. (2016) proposed the carbon maximization criterion, which states that at each instant in time
the stomata regulate canopy gas exchange and pressure to achieve the maximum profit, which is the maximum
difference between photosynthetic gains and costs, the latter associated with hydraulic vulnerability attained
with low water potentials. Such approach has been shown to be supported by data from global forest biomes
(Anderegg et al. 2018). Building on this approach, Sperry et al. (2017) presented a profit maximization
function where hydraulic costs of opening the stomata are compared against photosynthetic gains. Details
of their formulation are given in this section. Stomatal regulation is performed in medfate separatedly for
sunlit and shade leaves.
12.1.2.1
Cost and gain functions
The hydraulic supply function is used to derive a transpirational cost function θ1(Ψleaf) that reflects the
increasing damage from cavitation and the greater difficulty of moving water along the continuum (Sperry
et al. 2016):
θ(Ψleaf) = kc,max −kc(Ψleaf)
kc,max −kcrit
(12.1)
where kc(Ψleaf) = dE/dΨ(Ψ) is the slope of the supply function corresponding to (leaf) water potential
Ψleaf, kc,max is the maximum slope of the supply function (which occurs when Eleaf = 0), i.e. the maximum
whole-plant conductance for the current soil moisture conditions, and kcrit = kc(Ψcrit) is the slope of the
supply function at Eleaf = Ecrit the critical flow beyond which hydraulic failure occurs.
The following figures illustrate the θ(Ψleaf) curves corresponding to the supply functions:
The normalized photosynthetic gain function β(Ψleaf) reflects the actual assimilation rate with respect to
the maximum (Sperry et al. 2016):
β(Ψleaf) = A(Ψleaf)
Amax
(12.2)
where Amax is the instantaneous maximum (gross) assimilation rate estimated over the full Ψleaf range
(including values that imply a stomatal conductance larger than the maximum).
The following figures illustrate the β(Ψleaf) curves corresponding to the supply and assimilation functions:
12.1.2.2
Profit maximization at the leaf level
Sperry et al. (2017) suggested that stomatal regulation can be effectively estimated by determining the
maximum of the profit function (Profit(Ψleaf)):
Profit(Ψleaf) = β(Ψleaf) −θ(Ψleaf)
(12.3)
The maximization is achieved when the slopes of the gain and cost functions are equal:
δβ(Ψleaf)
δΨleaf
= δθ(Ψleaf)
δΨleaf
(12.4)
Instantaneous profit maximization assumes a ‘use it or lose it’ reality with regards to available soil water. Be-
cause the gain function accelerates more quickly from zero and reaches 1 sooner than the cost functiion, their

12.1. STOMATAL REGULATION UNDER SPERRY’S SUB-MODEL
145
0
1
2
3
4
5
6
7
0.0
0.2
0.4
0.6
0.8
1.0
Cost 1 (original)
Leaf sap pressure (−MPa)
Cost function 1
Sandy loam
Silt loam
Clay
0
1
2
3
4
5
6
7
0.0
0.2
0.4
0.6
0.8
1.0
Cost 1 (after cavitation)
Leaf sap pressure (−MPa)
Cost function
Sandy loam
Silt loam
Clay
Figure 12.1: Cost functions (i.e. θ(Ψleaf)) obtained for a hydraulic network, corresponding to fig. 10.15 and
different soil textures and soil water potentials. Left/right panels show values for uncavitated/cavitated
supply functions, respectively.
0
1
2
3
4
5
6
7
0.0
0.2
0.4
0.6
0.8
1.0
Gain (original)
Canopy sap pressure (−MPa)
Gain function
Sandy loam
Silt loam
Clay
0
1
2
3
4
5
6
7
0.0
0.2
0.4
0.6
0.8
1.0
Gain (after cavitation)
Canopy sap pressure (−MPa)
Gain function
Sandy loam
Silt loam
Clay
Figure 12.2: Gain function (β(Ψleaf)) obtained for a hydraulic network, corresponding to fig. 10.15 and
different soil textures and soil water potentials. Left/right panels show values for uncavitated/cavitated
supply functions, respectively.

146
CHAPTER 12. STOMATAL REGULATION, TRANSPIRATION AND PHOTOSYNTHESIS
maximum difference occurs at intermediate Ψleaf values. Once Ψleaf that maximizes profit is determined,
the values of the remaining variables are also determined. At this point, it may happen that gsw(Ψleaf)
is lower than the minimum (i.e. cuticular) water vapor conductance (gsw,min) or larger than the maximum
water vapor conductance (gsw,max). These thresholds need to be taken into account when determining the
maximum of the profit function.
The following figures illustrate the Profit(Ψleaf) curves of corresponding to the previous cost and gain
curves:
0
1
2
3
4
5
6
7
0.0
0.2
0.4
0.6
0.8
1.0
original
Leaf sap pressure (−MPa)
Profit
Sandy loam
Silt loam
Clay
0
1
2
3
4
5
6
7
0.0
0.2
0.4
0.6
0.8
1.0
after cavitation
Leaf sap pressure (−MPa)
Profit
Sandy loam
Silt loam
Clay
Figure 12.3: Profit functions (i.e. Profit(Ψleaf)) obtained for a hydraulic network, corresponding to fig. 10.15
and different soil textures and soil water potentials. Left/right panels show values for uncavitated/cavitated
supply functions, respectively.
Squares in the previous figures indicate the maximum profit points in each situation. The drier the soil,
the closer is the maximum profit Ψleaf to soil water potential as one would expect intuitively (i.e. a smaller
drop in water potential along the hydraulic pathway).
Note that when the soil is very dry the squares
are to the right of the true maximum. This is because the transp_profitMaximization() function takes
into account the minimum and maximum stomatal conductance and, in this case, does not allow optimum
stomatal conductances below the minimum (cuticular) value.
Note that θ, β and Profit functions can be expressed as a function of stomatal conductance, instead of
leaf water potential. This allows visualizing more clearly the effect of gsw,min and gsw,max thresholds on the
maximum profit optimization strategy, as illustrated in the following figures.
12.1.3
Cohort-level transpiration
In the previous section, we considered stomatal regulation at the leaf level only. At the plant cohort level,
the gain function could be build from a crown photosynthesis function A(Ψleaf), as shown in section 11.2.
However, applying the profit maximization approach for a single crown photosynthesis function would imply
the assumption that the same stomatal aperture occurs in all leaves of the plant cohort, independently of
whether they are in shade or sunlit. A more realistic approach is to determine stomatal regulation by profit
maximization for sunlit and shade leaves separately. The gain function and profit maximization calculations
conducted for each leaf type yield instantaneous leaf water potentials Ψsunlit
leaf
and Ψshade
leaf
and instantaneous
flow values Eshade and Esunlit from the supply functions. The corresponding photosynthesis functions allow

12.2. STOMATAL REGULATION AND TRANSPIRATION UNDER SUREAU’S SUB-MODEL
147
0.001
0.005
0.020
0.100
0.500
0.0
0.2
0.4
0.6
0.8
1.0
original
Stomatal conductance
Profit
Sandy loam
Silt loam
Clay
0.001
0.005
0.020
0.100
0.500
0.0
0.2
0.4
0.6
0.8
1.0
after cavitation
Stomatal conductance
Profit
Sandy loam
Silt loam
Clay
Figure 12.4: Profit function as a function of stomatal conductance, corresponding to fig. 12.3 and different soil
textures and soil water potentials. Left/right panels show values for uncavitated/cavitated supply functions,
respectively.
determining values for leaf temperatures T sunlit
leaf
and T shade
leaf
, vapour pressure deficits V PDsunlit
leaf
V PDshade
leaf ,
stomatal conductance gsunlit
sw
and gshade
sw
and net photosynthesis rates Asunlit
n
and Ashade
n
. This is a lot of
useful information at the leaf level for each plant cohort i, but we also need transpiration and photosynthesis
values at the plant cohort-level.
The average instantaneous flow rate (Eaverage
i
, in mmol H2O · s−1 · m−2) per leaf area unit of plant cohort
i is the weighed average:
Eaverage
i
= Eshade
i
· LAIsunlit
i
+ Eshade
i
· LAIshade
i
LAIϕ
i
(12.5)
where LAIsunlit
i
and LAIshade
i
are the cohorts LAI values for sunlit and shade leaves, from eq. (9.8), and
LAIϕ
i is the leaf area index of plant cohort i. The model then uses the hydraulic supply function to find
the transpiration rate Ei numerically closest to Eaverage
i
(remember that the supply function is build in
discrete steps). Finding the Ei value numerically closest to Eaverage
i
determines the Ei,t the instantaneous
transpiration flow for current time step t, and also leads to setting values for t of several other variables, such
as water potentials (Ψleaf,i,t, Ψstem,i,t, Ψrootcrown,i,t, . . . ), the slope of the supply function ((dE/dΨi)t), and
instantaneous soil water extraction rates (Ei,s,t).
12.2
Stomatal regulation and transpiration under Sureau’s sub-
model
12.2.1
Transpiration flows
In Sureau-ECOS (Ruffault et al. 2022), plants lose water through stomatal transpiration (Estom), cuticular
transpiration of the leaf (Eleaf,cuti) and cuticular transpiration of the stem (Estem,cuti), see Fig. 10.2.

148
CHAPTER 12. STOMATAL REGULATION, TRANSPIRATION AND PHOTOSYNTHESIS
The total plant transpiration EP lant is decomposed as the sum of the average leaf transpiration and wood
cuticular transpiration:
Eplant = Eleaf,average + Estem,cuti
(12.6)
where Eleaf,average is computed as the weighted average of sunlit and shade leaf transpiration:
Eleaf,average = Esunlit · LAIsunlit + Eleaf,shade · LAIshade
LAIϕ
(12.7)
In turn, Eleaf,sunlit and Eleaf,shade are the result of considering stomatal transpiration and cuticular tran-
spiration:
Eleaf
=
Estom + Eleaf,cuti
(12.8)
=

1
gstom + gleaf,cuti
+
1
gbound
+
1
gcrown
−1
· V PDleaf
Patm
(12.9)
where V PDleaf (in MPa) is the vapor pressure deficit of the leaf, Patm is the atmospheric pressure, gstom
is the stomatal conductance, gleaf,cuti is the cuticular conductance of the leaf, gbound is the conductance of
the leaf boundary layer and gcrown is the conductance of the tree crown. Note that sunlit and shade leaves
will differ in gstom, gleaf,cuti and V PDleaf, because of their different radiation and heat balance.
Finally, Estem,cuti is calculated as follows:
Estem,cuti =

1
gstem,cuti
+
1
gbound
+
1
gcrown
−1
· V PDair
Patm
(12.10)
where V PDair is the vapour pressure deficit in the canopy air:
V PDair = esat(Tair) −eair
(12.11)
12.2.2
Cuticular conductances
gleaf,cuti is a function of leaf temperature (Tleaf), which is based on a single or double Q10 equation depending
on whether leaf temperature is above or below the transition phase temperature (Tphase). If Tleaf ≤Tphase
we have:
gleaf,cuti = gleaf,cuti,20 · Q
Tleaf −20
10
10a
(12.12)
whereas if Tleaf > Tphase we have:
gleaf,cuti = gleaf,cuti,20 · Q
Tleaf −20
10
10a
· Q
Tleaf −Tphase
10
10b
(12.13)
Sunlit and shade leaves will have different gleaf,cuti because of their different temperature. Unlike gleaf,cuti,
gstem,cuti is assumed non temperature dependent.
12.2.3
Stomatal conductance
gstom is the stomatal conductance taking into account the dependence of stomata on light and temperature,
as well as water status:
gstom = λ(Ψleaf,sym)ůgstom,jarvis
(12.14)
where gstom,jarvis is the stomatal conductance without water stress and is determined as a function of light
and temperature following Jarvis (1976). λ is a regulation factor that varies between 0 and 1 to represent
stomatal closure according to leaf symplasmic water potential (Ψleaf,sym) using sigmoid-type function:

12.3. COHORT-LEVEL TRANSPIRATION AND PHOTOSYNTHESIS
149
λ(Ψleaf,sym) = 1 −

1 + e(slopegs/25)·(Ψleaf,sym−Ψ50gs)
−1
(12.15)
depending on the potential at 50 % of stomatal closure (Ψ50gs) and a shape parameter (slopegs) describing
the rate of decrease in stomatal conductance per unit of water potential drop.
With the current implementation, λ will be the same for sunlit and shade leaves (i.e. there is only one
symplasmic water potential for both kind of leaves), but gstom,jarvis will differ because of the different light
and temperature conditions.
12.3
Cohort-level transpiration and photosynthesis
The amount of transpiration from the plant cohort in a given time step t (Tri,t, in l · m−2 of ground area,
i.e. in mm) is:
Tri,t = Ei,t · LAIϕ
i · fdry · 10−3 · 0.01802 · ∆tstep
(12.16)
where 0.01802 is the molar weight (in kg = l) of water and ∆tstep = 86400/nt the size of the time step
in seconds, being nt the number of time steps.
fdry is the fraction of the canopy that is assumed dry,
which is necessary to avoid overestimating total evapo-transpiration. In non-rainy days fdry = 1 whereas in
rainy days it is derived from comparing the daily evaporation due to rainfall interception (In; in mm) with
Penman’s potential evapo-transpiration (PET; in mm):
fdry = 1.0 −
In
PET
(12.17)
Soil extraction rates (Ex) are scaled to the cohort level as done for transpiration:
Exi,s,t = Ei,s,t · LAIϕ
i · fdry · 10−3 · 0.01802 · ∆tstep
(12.18)
If plant capacitance is not considered, one should have that soil extraction equals transpiration:
Tri,t = Exi,t =
X
s
Exi,s,t
(12.19)
Instantaneous net photosynthesis per leaf area of sunlit and shade leaves in a given time step t (i.e. Asunlit
n,i,t
and Ashade
n,i,t ) are also aggregated into An,i,t, the net photosynthesis of the plant cohort i for the time step t,
in g C · m−2 of ground area:
An,i,t = (Asunlit
n,i,t
· LAIsunlit
i
+ Ashade
n,i,t · LAIshade
i
) · 10−6 · 12.01017 · ∆tstep
(12.20)
12.4
Cavitation and conduit refilling
Like with the basic water balance model, the advanced water balance model is normally run assuming that
although soil drought may reduce transpiration. Embolized xylem conduits may be automatically refilled
when soil moisture recovers if stemCavitationRecovery = "total". Automatic refilling is always assumed
for root segments, but not for leaves and stems. There are three other options to deal with leaf and stem
xylem cavitation besides automatic refilling. Any of them cause the model to keep track of the proportion
of lost conductance in the leaf and stem xylem of the plant cohort i (PLCleaf,i and PLCstem,i) at successive
time steps:
PLCleaf,i,t
=
max{PLCleaf,i,t−1, 1 −kleaf,i(Ψleaf)/kmax,leaf,i}
(12.21)
PLCstem,i,t
=
max{PLCstem,i,t−1, 1 −kstem,i(Ψstem)/kmax,stem,i}
(12.22)

150
CHAPTER 12. STOMATAL REGULATION, TRANSPIRATION AND PHOTOSYNTHESIS
When water compartments are not considered, this equation is evaluated every hour time step, whereas it
is evaluated every 1s with water compartments, as part of the constitutive equations (see ??).
For simulations of less than one year one can use stemCavitationRecovery = "none" to keep track of
the maximum drought stress. However, for simulations of several years, it is normally advisable to allow
recovery. If stemCavitationRecovery = "annual", PLCleaf,i and PLCstem,i values are set to zero at the
beginning of each year, assuming that embolized plants overcome the conductance loss by creating new xylem
tissue. Finally, if stemCavitationRecovery = "rate" the model simulates stem refilling at daily steps as a
function of symplasmic water potential. First, a daily recovery rate (rrefill; in cm2·m−2·day−1) is estimated
as a function of Ψsymp,stem:
rrefill(Ψsymp,stem) = rmax,refill · max{0.0, (Ψsymp,stem + 1.5)/1.5}
(12.23)
Where rmax,refill is the control parameter cavitationRecoveryMaximumRate indicating a maximum re-
fill rate.
The right part of the equation normalizes the water potential, so that rrefill = rrefill,max if
Ψsymp,stem = 0 and rrefill = 0 if Ψsymp,stem <= −1.5MPa. The proportion of conductance lost in leaves
and stem are then updated using:
PLCleaf,i
=
max{0.0, PLCleaf,i −(rrefill/Hv)}
(12.24)
PLCstem,i
=
max{0.0, PLCstem,i −(rrefill/Hv)}
(12.25)
where Hv is the Huber value in units of cm2 · m−2.

Chapter 13
Closing energy balances
In chapter 9 we described the details of radiation energy transfer. Transpiration is an important latent heat
component of the energy balance, and the details of how plant transpiration is determined were given in
chapters 10, 11 and 12. This chapter explains how to calculate the remaining components of the canopy
energy balance, while distinguishing between assuming a single-layer canopy or considering a multiple-layer
canopy.
13.1
Single-layer canopy
The first part of the section describes the calculation of latent heat and convective energy exchanges between
the soil, canopy and atmosphere layers. These are the remaining energy components that are needed to close
the energy balances of the canopy (eq. (7.3)) and soil layers (eqs. (7.5) and (7.6)). Temperature changes
applied to the canopy and soil layers are also described.
13.1.1
Latent heat
Canopy exchanges of latent heat include latent heat exchanged from plant transpiration and evaporation of
rain intercepted by the canopy. In the single-layer canopy energy balance, vaporisation latent heat exchange
for the whole canopy (LEvap,can; in W · m−2) is calculated as:
LEvap,can = λv(Tcan) ·
Int + Pc
i=1 Tri,t
∆tstep

(13.1)
where λv(Tcan) is the latent heat of vaporization at temperature Tcan (in Jůkg−1), Tri,t is the amount (in
mm = kg ·m−2) of transpiration for cohort i during time step t (12.16), and Int is the amount of intercepted
water evaporated from the canopy for time step t (total daily interception In is divided into timesteps
according to the proportion of shortwave radiation absorbed by the canopy at each time step).
Fusion latent heat due to snow melting (LEfus,soil; in W · m−2) is estimated using:
LEfus,snow = λf · Smt
∆tstep
(13.2)
where λf = 0.33355Jůkg−1 is the latent heat of fusion. The latent heat exchange between the soil and the
atmosphere comes as vaporisation latent heat from water evaporated from the soil surface (LEvap,soil; in
W · m−2). It is estimated from water flow in mm = kg · m−2 using:
LEvap,soil = λv(Tsoil) · Est
∆tstep
(13.3)
151

152
CHAPTER 13. CLOSING ENERGY BALANCES
where λv(Tsoil) is the latent heat of vaporization at temperature Tsoil.
As before, daily evaporation from bare soil (Es) and snow melt water equivalent (Sm) are divided into time
steps according to the proportion of shortwave radiation absorbed by the soil layer each step.
13.1.2
Convective energy
Convective energy fluxes between atmosphere and the canopy (Hcan,atm) and between the canopy and the
soil (Hcan,soil) are determined as follows:
Hcan,atm
=
ρatm · cp
rcan,atm
· (Tcan −Tatm)
(13.4)
Hcan,soil
=
ρcan · cp
rcan,soil
· (Tcan −Tsoil,1)
(13.5)
where ρatm and ρcan are the air density above-canopy and inside-canopy, respectively, calculated from the
corresponding temperatures (see utility functions in meteoland reference manual); cp = 1013.86 Jůkg−1ůC−1
is the specific heat capacity of the air. rcan,atm and rcan,soil are the atmosphere-canopy and canopy-soil
aerodynamic resistances (in sům−1). These, in turn, are calculated using the FAO56 calculation procedure
and canopy height, total LAI and above-canopy and below-canopy wind speeds. Wind speed below the
canopy is calculated as explained in 23.2 assuming a height of 2 m.
13.1.3
Canopy temperature changes
After evaluating the canopy energy balance equation (7.3) one has to translate energy balance into temper-
ature variation of the canopy. Rearranging the same equation and expressing it in discrete time steps we
have:
∆Tcan = ∆tstep · Kabs,can + Lnet,can −LEcan −Hcan,atm −Hcan,soil
TCcan
(13.6)
where TCcan is the canopy thermal capacitance (in J · m−2 · K−1) and ∆tstep = 86400/nt is the size of the
time step in seconds. Canopy thermal capacitance depends on the leaf area index of the stand:
TCcan = TCLAI · 0.8 · LAIstand + 1.2 · (LAIphi
stand + ·LAIdead
stand)
2
(13.7)
where TCLAI is the thermal capacitance per LAI unit, which is specified by the control parameter
thermalCapacityLAI. By using both the maximum leaf area of the stand, LAIstand, and its current
live/dead leaf area (LAIphi
stand + LAIdead
stand) it is assumed that part of thermal capacitance corresponds to
stems and branches, so that capacitance does not drop to zero for deciduous canopies.
13.1.4
Soil temperature changes
Analogously to the canopy, the change in temperature for a given soil layer s in the current time step is
given by rearranging eq. (7.6):
∆Tsoil,s = ∆tstep · Gs−1,s −Gs,s+1
Csoil,s
(13.8)
where the energy balance on each soil layer s depends on the balance between energy coming from above
(Gs−1,s) and energy going to below (Gs,s+1) and Csoil,s, the thermal capacitance of soil layer s. Energy
inflow to the first (uppermost) layer (i.e. G0,1) is the result of energy exchanges between the soil layer and
the canopy and atmosphere, i.e. from eq. (7.5):
G0,1 = Ksoil + Lnet,soil + Hcan,soil −LEsoil
(13.9)

13.2. MULTI-LAYER CANOPY
153
Heat conduction between layers s and s+1 (i.e. Gs,s+1) depend on the soil temperature gradient (see function
soil_temperatureGradient():
Gs,s+1 = λsoil,s · δTsoil,s
δz
= λsoil,s · Tsoil,s −Tsoil,s+1
(Zs−1 −Zs+1)/2
(13.10)
where Zs−1 and Zs+1 are expressed in m and λsoil,s is the thermal conductivity of layer s, calculted from
soil moisture and texture following Dharssi et al. (2009) (see function soil_thermalconductivity()). The
gradient in the lowermost layer is calculated assuming a temperature of the earth (at 10 m) of 15.5 Celsius.
Finally, Csoil,s the thermal capacitance of soil layer s is calculated as:
Csoil,s = V TCsoil,s · ds
(13.11)
where ds is the soil width of layer s (expressed in m) and V TCs is the volumetric thermal capacity of soil
layer s (in J · m−3 · K−1), calculated from soil moisture and texture following a simplification of Cox et al.
(1999) (see function soil_thermalcapacity()).
13.2
Multi-layer canopy
A multi-layer canopy energy balance requires the calculation of sensible heat and latent heat exchanges
between the air in each canopy layer and the leaves it contains.
In addition, one has to consider heat
exchanges between each layer and the ones below/above, derived from turbulent flow.
13.2.1
Latent heat of vaporization
The latent heat of vaporization for a given canopy layer j (LEvap,j; in W · m−2) includes transpiration and
evaporation of intercepted rain, and is estimated analogously to the single-canopy case (eq. (13.1)):
LEvap,j = λv(Tair,j) ·
 Inj,t
∆tstep
+ Ej,t

(13.12)
where λv(Tair,j) is the latent heat of vaporization at temperature Tair,j (in Jůkg−1), Inj,t is the intercepted
water that is evaporated from the canopy layer, determined by dividing Int among canopy layers according
to the fraction of total LAI in each one:
Inj,t = Int ·
P
i=1 LAIϕ
i,j
LAIϕ
stand
(13.13)
and Ej,t is the instantaneous transpiration rate in layer j (in kg H2O · m−2 · s−1), given by:
Ej,t = 10−3 · 0.01802 ·
c
X
i=1
Esunlit
i,t
· LAIsunlit
i,j
+ Eshade
i,t
· LAIshade
i,j
(13.14)
where Esunlit
i,t
and Eshade
i,t
are the instantaneous transpiration rates (in mmol H2O · m−2 · s−1) of sunlit and
shade leaves, respectively, of cohort i during time step t; and LAIsunlit
i,j
and LAIshade
i,j
are the leaf area index
of sunlit and shade leaves, respectively, of cohort i in layer j (9.8).
Latent heat derived from soil water evaporation and snow melting (LEvap,soil and LEfus,snow; in W · m−2)
are estimated as in the single-canopy case, using eqs. (13.3) and (13.2).

154
CHAPTER 13. CLOSING ENERGY BALANCES
13.2.2
Sensible heat between leaves and the canopy air space
The sensible heat exchanged between the air of canopy layer j and the leaves within it (Hleaf,j; W · m−2) is
obtained using:
Hleaf,j =
c
X
i=1
LAIsunlit
i,j
· Hsunlit
i,j
+ LAIshade
i,j
· Hshade
i,j
(13.15)
where LAIsunlit
i,j
and LAIshade
i,j
are the leaf area index of sunlit and shade leaves of plant cohort i in layer j,
respectively (see eq. (9.8)). Hsunlit
i,j
and Hshade
i,j
are the sensible heat exchange between layer j and sunlit or
shade leaves of cohort i (Ma & Liu 2019):
Hsunlit
i,j
=
−2 · Cp · (T sunlit
leaf,i −Tair,j) · gHa,i,j
(13.16)
Hshade
i,j
=
−2 · Cp · (T shade
leaf,i −Tair,j) · gHa,i,j
(13.17)
where T sunlit
leaf,i and T shade
leaf,i are, respectively, the sunlit and shade leaf temperatures for cohort i (determined
using eq. (11.1)); Tair,j is the current air temperature in canopy layer j, Cp = 29.37152 J · mol−1 · žC−1 is
the specific heat capacity of dry air at constant pressure; and gHa,i,j is the leaf boundary layer conductance
for heat (mol · m−2 · s−1) for leaves of cohort i and wind speed in layer j (see eq. (11.3)).
13.2.3
Turbulent heat exchange
Turbulent heat exchanges occur between the soil and the bottom canopy layer (i.e. j = 1):
H1,soil = ρ1 · cp
r1,soil
· (Tair,1 −Tsoil,1)
(13.18)
where cp = 1013.86 Jůkg−1ůC−1 is the specific heat capacity of the air, ρ1 is the air density at j = 1, Tair,1
is the air temperature of layer 1, Tsoil,1 is the temperature of the top soil layer and r1,soil is the aerodynamic
resistance between the soil and canopy layer 1 (in sům−1).
The bottom layer also have turbulent heat
exchanges with the layer above, determined by the canopy turbulence model.
The turbulent heat flux
gradient for layer j = 1 is:
(δFH/δz)1 = −cp · ρ1 · (Tair,2 −Tair,1) · ¯
uw1
∆z · (δu/δz)1
−H1,soil
(13.19)
where ∆z is the size of vertical layers (in m); and (δu/δz)1 and ¯
uw1 are the wind speed gradient and Reynolds
stress at j = 1.
For all intermediate layers (i.e. 1 < j < l) we have turbulent exchanges with the neighboring layers j −1
and j + 1, which results in the following turbulent heat flux gradient:
(δFH/δz)j = −cp · ρj · (Tair,j+1 −Tair,j−1) · ¯
uwj
2 · ∆z · (δu/δz)j
(13.20)
And, finally, the topmost layer (i.e. j = l) has turbulent heat exchanges with the layer below l −1 and the
atmosphere, so that:
(δFH/δz)l = −cp · ρl · (Tatm −Tair,l−1) · ¯
uwl
2 · ∆z · (δu/δz)l
(13.21)
13.2.4
Canopy and soil temperature changes
Evaluation of the canopy layer energy balance equation (7.4) is done taking into account that sensible heat
exchange for a given layer j includes heat exchange with leaves (i.e. Hleaf,j) and the turbulent heat flux

13.2. MULTI-LAYER CANOPY
155
gradient (i.e. (δFH/δz)j), so that the variation of air temperature in layer j for a given time interval ∆tsubstep
is:
∆Tair,j = ∆tsubstep · Kabs,j + Lnet,j −LEj + Hleaf,j + (δFH/δz)j
TCj
(13.22)
where TCj is the thermal capacitance of canopy layer j (in J · m−2 · K−1), found analogously to TCcan (eq.
(13.7)):
TCj = TCLAI ·
0.8 · LAIj + 1.2 · (LAIphi
j
+ ·LAIdead
j
)
2
(13.23)
∆tsubstep is the time step for closing the energy balance, which has to be smaller than ∆tstep to avoid
numerical instabilities due to turbulent flow.
When simulating a multiple-layer energy balance, we have to replace Hcan,soil by H1,soil in the energy inflow
of soil layer 1: (13.9):
G0,1 = Ksoil + Lnet,soil + H1,soil −LEvap,soil
(13.24)
Soil temperature changes are estimated in the same way as for single-canopy energy balance, except that a
smaller temporal step is used:
∆Tsoil,s = ∆tsubstep · Gs−1,s −Gs,s+1
Csoil,s
(13.25)
13.2.5
Within-canopy changes in water vapor and CO2
Multi-layer canopy energy balance also entails the possibility of considering gradients of scalars such as
water vapor or CO2. Analogously to the turbulent heat exchange, wind turbulence leads to changes in
concentration of water vapor or CO2 within canopy layers. In addition, plant physiology also alters the
concentration of these gases through transpiration in photosynthesis. To model temporal changes in these
scalars for canopy layers, we first have to estimate CO2 concentration in mg · m−3 and H2O concentration
in kg · m−3 from Cair,j (ppm) and eair,j (kPa) using:
[CO2]j
=
0.409 · 44.01 · Cair,j
(13.26)
[H2O]j
=
0.622 · eair,j · ρj
Patm
(13.27)
The one-dimensional scalar flux balance for an homogeneous turbulent flow can be described by the following
conservation equations (Lai et al. 2000):
(δ[CO2]/δt)j
=
(δF[CO2]/δz)j + S[CO2],j
(13.28)
(δ[H2O]/δt)j
=
(δF[H2O]/δz)j + S[H2O],j
(13.29)
where (δF[CO2]/δz)j and (δF[H2O]/δz)j are the gradients of vertical flux of CO2 and H2O in layer j, re-
spectively; and S[H2O],j and S[CO2],j are the source strengths for [H2O] (in kg H2O · m−3 · s−1) and [CO2]
(in mg CO2 · m−3 · s−1) in layer j, respectively, which derive from transpiration (source of water) and
photosynthesis (sink of CO2):
S[H2O],j
=
(Inj,t/∆t) + Ej,t
∆z
(13.30)
S[CO2],j
=
−An,j,t
∆z
(13.31)
where Ej,t and An,j,t are the instantaneous transpiration and photosynthesis rates in layer j. The former
was already defined in eq. (13.14), whereas the latter (An,j,t; in mg CO2 · m−2 · s−1) is defined analogously:
An,j,t = 10−3 · 44.01 ·
c
X
i=1
Asunlit
n,i,t
· LAIsunlit
i,j
+ Ashade
n,i,t · LAIshade
i,j
(13.32)

156
CHAPTER 13. CLOSING ENERGY BALANCES
where Asunlit
n,i,t
and Ashade
n,i,t
are the instantaneous net photosynthesis rates (in µmol CO2 · m−2 · s−1) of sunlit
and shade leaves, respectively, of cohort i during time step t; and LAIsunlit
i,j
and LAIshade
i,j
are the leaf area
index of sunlit and shade leaves, respectively of cohort i in layer j (9.8). For the special case of the lowest
canopy layer, water vapor needs to include the evaporation from soil, i.e.:
S[H2O],1 = ((In1,t + Est)/∆t) + E1,t
∆z
(13.33)
For any layer 1 < j < l the gradients of vertical scalar fluxes are found using:
(δF[H2O]/δz)j = −cp · ρj · ([H2O]j+1 −[H2O]j−1) · ¯
uwj
2 · ∆z · (δu/δz)j
(13.34)
(δF[CO2]/δz)j = −cp · ρj · ([CO2]j+1 −[CO2]j−1) · ¯
uwj
2 · ∆z · (δu/δz)j
(13.35)
whereas for the bottom layer (j = 1) we have:
(δF[H2O]/δz)1 = −cp · ρ1 · ([H2O]2 −[H2O]1) · ¯
uw1
∆z · (δu/δz)1
(13.36)
(δF[CO2]/δz)1 = −cp · ρ1 · ([CO2]2 −[CO2]1) · ¯
uw1
∆z · (δu/δz)1
(13.37)
and for the top layer (j = l) we have:
(δF[H2O]/δz)l = −cp · ρl · ([H2O]atm −[H2O]l−1) · ¯
uwl
2 · ∆z · (δu/δz)l
(13.38)
(δF[CO2]/δz)l = −cp · ρj · ([CO2]atm −[CO2]l−1) · ¯
uwl
2 · ∆z · (δu/δz)l
(13.39)
Equation (13.29) is solved via discretization both in terms of space (vertical layers) and time, the latter
using ∆tsubstep as for the energy balance.

Chapter 14
Day-level results
In the preceeding chapters we detailed how the model performs canopy and soil energy balances for subdaily
time steps and how transpiration and photosynthesis values are determined for any given substep. This
chapter indicates how these are aggregated at the daily scale and how other day-level model outputs are
calculated.
14.1
Photosynthesis and transpiration
Cohort’s transpiration Tri,t (eq. (12.16)) are added across subdaily steps to yield daily transpiration (Tri,
in mm H2O):
Tri =
nt
X
t=1
Tri,t
(14.1)
An the same for water extraction Exi,s,t for each soil layer s (eq.(12.18)):
Exi,s =
nt
X
t=1
Exi,s,t
(14.2)
Exi,s are substracted from the water content of the corresponding soil layer, closing the soil water balance
of the day (eq. (7.1)).
Daily values of net carbon assimilation for plant cohorts are obtained similarly. An,i,t (eq. (12.20)) are added
across subdaily steps to obtain An,i, the daily net assimilation at the cohort level (in g Cům−2):
An,i =
nt
X
t=1
An,i,t
(14.3)
14.2
Plant water potentials and relative water contents
Because the model determines optimum transpiration for every subdaily time step, this leads to a daily
sequence of leaf water potential (Ψleaf,i,t), stem water potential (Ψstem,i,t), root crown water potential
(Ψrootcrown,i,t) and root surface water potential (Ψrootcrown,i,s,t) values for each plant cohort i (and soil
layer s in the last case). The model defines the following daily water potentials for every cohort i:
• Pre-dawn leaf water potential (Ψpd,i): the maximum of Ψleaf,i,t values.
• Pre-dawn shade leaf water potential (Ψshade
pd,i ): the maximum of Ψshade
leaf,i,t values.
157

158
CHAPTER 14. DAY-LEVEL RESULTS
• Pre-dawn sunlit leaf water potential (Ψsunlit
pd,i
): the maximum of Ψsunlit
leaf,i,t values.
• Mid-day leaf water potential (Ψmd,i): the minimum of Ψleaf,i,t values.
• Mid-day shade leaf water potential (Ψshade
md,i ): the minimum of Ψshade
leaf,i,t values.
• Mid-day sunlit leaf water potential (Ψsunlit
md,i ): the minimum of Ψsunlit
leaf,i,t values.
• Stem water potential (Ψstem,i): the minimum of Ψstem,i,t values.
• Root-crown water potential (Ψrootcrown,i): the minimum of Ψrootcrown,i,t values.
• Root surface water potentials (Ψrootsurf,i,s): the minimum of Ψrootsurf,i,s,t values for each soil layer s.
Analogously, relative water content of stems and leaves is known for every subdaily time step, which results in
a daily sequence of leaf relative water content (RWCleaf,i,t) and stem relative water content (RWCstem,i,t).
These are summarized at the daily level for each plant cohort i:
• Leaf relative water content (RWCleaf,i): the mean RWCleaf,i,t values.
• Stem relative water content (RWCstem,i): the mean of RWCstem,i,t values.
Finally, the daily sequence of slopes of the supply function (dE/dΨi,t) is also averaged at the daily level:
• Slope of the supply function (dE/dΨi): the mean dE/dΨi,t values.
14.3
Plant drought stress
In order to have an estimate of daily drought stress for the plant cohort, the model uses the stem vulnerability
curve of the plant to find the conductance relative to maximum stem conductance and turns it into its
complement:
DDSi = ϕi ·

1.0 −kstem,i(Ψrootcrown,i)
kmax stem,i

= ϕi ·

1.0 −e−(Ψrootcrown,i/dstem)cstem
(14.4)
where ϕi is the leaf phenological status. Note the use of Ψrootcrown,i (and not Ψleaf,i) to determine drought
stress index.
Thus the model tracks the degree of conductance decrease at the beginning of the stem
as a measure of drought stress. This choice makes daily drought stress values of the Simple and Complex
transpiration modes more comparable (because leaf mid-day water potentials are usually much more negative
than soil water potentials) and is a sensible choice if one wants to run the model in irreversible cavitation
mode (see below).

Part IV
Forest growth modelling
159


Chapter 15
Forest growth model
This chapter provides an overview of a forest growth model, which builds on the previous two models and
allows simulating carbon and water balance as well as growth and mortality on a daily step basis for a given
forest stand and for the period corresponding to input weather data. The model was described in De Cáceres
et al. (2023) and is run using function growth(), for a set of days, or function growth_day(), for a single
day.
The forest growth model can be run in two different levels of complexity, depending on the water balance
submodel employed (basic and advanced, corresponding to chapters 3 and 7). In this and the following
chapters, we indicate those design and formulation elements where the forest growth model building on the
basic water balance differs from that building on the advanced one.
The information provided in the current chapter should be enough to understand what the growth model
does, but the reading previous chapters and the following ones should provide a more detailed understanding
on how the different processes are designed and formulated.
15.1
Design principles
15.1.1
Overview
Like in the preceding models, the physical structure of the stand is represented in one (vertical) dimension
(i.e. the horizontal coordinates of plants are not explicit). The model is cohort-based, meaning that similar
plant individuals are represented using a single entity with average characteristics (e.g. tree height and
diameter at breast height) and a density variable is used to scale from individual level to the cohort level.
Processes are modelled either at the cohort level (water balance, photosynthesis, or plant mortality) or
at the “average” individual level (carbon balance, tissue growth and senescence). Water fluxes, soil water
balance and plant photosynthesis processes follow the design of the soil water balance model and will not be
repeated here (see chapters 3 and 7). The growth model tries to reproduce the physical and physiological
processes that modulate leaf area changes, sapwood area changes and fine root area changes (the latter only
under the advanced water balance submodel), while accounting for both source and sink limitations to tissue
growth. Formation of new sapwood leads to diameter and height increases, so that physiological processes
involve structural changes. Since the model does not implement all processes and drivers (such as nutrient
availability) potentially affecting growth, user input parameters are used to empirically constrain growth
rates and plant size, i.e. maximum relative sapwood area growth rates, maximum plant height and diameter-
height ratios. The forest growth model also implements tree mortality, which reduces cohort density, arising
from different processes. A baseline mortality rate is incremented either because of exhaustion of carbon
reserves (i.e. plant starvation) or dehydration of plant tissues (i.e. plant desiccation).
Additionally, fire
behavior and effects (i.e. fire severity) can be simulated. Fires can partially or totally burn crown leaves and
buds. Fire heat can also induce necrosis in the cambium, leading to full above-ground mortality.
161

162
CHAPTER 15. FOREST GROWTH MODEL
15.1.2
Carbon compartments, transport and carbon balance
Three carbon compartments are considered separately: leaves, sapwood (including stem, branches and
coarse roots) and fine roots. Each compartments has one or more carbon pools where carbon is in different
form.
Carbon pools are differentiated between structural and labile.
In turn, labile carbon involves
metabolic and storage (Richardson et al. 2013; Dietze et al. 2014), with a conversion rate regulated by
the need to maintain, as much as possible, an equilibrium in the amount of metabolic carbon to sustain
cell metabolism and for osmotic purposes. Similar designs of two non-structural carbon compartments have
been implemented in other forest ecosystem models (Cho et al. 2022).
Details of the carbon pools in different compartments are as follows (Fig. 15.1):
• Structural carbon corresponds carbon forming cell membranes, cell walls and the cytosolic machinery
(in the case of living cells).
The amount of structural carbon in a given compartment is used to
determine maintenance respiration costs (together with labile carbon), and the structural carbon per
tissue unit determines growth respiration costs. Structural carbon occurs in the three compartments,
leaves, sapwood and fine roots, which however have different maintenance and growth costs. Sapwood
carbon includes branches, stem and coarse roots. Only live (parenchymatic) sapwood cells, accounting
for between 5 and 40% of sapwood volume (Plavcová & Jansen 2015), contribute to estimate sapwood
maintenance respiration costs. The fraction of embolized sapwood is also discounted from sapwood
respiratory biomass. Structural carbon is lost via tissue senescence (in the case of sapwood due to
conversion to heartwood).
• Metabolic carbon is a labile carbon form assumed to correspond to sugars (e.g., glucose or fructose)
used to sustain cell functioning (i.e. provide carbon for maintenance respiration). Moreover, changes
in metabolic carbon are coupled to variations in osmotic potential. Metabolic carbon occurs in leaves
and sapwood compartments only.
Leaf metabolic carbon is generated from photosynthesis or leaf
starch degradation and used in different functions, including leaf maintenance respiration and export
to sapwood via phloem transport.
An excess of leaf metabolic carbon can inhibit photosynthesis.
Sugar concentration in the phloem is assumed to be (passively) in equilibrium with leaf metabolic
sugar concentration.
Sapwood metabolic carbon comes from phloem transport, or sapwood starch
degradation, and is used to directly sustain maintenance respiration of sapwood and fine roots.
• Storage carbon is a labile carbon form assumed to loosely correspond to starch. Leaf storage carbon
is intended to represent short-term storage (mainly starch within chloroplasts) and its inclusion in the
model follows the need to buffer daily variations in leaf metabolic carbon as well as in the corresponding
leaf osmotic potential. Sapwood storage carbon in parenchymatic tissues of branches, stems and coarse
roots conforms a much larger carbon pool and is intended to serve as carbon source for growth and
long-term (seasonal and inter-annual) storage (Plavcová & Jansen 2015).
Different processes contribute to the carbon balance of structural and labile compartments:
• Carbon balance of labile carbon pools is performed by considering photosynthesis, maintenance
respiration , growth costs, sugar-starch conversion, root exudation and phloem transport.
Photosynthesis estimates come from the water balance submodel. Respiration is modelled following the
growth-maintenance paradigm, but we acknowledge that such approach has limitations and that others
have been proposed such as assuming a constant carbon use efficiency or the process/residual approach
(Cannell & Thornley 2000; Gifford 2003). Maintenance respiration demand of leaves and sapwood
depends on both structural and metabolic carbon, whereas only structural carbon counts for fine root
maintenance respiration because they lack labile carbon pools. Maintenance respiration of leaves and
fine roots can be species-specific rates, but can also be estimated from species-specific values of nitrogen
concentration (Reich et al. 2008). In contrast, the species-specific maintenance respiration per sapwood
unit mass (in fact, only parenchymatic tissues contribute to sapwood respiration) is not estimated from
nitrogen concentration and should be calibrated. In all three cases, however, temperature dependencies
are included in the actual respiration rates(Tjoelker et al. 2001). Growth costs include the carbon cost
of building new structures as well as the respiration expenses of growth. Sugar-starch conversion is

15.1. DESIGN PRINCIPLES
163
Figure 15.1: Schematic representation of carbon compartments, carbon pools and carbon balance components
(translocation of reserves during senescence not included)

164
CHAPTER 15. FOREST GROWTH MODEL
designed to maintain an equilibrium in the concentration of metabolic sugar. Any surplus in sapwood
storage carbon over storage capacity is assumed to be diverted towards root exudation. Hence, root
exudation is not modeled as a process actively competing for metabolic carbon, but as a consequence
of plant C storage capacity being surpassed (Prescott et al. 2020).
• Biomass balance in structural pools comes from the interplay between growth (i.e. new tissue
formation) and senescence (see below).
Structural growth rates are lower than growth costs for
labile pools, since growth costs also include growth respiration expenses. During leaf senescence it
is assumed that non-structural carbon sources (i.e. labile carbon pools) are recycled and relocated
to sapwood storage. Analogously, when sapwood is converted into heartwood, labile carbon in the
protoplasm of parenchyma cells is assumed to be re-absorbed by neighboring living cells as storage
(Spicer 2005).
Further design details and formulation regarding the estimation of carbon pool sizes and carbon balance
components are given in chapter 16.
15.1.3
Tissue growth, senescence and allocation
The forest growth model allows simulating the variation of leaf area, sapwood area and fine root area via
the following processes (see fig. 15.2):
i. Leaf growth: Whereas in the water balance models expanded leaf area corresponded to the portion
of live leaf area that was unfolded according to the phenological status (see 4.1), in the growth model
expanded leaf area results from explicit simulation of growth. However, leaf phenology submodel still
controls the duration of phenophases corresponding budburst, leaf development and senescence. Leaf
area growth occurs during leaf unfolding periods only, whereas bud formation periods are required to
update the target leaf area (in accordance to an allocation strategy, see below). Storage carbon levels
need to be at more than 10% of their capacity to allow leaf growth. Moreover, leaf area target is
constrained by stand structure (i.e. competition) via allometric equations.
ii. Leaf senescence: Leaf senescence (and the corresponding increases in dead leaf area) can occur in the
model due to leaf aging in evergreen species, due to programmed leaf senescence in deciduous species,
or due to leaf dessication (as a result of xylem cavitation and/or low leaf relative water content).
In addition, fires can induce foliage burning, which also leads to a decrease in leaf area (but where
non-structural carbon reallocation is not possible and dead leaf area does not increase).
iii. Sapwood growth: Formation of new sapwood can only occur if unfolded leaves are present, assuming
that hormonal signals controlling cambium division are mainly synthesized within leaves. Sapwood
formation corresponds mostly to secondary growth (but primary growth occurs at the same time due
to diameter-height relationships), and is only allowed if storage carbon levels are above a given species-
specific threshold (e.g. 50%). These levels are much higher than required for leaf or fine root growth.
Thus, when carbon levels are low, sapwood growth rates fall to zero, whereas replacement of leaves and
fine roots continues to sustain metabolism. This design was chosen to stop sapwood growth much before
emptying storage carbon reserves, so that maintenance respiration can be sustained longer whenever
photosynthesis is low, as in shadow-tolerant species.
iv. Sapwood senescence: Losses in sapwood area (i.e. conversion to heartwood) occur via tissue aging
(i.e. assuming a daily rate of conversion). Similarly to 3-PG (Landsberg & Waring 1997) we assume
that the relative turnover rate of sapwood is smallest for young plants, and it increases up to a
maximum value. However, recent reviews indicate that heartwood formation should be viewed as an
active developmental program during which a conductive but vulnerable sapwood is transformed in a
non-conductive but durable heartwood (Spicer 2005). Tree sapwood senescence also occurs whenever
the sapwood area exceeds the amount required to sustain the current leaf area target. Note that stem
cavitation reduces the area of sapwood that is effectively functional for water transport, but does not
lead to sapwood senescence per se.
v. Fine root growth: Fine root growth can in principle occur any time of the year (i.e. the model
does not explicitly consider root phenology), but since fine root biomass targets depend on leaf area,

15.1. DESIGN PRINCIPLES
165
seasonal fine root area patterns may follow phenological changes in leaf area. Like in leaf growth,
storage carbon levels need to be at more than 10% of their capacity to allow fine root growth.
vi. Fine root senescence: Fine root senescence occurs via aging with a turnover rate depending on soil
temperature.
Figure 15.2: Schematic representation of tissue growth and senescence drivers for trees
Formation of new leaf, sapwood and fine root tissues is determined taking into account both source (i.e. car-
bon availability) and sink (i.e. biophysical constraints on plant tissue expansion) limitations (Fatichi et al.
2014; Guillemot et al. 2015; Körner 2015). Temperature and turgor sink limitations are implemented fol-
lowing Cabon et al. (2020a) and Cabon et al. (2020b). These authors developed their approach for tracheid
production and enlargement only, whereas we apply it to different kinds of tissues. In the case of fine roots,
differences in soil water potential between layers can lead to different degrees of turgor limitation for the
growth of fine roots, resulting in adaptation of fine root distribution.
The growth rates in all three compartments are modulated by parameters specifying maximum daily growth
rates relative to the amount of sapwood area. Nevertheless, tree leaf area and fine root biomass targets are
constrained by leaf biomass allometric equations, which limits leaf and fine root growth to the replacement
of aging tissues, unless there are changes in forest structure, i.e. competition is released or the target tree
increases in diameter (see fig. 15.2). In contrast, the sapwood area target modulates sapwood senescence
(i.e. the conversion to heartwood), but not sapwood growth. Sapwood growth rates are mainly determined by
maximum relative growth rates (which can be parameterized with empirical observations), carbon availability
and sink limitations. Since sapwood formation leads to tree diameter increases, maximum sapwood growth
rate indirectly determine the rate of growth of leaves and fine roots at seasonal and annual scales, hence
determining the whole-plant maximum growth rate.
Two options are possible regarding the relationship between structural carbon of leaves and sapwood:
1. Stable Huber value: In this strategy, growth of leaf area and sapwood area need are coordinated so that
the ratio of sapwood area to leaf area (i.e. Huber value) is in dynamic equilibrium around its initial

166
CHAPTER 15. FOREST GROWTH MODEL
value. To this aim, sapwood senescence is scheduled whenever the current Huber value is larger than
the target (i.e. there is an excess of sapwood area). This approach is similar to the LPG model (Sitch
et al. 2003), where different turnover rates are applied for different tissues, but then the model tries to
satisfy the pipe model (Shinozaki et al. 1964) by allocating C where it is more limiting. Note that in
this strategy the whole-plant conductance will progressively decrease with the increase in plant height,
because of the increase in the length of stem xylem pathway.
2. Stable whole-plant conductance: Ratios of sapwood area to leaf area (i.e. Huber values) can vary within
species, due to environmental conditions (Mencuccini & Grace 1995).
In this allocation strategy,
growth of leaf area, sapwood area and height needs to be coordinated so that whole-plant conductance
(i.e. from roots to leaves) is in dynamic equilibrium around its initial value. Sapwood senescence is
scheduled whenever the current whole-plant conductance is above the target value. In this strategy,
the Huber value will tend to increase with the increase in plant height, thereby increasing the sapwood
respiratory demands.
When running the growth model along with the basic water balance submodel, a stable Huber value is the
only strategy available and fine root area growth also follows the need to achieve a stable ratio between leaf
area and fine root area. In contrast, the two strategies are possible when simulating growth along with the
advanced water balance. In this case, fine root area growth is coordinated with the formation of the other
tissues via the need to ensure an average resistance fraction in the rhizosphere, which is used to define the
fine root area target and, hence, the allocation to fine roots.
Further details and formulation of growth, senescence and allocation are given in chapter 17.
15.1.4
Coordination between water and carbon balances
The growth model allows coordinating several aspects of carbon and water balances through different state
variables (Fig. 15.3), most of them applying to the simulation using the advanced transpiration model:
a. Transpiration and photosynthesis are coordinated via the stomatal regulation submodel (see chapter
11).
b. Hydrostatic water potential of leaf symplastic tissues influences the turgor pressure necessary for leaf
growth (17.1.2), while (metabolic) leaf sugar concentration determines changes in osmotic potential at
full turgor and hence, the relative water content of leaf symplasmic tissue.
c. Analogously, water potential of stem symplastic tissues determines the turgor in the cambium and the
sapwood formation rate (17.1.3), while the sugar concentration in the sapwood determines the osmotic
potential at full turgor of stem symplastic tissues and its relative water content.
d. Leaf growth and senescence influence hydraulic conductances of several tissues (fine roots, coarse root
sapwood and stem sapwood), as they are defined on a leaf area basis (17.3.1).
e. Sapwood growth and senescence influence hydraulic conductance of stems via changes in sapwood area,
and indirectly those of coarse roots and the rhizosphere (17.3.1).
f. Fine root biomass dynamics determines fine root distribution and rhizosphere conductance across soil
layers (17.3.1).
15.1.5
Plant mortality
Mortality pathways
Dynamic vegetation models implement mortality processes in very different ways, from purely-empirical to
process-based (Hawkes 2000; Keane et al. 2001; Bugmann et al. 2019). The fact that proximal causes
of mortality are complex, co-occurring, interrelated and variable has prompted the question of whether a
mechanistic approach will improve prediction ability (Adams et al. 2013). In medfate, (above-ground parts
of) woody plants can die following a combination of empirical and process-based approaches:

15.1. DESIGN PRINCIPLES
167
Hydraulics
Carbon
Transpiration
Photosynthesis
Leaf growth and 
senescence
Leaf water 
potential
Stomatal 
conductance
Leaf metabolic 
carbon
Leaf area
Stem 
conductance
Sapwood growth 
and senescence
Sapwood area
Sapwood metabolic 
carbon
Stem water 
potential
Leaf turgor
Leaf osmotic 
potential
Sapwood osmotic 
potential
Fine root growth 
and senescence
Communication variable
Floem 
transport
Leaf storage
Sapwood 
storage
Cambium turgor
Fine root 
conductance 
and distribution
Fine root biomass and 
distribution
Figure 15.3: Schematic representation of relationships between water balance (advanced model) and carbon
balance. Relationships within water or carbon balances have been omitted

168
CHAPTER 15. FOREST GROWTH MODEL
1. Trees with DBH < 7.5 cm (i.e. saplings) are assumed to suffer mortality due to a self-thinning process
of unspecified cause. Specifically, the model represents the self-thinning process occurring between
small trees (e.g. 1 cm DBH) resulting from seed establishment (or resprouting) and trees achieving
the size (e.g. 7.5 cm) corresponding to inclusion as individual in forest inventories (e.g. ingrowth size).
Although implemented here, this self-thinning process is most relevant for simulations of mid- and
long-term forest dynamics (see 18).
2. All woody cohorts are assumed to die at a basal rate due to processes not included in the model
(e.g. biotic attacks). This rate is empirically determined and can be a constant value or, in the case
of trees, can depend on the degree of competition (i.e. basal area). This latter option is important to
ensure a limit in stand basal area, which may not occur as a result of mechanistic mortality processes.
3. Mortality rates can be higher than the basal rates whenever physiological thresholds presumed to lead
to plant mortality are surpassed (Hawkes 2000). The model allows plants to die from either starvation
(if metabolic carbon is exhausted) or dessication (tissue dehydration) (McDowell et al. 2008; McDowell
2011). Allowing for starvation is important to simulate death due to shading by other plant cohorts,
whereas plant dessication is important to represent situations of low soil water availability.
With respect to intra-cohort variability, the model can be run assuming that all individuals within plant
cohorts are functionally equal, so that mortality applies to the entire plant cohort. Alternatively, mortality
can be applied to a fraction of the plant cohort, in proportion to the mortality likelihood, which implicitly
acknowledges intra-cohort differences. As common in other models, mortality process can be simulated in a
deterministic or stochastic fashion.
Physiological underpinnings of drought-related mortality
Multiple mechanisms determine plant survival or mortality under drought (McDowell et al. 2008; McDowell
et al. 2022). However, hydraulic failure is widely recognized as one of the key mechanisms of drought-induced
mortality in woody plants. Lethal water potential have been defined as a critical threshold beyond which
trees are unable to recover from drought, even after rewatering. Experimental work by Urli et al. (2013)
determined that irreversible damage in angiosperm saplings occurred only after 88% losses in stem hydraulic
conductance. Similarly, Hammond et al. (2019) found probability of mortality to strongly increase beyond
80% of loss in hydraulic conductivity in saplings a gymnosperm species. In a multi-species synthesis, Adams
et al. (2017) assessed found that all studied species showed at least 60% or higher loss of xylem hydraulic
conductivity, whereas evidence for carbon starvation was more common for gymnosperms. While loss of
hydraulic function seems ubiquitous in drought-related mortality, not all researchers agree that hydraulic
failure be the primary cause of mortality. Körner (2019) argued that hydraulic failure often correlates with
a critical degree of tree dehydration and that the disruption of capillary continuum from soil to the root
because of soil dehydration is more important because it forces trees to drop their leaves and rely on their
own water reserves. Trees will die when the symplast surpasses its dehydration tolerance, and Körner (2019)
considers xylem embolism as a byproduct rather than the cause of critical tree dehydration under severe
drought, so that mechanistic models should focus on the dehydration process. Other authors have stressed
the importance of the interplay between water reserves and water loss rates through cuticule after stomatal
closure (Blackman et al. 2016; Martin-StPaul et al. 2017). Regardless of causality, loss of hydraulic function
could still be a good indicator of mortality likelihood. However, recently Martinez-Vilalta et al. (2019)
suggested use the relative water content as an indicator of mortality risk, as it integrates several aspects
related to hydraulics, stomatal responses and carbon economy during drought.
Starvation thresholds
We use the amount of metabolic sugar in the stem as indicator of carbon starvation. Martínez-Vilalta et al.
(2016) found that plants can have very distinct amounts of non-structural carbon concentration but minimum
seasonal values are around 46% of maximum values. Accordingly, we define the indicator of starvation in
relative terms (see control variable mortalityRelativeSugarThreshold, set to 30% by default) with respect
to the stem equilibrium sugar concentration.
Dessication thresholds
Following Martinez-Vilalta et al. (2019), we primarily use the relative water content (RWC) in the stem
symplastic tissues as the stress variable increasing dessication likelihood under drought. Whereas the stem

15.1. DESIGN PRINCIPLES
169
symplastic pressure-volume curve is always used to determine RWC from the stem water potential, in
the basic water balance model the latter is assumed to be equal to the estimated plant water potential
(i.e. Ψsym,stem = Ψplant; see 6.2.1). Moreover, in the advanced water balance model there is no distinction
between stem apoplastic and symplastic (i.e. parenchymatic) water potentials (i.e. Ψsym,stem = Ψapo,stem)
unless plant water compartments are explicitly simulated.
Using stem relative water content as indicator of dessication has the inconvenient, however, that the parame-
ters π0,stem and ϵstem specifying the stem pressure-volume curve are often not known, so that estimates have
to come from its covariation with other traits (here wood density, see @ref{inputationPV}). The uncertainty
coming from this parameterization issue can be avoided if one combines the use of RWC with the loss of
xylem hydraulic conductivity, since parameters of the hydraulic vulnerability curve are much more frequently
available. For this reason, we use the maximum of stem relative water content and relative xylem
hydraulic conductance as the drought stress variable to determine dessication.
The critical threshold for dessication is specified in the control variable mortalityRWCThreshold, set to
40% by default. Note that most studies focus on leaf RWC, for which Kursar et al. (2009) indicate ranges
between 16% and 61%, and Körner (2019) advocates for values around 50%.
Details of the implementation of plant mortality are given in section 17.4.
15.1.6
Fire occurrence and severity
The occurrence of fires is represented in the growth model in a forcing variable that describes the daily
probability that a wildfire strikes the stand. Whenever a fire occurs, the model first simulates fire behavior
according to the conditions of the stand (see chapter 24) and then fire severity is evaluated.
The degree to which vegetation is impacted by fire depends on the heat fluxes incident on plant tissues and
organs, which is an outcome of various fire behavior variables (such as fireline intensity and residence time)
and the position of plant organs in the stand, and the physiological responses triggered thereafter. Fire
effects on plants can be classified as two types: first- and second-order effects (Hood et al. 2018; Bär et
al. 2019). First-order effects comprise the immediate impacts of heat transfer on plant tissues. Nonlethal
first-order heat injuries can trigger second-order effects, such as physiological limitations in carbon and water
relations or increased susceptibility to insect attacks and pathogenic infections. The growth model currently
deals with first-order effects only. Moreover, the model focuses on effects in above-ground tissues (leaves,
buds and cambium), disregarding fire effects on below-ground structures such as seed banks, or below-ground
meristems, which are also important for the resilience of ecosystems (Stephan et al. 2010).
Fire-induced plant injury and mortality models can be grouped into two categories: (1) statistical models that
involve regression equations relating injury and mortality to observable indicators; and (2) process models
that explicitly simulate the underlying thermal and biophysical processes occurring when a plant is heated
(Butler & Dickinson 2010; Hood et al. 2018). The design of first-order fire effects on vegetation follows,
with some modifications, the process-based model proposed by Michaletz & Johnson (2008) for surface fires,
and it is outlined in fig. 15.3. The surface fire behavior variables required for severity evaluation are the
residence time and fireline intensity. With them, the model estimates the air temperature gradient of the
plume, which is then compared to the distribution of foliage for the determination of the proportion of the
crown foliage and crown buds that die due to heat accumulation. In addition, the model determines the
effects on the cambium by estimating the radial necrosis depth and comparing it with bark thickness. If
enough heat reaches the cambium, the tree is considered girdled, which leads to above-ground mortality.
Otherwise, the degree of crown bud necrosis will determine whether the plant can resprout from the crown
(and rebuild the leaf area lost) or not.
Crown fires will be considered to impact the forest stand whenever surface fireline intensity is larger than
the critical value considered necessary for crowing (Scott & Reinhardt 2002). Crown fires are considered to
burn for all plant cohorts, 100% of crown foliage and, most likely, 100% of crown buds (although very fast
crown fires could spare buds if sufficiently protected, (Michaletz & Johnson 2008)). When crown fires do not
occur at the stand level, torching may still occur for particular plant cohorts depending on its crown base
height, with the same effects.

170
CHAPTER 15. FOREST GROWTH MODEL
If 100% of crown buds have died but the cambium is alive and the species has dormant buds beneath the bark,
then the plant has suffered crown kill but it can resprout epicormically without losing height (Hood et al.
2018). If the cambium is dead, however, all above-ground plant organs will be considered dead (i.e. topkill;
Hood et al. (2018)). At this point, the plant may still exhibit basal resprouting from the root crown or
below-ground meristems, but is dealt in the forest dynamics model (see chapter 18).
Figure 15.4: Schematic representation of the design of fire effects on foliage, buds and cambium.
While the severity sub-model described above is based on heat transfer and accumulation in tissues, causing
necrosis, it is important to note that a growing number of studies increasingly have been documenting fire
impacts on xylem hydraulic function, both via increased vapor pressure deficit (causing cavitation) and via
structural damage in the xylem, affecting its efficiency and vulnerability (Hood et al. 2018; Bär et al. 2019).
These first-order effects are not considered here.
Details of the implementation of fire severity are given in section 17.5.
15.1.7
Tree diameter, tree height and shrub cover updates
Tree diameter increment follows the creation of sapwood area, whereas sapwood area decreases do not affect
diameter, as they imply conversion to heartwood.
Tree height increments are estimated from diameter
increments following diameter-height ratios that are modulated by the proportion of light available to the
plant cohort, as frequently done in forest gap models (Lindner et al. 1997). Tree crown ratios are updated

15.2. STATE VARIABLES
171
using static allometric relationships, whereas shrub height and cover are estimated from new leaf area values
by inverting static leaf biomass allometries.
Further details and formulation of structural update are given in chapter 17.6.
15.2
State variables
Many state variables are inherited by the corresponding water balance model and depend on its level of
complexity (see 3.2 and 7.3). Several cohort-level state variables were treated as fixed parameters in the
water balance models. For each plant cohort:
• Leaf area index of live leaves, LAIlive, and the actual expanded leaf area, LAIϕ.
• Diameter at breast height for trees, DBH (cohort average).
• Percent cover of shrubs, Cover.
• Density of individuals in the plant cohort, N.
• Plant height, H (cohort average).
• Crown ratio, CR.
• The proportion of fine roots, FRPs, in each soil layer s.
• The radial length of coarse roots Lradial,s in each soil layer s.
Additional individual-level state variables are needed in growth model simulations:
• Leaf area, LA (m2), and target leaf area, LAtarget (m2).
• Sapwood area, SA (cm2), and target sapwood area, SAtarget (cm2).
• The percentage of the crown with active buds (PCAB).
• Fine root biomass, Bfineroot,s (g dry), and the target fine root biomass, Bfineroot,target,s (g dry), in
each soil layer s.
• Sugar concentration in leaves, SSleaf (mol gluc · L−1).
• Starch concentration in leaves, STleaf (mol gluc · L−1).
• Sugar concentration in sapwood (stem, branches and coarse roots), SSsapwood (mol gluc · L−1).
• Starch concentration in sapwood (stem, branches and coarse roots), STsapwood (mol gluc · L−1).
Note that LA is the same state variable as LAIϕ, but expressed at the individual level, and the same occurs
between LAtarget and LAIlive. These pairs of state variables are related by cohort density (N).
Other functional variables can be derived from the true state variables and, hence, hence do not need to be
treated as state variables themselves but are often used in equations instead of the true state variables:
• Leaf biomass (Bleaf;in g dry) from LA.
• Sapwood biomass (Bsapwood; in g dry) from SA, H and FRPs and Lradial,s.
• Leaf storage volume (Vstorage,leaf; in L) from Bleaf.
• Sapwood storage volume (Vstorage,sapwood; in L) from SA, H and FRPs and Lradial,s.
• Fine root area (FRAs; in m2) in each soil layer s, from Bfineroot,s.
Some belowground variables (such as the radial length of coarse roots) are only considered dynamic when
simulating growth with advance water balance.
15.3
Mass and energy balances
15.3.1
Water and energy balance
Since the growth model builds on soil and plant water balance models, the water and energy balances
explained in sections 3.3 or 7.4 (depending on transpirationMode) also hold for this model.

172
CHAPTER 15. FOREST GROWTH MODEL
15.3.2
Labile carbon balance
The model performs daily carbon balance of labile carbon in leaves and sapwood (stem, branches and coarse
roots) for each plant cohort. In each of these two compartments carbon balance is performed for the two labile
carbon forms, dissolved sugars (i.e. metabolic carbon) and starch (i.e. storage carbon). In the following all
carbon flows (i.e. the components of right hand side of equations) are assumed to be in units of g gluc·day−1.
At the leaf level, the carbon balance equations for dissolved sugars and starch are (i subscripts omitted):
∆SSleaf · Vstorage,leaf
=
A −Mleaf −Fphloem −SCleaf −TSleaf
(15.1)
∆STleaf · Vstorage,leaf
=
SCleaf −TTleaf
(15.2)
where A is (gross) photosynthesis, Mleaf is leaf maintenance respiration, Fphloem is the sugar flow via phloem
towards the stem and roots, SCleaf is the conversion from leaf sugar to leaf starch, TSleaf and TTleaf are
the translocation of leaf sugars and starch into sapwood storage, respectively, during leaf senescence (see
(15.6) below) or if leaf storage capacity is surpassed.
The corresponding carbon balance equations for sapwood dissolved sugars and starch are:
∆SSsapwood · Vstorage,sapwood
=
Fphloem −Msapwood −Mfineroot
(15.3)
−SCsapwood −TSsapwood
(15.4)
∆STsapwood · Vstorage,sapwood
=
SCsapwood + TSleaf + TTleaf + TSsapwood
(15.5)
−Gsapwood −Gleaf −Gfineroot −REsapwood
(15.6)
where Fphloem is the sugar inflow via phloem transport, Msapwood is the sum of maintenance respiration of
branches, stem and coarse roots, Mfineroot is the maintenance respiration of fine roots, Gleaf, Gsapwood and
Gfineroot are the carbon costs of forming new leaves, sapwood or fine roots (respectively), SCsapwood is the
conversion of sapwood sugar to sapwood starch, TSsapwood is the translocation of sapwood sugars into starch
during leaf senescence and REsapwood is the root exudation of sapwood carbon.
If we define Slabile as the total amount of labile carbon in the plant (in g gluc):
Slabile = (SSleaf + STleaf) · Vstorage,leaf + (SSsapwood + STsapwood) · Vstorage,sapwood
(15.7)
then labile carbon balance at the plant level reduces to:
∆Slabile = A −M −G −RE
(15.8)
where M = Mleaf + Msapwood + Mfineroot is plant-level maintenance respiration, G = Gleaf + Gsapwood +
Gfineroot is plant-level growth costs and RE = REsapwood is plant-level root exudation.
15.3.3
Biomass balance
In addition to changes in labile carbon pools, the model also implements changes in the size of carbon
compartments (leaves, sapwood and fine roots), as a result of the interplay between growth and senescence
processes. Hence, we can define the following structural equations:
∆Bleaves
=
Bleaves,growth −Bleaves,senescence
(15.9)
∆Bsapwood
=
Bsapwood,growth −Bsapwood,senescence
(15.10)
∆Bfineroot
=
Bfineroot,growth −Bfineroot,senescence
(15.11)
where all variables would be in units of g dry · day−1. And the following equation defines the structural
biomass balance at the plant level:
∆Bstructure = ∆Bleaves + ∆Bsapwood + ∆Bfineroot
(15.12)

15.4. PROCESS SCHEDULING
173
The biomass balance at the individual level is completed if we add the labile biomass balance to the
structural biomass balance:
∆Bplant = ∆Bstructure + ∆Slabile
(15.13)
At the cohort level, however, we need to take into account that some individuals will die, so that the
biomass balance needs to incorporate mortality losses:
∆Bcohort = ∆Bplant · Ncohort −Bmortality
(15.14)
where Ncohort is the initial cohort density (before mortality occurred) and Bmortality is the biomass loss due
to mortality of individuals, which in order to close the balance has to be defined as:
Bmortality = (Bplant + ∆Bplant) · Ndead
(15.15)
where Ndead is the density of dead individuals and Bplant is the initial plant biomass.
15.3.4
Stand-level carbon balance
With the aim to produce outputs to be compared with Eddy-covariance flux data, the model produces
aggregates of gross photosynthesis and respiration at the stand level, all expressed using units of g C · m−2.
• Gross primary production (GPP) is the sum of gross photosynthesis across plant cohorts.
• Maintenance respiration is the sum across cohorts of the carbon emitted to the atmosphere as a result
of maintenance respiration, i.e. M.
• Synthesis respiration is the sum across cohorts of the carbon returned to the atmosphere as a result
of the process of synthesizing new structures. Note that this is less than G, as it does not include the
carbon allocated to the new structures.
• Net primary production (NPP) is GPP minus the maintenance and synthesis respiration terms.
15.4
Process scheduling
Growth simulations are conducted in daily time steps. If using the basic water balance sub-model, processes
are scheduled following the regular scheduling. In contrast, if using the advanced water balance model, the
growth processes can be simulated using a detailed scheduling.
15.4.1
Regular scheduling
For every day to be simulated, first executes soil water balance, transpiration and photosynthesis calculations
by calling the basic water balance model (3.4). After that, the model performs the following steps for each
plant cohort:
1. Determine the amount of live structural biomass (in leaves, sapwood and fine root compartments),
storage volume (in leaves and sapwood) and storage capacity (16.1).
2. Calculate gross photosynthesis per individual (A), maintenance respiration for leaves (Mleaf), sapwood
(Msapwood) and fine roots (Mfineroot) (16.2).
3. If phenology indicates leaf unfolding, evaluate leaf temperature and turgor sink limitations, growth
costs (Gleaf) and leaf area increase (17.1.2).
4. If sapwood growth is permitted, evaluate sapwood temperature and turgor sink limitations, growth
costs (Gsapwood) and sapwood area increase (17.1.3).
5. Evaluate fineroot temperature and turgor sink limitations, growth costs (Gfineroot) and fineroot
biomass increase (17.1.4).

174
CHAPTER 15. FOREST GROWTH MODEL
6. Update changes in sugar and starch compartments due to photosynthesis, maintenance respiration
and growth. Apply transfer from leaf metabolic to sapwood metabolic carbon (16.2.4) and conversions
between storage and metabolic carbon (16.2.5).
7. Determine leaf senescence due to aging or cavitation effects (17.2.1).
8. Determine sapwood area senescence by aging (17.2.2).
9. Determine fine root senescence by aging (17.2.3).
10. Evaluate labile carbon translocation due to leaf and sapwood senescence (TSleaf, TTleaf and
TSsapwood). If leaf storage carbon is surpassed, add the excess to TTleaf. Add the sum of translocated
carbon to the starch sapwood pool.
11. Move any surplus in sapwood storage carbon to root exudation (REsapwood). This completes the daily
carbon balance for leaf labile pools (15.2), sapwood labile pools (15.6), and plant-level labile carbon.
(15.8).
12. Update leaf area, sapwood area, fine root area and derived variables (e.g., leaf area index and Huber
value) (17.3.1).
13. Determine if a wildfire stroke the forest stand and, if so, fire severity effects (17.5).
14. Determine if plant death by starvation or desiccation occurred (17.4).
15. Update fine root area target and, if phenology indicates bud formation, update the leaf area target
(17.3.2).
16. Translate sapwood area growth into structural variables (i.e., plant height, tree DBH, tree crown ratio
and shrub cover), (17.6) and update storage volumes and the concentration of labile pools.
15.4.2
Advanced scheduling
For every day to be simulated, the model first executes soil water balance, energy balance, transpiration
and photosynthesis calculations in subdaily times steps, by calling the advanced water balance model (7.5).
After that, the model performs the following steps for each plant cohort:
1. Determine the amount of live structural biomass (in leaves, sapwood and fine root compartments),
storage volume (in leaves and sapwood) and storage capacity (16.1).
2. For every subdaily step, perform carbon balance as follows:
a. Calculate gross photosynthesis per individual (A) and maintenance respiration for leaves (Mleaf),
sapwood (Msapwood) and fine roots (Mfineroot), taking into account both live structural biomass
and labile sugar biomass (see 16.2).
b. If phenology indicates leaf unfolding, evaluate temperature and turgor sink limitations for growth
of leaves, estimate growth costs (Gleaf) and record leaf area increases (17.1.2).
c. If sapwood growth is permitted, evaluate temperature and turgor sink limitations for growth of
sapwood, estimate growth costs (Gsapwood) and record sapwood area increases (17.1.3).
d. Evaluate temperature and turgor sink limitations for growth of fine roots, estimate growth costs
(Gfineroot) and record fine root biomass increases (17.1.4).
e. Evaluate phloem transport (Fphloem) and sugar-starch dynamics in the leaf and sapwood com-
partments at 1s time steps (16.2.4), including photosynthesis, maintenance respiration and
growth respiration as well as diversion towards root exudation if maximum leaf or sapwood starch
capacity is attained (REleaf and REsapwood). This completes the sub-daily carbon balance for
plant-level labile carbon (15.8).
3. Determine leaf senescence due to aging or cavitation effects (17.2.1).
4. Determine sapwood area senescence by aging (17.2.2).
5. Determine fine root senescence by aging (17.2.3).
6. Evaluate labile carbon translocation due to leaf and sapwood senescence (TSleaf, TTleaf and
TSsapwood), adding the resulting carbon to the starch sapwood pool. This completes the daily carbon
balance for leaf labile pools (15.2), sapwood labile pools (15.6), and plant-level labile carbon.

15.5. INPUTS AND OUTPUTS
175
7. Update leaf area, sapwood area, fine root biomass and distribution. Update derived variables (e.g., leaf
area index, Huber values, hydraulic conductance of stems, roots and rhizosphere, osmotic potential at
full turgor of leaves and sapwood) (17.3.1).
8. Determine if plant death by starvation or desiccation occurred (17.4).
9. If phenology indicates bud formation, update the leaf area target (17.3.2). Update the fine root biomass
target, according to the hydraulic conductance in the rhizosphere (17.3.2).
10. Translate sapwood area growth into structural variables (i.e., plant height, tree DBH, tree crown ratio
and shrub cover), (17.6) and update storage volumes and the concentration of labile pools.
15.5
Inputs and outputs
15.5.1
Soil, vegetation and meteorology
Soil
Soil input requirements are the same as for the basic water balance model and were fully described in section
2.3. Genuchten (1980) water retention curves are forced for this model, because rhizosphere conductance is
modelled using van Genuchten hydraulic equations (see subsection 10.2).
Vegetation
Vegetation input requirements were fully described in section 2.4.
Trees and shrubs do not need to be
characterized with different variables in soil water balance calculations, since both kinds of cohort have a
LAI value. In most cases, users only need to estimate the leaf area index corresponding to live leaves,
i.e. LAIlive, because one can assume no dead leaves in the canopy (i.e., LAIdead = 0). Note that vegetation
characteristics are modified by simulations in this model.
Metereological input
The minimum weather variables required to run the model are min/max temperatures (Tmin and Tmax),
min/max relative humidity (RHmin and RHmax), precipitation (P) and solar radiation (Rad). Wind speed
(u) is also needed, but the user may use missing values if not available (a default value will be used in this
case). Wind speed is assumed to have been measured at a specific height above the canopy (by default at 2
m). Atmospheric CO2 concentration (Catm) may also be specified, but if missing a default constant value is
assumed, which is taken from the control parameters. If wildfire occurrence and severity is to be simulated,
the user has to specify daily fire probability (Pfire) in an additional column. Definitions and units of these
variables were given in section 2.5.
15.5.2
Vegetation functional parameters
The growth model requires many functional parameters to be specified for plant cohorts. Some of them
depend on whether the basic or advanced water balance is adopted. Here we report functional parameters
needed in addition to those necessary for the water balance submodel.
A first set of parameters refers to anatomical features (paramsAnatomy), most of them already required by
water balance model simulations:
Symbol
Units
R
Description
Hmax
cm
Hmax
Maximum plant height
Hmed
cm
Hmed
Median plant height
1/Hv
m2 · m−2
Al2As
Leaf area to sapwood area ratio
RLR
m2 · m−2
Ar2Al
Fine root area to leaf area ratio
SLA
m2 · kg−1
SLA
Specific leaf area
LW
cm
LeafWidth
Leaf width

176
CHAPTER 15. FOREST GROWTH MODEL
Symbol
Units
R
Description
ρleaf
g · cm−3
LeafDensity
Leaf tissue density
ρwood
g · cm−3
WoodDensity
Wood tissue density
ρfineroot
g · cm−3
FineRootDensity
Fine root tissue density
fconduits
[0-1]
conduit2sapwood
Proportion of sapwood corresponding to xylem conduits (the
remaining corresponds to parenchymatic tissues)
SRL
cm · g−1
SRL
Specific root length
RLD
cm · cm−3
RLD
Fine root length density (i.e. density of root length per soil volume)
r6.35
r635
Ratio between the weight of leaves plus branches and the weight of
leaves alone for branches of 6.35 mm
A second set of parameters refers to allometric coefficients needed for structural updates (paramsAllometries).
Symbol
Units
R param
Description
aash
Aash
Coefficient relating the square of shrub height
with shrub area
absh, bbsh
Absh, Bbsh
Coefficients relating crown volume with dry
weight of shrub individuals
btsh
BTsh
Bark thickness in shrubs
acr, b1cr, b2cr, b3cr,
c1cr, c2cr
B1cr, B2cr, B3cr,
C1cr, C2cr
Coefficients to calculate crown ratio of trees
acw, bcw
Acw, Bcw
Regression coefficients used to calculate the
crown width of trees (as intermediary step to
obtain the crown ratio).
abt, bbt
Abt, Bbt
Regression coefficients used to calculate the
bark thickness of trees
A third set of parameters refers to growth parameters (paramsGrowth).
Symbol
Units
R param
Description
Nleaf
mg N ·
g dry−1
Nleaf
Leaf nitrogen concentration per dry mass
Nsapwood
mg N ·
g dry−1
Nsapwood
Sapwood nitrogen concentration per dry mass
Nfineroot
mg N ·
g dry−1
Nfineroot
Fine root nitrogen concentration per dry mass
MRleaf
g gluc ·
g dry−1 ·
day−1
RERleaf
Leaf respiration rate at 20 ºC. Normally
estimated via Nleaf.
MRsapwood
g gluc ·
g dry−1 ·
day−1
RERsapwood
Living sapwood (parenchymatic tissue)
respiration rate at 20 ºC. Normally estimated
via Nsapwood.
MRfineroot
g gluc ·
g dry−1 ·
day−1
RERfineroot
Fine root respiration rate at 20 ºC. Normally
estimated via Nfineroot.
MRleaf
g gluc ·
g dry−1 ·
day−1
RERleaf
Leaf respiration rate at 20 ºC

15.5. INPUTS AND OUTPUTS
177
Symbol
Units
R param
Description
MRsapwood
g gluc ·
g dry−1 ·
day−1
RERsapwood
Living sapwood (parenchymatic tissue)
respiration rate at 20 ºC
MRfineroot
g gluc ·
g dry−1 ·
day−1
RERfineroot
Fine root respiration rate at 20 ºC
RGRleaf,max
m2·cm−2·
day−1
RGRleafmax
Maximum leaf area daily growth rate, relative
to sapwood area
RGRcambium,max
cm2 ·
cm−1 ·
day−1
RGRcambiummax
Maximum daily tree sapwood growth rate
relative to cambium perimeter length
RGRsapwood,max
cm2 ·
cm−2 ·
day−1
RGRsapwoodmax
Maximum daily shrub sapwood growth rate
relative to sapwood area
RGRfineroot,max
g dry ·
g dry−1 ·
day−1
RGRfinerootmax
Maximum daily fine root relative growth rate
CCleaf
g gluc ·
g dry−1
CCleaf
Leaf construction cost
CCsapwood
g gluc ·
g dry−1
CCsapwood
Sapwood construction cost
CCfineroot
g gluc ·
g dry−1
CCfineroot
Fine root construction cost
SRsapwood
day−1
SRsapwood
Daily sapwood senescence rate
SRfineroot
day−1
SRfineroot
Daily fine root senescence rate
RSSG
[0-1]
RSSG
Minimum relative starch for sapwood growth to
occur.
fHD,min
cm · cm−1
fHDmin
Minimum height-to-diameter ratio
fHD,max
cm · cm−1
fHDmax
Maximum height-to-diameter ratio
g C ·
g−1dry
WoodC
Wood carbon content per dry weight
A third set of parameters refers to mortality/regeneration parameters (paramsMortalityRegeneration).
Symbol
Units
R param
Description
Pmort,base
[0 −1]
MortalityBaselineRateDeterministic proportion or probability
specifying the baseline reduction of cohort’s
density occurring in a year as a result of
processes not explicitly modelled
TSsurv
[0 −1]
SurvivalModelStep
Time step in years of the empirical survival
model depending on stand basal area (e.g. 10)
βsurv,0
[0 −1]
SurvivalB0
Intercept of the logistic baseline survival model
depending on stand basal area
βsurv,1
[0 −1]
SurvivalB1
Slope of the logistic baseline survival model
depending on stand basal area
Ntree,recr
ind · ha−1
RecrTreeDensity
Density of tree recruits from seeds.
Ntree,ingrowth
ind · ha−1
IngrowthTreeDensity Density of trees reaching ingrowth DBH.
DBHtree,recr
cm
RecrTreeDBH
DBH for tree recruits from seeds or resprouting
(e.g. 1 cm).
DBHtree,ingrowth
cm
IngrowthTreeDBH
Ingrowth DBH for trees (e.g. 7.5 cm).

178
CHAPTER 15. FOREST GROWTH MODEL
Vegetation functional attributes are normally filled for each cohort by function growthInput() or
forest2growthInput() from species identity. However, different parameters can be specified for different
cohorts of the same species if desired (see section 2.4.9).
15.5.3
Control parameters
Control parameters modulate the overall behaviour of growth simulations (see section 2.6).
Parameters
controlling water balance have been already described in sections 3.5.3 and 7.6.3. Here we only mention
those control parameters specific to the growth() function.
First, there are flags that regulate the application of processes:
• allowDessication [=TRUE]: Boolean flag to indicate that mortality by dessication is allowed.
• allowStarvation [=TRUE]: Boolean flag to indicate that mortality by starvation is allowed.
• sinkLimitation [=TRUE]: Boolean flag to indicate that temperature and turgor limitations to growth
are applied.
• shrubDynamics [= TRUE]: Boolean flag to allow the application of demographic processes to shrubs.
• herbDynamics [= TRUE]: Boolean flag to allow dynamic herb leaf area as a function of shading due
to leaf area of woody cohorts.
An important parameter concerns the allocation strategy:
• allocationStrategy
[="Plant_kmax"] defines the allocation strategy (investment in leaf area
vs. sapwood area) of the growth model. If allocationStrategy = "Plant_kmax" then the target
leaf area is set to maintain the input whole-plant maximum conductance. If allocationStrategy =
"Al2As" then the target leaf area is set to maintain the input Huber value.
A number of control parameters regulate carbon balance:
• phloemConductanceFactor [= 0.2]: Factor to transform stem xylem conductance to phloem con-
ductance (only for transpirationMode = "Sperry").
• nonSugarConcentration [=0.25]: A constant specifying non-sugar (inorganic) solute concentration
(mol · L−1) in cells.
• equilibriumOsmoticConcentration [= c(leaf = 0.8, sapwood = 0.6)]:
Equilibrium osmotic
concentrations (mol · L−1) for leaf and sapwood cells.
The difference between leaf and sapwood
values helps maintaining phloem transport.
The equilibrium sugar concentration is found using
equilibriumOsmoticConcentration - nonSugarConcentration
and
defaults
to
[= c(leaf =
0.55, sapwood = 0.35)].
• minimumRelativeStarchForGrowth [= 0.50]:
Default minimum concentration of storage carbon
(starch), relative to the maximum storage capacity, for sapwood growth to occur. This default value
is used when species-specific values are not specified via SpParams.
• senescenceRates [= c(sapwood = 0.0001261398, fineroot = 0.001897231)]:
Relative senes-
cence rates (day−1) for sapwood and fine roots.
Default are equivalent to 4.5% and 50% annual
turnover for sapwood and fine roots, respectively.
Leaf senescence rates depend on leaf lifespan
(i.e. leaf duration) for evergreen species. These are default values used when relative growth rates are
not specified via species-specific SpParams.
• constructionCosts [= c(leaf = 1.5, sapwood = 1.47, fineroot = 1.30)]: Default construc-
tion costs, including respiration and structural carbon, per dry weight of new tissue (g gluc · g dry−1).
These are default values used when relative growth rates are not specified via species-specific SpParams.
• maximumRelativeGrowthRates [= c(leaf = 0.01, cambium = 0.005, sapwood = 0.002,
fineroot = 0.1)]:
Default maximum relative growth rates for leaves (m2 · cm−2 · day−1), tree
sapwood (cm2·cm−1·day−1), shrub sapwood (cm2·cm−2·day−1) and fine roots (g dry·g dry−1·day−1).
These are default values used when relative growth rates are not specified via species-specific SpParams.

15.5. INPUTS AND OUTPUTS
179
Finally, we have the following options regarding mortality:
• mortalityMode [= "density/deterministic"]: String describing how mortality is applied. Current
accepted values are combinations of "cohort" vs "density" (for whole-cohort mortality vs reduction
of stem density) and "deterministic" vs. "stochastic".
• mortalityBaselineRate [= 0.0015]: Default deterministic proportion or probability specifying the
baseline reduction of cohort’s density occurring in a year as a result of processes not explicitly modelled
(for mortalityMode = "density/deterministic" or "density/stochastic").
• mortalityRelativeSugarThreshold [= 0.4]: Threshold of stem sugar concentration relative to equi-
librium values (by default 40%), resulting in an increased mortality rate/probability whenever levels
are below.
• mortalityRWCThreshold [= 0.4]: Threshold of stem relative water content resulting in increased
mortality rate/probability whenever levels are below (by default 40%).
15.5.4
Model output
15.5.4.1
Daily output
Functions growth() returns a list of a class with the same name. The first four elements of this list (i.e.,
latitude, topography, weather and growthInput) are simply copies of model inputs. The next element is
growthOutput, which contains the state of the input object at the end of the simulation (this can be used
to perform further simulations starting with current values of state variables). The remaining list elements
are:
Element
Description
WaterBalance
Climatic input and water balance flows (i.e. net precipitation, infiltration, runoff,
transpiration. . . ). All of them in mm = L · m−2.
EnergyBalance Energy balance components (instantaneous values) for the soil and the canopy
CarbonBalance Stand-level carbon balance components (gross primary production, maintenance
respiration, synthesis respiration and net primary production). All of them in g C · m−2.
BiomassBalanceStand-level biomass balance components. All of them in g dry · m−2.
Temperature
Minimum and maximum temperature values for topsoil, canopy and atmosphere (if
transpirationMode = "Sperry")
Soil
Soil variables for each soil layer: Moisture relative to field capacity (Ws), water potential
(Ψs) and volumetric water content (Vs).
Stand
Stand-level variables, such as LAIϕ
stand = LAIlive
stand, LAIdead
stand, the water retention capacity
of the canopy (Scanopy) or the fraction of light reaching the ground (LP AR
ground and LSW R
ground).
Plants
Plant-level variables, such as LAIphi
i
, plant transpiration, plant water potential, etc.
SunlitLeaves
Leaf-level output variables for sunlit leaves (transpirationMode = "Sperry").
ShadeLeaves
Leaf-level output variables for shade leaves (transpirationMode = "Sperry").
LabileCarbonBalance
A list with the daily results of labile carbon balance components and carbon pools.
PlantBiomassBalance
A list with the daily results of biomass balance components for plant cohorts.
PlantStructureA list with daily results of plant compartment sizes, in terms of area and biomass.
GrowthMortalityA list with daily results of growth rates for leaf, sapwood and fine roots; as well as daily
mortality rates.
Elements WaterBalance to ShadeLeaves are equal to the output of function spwb() and were described in
previous chapters (see 3.5.4 and 7.6.4).
The following table describes the child elements of LabileCarbonBalance, each of them a data frame with
dates in rows and plant cohorts in columns:

180
CHAPTER 15. FOREST GROWTH MODEL
Element
Symbol
Units
Description
GrossPhotosynthesis
Ai/Bi
g gluc ·
g dry−1 ·
day−1
Daily gross photosynthesis per dry weight of living biomass.
MaintentanceRespiration
Mi/Bi
g gluc ·
g dry−1 ·
day−1
Daily maintenance respiration (including leaves, sapwood and
fine roots) per dry weight of living biomass.
GrowthCosts
Gi/Bi
g gluc ·
g dry−1 ·
day−1
Daily growth costs (including leaves, sapwood and fine roots)
per dry weight of living biomass.
RootExudation REi
g gluc ·
g dry−1 ·
day−1
Daily root exudation per dry weight of living biomass.
CarbonBalance ∆Si/Bi
g gluc ·
g dry−1
Daily labile carbon balance (eq. (15.8)) per dry weight of living
biomass.
SugarLeaf
SSleaf,i
mol gluc ·
L−1
Sugar concentration in leaves.
StarchLeaf
STleaf,i
mol gluc ·
L−1
Starch concentration in leaves.
SugarSapwood SSsapwood,i
mol gluc ·
L−1
Sugar concentration in sapwood.
StarchSapwood STsapwood,i
mol gluc ·
L−1
Starch concentration in sapwood.
SugarTransportFphloem
mol gluc ·
s−1
Average instantaneous rate of carbon transferred between
leaves and stem compartments via phloem.
The following table describes the child elements of PlantCarbonBalance, each of them a data frame with
dates in rows and plant cohorts in columns:
Element
Symbol
Units
Description
StructuralBiomassBalance
g dry ·
m−2 ·
day−1
Daily structural biomass balance.
LabileBiomassBalance
g dry ·
m−2 ·
day−1
Daily labile biomass balance.
PlantBiomassBalance
g dry ·
m−2 ·
day−1
Daily plant biomass balance.
MortalityBiomassLoss
g dry ·
m−2 ·
day−1
Daily biomass loss due to mortality.
CohortBiomassBalance
g dry ·
m−2 ·
day−1
Daily cohort biomass balance (includes plant biomass balance
and mortality).
The following table describes the child elements of PlantStructure, again each of them a data frame with
dates in rows and plant cohorts in columns:

15.5. INPUTS AND OUTPUTS
181
Element
Symbol
Units
Description
LeafBiomass
Bleaf,i
g dry ·
ind−1
Daily leaf structural biomass for an average individual.
SapwoodBiomassBsapwood,i
g dry ·
ind−1
Daily sapwood structural biomass for an average individual.
FineRootBiomass
Bfineroot,i
g dry ·
ind−1
Daily fine root biomass for an average individual.
LeafArea
LAi
m2
Daily amount of leaf area for an average individual.
SapwoodArea
SAi
cm2
Daily amount of sapwood area for an average individual.
FineRootArea FRAi
m2
Daily amount of fine root area for an average individual.
HuberValue
Hv
cm2 · m−2
The ratio of sapwood area to (target) leaf area
RootAreaLeafArea
m2 · m−2
The ratio of fine root area to (target) leaf area
DBH
DBHi
cm
Daily diameter at breast height for an average individual.
Height
Hi
cm
Daily total height for an average individual.
The following table describes the child elements of GrowthMortality, again each of them a data frame with
dates in rows and plant cohorts in columns:
Element
Symbol
Units
Description
LAgrowth
∆LAi/SAi
m2·cm−2·
day−1
Leaf area growth relative to sapwood area for an average
individual.
SAgrowth
∆SAi/SAi
cm2 ·
cm−2 ·
day−1
Leaf area growth relative to sapwood area for an average
individual.
FRAgrowth
∆FRAi/SAi m2·cm−2·
day−1
Fine root area growth relative to sapwood area for an average
individual.
StarvationRate
ind ·
ind−1 ·
day−1
Daily mortality rate from starvation.
DessicationRate
ind ·
ind−1 ·
day−1
Daily mortality rate from dessication.
MortalityRate
ind ·
ind−1 ·
day−1
Daily mortality rate (any cause).
15.5.4.2
Subdaily output
As with function spwb(), subdaily output can also be generated with function growth(). This is done via
setting subdailyResults = TRUE in the control parameter list. In that case, the output list of growth()
will include an element subdaily, whose subelements correspond to the results of growth_day() for each
date simulated. Refer to the documentation of function growth_day() for details of sub-daily output.

182
CHAPTER 15. FOREST GROWTH MODEL

Chapter 16
Carbon pools and components of the
carbon balance
16.1
Size of carbon pools
Biomass of leaves, sapwood and fine roots is needed in the model to estimate respiratory costs and the size
of the C storage pools.
16.1.1
Leaf structural, metabolic and storage biomass
The live leaf area LAlive per individual (in m2) is:
LAlive = 10000 · LAIlive/N
(16.1)
where N is the density of the cohort and LAIlive is the leaf area index. The actual (expanded) leaf area
LAϕ is estimated analogously from LAIϕ:
LAϕ = 10000 · LAIϕ/N
(16.2)
Structural leaf biomass per individual (Bleaf; g dryůind−1) is the result of dividing leaf area by SLA (m2 ·
kg−1), the specific leaf area of the species:
Bleaf = 1000 · LAϕ/SLA
(16.3)
where a factor 1000 is used to convert from kg to g. Hence, only expanded leaf area has respiratory cost
(i.e. winter resistance buds do not). Leaf storage volume for an individual (Vstorage,leaf; in L · ind−1) is:
Vstorage,leaf = LAϕ · Vleaf
(16.4)
where Vleaf is the water storage capacity of leaf tissue per leaf area unit (in L·m−2) (see A.4.5). Leaf storage
volume is necessary to estimate the biomass of metabolic (sugars) or storage (starch) from the concentration
of these substances in leaves (SSleaf and STleaf, which are expressed in mol gluc · L−1), and conversely. For
example:
Bsugar,leaf = SSleaf · Vstorage,leaf · mgluc
(16.5)
where mgluc is the molar mass of glucose. To estimate leaf starch storage capacity, the model assumes that
up to 10% of leaf tissue volume can be occupied with starch, so that the leaf starch storage capacity (ST max
leaf ;
in mol · ind−1) is:
ST max
leaf = 0.1 · 1000 · Vstorage,leaf · ρstarch
mstarch
(16.6)
where ρstarch is the density of starch and mstarch is its molar mass.
183

184
CHAPTER 16. CARBON POOLS AND COMPONENTS OF THE CARBON BALANCE
16.1.2
Sapwood structural, metabolic and storage biomass
Sapwood volume (Vsapwood; in L·ind−1) is defined as the product of sapwood area and the sum of aboveground
height and belowground coarse root length:
Vsapwood = 1000 · SA · (H +
X
s
FRPs · Ls)
(16.7)
where SA is sapwood area, H is plant height, FRPs is the proportion of fine roots in soil layer s and Ls is the
coarse root length in layer s (all lengths expressed here in m). Sapwood structural biomass per individual
(Bsapwood; g dryůind−1) represents the sapwood biomass of sapwood of trunks, branches and coarse roots.
It is defined as the product of Vsapwood and wood density (ρwood; gdryůcm−3):
Bsapwood = 1000 · Vsapwood · ρwood
(16.8)
While Bsapwood represents the structural sapwood biomass, it cannot be used to estimate sapwood respiration,
since only xylem axial or radial parenchymatic rays (and not dead cells like tracheids or vessels) contribute to
sapwood respiration. In addition, we assume that embolized parts of sapwood do not contribute to sapwood
respiration. Hence, sapwood living (respiratory) biomass is estimated using:
Bliving,sapwood = 1000 · (1 −PLCstem) · Vsapwood · ρwood · (1 −fconduits)
(16.9)
where PLCstem is the current proportion of stem conductance lost and fconduits is the fraction of sapwood
volume that corresponds to dead conducts, being the complement of the fraction of parenchymatic tissue.
The volume available for metabolic or storage carbon within sapwood is limited by both the sapwood
fraction that corresponds to parenchyma and wood porosity (i.e. (1 −(ρwood/1.54))).
Sapwood storage
volume (Vstorage,sapwood; in L · ind−1) is:
Vstorage,sapwood = Vsapwood · (1 −(ρwood/1.54)) · (1 −fconduits)
(16.10)
Analogously to leaf carbon, Vstorage,sapwood is used to estimate the biomass of metabolic (sugars) or stor-
age (starch) from the concentration of these substances in sapwood (SSsapwood and STsapwood, which are
expressed in mol gluc · L−1), and conversely. For example:
Bsugar,sapwood = SSsapwood · Vstorage,sapwood · mgluc
(16.11)
where mgluc is the molar mass of glucose. To estimate sapwood storage capacity, the model assumes that
up to 50% of volume of parenchymatic cells can be occupied with starch, so that the sapwood starch storage
capacity (ST max
sapwood; in mol · ind−1) is:
ST max
sapwood = 0.5 · 1000 · Vstorage,sapwood · ρstarch
mstarch
(16.12)
16.1.3
Fine root area and biomass
The fine root compartment does not have labile carbon (i.e. the model supplies labile carbon for fine roots
from sapwood compartment), so that only the structural biomass of fine roots needs to be estimated. If
growth is simulated using the basic water balance model, the initial area of fine roots (FRA, m2) for layer
s is estimated from leaf area using:
FRA = FRPs · LAϕ · RLR
(16.13)
where FRPs is the proportion of fine roots in layer s and RLR is the species-specific root area to leaf area
ratio. Biomass of fine roots per individual for a given layer s (Bfineroot,s; g dryůind−1) is then estimated
from FRAs using:
Bfineroot,s =
104 · FRAs
2.0 ·
q
π·SRL
ρfineroot
(16.14)

16.2. COMPONENTS OF LABILE CARBON BALANCE
185
where ρfineroot is fine root tissue density (g dry · cm−3) and SRL (cm · g dry−1) is the specific root length.
Fine root biomass per individual (g dry · ind−1) is simply the sum across layers:
Bfineroot =
X
s
Bfineroot,s
(16.15)
If growth is simulated using the advanced water balance model, the initial fine root length per area in each
soil layer (FLAs; m · m−2) is estimated from rhizosphere conductance, assuming a cylindrical flow geometry
in the rhizosphere. The initial fine root biomass for a given layer s (g dry · ind−1) is then calculated using:
Bfineroot,s = 10000 · FLAs
N · 0.01 · SRL
(16.16)
where N is the density of individuals.
Finally, initial fine root area in each soil layer (FRAs) is then
calculated from Bfineroot by inverting the equation presented above:
FRAs = 10−4 · Bfineroot,s · 2.0 ·
s
π · SRL
ρfineroot
(16.17)
16.1.4
Total living biomass
Total living biomass per individual (i.e. not accounting for heartwood or xylem conduits) is:
Btotal = Bleaf + Bliving,sapwood + Bfineroot+
+ Bsugar,leaf + Bstarch,leaf + Bsugar,sapwood + Bstarch,sapwood
Btotal is used to express carbon balance components per dry weight of living biomass in the model output,
which allows a better comparison across plant cohorts of different size and species.
16.2
Components of labile carbon balance
Here we provide the details of labile carbon balance calculations, i.e. how the components of eqs. (15.2) and
(15.6) are determined.
16.2.1
Gross photosynthesis
The soil water balance submodel provides values of photosynthesis calculated at the plant cohort level, but
note that the user output of function spwb and pwb refers to net photosynthesis (An) after accounting for
an estimate of leaf respiration. In the basic water balance model there is no way to make the distinction
between gross and net photosynthesis, so we will assume here that Ag = An (in g C · m−2) as calculated in
section 6.1.6. In the advance water balance model the output is also net photosynthesis, but the distinction
is possible (see section 11.1). In any case, here we start with a Ag value in units of carbon per ground area
unit, i.e. g C · m−2, and to enter the carbon balance we need scale photosynthesis to units of glucose per
individual (A; in g gluc · ind−1). This is done using:
A = 10000 · Ag
N
·
mgluc
mcarbon · 6
(16.18)
where N is the density of individuals per hectare, mgluc is the glucose molar mass and mcarbon is the carbon
molar mass.

186
CHAPTER 16. CARBON POOLS AND COMPONENTS OF THE CARBON BALANCE
16.2.2
Maintenance respiration
Maintenance respiration (in g glucůind−1) is calculated for each of the three compartments (leaves, sapwood,
and fine roots) individually (Mouillot et al. 2001), and differs slightly depending on the complexity of the
transpiration submodel.
When simulating growth with the basic water balance, the model uses a Q10 relationship of baseline res-
piration with temperature, which means that for every 10 ºC change in temperature there is a Q10 factor
change in respiration:
Mleaf
=
(Bleaf + Bsugar,leaf) · MRleaf · Q(Tmean−20)/10
10
· (LP AR)W UEdecay
(16.19)
Msapwood
=
(Bliving,sapwood + Bsugar,sapwood) · MRsapwood · Q(Tmean−20)/10
10
(16.20)
Mfineroot
=
Bfineroot · MRfineroot · Q(Tmean−20)/10
10
· (LAi/LAlive
i
)
(16.21)
where Tmean is the average daily temperature (in ºC). Baseline maintenance respiration rates per dry biomass
(MRleaf, MRsapwood and MRfineroot for leaves, parenchymatic sapwood and fine roots, respectively; in
g gluc · g dry−1 · day−1) are can be supplied via species-specific parameters and should refer to 20 ºC. Leaf
and fine root rates can also be estimated from nitrogen concentration, following Reich et al. (2008) (see
section A.3.18).
Factor Q10 has been found to decrease with temperature (Tjoelker et al.
2001).
For
example, a 10 °C increase in measurement temperature at low measurement temperatures from 5 to 15 °C
results in an approximate 2.8 fold increase in respiration rate, whereas an increase in temperature from 25
to 35 °C results in a less than two-fold (1.8) increase in rate. The general temperature relationship proposed
by Tjoelker et al. (2001) is used here:
Q10 = 3.22 −0.046 · Tmean
(16.22)
Factor (LP AR)W UEdecay is added to reduce respiration rates in leaves under shade, analogously to the re-
duction of water use efficiency explained in 6.1.6. Thus, it is assumed that the carbon use efficiency of the
leaves is more or less constant. Factor LAi/LAlive
i
is added to the maintenance respiration of fine roots to
reduce respiration rates during winter in winter-deciduous species, assuming a decrease in respiration rates
of fine roots parallel to that of leaves.
When simulating growth with the advanced model, sub-daily leaf maintenance respiration rates are estimated
as the difference between gross and net photosynthesis (see 11.1.4). Sapwood and fine root respiration rates
are also estimated at sub-daily steps and, hence, sub-daily canopy temperature variation is taken into account
(i.e. sub-daily canopy Tcan values are used instead of the daily temperature mean, Tmean).
16.2.3
Growth respiration
Construction costs per unit dry weight of new tissue (CCleaf, CCsapwood and CCfineroot for leaves, sapwood
and fine roots; in g gluc · g dry−1) are specified as control parameters (i.e. they are not species-specific).
These unitary costs include both the carbon used in respiration during growth and structural carbon. Given
an increase in leaf area ∆LA, leaf growth respiration is:
Gleaf = ∆LA · CCleaf · 1000/SLA
(16.23)
Analogously, given an increase in sapwood area ∆LA, sapwood growth respiration is:
Gsapwood = ∆SA · CCsapwood · (H +
X
s
FRPs · Ls) · ρwood
(16.24)
Finally, and given an increase in fine root biomass ∆Bfineroot:
Gfineroot = ∆Bfineroot · CCfineroot
(16.25)

16.2. COMPONENTS OF LABILE CARBON BALANCE
187
16.2.4
Phloem transport
When growth is simulated using the basic water balance model, phloem transport between leaf and sapwood
(Fphloem) is simply modelled as the flow needed to make the concentration of metabolic carbon equal in both
compartments. When the advanced water balance submodel is used, Fphloem is modelled following Hölttä
et al. (2017). Specifically, the instantaneous phloem flow per leaf area basis (mol gluc · m−2 · s−1) depends
on kphloem, i.e. the phloem conductance per leaf area basis (L · m−2 · MPa−1 · s−1), sap viscosity relative
to water and the difference in turgor between the sieve cells of leaf and sapwood compartments. kphloem is
estimated as linear function of stem maximum conductance, kstem,max:
kphloem = fphloem · kstem,max
(16.26)
where factor fphloem is specified by the control parameter phloemConductanceFactor. Sap viscosity is calcu-
lated following Först et al. (2002), which takes into account temperature and the average sugar concentration
between the two compartments (no phloem flow can occur if temperature is below zero). Turgor in sieve cells
of each compartment depends on symplastic water potential and osmotic water potential, with Van’t Hoff’s
equation being used to calculate the osmotic water potential, based on temperature, sugar concentration
and the concentration of other solutes (control parameter nonSugarConcentration). Note that here leaf
or sapwood sugar concentration is modulated to account for the effect of the relative water content of the
compartment on osmotic water potential.
16.2.5
Sugar-starch dynamics
When growth is simulated using the basic water balance submodel, sugar-starch dynamics (SCleaf and
SCsapwood) are simply defined as the conversion between metabolic and storage carbon needed to keep the
sugar concentration equal to an equilibrium required for metabolic functioning, which is specified by control
parameters equilibriumOsmoticConcentration (including two values, for leaves and sapwood respectively)
and nonSugarConcentration. For example, if leaf osmotic equilibrium concentration is 0.8 mol gluc · L−1
and non-sugar concentration is 0.3 mol gluc·L−1, the model will simulate sugar-starch dynamics to stabilize
sugar concentration in leaves to 0.5 mol gluc·L−1. A lower equilibrium osmotic concentration is required for
sapwood, by default 0.6 mol gluc · L−1, so that sugar equilibrium concentration is 0.1 mol gluc · L−1. That
lower equilibrium concentrations are required for sapwood than for leaves is necessary to sustain the phloem
transport of sugars from leaves towards sapwood.
When growth is simulated using the advanced water balance submodel, sugar-starch dynamics are similar
to the previous case, in the sense that equilibrium sugar concentrations are sought for leaves and sapwood.
However, instantaneous conversion rates are calculated depending on equations regulating starch synthesis
(occurring when sugar concentration is higher than the equilibrium concentration) and starch hydrolysis
(occurring when sugar concentration is lower than the equilibrium concentration). Synthesis is modelled
as a Michaelis-Menten function, whereas hydrolysis rate is simply a linear function of starch concentration.
Maximum synthesis rates and hydrolysis linear factors are larger (i.e. faster sugar-starch dynamics) in leaves
than sapwood.
16.2.6
Root exudation
Whereas surplus in leaf storage capacity is relocated into sapwood storage, surplus in sapwood storage
carbon is diverted towards root exudation (REsapwood). Hence, root exudation is not a process competing
for metabolic carbon, but only a consequence of plant C storage capacity being surpassed (Prescott et
al. 2020). Root exudation may happen in the model when growth is restricted due to sink limitations
but photosynthesis continues and storage carbon levels have attained the storage capacity in the sapwood
compartment (STsapwood > ST max
sapwood).

188
CHAPTER 16. CARBON POOLS AND COMPONENTS OF THE CARBON BALANCE

Chapter 17
Growth, senescence and mortality
17.1
Growth
17.1.1
Temperature and turgor sink limitations
Sink limitations due to temperature and turgor effects on growth are modelled following Cabon et al. (2020a)
and Cabon et al. (2020b). These authors suggested equations to model sink limitations on cambium cell
division and tracheid expansion, but we apply the same approach for simulating growth of leaves, sapwood
and fine roots. Cell relative expansion rate (rcell) is central to the approach by Cabon et al. and is defined
as the relative time derivative of cell volume:
rcell = dV
V dt
(17.1)
Cabon et al. (2020a) first suggested to model the dependence of rcell on cell turgor using Lockhart’s equation:
rcell(Ψ, π0) = ϕmax · (Ψ −π0 −YP )
(17.2)
where Ψ is the water potential, π0 is the osmotic water potential at full turgor, YP is the turgor yield
threshold and ϕmax is the maximum cell wall extensibility. Later, Cabon et al. (2020b) suggested to account
for both turgor and temperature limitations on rcell using the following expanded equation:
rcell(T, Ψ, π0) = ϕmax · (Ψ −π0 −YP ) ·
fmet(TK)
fmet(288.15) · fmicro(T, Tthr)
(17.3)
where T is temperature, fmet(TK) is a function modulating the effect of temperature TK in Kelvin, on
metabolic rate, and fmicro(T, Tthr) is a sigmoidal function modulating the effect of temperature on micro-
tubule stability, depending on a temperature threshold Tthr. Function fmet(TK) is defined as:
fmet(TK) =
TK · exp
 ∆HA
Rn·TK
	
1 + exp
 ∆SD
Rn ·

1 −
∆HD
∆SD·TK
 	
(17.4)
where Rn is the ideal gas constant, ∆HA = 87500 the enthalpy of activation and ∆HD = 333000 and
∆SD = 1090 the enthalpy and entropy difference (respectively) between the catalytically active and inactive
states of the enzymatic system).
Scaling from the cell to the tissue level is conducted by assuming that maximum cell-level expansion rates
correspond to maximum tissue-level relative growth rates.
189

190
CHAPTER 17. GROWTH, SENESCENCE AND MORTALITY
17.1.2
Leaf growth
Leaf area increment ∆LA only occurs when phenological state is unfolding, and is defined as the minimum
of three values expressing three corresponding constraints:
∆LA = min(∆LAalloc, ∆LAsource, ∆LAsink)
(17.5)
First, ∆LAalloc is the maximum leaf area increment allowed by the leaf area target set by the allocation
rule, LAtarget, in comparison with current leaf area LAϕ:
∆LAalloc = max(LAtarget −LAϕ, 0)
(17.6)
Remember that leaf area target is updated during bud formation (see 17.3.2).
Second, ∆LAsource represents the leaf area increment expected given carbon source limitations and is cal-
culated:
∆LAsource = STsapwood · mgluc · Vsapwood,leaf
1000 · CCleaf/SLA
(17.7)
where STsapwood is the current concentration of sapwood storage carbon (starch), Vstorage,sapwood is the
sapwood storage volume and mgluc is glucose molar mass and the denominator contains the construction
costs per leaf area unit, see eq. (16.23).
Finally, ∆LAsink represents the leaf area increment expected by taking into account the maximum leaf tissue
growth rate relative to sapwood area (RGRleaf,max; in m2 · cm−2 · day−1), the percentage of the crown with
active buds (PCAB) and the relative cell expansion rate given Tday, Ψsymp,leaf and π0,leaf:
∆LAsink
=
SA · (PCAB/100) · RGRleaf,max · rcell(Tday, Ψsymp,leaf, π0,leaf)
rcell,max
(17.8)
=
SA · (PCAB/100) · RGRleaf,max · (Ψsymp,leaf −π0,leaf −YP )
(2 −YP )
· fmet(Tday)
fmet(30)
(17.9)
where cell relative expansion rate is divided by the maximum relative cell expansion rate rcell,max =
rcell(30, 0, −2) so that RGRleaf,max is attained when sink conditions are optimal. Other parameters for
eq. (17.3) are ϕmax = 0.5 (which becomes irrelevant), YP = 0.05 MPa and Tthr = 5ºC. Note that the final
expression of ∆LAsink reduces to a product of the maximum leaf area growth times two factors (for turgor
and temperature) bounded between 0 and 1.
17.1.3
Sapwood growth
Sapwood area increment ∆SA can only occur if LAlive > 0. Unlike leaf area or fine root biomass, it is not
explicitly constrained by any allocation rule. However, newly assimilated carbon is preferentially allocated
to leaves and fine roots whenever storage levels are low. ∆SA is defined as the minimum of two values
expressing source and sink constraints:
∆SA = min(∆SAsource, ∆SAsink)
(17.10)
∆SAsource represents the sapwood area increment expected given carbon source limitations and is calculated
using:
∆SAsource = max(STsapwood −STsapwood,growth, 0) · mgluc · Vstorage,sapwood
CCsapwood · (H + P
s FRPs · Ls) · ρwood
(17.11)
where STsapwood is the current starch concentration, STsapwood,growth is the minimum starch concentration
required for sapwood growth, Vstorage,sapwood is the sapwood storage volume, mgluc is glucose molar mass and
the denominator contains the construction costs per sapwood area unit, see eq. (16.24). STsapwood,growth is
related to the minimum relative starch concentration for growth (RSSG), which is specified via the species-
specific parameter RSSG or the control parameter minimumRelativeStarchForGrowth. This parameter is

17.1. GROWTH
191
important because it allows specifying to which extent a given plant species stops growth and saves carbon
to ensure survival (e.g. shadow tolerant species), as opposed to a species strongly investing in growth to
reach the top of the canopy and have access to high light levels (e.g. light-demanding species).
Sink limitations to sapwood growth are simulated using a set of Nc = 10 cambium cells that undergo division
and the new cells are added to a ring (i.e. a vector) of vessels that later suffer enlargement and maturation
(Friend et al. 2019). Assuming that cambium cell volume must double before division, that cell-doubling
time is the variable limiting cell division and that each division instantly results in a cell exiting the cambium
and initiating differentiation into a vessel, production rate (PRcambium) of new vessels cells can be related
to the cambial cell expansion rate rcambium such that (Cabon et al. 2020b):
PRcambium =
Nc
ln(2) · rcambium
(17.12)
where rcambium = rcell(Tday, Ψsymp,stem, −0.8), with other parameters of eq. (17.3) being ϕmax = 0.13,
YP = 0.05 MPa and Ythr = 8 ºC. The ring growth model is implemented at daily time steps and daily
PRcambium values are accumulated (i.e. Pcambium,t = Pcambium,t−1 + PRcambium,t). A new vessel is formed
and added to the ring every time Pcambium advances one integer.
All vessel cells in the ring undergo
daily enlargement following eq.
(17.3), again with YP = 0.05 MPa and Ythr = 8 ºC. During cell later
stages of enlargement, the cell wall becomes thicker and more rigid as a consequence of cell wall deposition.
Consequently, ϕmax = 0.13 for newly formed cells, but then variations in ϕmax are modelled as (Cabon et
al. 2020a):
dϕmax
ϕmax · dt = s · rcell −h ·
fmet(TK)
fmet(288.15)
(17.13)
where s = 1.8 and h = 0.043 · 1.8 are a softening factor and a constant hardening rate, respectively, and the
hardening rate is modulated by temperature effects. Cell radial diameter is initially 8.3µm and tangential
diameter is assumed constant and equal to 20µm, so that volume increases in ring cells can be translated to
daily ring area increases, ∆Aring (in µm2).
Assuming that the maximum relative sapwood growth rate (RGRcambium,max or RGRsapwood,max) corre-
sponds to a maximum rate of daily ring area increase, we have that the daily increase in sapwood area
according to sink limitations, ∆SAsink, is defined as:
∆SAsink = π · DBH · RGRcambium,max ·
∆Aring
∆Aring,max
(17.14)
for trees, and as:
∆SAsink = SA · RGRsapwood,max ·
∆Aring
∆Aring,max
(17.15)
for shrubs. Sapwood growth in trees is proportional to the cambium length (in cm), whereas in trees it is
proportional to the current sapwood area (in cm2). Hence, two different maximum relative growth rates are
defined for trees (RGRcambium,max) and shrubs (RGRsapwood,max). In the previous equations, ∆Aring,max =
Nc·950 µm2·day−1, which was obtained by simulating a ring growth under optimum temperature (Tday = 30
ºC) and water (Ψsymp,stem = −0.033 MPa) conditions and observing the steady-state ring area increase.
17.1.4
Fine root growth
Fine root biomass increment is modelled for each soil layer separately, and is defined analogously to leaf area
increment:
∆Bfineroot = min(∆Bfineroot,alloc, ∆Bfineroot,source, ∆Bfineroot,sink)
(17.16)
First, ∆Bfineroot,alloc is the maximum fine root biomass increment allowed by the biomass target set by the
allocation rule, Bfineroot,target (see 17.3.2), in comparison with current biomass, Bfineroot:
∆Bfineroot,alloc = max(Bfineroot,target −Bfineroot, 0)
(17.17)

192
CHAPTER 17. GROWTH, SENESCENCE AND MORTALITY
Second, ∆Bfineroot,source represents the biomass increment expected given the available storage carbon
(starch):
∆Bfineroot,source = STsapwood · mgluc · Vstorage,sapwood
CCfineroot
(17.18)
where STsapwood is the current sapwood concentration of storage carbon, Vstorage,sapwood is the sapwood
storage volume, mgluc is glucose molar mass and CCfineroot is the construction costs per fine root biomass
unit.
Finally, ∆Bfineroot,sink represents the biomass increment expected by taking into account maximum tissue
growth rate (RGRfineroot,max; in g dry·g dry−1·day−1) and the relative cell expansion rate given temperature
(Tday), water potential in the rhizosphere (Ψrhizo,s) and the stem osmotic potential at full turgor(π0,stem):
∆Bfineroot,sink
=
Bfineroot · RGRfineroot,max · rcell(Tday, Ψrhizo,s, π0,stem)
rcell,max
(17.19)
=
Bfineroot · RGRfineroot,max · (Ψrhizo,s −π0,stem −YP )
(2 −YP )
· fmet(Tday)
fmet(30)
(17.20)
cell relative expansion rate is divided by the maximum relative cell expansion rate rcell,max = rcell(30, 0, −2)
so that RGRfineroot,max is attained when sink conditions are optimal. Other parameters for eq. (17.3) are
like for leaf growth, ϕmax = 0.5, YP = 0.05 MPa and Tthr = 5ºC.
17.2
Senescence
17.2.1
Leaf senescence and cavitation effects on leaves and buds
Leaf senescence can occur due to two processes: aging or dessication. Senescence due to advanced leaf age
is assumed to be programmed (Ca+ accumulation?). In deciduous species all live leaf area turns to death
leaf area when the phenology submodel indicates it (4.1.3). In evergreen species the proportion of leaf area
that undergoes senescence each day is determined by the species-specific leaf duration parameter (LD):
paging,leaf =
1
365.25 · LD
(17.21)
Senescence due to drought effects occurs as a consequence of stem cavitation. If the proportion of conductance
loss has increased with respect to the preceeding day, the model determines the leaf area corresponding to
the current level of cavitation:
LAcavitation = (1 −PLCstem) · LAtarget
(17.22)
if LAcavitation < LAϕ then the corresponding proportion pcavitation,leaf is estimated.
The maximum of
paging,leaf and pcavitation,leaf is applied as a reduction of leaf area. If growth is simulated using the ad-
vanced water model, it also checks whether the relative water content in leaves becomes less than 50%
(i.e. RWCleaf < 0.5) and, if this happens, the plant cohort is completely defoliated.
Xylem cavitation not only causes defoliation but also mortality of buds, which has the effect of slowing down
post-drought leaf area recovery. The percentage of the crown with active buds (PCAB) is reduced whenever
the proportion of conductance loss has increased with respect to the preceeding day.
PCAB = min(PCAB, 100 · (1 −PLCstem))
(17.23)
17.2.2
Sapwood senescence
The daily rate of sapwood senescence is specified via the species-specific parameter SRsapwood or, when
missing, via a control parameter. Prentice et al. (1993) assumed a constant annual rate of 4% for the

17.3. UPDATE OF PLANT TRAITS AND ALLOCATION TARGETS
193
conversion from sapwood to heartwood. Similarly, Sitch et al. (2003) assumed a sapwood annual turnover
rate of 5% for all biomes. In our model, the proportion of sapwood area that is transformed into heartwood
daily is estimated using:
paging,sapwood =
SRsapwood
1 + 15 · e−0.01·H · max(Tday −5, 0)
20
(17.24)
where SRsapwood is a species-specific parameter, Tday is the average day temperature and 0.01 is a constant
causing shorter plants to have slower senescence rates. It is important to mention that, while stem cavitation
PLCstem reduces the amount of functional sapwood in with respect to hydraulics (and therefore transpiration
and photosynthesis), it does not increase the rate of sapwood senescence. Hence, when xylem embolism occurs
air bubbles are formed within vessels but surrounding parenchymatic cells (as well as the storage carbon
they contain) are assumed unaffected.
17.2.3
Fine root senescence
Aging is the only process leading to fine root senescence.
The daily turnover proportion for fine roots
(SRfineroot) is assumed to correspond to a temperature of 25 ºC, is specified via species-specific parameters
or the control parameters turnoverRates. Actual turnover proportion for a given soil layer (paging,fineroot)
decreases linearly with soil temperature down to zero at 5 ºC:
paging,fineroot = SRfineroot · max(Tsoil,s −5, 0)
20
(17.25)
where Tsoil,s is the temperature of soil layer s. When SRfineroot is missing from species parameter, a default
control value for SRfineroot is taken, which produces an annual 50% turnover of fine roots.
17.3
Update of plant traits and allocation targets
17.3.1
Plant traits
Multiple anatomic and physiological parameters are updated every day after applying changes in the size
of leaf, sapwood and fine root compartments, which creates a feedback to those hydraulic and physiological
processes simulated in the water balance submodel (15.1.4). Hence, the growth model allows emulating plant
acclimation to environmental cues, mediated by growth and senescence of plant tissues.
First leaf area index (LAIϕ) is updated from leaf area (LAϕ) inverting eq. (16.2). The Huber value (Hv,
the sapwood area to leaf area ratio; in m2 · m−2) is affected by changes in LAlive = LAtarget and sapwood
area SA:
Hv = SA/10000
LAlive
(17.26)
Note that we specify LAlive = LAtarget and not LAϕ to avoid variations in Huber value due to leaf phenology.
By definition, fine root biomass changes in each soil layer (Bfineroot,s) lead to updates in the proportion of
fine roots in each layer (FRPs):
FRPs =
Bfineroot,s
P
l Bfineroot,l
(17.27)
When we simulate growth with the advanced water balance model other parameters are subject to acclima-
tion. Stem maximum conductance per leaf area unit (kstem,max; in mmol ·m−2 ·s−1 ·MPa−1) is determined
as a function of species-specific xylem conductivity (Kxylem,max; in kg·m−1·s−1·MPa−1), leaf area, sapwood
area and tree height (Christoffersen et al. 2016):
kstem,max = 1000
0.018 · Kxylem,max · Hv
(H/100)
· χtaper
(17.28)

194
CHAPTER 17. GROWTH, SENESCENCE AND MORTALITY
where χtaper is a factor to account for taper of xylem conduit with height (Savage et al. 2010; Christoffersen
et al. 2016), 0.018 is the molar weight of water (in kg · mol−1). Both an increase in SA or a decrease in
LAlive (i.e. an increase in Hv) increase kstem,max and, hence, alleviate drought effects (i.e. a lower decrease
in water potential across the stem for the same flow). In contrast, an increase in plant height will decrease
stem conductance and increase drought stress. Changes in stem maximum conductance has cascade effects
on root maximum conductance. First, coarse root minimum resistance is defined as a fixed proportion of
whole-plant minimum resistance, so an increase in stem maximum conductance will increase whole-plant
conductance and coarse root conductance, kroot,max.
Rhizosphere maximum conductance per leaf area unit in a given soil layer s (krhizo,max,s; in mmol · m−2 ·
s−1 · MPa−1) depends on fine root biomass in this layer (Bfineroot,s) and on leaf area (i.e. LAlive). The
equations regulating these relationships are modulated by several soil and species parameters, such as soil
saturated hydraulic conductance, species-specific root length, root length density and density of fine roots.
The proportion of conductance loss due to cavitation (PLCstem) is reduced whenever sapwood area growth
occurs:
PLCstem,t+1 = min(PLCstem,t −∆SA
SA , 0)
(17.29)
This allows a progressive increase in functional sapwood area. Similarly, if previous drought or fire impacts
had reduced the percentage of the crown with active buds (PCAB), this percentage is increased along with
the formation of new sapwood area (until it achieves 100%):
PCABt+1 = min(PCABt + 100 · ∆SA
SA , 100)
(17.30)
17.3.2
Leaf area and fine root biomass targets
Leaf area target (LAlive = LAtarget) is updated when phenological phase is bud formation. If the allocation
strategy pursues a stable Huber value, the model tries to bring Hv close to an initial value Hv,target, and
the leaf area target is defined as:
LAlive = LAtarget =
SA
10000 · Hv,target
(17.31)
Note that the specification of LAtarget will cause sapwood area increases to be followed by leaf area increases,
as long as Hv > Hv,target. On the contrary, if Hv < Hv,target then leaf area growth is inhibited and sapwood
area growth will progressively increase Hv. Fine root biomass target is set using:
Bfineroot,target = 104 · LAtarget · RLR
2.0 ·
q
π·SRL
ρfineroot
(17.32)
where RLR is the root area to leaf area ratio, ρfineroot is fine root tissue density (g dry · cm−3) and SRL
(cm · g dry−1) is the specific root length.
If the allocation strategy pursues a stable whole-plant conductance, the model tries to keep kplant close
to an initial value kplant,target, and here the leaf area target is defined as:
LAtarget = LAlive · kplant,max
kplant,target
(17.33)
In this strategy, increases in leaf area will be scheduled whenever the current whole-plant conductance is above
target value (i.e. kplant,max > kplant,target). Analogously to the previous strategy, if kplant,max < kplant,target
then leaf area growth is inhibited and sapwood area growth will progressively increase kplant,max.
While leaf area target depends on the allocation strategy, the target of fine root biomass for any given soil layer
s (Bfineroot,target,s) directly follows changes in maximum whole-plant conductance. The average resistance in
the rhizosphere is assumed to correspond to a fixed percentage of total soil-plant resistance. Hence, changes

17.4. PLANT MORTALITY
195
in the conductance of leaves, stem or coarse roots will entail a variation in the absolute rhizosphere maximum
conductance to be targeted (krhizo,max,target,s), which in turn will determine Bfineroot,target,s. For example
krhizo,max,target,s will increase as a consequence of sapwood area growth. The model thus first estimate
krhizo,max,target,s for each layer s and then translates krhizo,max,target,s values to Bfineroot,target,s using the
relationships based on soil saturated hydraulic conductance, species-specific root length, root length density
and density of fine roots mentioned above.
17.4
Plant mortality
17.4.1
Self-thinning of small trees
As explained in the mortality design section (15.1.5), the model implements a mortality process for young
individual trees, meant to represent a self-thinning process occurring between trees of small diameter
(DBHtree,recr, typically 1 cm) and trees having a diameter corresponding to inclusion as individual in
forest inventories (DBHtree,ingrowth, typically 7.5 cm). The aim is to ensure that the tree density is progres-
sively reduced until the tree cohort reaches DBHtree,ingrowth, where the density should be Ntree,ingrowth.
The following relationship between tree diameter and density is used:
N = ast · DBHbst
(17.34)
where ast and bst are parameters regulating the speed of the self-thinning process. Note that if we know the
diameter and density of recruitment (i.e. DBHtree,recr and Ntree,recr), as well as Ntree,ingrowth, the density
we want to ensure when the tree reaches DBHtree,ingrowth, the self-thinning curve is completely determined.
Hence, we can estimate bst using:
bst =
log(Ntree,ingrowth/Ntree,recr)
log(DBHtree,ingrowth/DBHtree,recr)
(17.35)
whereas ast can be estimated using:
ast =
Ntree,ingrowth
DBHbst
tree,ingrowth
(17.36)
Once we know the parameters of the self-thinning curve, we can determine the maximum cohort density
allowed for any cohort of diameter DBHi. If the tree cohort has density Ni, the density decrease due to
self-thinning mortality can be estimated using:
Ndead,i = Ni −min(Ni, ast · DBHbst
i
)
(17.37)
Note that the self-thinning process does not distinguish between tree resprouts or trees recruited from seeds.
17.4.2
Basal mortality rates
Adult trees (DBH > 7.5 cm) and shrubs die at a basal rate due to unspecific causes. For shrubs, the basal
rate is always a species-specific constant (Pmort,base). For trees, the basal rate can alternatively depend on
the degree of (symmetric) competition, which is measured using the tree basal area BA (m2 · ha−1) of the
stand, through a simple survival logistic model:
Psurv,base = logit−1(βsurv,0 + βsurv,1 ·
√
BA) =
exp(βsurv,0 + βsurv,1 ·
√
BA)
1 + exp(βsurv,0 + βsurv,1 ·
√
BA)
(17.38)
where βsurv,0 and βsurv,1 are species-specific coefficients obtained by fitting Generalized Linear Models on
repeated forest inventory plot data. These models can be developed for arbitrary time steps (normally 5 or
10 years), but the basal mortality rate has to be finally expressed as a daily probability (Pbase,daily).

196
CHAPTER 17. GROWTH, SENESCENCE AND MORTALITY
17.4.3
Mortality due to starvation
The starvation stress indicator is ST sapwood
relative , the starch concentration in sapwood relative to the equilibrium
value:
ST sapwood
relative =
STsapwood
ST sapwood
equilibrium
(17.39)
where STsapwood ( mol gluc · l−1) is the current starch concentration in sapwood and ST sapwood
equilibrium is the
equilibrium concentration (by default ST sapwood
equilibrium = 0.35 mol gluc · l−1.
Assuming that a threshold of
relative starch concentration (ST thresh
relative) corresponds to 50% annual mortality due to starvation, a logistic
sigmoidal function is used to estimate the probability of annual starvation from a given ST sapwood
relative :
Pstarv,annual = 1.0 −
exp(40 · (ST sapwood
relative −ST thresh
relative))
1.0 + exp(40 · (ST sapwood
relative −ST thresh
relative))
(17.40)
Since the model operates at the daily temporal resolution, Pstarv,annual is re-expressed as a daily probability
using:
Pstarv,daily = 1.0 −exp(log(1.0 −Pstarv,annual)/356)
(17.41)
Assuming a relative threshold ST thresh
relative = 0.4, the figure below illustrates the shape of the sigmoidal function
(top) and the corresponding daily probability function.
17.4.4
Mortality due to dessication
As explained in the section 15.1.5, the dessication stress indicator (Dstem) is the maximum of relative water
content in the stem (RWCstem) and relative hydraulic conductance in the stem, i.e. the complement of
PLCstem
Dstem = (RWCstem, 1.0 −PLCstem)/2.0
(17.42)
Assuming that a threshold of relative water content (RWCthresh) corresponds to 50% annual mortality due
to dessication, its probability is estimated analogously to starvation. First, a logistic sigmoidal function is
used to estimate the probability of annual dessication from a given Dstem value:
Pdessic,annual = 1.0 −
exp(40 · (Dstem −RWCthresh))
1.0 + exp(40 · (Dstem −RWCthresh))
(17.43)
Since the model operates at the daily temporal resolution, Pdessic,annual is re-expressed as a daily probability
using:
Pdessic,daily = 1.0 −exp(log(1.0 −Pdessic,annual)/356)
(17.44)

17.4. PLANT MORTALITY
197
0.00
0.25
0.50
0.75
1.00
0
25
50
75
100
Percent of equilibrium starch concentration (%)
Annual starvation probability [0−1]
0.00
0.01
0.02
0.03
0.04
0
25
50
75
100
Percent of equilibrium starch concentration (%)
Daily starvation probability [0−1]
Figure 17.1: Annual (top) and daily (bottom) probability of starvation as a function of sapwood starch
concentration relative to its equilibrium value.

198
CHAPTER 17. GROWTH, SENESCENCE AND MORTALITY
Assuming a relative threshold RWCthresh = 0.4, the figure below illustrates the shape of the sigmoidal func-
tion (top) and the corresponding daily probability function.
0.00
0.25
0.50
0.75
1.00
50
75
100
Average of stem relative water content and ste
Annual dessication probability [0−1]
0.00
0.01
0.02
0.03
0.04
50
75
100
Average of stem relative water content and ste
Daily dessication probability [0−1]
Uncertainty of stem pressure-volume parameters
As explained in 15.1.5, using stem relative water content as indicator of dessication has the inconvenient
that the parameters π0,stem and ϵstem specifying the pressure-volume curve are often not known, so that
estimates have to come from wood density (see section A.3.13). The following figure shows the water potential
corresponding to the dessication threshold for species with different wood density:

17.4. PLANT MORTALITY
199
Abies alba
Cistus albidus
Juniperus communis
Pinus halepensis
Pinus sylvestris
Populus spp.
Quercus ilex
Quercus pubescens
Quercus suber
−7.5
−5.0
−2.5
0.0
0.25
0.50
0.75
1.00
Wood density (g/cm3)
Lethal water potential (40% relative water content)
If the relationship between wood density and the stem pressure-volume curve (A.3.13) does not hold for
a particular species the mortality rate may be under or overestimated. Here an example would be Cistus
albidus, which has a low wood density but high dessication resistance. This is illustrated when we draw a
scatter plot between the water potential corresponding to 60% stem PLC (i.e. 40% stem relative hydraulic
conductance) against the water potential corresponding to 40% stem RWC:

200
CHAPTER 17. GROWTH, SENESCENCE AND MORTALITY
Abies alba
Cistus albidus
Juniperus communis
Pinus halepensis
Pinus sylvestris
Populus spp.
Quercus ilex
Quercus pubescens
Quercus suber
−8
−6
−4
−2
−6
−5
−4
−3
−2
Water potential PLC 60%
Water potential RWC 40% (from wood density)
As explained in 15.1.5, one can avoid the potential uncertainty in dessication mortality by defining the
dessication stress indicator (Dstem) as the maximum of relative water content in the stem (RWCstem) and
relative hydraulic conductance in the stem. When we do so, the following curves are obtained for each of
the previous species:

17.4. PLANT MORTALITY
201
0.00
0.25
0.50
0.75
1.00
−12.5
−10.0
−7.5
−5.0
−2.5
Stem water potential (MPa)
Annual dessication probability [0−1]
Abies alba
Cistus albidus
Juniperus communis
Pinus halepensis
Pinus sylvestris
Populus spp.
Quercus ilex
Quercus pubescens
Quercus suber
0.00
0.01
0.02
0.03
0.04
−12.5
−10.0
−7.5
−5.0
−2.5
Stem water potential (MPa)
Daily dessication probability [0−1]
It is obvious in the former figure that using Dstem is indicator results in curves that are not continuous in
all their range. However, we prefer this inconvenient to the potential overestimation of mortality due to an
uncertainty in the pressure-volume curve parameters.
17.4.5
Overall mortality probability
Every day the model determines for woody cohorts the overall probability of mortality (Pmort,daily) as the
maximum of the basal probability, starvation probability and dessication probability:
Pmort,daily = max(Pbase,daily, Pstarv,daily, Pdessic,daily)
(17.45)
At this point Pmort,daily may be used deterministically (i.e., as a proportion of N to kill) or stochastically
(i.e. throwing a random number between 0 and 1 to determine the mortality event).

202
CHAPTER 17. GROWTH, SENESCENCE AND MORTALITY
17.5
Fire severity
Fire effects on plants follow, with some modifications, the model by Michaletz & Johnson (2008). Buoyant
plume theory is first used to estimate the vertical plume temperature Tplume distribution that will drive
heat transfer to the vascular cambium and vegetative organs. Heat transfer theory is then used to calculate
the depth of vascular cambium necrosis and height of crown foliage and crown bud necrosis. Finally, these
severity metrics are used to define the fate of the plant cohort, as described in section 15.1.6.
17.5.1
Plume temperature distribution
The surface fire is assumed to occur at the time of the day where temperature is Tmax is the maximum daily
temperature. For a line-source plume in a quiescent atmosphere (no wind), the plume temperature Tplume
at height z (in m) can be estimated using (Michaletz & Johnson 2008):
Tplume(z) = min
"
900, Cplume ·
1
z

·
Tmax + 273.15
g
1/3
·

IB
cp,air · ρair
2/3
+ Tmax
#
(17.46)
where Cplume = 2.6 is the plume proportionality constant, g = 9.8 m · s−2 is the gravity constant, IB is
Byram’s surface fireline intensity (eq. (24.131); expressed in kW · m−1), cp,air = 1.007 J · kg−1 ·◦C−1 is
the specific heat capacity of the air and ρair is the air density at temperature Tmax. Because this similarity
analysis fails at heights comparable with the fireline width, Tplume is constrained to a maximum flame
temperature of 900 ◦C.
17.5.2
Foliage and crown bud necrosis
The model predicting the distribution of plume temperature and the residence time of surface fires tR (eq.
(24.132)), are used to determine the height of necrosis for plant organs, here foliage or crown buds, depending
also on their heat capacitance. The estimate (foliage or bud) necrosis height zn (in m) is given by (Michaletz
& Johnson 2008):
zn = Cplume ·

1
Tcrit −Tmax

·
Tmax + 273.15
g
1/3
·

IB
cp,air · ρair
2/3
(17.47)
where Tcrit is the critical temperature of the plume required for organ necrosis, given a residence time tR,
which is estimated using:
Tcrit = Tn −θT · Tmax
1 −θT
(17.48)
Here, Tn is the temperature leading to necrosis, assumed to be 60◦C and θT is defined as the excess temper-
ature ratio, which depends on the organ thermal factor (TF) and tR:
θT = exp(−TF · tR)
(17.49)
The thermal factor TF is normally larger for leaves than buds, given their higher surface are to volume
ratio, resulting in lower values of Tcrit and, therefore, higher values of necrosis height. In the case of leaves,
the thermal factor (TFleaves) is estimated from specific leaf area, SLA, using (Michaletz & Johnson 2006;
Michaletz & Johnson 2008):
TFleaves = SLA · (hleaves/cleaves)
(17.50)
where hleaves = 130 stands for the convection heat transfer coefficient of leaves and cleaves = 2500 is the
specific heat capacity of leaves. Typical values would be TFleaves = 0.208 for SLA = 4 and TFleaves = 0.624
for SLA = 12. Currently, for crown buds a constant TFbuds = 0.130 is assumed, on the basis of values given
in Michaletz & Johnson (2006), but we acknowledge that TFbuds should be at least species-specific. Once

17.6. UPDATE OF STRUCTURAL VARIABLES
203
zn is defined, for either leaves or crown buds, depending on their TF value, the vertical leaf distribution
described in 2.4.6 is used to determine the proportion of crown leaves or crown buds with necrosis.
If the case of a crown fires, i.e. if surface fireline intensity is larger than van Wagner’s critical intensity; eq.
(24.160), then all crown foliage is burned. The same happens if torching occurs for the target plant cohort,
which is determined by calculating a cohort-specific critical intensity. Crown bud necrosis is decided in those
cases by calculating Tcrit using the crown fire residence time and comparing it to the flame temperature,
i.e. 900◦C. Despite these calculations, in practice all crown buds will also normally suffer necrosis under a
crown fire.
17.5.3
Cambium necrosis
Vascular cambium necrosis is a one-dimensional transient conduction problem depending the thermal diffu-
sivity of the bark, αbark, and the surface fire residence time tR. Assuming that the bark surface temperature
is equal to the plume temperature at z = 0.1, i.e. Tplume(0.1), the radial bole necrosis depth, xn (in m), can
be estimated using:
xn = 2 · (αbark · tR)1/2 · erf−1
 Tn −Tplume(0.1)
Tmax −Tplume(0.1)

(17.51)
where erf−1 is the inverse error function. Bark diffusivity (αbark) is estimated following the equations given
in Michaletz & Johnson (2008), which depend on bark’s tissue density, moisture content (estimated assuming
a fine dead fuel) and temperature. Cambium necrosis is determined by comparing xn (in m) with xba (in
mm) the bark thickness of the plant, which in case of trees depends on DBH:
xba = abt · DBHbbt
(17.52)
and in the case of shrubs xba is assumed to be equal to a fixed species-specific value btsh.
17.6
Update of structural variables
17.6.1
Tree diameter, height and crown ratio
In the case of tree cohorts, the new sapwood area (∆SA, in cm2) is translated to an increment in DBH
(∆DBH, in cm) following:
∆DBH = 2 ·
p
(DBH/2)2 + (∆SA/π) −DBH
(17.53)
Furthermore, the model assumes that increments in height are linearly related to increments in diameter
through a function fHD (Lindner et al. 1997):
∆H = fHD · ∆DBH
(17.54)
Hence, fHD represents the height increment (in cm) per each cm of diameter increment. It was customary
in forest gap models to prevent height from being larger than a species-specific value Hmax, so that beyond
some point trees only grew in size by increasing their diameter. Moreover, light conditions influence growth
in height with trees living under the shade of others generally showing larger increases in height than trees
living in open conditions. Hence, our formulation for fHD is (Lindner et al. 1997; Rasche et al. 2012):
fHD =

fHD,min · LP AR + fHD,max · (1 −LP AR)

·

1 −
H −137
Hmax −137

(17.55)
where fHD,min would be the height-diameter ratio for a tree of 137 cm height growing in full light and fHD,max
would be the same ratio for a tree of the same height growing in the shadow, and LP AR is the proportion

204
CHAPTER 17. GROWTH, SENESCENCE AND MORTALITY
of photosynthetically active radiation available at mid-crown height (4.2). This formulation seems slightly
easier to calibrate than that presented in Rasche et al. (2012). Hmax could be dependent on environmental
conditions, but we skip this here, because environmental conditions already affect growth rate and carbon
balance.
After updating tree diameter (DBH) and tree height (H), the model updates tree crown ratio (CR) by
applying allometric relationships that take into account tree size and competition (see details in 21.2.3).
17.6.2
Shrub height and cover
Since shrub structural variables are height and cover, shrub growth is done in a way somewhat different from
trees. Shrubs are often multi-stemmed (some trees also are), so that increases in sapwood area are not easily
related to diameter growth. Since leaf biomass is related to sapwood area, one may model shrub growth
assuming an allometric relationship between phytovolume of individual shrub crowns and photosynthetic
biomass. This strategy entails that shrubs may grow or shrink in size depending on their C balance, in the
same way that tree crowns would become denser or sparser depending on their C balance. Hence, shrubs
can be understood as crowns in the floor.
Starting from live leaf area (m2ům−2) we can calculate the foliar weight per shrub individual (in kgůind−1):
Wleaves =
LAIlive
(N/10000) · SLA
(17.56)
An allometric relationship relating the biomass of leaves plus small branches and crown phytovolume (PV ;
in m3ůind−1) can be drawn from fuel calculations:
Wleaves+branches = Wleaves · r6.35 = absh · PV bbsh
(17.57)
where absh and bbsh are allometric relationships and r6.35 is a species-specific ratio relating the dry weight
of leaves plus small branches to the dry weight of leaves. Inverting this relationship we obtain an expression
of shrub crown phytovolume:
PV =
Wleaves · r6.35
absh
1/bbsh
(17.58)
Phytovolume is defined as the volume occupied by the shrub individual, i.e.:
PV = (Ash/10000) · (H/100)
(17.59)
where Ash is the area of a single shrub individual (in cm2). If we use the following quadratic relationship
between Ash and H:
Ash = aash · Hbash
(17.60)
we can calculate shrub height from phytovolume using:
H =
106 · PV
aash
1/(1+bash)
(17.61)
Finally, the new value for shrub cover (in percent) can be obtained from H and N (in ind·ha−1):
Cover = 100 · (N/10000) · (Ash/10000) = N · aash · H2
106
(17.62)
Note that crown ratio for shrubs is assumed constant in the model. Like for trees, shrub height is limited
to a maximum height Hmax. However, unlike trees, shrubs are not allowed to continue growing once this
maximum size is attained.

Part V
Forest dynamics modelling
205


Chapter 18
Forest dynamics model
This chapter provides an overview of a forest dynamics model, which builds on the previous models and
allows simulating the recruitment, growth, mortality and management of woody plant cohorts in a forest
stand. The model was described in De Cáceres et al. (2023) and is run using function fordyn() for a set of
years.
18.1
Design principles
The design of the forest dynamics model is to a large degree inherited from the water balance and growth
models it builds on. Readers should refer to former sections to learn the design of the basic water balance
(see 3.1), advanced water/energy balance (see 7.2) or growth/mortality processes (see 15.1). Regeneration,
from either seed germination and establishment or via resprouting, and forest management are explicitly
simulated at the level of fordyn() and hence will be the focus of this chapter.
18.1.1
Recruitment from seeds
Recruitment of saplings involves a number of processes (flowering and pollination, fruit/seed production,
dispersal, storage, seed predation, germination, seedling establishment and survival until the sapling stage).
All these processes have their own biotic and abiotic drivers (Price et al. 2001), so that modelling becomes
a challenging task. Processes leading to sapling recruitment are frequently extremely simplified or their
mechanisms ignored in many forest models (Price et al. 2001). The design of the forest dynamics model
with respect to recruitment follows that of many gap models.
Local seed production is considered in a
binary way, where plants are considered fertile and able to produce viable seeds if they reach a given height
(different for shrubs and trees). Alternatively, the user can specify a set of species whose seeds arrive to the
target stand via simulation control parameters or dispersal processes (see chapter 20). A seed bank exists
in the forest stand, where seed levels are relative (up to 100%) and result from the interplay between seed
rain and seed mortality. Actual recruitment from seeds depends on a set of regeneration thresholds are used
to determine whether recruitment of new saplings (i.e. ingrowth into a given diameter class for trees or size
for shrubs) is possible. Typically, regeneration thresholds concern environmental conditions, although some
models also consider ungulate browsing (Wehrli et al. 2007). In our case we focus on three environmental
drivers limiting the transition from seedlings to saplings:
1. Tolerance to low temperatures, indicated by the mean temperature of the coldest month.
2. Drought tolerance, indicated by the annual moisture index (annual precipitation divided by annual
evapotranspiration).
3. Shade tolerance, indicated by the percentage of photosynthetic active radiation reaching the ground.
207

208
CHAPTER 18. FOREST DYNAMICS MODEL
A target species can recruit on a given year if current conditions for all three environmental indicators are
above the species tolerance thresholds. A constant probability of recruitment determines actual recruitment
within these bioclimatic limits. Recruitment densities and plant size of recruited individuals are specified
via species parameters. Trees recruited from seed are subject to self-thinning processes before attaining the
diameter of ingrowth (see 17.4.1).
18.1.2
Resprouting
Resprouting is a common feature of Mediterranean species. Most, if not all, Mediterranean broadleaved
species are able to resprout from buds protected in branches, subterranean structures (e.g. burl, taproot,
lateral roots) or in the root collar after a disturbance destroys the aerial part. Yet, some differences in the
resprouting ability (i.e. survival) exist regarding the type of disturbance and the species affected.
In medfate, resprouting is assumed happen from buds at the stump/stool level after a given disturbance
has led to aboveground plant die-back. Resprouting can occur as a response to different disturbances. For
example, resprouting occurs after clipping (e.g. if management is applied), after a fire, or after cavitation
has led to dessication of above-ground plant organs.
Regarding disturbance type, differences in survivorship through resprouting mostly depends on the intensity
of the disturbance experienced, with an increasing occurrence of mortality after disturbances in the following
order: browsing, cutting, drought and fire (Espelta et al. 1999). Fire is the disturbance that causes greatest
mortality, probably because it may physically destroy part of the bud bank due to lethal temperatures or
directly charring it (Pausas et al. 2016). Moreover, resprouting vigor also depends on the size of the plant
(Moreira et al. 2012). According to different literature sources, the number of resprouts initially produced
is approximately 2 per 1 cm2 of stump area (Retana et al. 1992; García-Jiménez et al. 2017). Hence, in
medfate the final density of resprouts depends on the disturbance that caused resprouting (via survivorship)
and on the diameter of the parent plant, but in all cases the resprouts inherit the root system of their parent.
Like saplings originated from seeds, resprouts are subject to self-thinning processes before attaining the
diameter of ingrowth (see 17.4.1).
18.1.3
Forest management
Forest management is an optional process in fordyn() simulations. Furthermore, management actions need
to be defined in an external function to be supplied by the user. This design was chosen because there are
multiple potential management strategies, and different traditions are followed in different countries. To
work properly within fordyn() simulations, the supplied management function needs to accept a forest
object as input, as well as a list of management parameters, and it has to return the reduction in tree density,
the reduction in shrub cover and the management parameters to be applied in subsequent calls.
Although the former design allows users to tailor management functions to their simulation needs, the package
includes defaultManagementFunction() to facilitate the simulation of these process in many situations, and
which is briefly described here. The function implements two different management models:
• Irregular management: An uneven-aged stand is managed using thinning operations each time a thresh-
old value of a chosen stand-level metric (such as basal area or Hart-Becking index) is trespassed.
Thinning operations can focus on trees of specific diameter classes.
• Regular management:
An even-aged (monospecific) stand is managed in cycles where thinning
(preparatory) cuts are followed by final (regeneration) cuts. Thinning operations are similar as those
of irregular management. One or several final cuts can be scheduled, the first starting whenever mean
diameter surpasses a chosen threshold, and the following after a chosen number of years. Optionally,
tree planting (of a chosen species) can be scheduled to occur after the last final cut.

18.2. STATE VARIABLES
209
The former models apply cuts on tree cohorts irrespective of their species. The default management function
applies shrub clearing each time there is an operation on trees, resulting in removal of any shrub cover above
a given maximum value.
18.2
State variables
The main state variables of the forest dynamic model are those conforming the structure and composition of
the forest stand, i.e. the set of woody cohorts (either trees or shrubs) and their attributes (height, density,
DBH, cover, etc.). Additionally, the seed species identity and relative abundance in the seed bank are also
state variables of the model.
Since the model performs calls to the growth() model, many other state
variables are defined for intra-annual simulations (see 15.4). When including forest management action,
additional state variables may be defined as management parameters.
18.3
Process scheduling
The fordyn() model divides the period to be simulated in years, which is the top-level time step of simula-
tions. Given an input forest object, the function first initializes the input for function growth(). For each
year to be simulated the model the performs the following steps:
1. Calls function growth() to simulate daily water/carbon balance, growth and mortality processes (sub-
daily processes may also be involved in transpirationMode = "Sperry" or transpirationMode =
"Sureau"). See section 15.4 for details of growth scheduling.
2. If a management function is supplied, calls this function and apply the resulting reductions in tree
density and shrub cover.
3. If required, simulates seed production, seed bank mortality, seed rain, recruitment from seeds and/or
resprouting. In a spatial context, seed rain will include seeds dispersed from other forest stands 20.
4. Removes tree (or shrub) cohorts whose remaining density (resp.
cover) is lower than a specified
threshold.
5. Merges surviving cohorts with recruitment in the forest object and prepares the input of function
growth() for the next annual time step.
6. Store current status of the forest object and update output tables/summaries.
18.4
Inputs and outputs
An important difference between fordyn() and the previous simulation functions is that it does not require
a specific input object, as in spwb()or growth() functions. In other words, soil, vegetation, meteorology
and control inputs are directly introduced as parameters to the function call to fordyn().
18.4.1
Soil, vegetation and meteorology
Soil
Soil input requirements are the same as for the former models and were fully described in section 2.3.
Vegetation
Unlike the former models, vegetation input for fordyn are objects of the class forest, which were described
in section 2.4.4.
Metereological input

210
CHAPTER 18. FOREST DYNAMICS MODEL
The minimum weather variables required to run the model are min/max temperatures (Tmin and Tmax),
min/max relative humidity (RHmin and RHmax), precipitation (P) and solar radiation (Rad). Wind speed
(u) is also needed, but the user may use missing values if not available (a default value will be used in this
case). Wind speed is assumed to have been measured at a specific height above the canopy (by default at 2
m). Atmospheric CO2 concentration (Catm) may also be specified, but if missing a default constant value is
assumed, which is taken from the control parameters. Definitions and units of these variables were given in
section 2.5.
18.4.2
Vegetation functional parameters
The forest dynamics model requires many functional parameters to be specified for plant cohorts. Some
of them depend on whether the basic or advanced water balance is adopted, whereas others are inherited
from the growth model. Here we report functional parameters needed in addition to those necessary for the
growth model (see 15.5.2).
All of them concern the simulation of recruitment and are specified in the species parameter table
(i.e. SpParams).
Symbol
Units
R
Description
Hseed
cm
SeedProductionHeight
Minimum height for seed production
SM
mg
SeedMassSeed dry mass
SL
yr
SeedLongevity
Seedbank average longevity
Dispdist
m
DispersalDistance
Distance parameter for dispersal kernel
Dispshape
DispersalShape
Shape parameter for dispersal kernel
Precr
[0-1]
ProbRecrProbability of recruitment from seeds within the bioclimatic limits
imposed by temperature, moisture and light thresholds
TCMrecr
◦C
MinTempRecr
Minimum average temperature (Celsius) of the coldest month for
successful recruitment from seeds
MIrecr
MinMoistureRecr
Minimum value of the moisture index (annual precipitation over
annual PET) for successful recruitment from seeds
FPARrecr
%
MinFPARRecr
Minimum percentage of PAR at the ground level for successful
recruitment from seeds
Ntree,recr
ind · ha−1
RecrTreeDensity
Density of tree recruits from seeds.
Ntree,ingrowth ind · ha−1
IngrowthTreeDensity
Density of trees reaching ingrowth DBH.
DBHtree,recr
cm
RecrTreeDBH
DBH for tree recruits from seeds or resprouting (e.g. 1 cm).
DBHtree,ingrowth
cm
IngrowthTreeDBH
Ingrowth DBH for trees (e.g. 7.5 cm).
Htree,recr
cm
RecrTreeHeight
Height for tree recruits from seeds or resprouting
Covershrub,recr%
RecrShrubCover
Recruitment cover for shrubs
Hshrub,recr
cm
RecrShrubHeight
Recruitment height for shrubs
Z50recr
mm
RecrZ50 Soil depth corresponding to 50% of fine roots for recruitment
Z95recr
mm
RecrZ95 Soil depth corresponding to 95% of fine roots for recruitment
Respfire
RespFireNumber of resprouts per stem after fire disturbance
Respdist
RespDistNumber of resprouts per stem after undefined disturbance (typically
desiccation)
Respclip
RespClipNumber of resprouts per stem after clipping
18.4.3
Control parameters
Control parameters modulate the overall behavior of fordyn simulations, which extend the parameters used
for growth simulations (see section 15.5.3). First, there are parameters that regulate the application of seed
production, seed bank dynamics, recruitment from seeds, resprouting and the removal of cohorts with few
individuals:

18.4. INPUTS AND OUTPUTS
211
• applySeedBankDynamics [= TRUE]: Boolean flag to indicate that seed bank dynamics (seed produc-
tion, seed bank mortality and seed rain) need to be simulated.
• applyRecruitment [= TRUE]: Boolean flag to indicate that recruitment from seeds is allowed.
• applyResprouting [= TRUE]: Boolean flag to indicate that resprouting is allowed.
• recruitmentMode [= "stochastic"]: String describing how recruitment from seeds is applied. Cur-
rent accepted values are “deterministic” or “stochastic”.
• removeEmptyCohorts [= FALSE]: Boolean flag to indicate the removal of cohorts whose density is too
low.
• minimumTreeCohortDensity [= 1]: Threshold of tree density resulting in cohort removal.
• minimumShrubCohortCover [= 0.01]: Threshold of shrub cover resulting in cohort removal.
• dynamicallyMergeCohorts [= TRUE]: Boolean flag to indicate that cohorts should be merged when
possible. This option speeds up calculations but results in a loss of cohort identity and reinitialization
of many state variables.
Next, a few parameters control the production/arrival of seeds:
• seedRain [= NULL]: Vector of species names whose seed rain is to be added to seed bank, regardless
of local seed production.
• seedProductionTreeHeight [= 300]: Default minimum tree height for producing seeds (when species
parameter SeedProductionHeight is missing).
• seedProductionShrubHeight [= 30]:
Default minimum shrub height for producing seeds (when
species parameter SeedProductionHeight is missing).
Then we have default parameters determining whether recruitment occurs:
• probRecr [= 0.05]: Default annual probability of recruitment (when species parameter ProbRecr is
missing).
• minTempRecr [= 0]: Default threshold of minimum average temperature of the coldest month neces-
sary for recruiting (when species parameter MinTempRecr is missing).
• minMoistureRecr [= 0.3]: Default threshold of minimum moisture index (annual precipitation over
annual ETP) necessary for recruiting (when species parameter MinMoistureRecr is missing).
• minFPARRecr [= 10]: Default threshold of minimum fraction of PAR (in %) reaching the ground
necessary for recruiting (when species parameter MinFPARRecr is missing).
Finally, there are a set of parameters specifying default values for recruited cohort attributes:
• recrTreeDBH [= 1]: Default DBH (cm) for recruited trees (when species parameter RecrTreeDBH is
missing).
• recrTreeDensity [= 100]: Default density (ind·ha-1) for recruited trees (when species parameter
RecrTreeDensity is missing).
• recrTreeHeight [= 100]:
Default height (cm) for recruited trees (when species parameter
RecrTreeHeight is missing).
• recrShrubCover [= 1]:
Default
cover
(%)
for
recruited
shrubs
(when
species
parameter
RecrShrubCover is missing).
• recrShrubHeight [= 100]:
Default height (cm) for recruited shrubs (when species parameter
RecrShrubHeight is missing).
• recrTreeZ50 [= 100]: Default value for Z50 (mm) in recruited trees (when species parameter RecrZ50
is missing).
• recrShrubZ50 [= 50]: Default value for Z50 (mm) in recruited shrubs (when species parameter
RecrZ50 is missing).
• recrTreeZ95 [= 1000]:
Default value for Z95 (mm) in recruited trees (when species parameter
RecrZ50 is missing).
• recrShrubZ50 [= 500]: Default value for Z95 (mm) in recruited shrubs (when species parameter
RecrZ50 is missing).

212
CHAPTER 18. FOREST DYNAMICS MODEL
18.4.4
Model output
Element
Description
StandSummary
A data frame with stand-level summaries (leaf area index, tree basal area, tree density,
shrub cover, etc.) at the beginning of the simulation and after each simulated year.
SpeciesSummaryA data frame with species-level summaries (leaf area index, tree basal area, tree density,
shrub cover, etc.) at the beginning of the simulation and after each simulated year.
CohortSummary A data frame with cohort-level summaries (leaf area index, tree basal area, tree density,
shrub cover, etc.) at the beginning of the simulation and after each simulated year.
TreeTable
A data frame with tree-cohort data (species, density, diameter, height, etc.) at the
beginning of the simulation (if any) and after each simulated year.
DeadTreeTable A data frame with dead tree-cohort data (species, density, diameter, height, etc.) at the
beginning of the simulation and after each simulated year.
CutTreeTable
A data frame with cut tree-cohort data (species, density, diameter, height, etc.) per each
simulated year.
ShrubTable
A data frame with shrub-cohort data (species, density, cover, height, etc.) at the beginning
of the simulation and after each simulated year.
DeadShrubTableA data frame with dead shrub-cohort data (species, density, cover, height, etc.) at the
beginning of the simulation (if any) and after each simulated year.
CutShrubTable A data frame with cut shrub-cohort data (species, density, cover, height, etc.) per each
simulated year.
ForestStructures
A list with the forest object of the stand at the beginning of the simulation and after
each simulated year.
GrowthResults A list with the results of calling function growth (i.e., see 15.5.4) for each simulated year.
ManagementArgsIf management is considered, a list of management arguments to be used in another call to
fordyn().
NextInputObjectAn object of class growthInput to be used in a subsequent simulation.
NextForestObject
An object of class forest to be used in a subsequent simulation.
18.5
Process details
18.5.1
Seed production and seed bank dynamics
The model considers mortality of seeds in the seed bank before adding new seeds. Annual seed bank
mortality is simulated for each species using an exponential decay function, driven by the species-specific
seed longevity (SL):
Seedst+1 = Seedst · exp(−1/SL)
(18.1)
To determine seed production, the model determines the seed rain in the stand by determining which cohorts
have total plant heights above maturity thresholds for trees and shrubs. This is done, for each cohort, by
comparing its height with the species-specific parameter seed production height (Hseed). Missing values of
Hseed are given values from control variables seedProductionTreeHeight and seedProductionShrubHeight
for trees and shrubs, respectively. In addition to locally produced seeds, the user can use control parameter
seedRain to specify a list of species names whose seeds arrive to the stand. Despite the origin, in non-spatial
simulations the seed bank relative amount of species with seed rain is set to 100%, assuming that there is
enough seed production to allow normal recruitment. However, when simulations are conducted in a spatial
context, the species identity and relative amount of seeds is determined via dispersal sub-model (see chapter
20).

18.5. PROCESS DETAILS
213
18.5.2
Recruitment from seeds
Actual sapling recruitment (i.e. recruitment of small trees, typically 1 cm diameter) depends on envi-
ronmental conditions in the stand. Specifically, the model calculates, for the year that ended, the mean
temperature of the coldest month (TCM), the moisture index (MI) and the fraction of photosynthetic
active radiation reaching the ground, given the current structure (FPAR). These values are compared to
species specific parameter thresholds TCMrecr, MIrecr and FPARrecr, respectively. More specifically, a
given species j can recruit only if TCM > TCMrecr,j, MI > MIrecr,j and FPAR > FPARrecr,j. These
filters do not ensure recruitment, as it is assumed that multiple processes can further determine the death of
recruits. A probability of recruitment Precr is used to represent these additional processes. When simulation
of recruitment is stochastic, a given species will recruit if (in addition to the bioclimatic limits) a Bernouilli
draw falls below Precr and, if so, the initial density or cover will be fixed. If recruitment is deterministic,
then the probability of recruitment is used to multiply the recruitment density or cover.
Tree recruitment density, diameter and height are determined by parameters Ntree,recr, DBHtree,recr and
Htree,recr, respectively; whereas cover and height of shrub recruitment is determined by parameters Coverrecr
and Hshrub,recr, respectively. Density/cover of recruits is reduced depending on the relative amount of seeds
in the seed bank (i.e. maximum density or cover will occur if seed bank levels are 100%). If stochastic
simulation of recruitment is requested, then density or cover values are considered mean values of a Poisson
distribution. Note that density of tree recruits will decrease during the years after recruitment due to a
self-thinning process, until DBH reaches DBHtree,ingrowth where N will be Ntree,ingrowth, as explained in
17.4.1.
18.5.3
Resprouting
Currently, resprouting only occurs in the model if plant cohorts have been cut, burned or they died of
desiccation (future model versions will include resprouting after fire impacts). In other words, resprouting
does not occur for baseline mortality, self-thinning of recruits or due to starvation.
Resprouting survivorship
The model first determines resprouting survivorship, which depends on the disturbance type and, in the
case of fire, on species identity. Unfortunately, we lack information on the mortality caused in resprouting
by cutting or drought for the vast majority of species except for holm oak (Quercus ilex). Thus, we suggest
applying tentatively to all species the mortality values obtained in different studies for this species: 2.5%
after browsing (Espelta et al. 2006), 4% after cutting (Retana et al. 1992), 5% after drought (Lloret et al.
2004). Larger differences among species have been reported for fire (Espelta et al. 2012). This pattern may
be linked to inter-specific differences in the size of the bud bank, the degree of bud protection or the amount
of stored resources in belowground organs (burl, taproot). Accordingly, default values for survivorship are
Respclip = 0.96 (for cutting) and Respdist = 0.95 (for dessication), whereas no default value is given for
Respfire. Naturally, the number of surviving trees (stumps) is given by the number of trees affected by the
disturbance multiplied by the survivorship rate:
Nsurv = Nmort,dist · Respdist
(18.2)
for a generic disturbance, but the same equation would apply for cutting, dessication or fire.
Resprouting vigor
For those individuals that survive the disturbance event and are able to resprout, the number of resprouts
present in a given moment is a matter of the stump area and age. According to different literature sources,
the number of resprouts initially produced is approximately 1.82 per 1 cm2 of stump area, but owing to
the intra- and inter-individual competition (self-thinning), the number of resprouts will decrease with time
following an exponential equation (Retana et al. 1999. Espelta et al. 1999, 2013):
Nresp = Nsurv · π · (DBH/2)2 · 1.82 · 10−0.053·x
(18.3)

214
CHAPTER 18. FOREST DYNAMICS MODEL
where DBH is diameter at breast height of the parent tree cohort, in cm, x = 5 is time in years, Nresp is
the number of resprouts, Nsurv is the number of parent trees that survived.
Initial characteristics and self-thinning
Tree resprouts have all a starting diameter DBHtree,recr and a height Htree,recr, but the root system is the
same of the parent tree cohort. Analogously to recruitment from seeds, the initial density of tree resprout will
decrease during the years after the initial resprouting due to a self-thinning process, until DBH reaches
DBHtree,ingrowth where N will be Ntree,ingrowth, as explained in 17.4.1.
Resprouting in shrubs
In the case of shrub species, the same operations are done, but on cover values instead of density values.
Shrub height of resprouts is assumed to be Hshrub,recr.

Part VI
Landscape/regional modelling
215


Chapter 19
Watershed hydrology
This chapter describes the distributed watershed water balance sub-model implemented in functions
spwb_land(), growth_land() and fordyn_land() of package medfateland (Fig. 1.3).
19.1
Design principles
Watersheds are described in raster (i.e. gridded) mode, each cell representing a patch of vegetation (or
another land cover) in a catchment. Land cover types are:
a. wildland: forests, shrublands or grasslands.
b. agriculture: agricultural lands.
c. rock: rock outcrops.
d. artificial: urban areas.
e. water: water bodies.
Watershed water balance simulations extend the simulation of soil water balance to the landscape scale.
Hence, the design of most vertical hydrological processes is the same as those of forest water balance. How-
ever, additional water compartments and processes are represented in watershed water balance simulations.
Each cell in the watershed may include the following: a snow-pack compartment, one or several soil layers
(including a rocky layer down to several meters depth), and a groundwater compartment assumed to be
beyond the reach of plant roots. Similar to other models such as TETIS (Francés et al. 2007), three lateral
flows are considered between adjacent cells:
(i) Overland surface flows from upper elevation cells.
(ii) Lateral saturated soil flows (i.e. interflow) between adjacent cells.
(iii) Lateral groundwater flow (i.e. baseflow) between adjacent cells.
Overland surface flows are modeled following T-HYDRO Ostendorf & Reynolds (1993). Subsurface flows,
including both soil saturated flow and groundwater flow, are modeled following the kinematic wave approach
of DSHVM Wigmosta et al. (1994).
Split-parameter parametrization following Francés et al. (2007).
217

218
CHAPTER 19. WATERSHED HYDROLOGY
19.2
State variables
Distributed simulation of rainfall-runoff processes implies that state variables are defined for each cell of the
watershed. For this kind of simulations, state variables describing the water content of different compartments
are the most important. In the case of wildland and agriculture cells these are:
• Ws, the proportion of soil moisture in relation to field capacity for each soil layer s in the cell.
• Ssnow the snow water equivalent (mm) of the snow pack storage over the cell surface.
• Saquifer the water content (mm) in the cell’s aquifer beyond the reach of plant roots.
Additional cell state variables in wildland cells concern the water status (or other state variables) of plant
cohorts in the cell, and they were described in chapters 3 and 7. In the case of cells of other land cover types
(i.e. rock, artificial or water) soils are not defined, and neither are soil state variables.
19.3
Water balance
In distributed watershed simulations water balance can be defined both at the cell level and at the watershed
level.
19.3.1
Cell level water balance
At the cell level, daily variations in water content can occur in the snowpack, soil or groundwater compart-
ments:
1. Variations in snowpack water equivalent content follows eq. (3.2).
2. Variations in soil water content (∆Vsoil) need to account for additional flows and are summarized as
(compare to (3.5)):
∆Vsoil = Pr + Sm + Ro + Ad −In −Ru −Dd −Es −Tr + ∆Ssat
(19.1)
where Pr is precipitation as rainfall, Sm is snowmelt, Ro is surface runon water entering the cell from
neighboring cells at higher elevation, Ad is aquifer discharge, In is rainfall interception loss, Ru is cell
surface runoff, Dd is deep drainage towards the aquifer, Es is soil evaporation, Tr is plant transpiration
and ∆Ssat is the variation in soil water content derived from the balance between saturated soil lateral
inputs and outputs.
3. Variations in the aquifer water content of a cell are summarized by:
∆Saquifer = Dd −Ad −∆Sbase
(19.2)
where ∆Sbase is the variation in water content of the aquifer derived from the balance between ground-
water lateral inputs and outputs.
19.3.2
Watershed water balance
At the watershed level, separate water balances can again be defined for the average water content of
snow pack, soil or groundwater compartments. These result from averaging water balances across cells.
Additionally, a water balance is defined regarding the overall water content in the watershed.
1. Changes in the average snow pack water equivalent over cells is the result of balancing precipitation
as snow (Ps) and snow melt (Sm), both flows averaged over cells:
∆ˆSsnow = ˆ
Ps −ˆ
Sm
(19.3)
where ˆ
Ps and
ˆ
Sm are the average snow fall and snow melt over cells.

19.4. PROCESS SCHEDULING
219
2. Changes in the average soil moisture (∆ˆVsoil) are the result of pooling soil inputs and outputs over
cells, which yields:
∆ˆVsoil = ˆ
Pr + ˆ
Sm + ˆ
Ad + ˆ
Ro −ˆ
Ru −ˆ
In −ˆ
Dd −ˆ
Es −ˆ
Tr
(19.4)
where
ˆ
Pr,
ˆ
Ad,
ˆ
Ro,
ˆ
Ru, ˆ
In,
ˆ
Dd,
ˆ
Es and ˆ
Tr are the average (over cells) of precipitation (including
rain and snow), aquifer discharge, lateral surface water input (runon), runoff, rainfall interception loss,
deep drainage, soil evaporation and plant transpiration, respectively. Lateral saturated soil flows are
not included as they cancel out at the watershed level.
3. Changes in the average of cell aquifer water content (∆ˆSaquifer) are the result of balancing deep
drainage (Dd) from soils and aquifer discharge (Ad):
∆ˆSaquifer = ˆ
Dd −ˆ
Ad
(19.5)
4. If we integrate the three water compartments, water balance at the watershed level is given by:
∆Swatershed = ˆ
Pr −ˆ
In −ˆ
Es −ˆ
Tr −ˆ
Ex
(19.6)
where ∆Swatershed = ∆ˆSsnow + ∆ˆVsoil + ∆ˆSaquifer is the change in water content in the watershed
and ˆ
Ex is the water exported as runoff from cells without neighbors (i.e. catchment outlet cells).
19.4
Process scheduling
For every day to be simulated, the model performs the following steps:
1. Calculation of soil and groundwater hydraulic heads for each cell (see 19.6.1).
2. Calculation of soil and groundwater lateral flows between adjacent cells, according to hydraulic gradi-
ents (see 19.6.1).
3. Apply changes in cell soil moisture content due to soil lateral flows (i.e. determine ∆Ssub for each cell),
including the possibility of a return flow to the surface if the soil becomes saturated (i.e. saturation
excess flow).
4. Apply changes in cell aquifer water content, including the possibility of discharge from the aquifer to
the soil and a saturation excess flow (eq. (19.2)).
5. Determine remaining cell flows by processing watershed cells in order of decreasing elevation (i.e. cells
at higher elevation are processed before cells at lower elevation). For each cell to be processed:
a. For wildland or agriculture cells, determine snow-pack dynamics, rainfall interception loss, infil-
tration and runoff, transpiration, soil evaporation processes as described in 3.4, while including
saturation excess flow as well as potential runon (Ro) from upslope cells as additional water inputs.
For rock and artificial cells, snow pack dynamics is still processed in these cells, but all runon
or rainfall input becomes runoff to be passed downhill, and when the level of the aquifer reaches
the surface any discharge also becomes runoff. In the case of water cells, snow pack dynamics is
also processed, but evaporation from the water surface is not modelled. All liquid water inputs
are poured onto the aquifer water content, and runoff can still occur when the aquifer reaches the
surface.
b. Distribute surface runoff among cells downhill (19.6.2). If a cell does not have downhill neighbors
(i.e outlet cell) its runoff becomes water exported from the watershed.
19.5
Inputs and outputs
19.5.1
Gridded inputs
Hydrological distributed models demand large amounts of data, information and parameters in order to
accurately represent the spatial variability of the main hydrological processes and weather inputs. As men-
tioned in design principles, watersheds are described in raster (i.e. gridded) mode, each cell representing

220
CHAPTER 19. WATERSHED HYDROLOGY
a patch of vegetation (or another land cover) in a catchment. Rasters do not need to be (should not be)
complete, since the model is intended to be used on individual catchments with defined boundaries.
Given a set of grid cells representing the watershed at a given spatial resolution, input data for spwb_land()
and growth_land() should be specified using sf objects. These were described in section 2.1.2.
19.5.2
Watershed meteorology input
Simulation of watershed hydrology requires specifying weather variables for all cells and the simulation period
considered. Functions spwb_land() and growth_land() allow weather to be specified in three ways:
• If a single data frame of daily weather is provided, the model assumes that all watershed cells experience
the same weather.
• A different data frame of daily weather may be provided for each cell, using column meteo of the sf
object (see 2.1.2).
• If an interpolator object of class stars is provided, the model will call function interpolate_data()
for every day to be simulated (see meteoland package documentation).
19.5.3
Watershed hydraulic correction parameters
Distributed hydrological models suffer from the need to specify many parameters. Frances et al. (2007)
demonstrated that by using a proper parameter structure, it is possible to obtain an excellent automatic
calibration of a distributed conceptual model while maintaining the spatial variability of parameters. In
particular, they showed how to define effective model parameters for those quantities normally estimated
at the point scale, so that model parameters and estimates usually suffer from being uncommensurable.
Effective model parameters can in this situation be defined as a correction function of the corresponding
hydrological characteristic. If the correction function takes into account the model and input errors, the
temporal and spatial scale effects and also the hydrological characteristics estimation error, it is reasonable
to assume the correction function for each parameter will be common to all cells within the watershed.
Frances et al. (2007) suggest using a correction factor for each hydraulic parameter, in a strategy called
split-parameter. From the calibration point of view, a very important consequence of the split-parameter
approach is that the number of variables to be adjusted is reduced dramatically.
Our model follows Frances et al. (2007) in that correction factors are defined for three hydraulic parameters
with spatial variation across the watershed:
• Kdrain vertical saturated soil conductivity for deep drainage.
• Ksat horizontal saturated soil conductivity for soil lateral flows.
• Kbase bedrock conductivity for groundwater lateral flows.
The effective model parameter for each of these is defined for the spatial (depending on the grid resolution)
and temporal (daily) scales of the model. Each effective parameter is split into the input value, assumed
to have been estimated at a given spatial and temporal scale, and the corresponding correction factor,
i.e. Rdrain, Rsat and Rbase.
The values for these correction factors should be the target of calibration
procedures, assuming that the spatial heterogeneity of effective parameters is adequately covered by the soil
and bedrock spatial inputs.
19.5.4
Model outputs
Distributed hydrological models can produce very detailed spatial and temporal outputs, hence consuming
lots of memory resources. While the model runs at a daily scale, functions spwb_land() and growth_land()

19.6. PROCESS DETAILS
221
can be asked to retain spatial outputs and summaries at coarser temporal scales (i.e. weekly, monthly, etc.).
The output of functions spwb_land() and growth_land() is an S3 list with the following data elements:
Element
Description
sf
An object of class sf containing the geometries, final state and temporal summary for each
of the landscape cells (values in mm/day, mm/week, mm/month or mm/year depending on
summary frequency).
watershed_balance
Data frame with spatially-averaged (over watershed cells) components of the water balance
corresponding to each temporal summary (values in mm/day, mm/week, mm/month or
mm/year depending on summary frequency).
watershed_soil_balance
Spatially-averaged (over watershed cells) components of the water balance, including only
cells that have defined soils (i.e. wildland and agriculture cells), corresponding to each
temporal summary (values in mm/day, mm/week, mm/month or mm/year depending on
summary frequency).
daily_runoff
A matrix with daily runoff (in m3/day) at each of the outlet cells of the landscape.
19.6
Process details
19.6.1
Subsurface flows
Both soil saturated lateral flow and groundwater lateral flow follow the saturated subsurface flow model of
Wigmosta et al. (1994), which is based on a kinematic wave approximation. Each grid cell can exchange
water with its eight adjacent neighbors. Local hydraulic gradients are approximated by local ground surface
slopes, so that each cell will generally receive water from its upslope neighbors and discharge to its downslope
neighbors. The rate of saturated flow from cell i to its downgradient neighbors is equal to (Wigmosta &
Lettenmaier 1999):
qij
=
−Ti · tan(βi,j) · wj βi,j < 0
(19.7)
qij
=
0 βi,j ≥0
(19.8)
where qi,k is the flow rate from cell i in the direction towards neighbor j, Ti is the transmissivity at cell i,
βi,j is the water table slope in the direction of j. The transmissivity function for soil saturated lateral flow
in cell i (Tsat,i) is specified using:
Tsat,i = Rsat · Ksat,i · Zsoil,i
nsat
· (1 −Zwt,i/Zsoil,i)nsat
(19.9)
where Ksat,i is the saturated conductivity of the first (top) soil layer in cell i, Zsoil,i is the soil depth at
cell i, Zwt,i is the water table depth at cell i and nsat is a power exponent. Rsat is a correction factor (a
watershed parameter) for the fact that Ksat,i is assessed from soil samples, whereas the parameter in the
model is defined at the scale of a grid cell (Francés et al. 2007). The transmissivity function for groundwater
lateral flow in cell i (Tbase,i) is analogous:
Tbase,i = Rbase · Kbase,i · Zbedrock,i
nbase
· (1 −Zaquifer,i/Zbedrock,i)nbase
(19.10)
where Kbase,i is the bedrock conductivity at cell i, Zbedrock,i is the depth of the unaltered bedrock, Zaquifer,i
is the depth of the aquifer water table and nbase is again a power exponent.
Saturated lateral flow inputs and outputs for a given cell i are balanced to determine increase or decrease in
soil moisture:
∆Ssat,i =
X
j
qsat,ji −
X
j
qsat,ij
(19.11)

222
CHAPTER 19. WATERSHED HYDROLOGY
and the same occurs for groundwater lateral flows and aquifer balance:
∆Sbase,i =
X
j
qbase,ji −
X
j
qbase,ij
(19.12)
19.6.2
Overland flows
To simulate surface runoff routing from one cell to the other, the approach of Ostendorf & Reynolds (1993)
is used, as in SIERRA (Mouillot et al. 2001). Overland water lateral transport for a given day occurs
instantaneously (i.e. no velocities are calculated) and depends on topography only. The model determines
cell neighbors following the queen rule (up to eight neighbors per cell). The proportion of surface water
runoff of cell i that will be added to the infiltration input (runon) of a neighboring cell j is Ostendorf &
Reynolds (1993):
qij =
∆zij/Lij
P
j ∆zij/Lij
(19.13)
if ∆zij = zi −zj > 0, that is, if the difference in elevation between the two cells is positive (i.e. if zj < zi).
Otherwise there is no overland transport from i to j, i.e. qij = 0. Lij indicates the distance between cell i
and j (which depends on cell size and on whether the neighboring cell j is diagonal to cell i). The summation
of the denominator is done only for neighbors at lower elevation, so that P
i qij = 1. The table of qij values
is calculated when initializing distributed watershed objects.
Every day, cells are processed in order from higher to lower elevation. After the daily water balance of a
given cell i, water runoff Rui is divided among the neighboring cells at lower elevation. The runon of a
neighbor j, Roj is updated as:
Roj = Roj + Rui · qij
(19.14)
Note that a given cell j can receive overland flow from more than one neighbor.
19.6.3
Watershed runoff
A special situation arises when processing cells that do not have downhill neighbors defined (i.e. where
qij = 0 for all j), either because they are in flat surfaces or at the watershed boundary. In both cases, these
cells should correspond to water bodies or streams connecting to the catchment outlet. Hence, these cells
are called outlet cells in the model, and the runoff they generate becomes watershed runoff.

Chapter 20
Seed dispersal
This chapter describes the seed dispersal sub-model implemented in functions fordyn_scenario() and
fordyn_land() of package medfateland (Fig. 1.3).
20.1
Design principles
Given their sessile lifestyle, dispersal is the only process through which plants can spread in a landscape.
Different parts of plants can be dispersed (seeds, fruits, branches or even the entire plant), but here it is
assumed that seeds are the dispersed elements. Mathematically, dispersal can be addressed via process-based
models (e.g. Nathan et al. (2001)). However, it is more commonly addressed via empirical dispersal kernels,
which describe the statistical distribution of dispersal distances in a population (Nathan et al. 2012). More
specifically, the dispersal kernel is a probability density function describing the distribution of post-dispersal
locations relative to a source point. While many different equations can be used and compared to describe
dispersal (Nathan et al. 2012), here we focus on the exponential power kernel proposed by Clark et al.
(1998), which has shown a good performance compared to other kernels (Bullock et al. 2017) and has been
used for other dynamic vegetation models (Snell 2014). The kernel is isotropic, meaning that is equal in all
directions. Therefore, one can consider dispersal either from source or sink locations.
When implementing a dispersal kernel in a dynamic forest simulation model, an important issue to overcome
is the fact that forest stands in the target landscape are often separated by distances that are larger (e.g. 500
m, 1 km or even more) than the average area that they represent (normally forest plots have a radius between
10 and 25 m). This entails that there is a uncertainty in the model regarding the presence of seed sources
from forest stands at distances between the two scales. In other words, the model does not know whether
there are forest patches that can act as seed sources, between a given target forest stand and its nearest
neighbors (Fig. 20.1). Ignoring this fact can lead to underestimating colonization. We address this issue by
considering that seed sources from unavailable forest stands can be estimated from the set of stands that are
represented in the data set, using weights inverse to their distance to the location of the unavailable stand.
This is illustrated in Fig. 20.1 below with the area with unavailable stands in grey and distances represented
using red and black arrows:
20.2
Process scheduling
Seed dispersal is considered once a year. Process scheduling in the dispersal sub-model is rather straightfor-
ward:
1. Mortality of seeds in first performed for all stands (see 18.5.1).
223

224
CHAPTER 20. SEED DISPERSAL
Figure 20.1: Example of sparse forest stand distribution and how to deal with dispersal in this situation.
The target stand where seed rain is to be determined is represented using a red dot. Blue dots are the
remaining forest stands. The upper figure shows the spatial distribution of stands, whereas the figure below
represents the number of stands per distance classes. In both cases, grey is used to identify an area with
unavailable data.

20.3. PROCESS DETAILS
225
2. Seed production is simulated in all stands with woody vegetation (see 18.5.1).
3. For each target forest stand, seed dispersal (including local seed rain) is simulated, leading to a replen-
ishment of its seed bank.
20.3
Process details
The exponential power kernel depends on species-specific parameters Dispdist and Dispshape and is calculated
for a given distance r using (Clark et al. 1998):
f(r) = 1
N · exp
"
−

r
Dispdist
Dispshape#
(20.1)
where N is the normalizing constant:
N = 2 · π · Disp2
dist · Γ(2/Dispshape)
Dispshape
(20.2)
and Γ() is the Gamma function.
Let i be the stand corresponding to seed sink location (e.g. the red dot in Fig. 20.1). We begin by computing
the geographic distances between i and all the other stands using geographic coordinates x and y (assuming
these are in meters).
d(i, j) =
q
(xi −xj)2 + (yi −yj)2
(20.3)
Let us now consider a given distance value r > 0 from i (e.g. the grey band in Fig. 20.1). We define the
probability of choosing a given stand j for a location at this distance from i as follows:
pi(r, j) = 1
M ·
1
|r −d(i, j)|
(20.4)
where M is an appropriate normalizing factor so that:
n
X
j=1
pi(r, j) = 1
(20.5)
Note that this last equation assumes that the density of spatial points is even across space. If not, the sum
should be lower than one.
Given the above definitions and assuming that seed bank of a given species should be refilled to 100% if and
only if all plots are seed sources for that species, the percentage of seeds of species s reaching the target
location i, i.e. Ps,i, is estimated using:
Ps,i = 100 · 2π ·
Z rmax
r>0
r · f(r) ·


n
X
j=1
I(s, j) · pi(r, j)

· δr
(20.6)
where rmax is the maximum allowed dispersal distance and I(s, j) ∈0, 1 is an indicator variable of the
availability of seed sources of species s in stand j.

226
CHAPTER 20. SEED DISPERSAL

Part VII
Static modules
227


Chapter 21
Allometric models
The purpose of this chapter is to describe how certain plant structural attributes are estimated in medfate
using allometric relationships. These static models are used to initialize vegetation input parameters from
forest plot data before simulations (in functions forest2spwbInput() and forest2growthInput()), to
update vegetation structure during growth simulations or to calculate foliar biomass for fuel assessments.
21.1
Input data
21.1.1
Forest plot data
As explained in section 2.4, medfate has been specially designed to work with forest inventory plots with
data in form of plant cohorts. The tree/shrub cohort attributes required to apply allometric models are the
following:
Symbol
Units
R
Description
trees
shrubs
SPi
SpeciesSpecies identity
Y
Y
Hi
cm
Height Average tree or shrub height
Y
Y
Ni
indůha−1
N
Density of tree individuals
Y
N
DBHi
cm
DBH
Tree diameter at breast height
Y
N
Coveri
%
Cover
Shrub percent cover
N
Y
Most allometric functions require data in form of a forest object (see section 2.4.4).
21.1.2
Species parameters
The following table shows the allometric coefficients needed for the calculations detailed in this chapter.
Symbol
Units
R param
Description
afbt, bfbt, cfbt
a_fbt, b_fbt, c_fbt
Coefficients to calculate foliar biomass of an
individual tree
aash, bash
a_ash, b_ash
Coefficients relating the square of shrub height
with shrub area
absh, bbsh
a_bsh, b_bsh
Coefficients relating crown volume with dry
weight of shrub individuals
229

230
CHAPTER 21. ALLOMETRIC MODELS
Symbol
Units
R param
Description
acr, b1cr, b2cr, b3cr,
c1cr, c2cr
a_cr, b_1cr, b_2cr,
b_3cr, c_1cr, c_2cr
Coefficients to calculate crown ratio of trees
cr
[0-1]
cr
Ratio between crown length and total height for
shrubs
r6.35
r635
Ratio between the weight of leaves plus
branches and the weight of leaves alone for
branches of 6.35 mm
SLA
m2 · kg−1
SLA
Specific leaf area
21.2
Allometric relationships
21.2.1
Leaf biomass
Leaf biomass calculations are done differently for trees and shrub cohorts. They are calculated from forest
objects using function plant_foliarBiomass().
Tree cohorts
Foliar biomass for a single tree of cohort i (FBtree,i; in kg) is calculated using:
FBtree,i = afbt · DBHbfbt
i
· ecfbt·BALi · e−0.0001·Ni
(21.1)
where DBHi is the diameter of the tree (in cm), BALi is the cummulative basal area (m2 · ha−1) of trees
having an equal or larger diameter (including the target tree), Ni is the density of the cohort, and afbt,
bfbt and cfbt are species-specific regression coefficients. The first two determine the relationship between
tree diameter and its foliar biomass, whereas the third one leads to reductions of foliar biomass because of
over-shading and self-shading. Factor e−0.001·Ni reduces foliar biomass for cohorts with very high density
(such as very dense regeneration after a fire). The foliar biomass of the whole tree cohort (FBi; in kg · m−2)
is obtained multiplying tree foliar biomass by tree density (Ni; in ind. · ha−1):
FBi = FBtree,i · (Ni/10000)
(21.2)
Shrub cohorts
To calculate the leaf biomass of a shrub cohort, we first determine Ash,i, the area (in cm2) occupied by one
average individual of height Hi (in cm), using the relationship:
Ash,i = aash · Hbash
i
(21.3)
where aash and bash are species-specific parameters. The model then estimates the dry weight of leaves and
branches up to 6.35mm in diameter (Bsh,i, in kg) of this average individual (i.e. fine fuel biomass), using an
allometric relationship with shrub crown phytovolume assuming a cylinder (in cm3):
Bsh,i = absh · (Ash,i · Hi)bbsh · e−0.235·LAIlive
trees
(21.4)
where absh and bbsh are species-specific parameters. Here LAIlive
trees (m2 · m−2) is the sum of leaf area index
values of tree cohorts, which induces a reduction of Bsh,i similar to the one described for tree foliar biomass
by BALi. This reduction is important for biomass and leaf area estimation of shrubs in forests, since it
has been observed that light availability affects the growth, architecture and bulk density of the understory
(Pimont et al. 2018).
Shrub density (Ni; in ind. · m−2) can be grossly estimated from percent cover (Ci, in percent) and Ash,i (in
cm−2):
Ni =
Ci/100
Ash,i/10000
(21.5)

21.2. ALLOMETRIC RELATIONSHIPS
231
The fine fuel biomass of a shrub cohort (Wi, in kg · m−2) is simply the product of Bsh,i (kg of dry weight)
and Ni:
Wi = Bsh,i · Ni
(21.6)
Foliar biomass (in kg · m−2) can be obtained using the species-specific ratio r6.35,i:
FBi = Wi/r6.35,i
(21.7)
If not known, r6.35,i can be set to a default value of 2 (equivalent to 50% of weight corresponding to leaves).
Herbaceous layer
Foliar biomass of the herbaceous layer (which is equal to its fine fuel loading) is estimated from herbaceous
cover (Coverherb; in %) and height (Hherb; in cm) assuming a constant bulk density coefficient:
FBherb = 0.014 · Coverherb · (Hherb/100.0) · e−0.235·LAIlive
woody
(21.8)
where the factor e−0.235·LAIlive
woody is analogous to that of shrubs (eq. (21.4)), but using the overall leaf area
index of woody cohorts as driving variable.
21.2.2
Leaf area and LAI
Leaf area index (LAI in m2 · m−2) of a given cohort i can be calculated from its foliar biomass (in kg · m−2)
by using a specific leaf area coefficient (SLA, in m2 · kg−1) that in medfate is species-specific:
LAIi = FBi · SLA
(21.9)
The leaf area (LA in m2) of an individual of the cohort is found by dividing it by plant density (Ni, in
ind. · ha−1) and multiplying by 10000 m2 · ha−1:
LAi = 10000 · LAIi/Ni
(21.10)
LAI values of woody cohorts are calculated from forest objects using function plant_LAI().
Leaf area index of the herbaceous layer (LAIherb) is estimated from FBherb by applying a SLA = 9 value,
is limited to LAIherb = 2 m2 · m−2, and can be calculated from forest objects using function herb_LAI().
21.2.3
Crown vertical dimensions
Crown base height, i.e. the height were the first living branch of trees or shrubs occurs, is an important
parameter to know the vertical distribution of leaves (see section 2.4.6). Crown base height of a plant cohort
i (i.e., Hcrown,i, in cm) is related to the total height of the cohort (Hi, in cm) and its crown ratio (CRi),
which is the ratio between crown length and plant height:
Hcrown,i = (1 −CRi) · Hi
(21.11)
In the case of shrubs the crown ratio CRi is normally an input (species-specific) parameter (cr). In the case
of trees, the crown ratio is modelled as a function of tree size and stand competition, following a modification
of the logistic equation of Hasenauer & Monserud (1996) :
CRi =
1
1 + e−(acr+b1cr·HDi+b2cr·(Hi/100)+b3cr·DBH2
i +c1cr·BALi+c2cr·ln(CCFi))
(21.12)
where HDi = Hi/(100 · DBHi) is the height to diameter ratio (in m · cm−1), Hi is the tree height, DBHi is
the diameter, CCFi is the crown competition factor and acr, b1cr, b2cr, b3cr, c1cr and c2cr are species-specific
parameters. The crown competition factor is in turn calculated using (Krajicek et al. 1961):
CCFi =
X
i
Ni · π · (CWi/2)2/100
(21.13)

232
CHAPTER 21. ALLOMETRIC MODELS
where Ni is the tree density and CWi is the crown width (in m) assuming an open-grown tree, estimated
from an allometric relationship with tree diameter:
CWi = acw · DBHbcw
i
(21.14)
where again acw and bcw are species-specific parameters.
Crown ratios can be calculated from forest objects using function plant_crownRatio(). Similar calculations
are performed to estimate crown length and crown base height, with functions plant_crownLength() and
plant_crownBaseHeight(), respectively.

Chapter 22
Post-simulation procedures
22.1
Water use efficiency
233

234
CHAPTER 22. POST-SIMULATION PROCEDURES

Chapter 23
Wind extinction
In this chapter we describe a few wind extinction models that are implemented in medfate. Wind extinction
is rellevant: (a) to determine convective heat exchanges between the soil and the canopy; (b) to estimate wind
speed and energy balance at the leaf level for different plant cohorts; and (c) for fire behaviour calculations.
23.1
Wind speed at the top of the canopy
Input wind speed (u) is assumed to represent the speed of wind at 6 m (20 feet) above the canopy. Following
Albini & Baughman (1979) the wind speed (in můs−1) at the top of the canopy is:
utop = (1.01857 · u) · 0.4265092 · Hcanopy
log(20 + 1.181102 · Htop)
(23.1)
where Htop is the canopy top height in m.
23.2
Wind extinction profile
The wind extinction profile, i.e the wind speed at any height z in m, can be calculated following Massman
(1987):
βstand
=
4.0 · 0.2 · LAIphi
stand
0.16 · 1.52
(23.2)
u(z)
=
utop ·
s
cosh(βstand · z/Htop)
cosh(βstand)
(23.3)
235

236
CHAPTER 23. WIND EXTINCTION

Chapter 24
Fuel characteristics and fire behaviour
24.1
Overview
Functions fuel_FCCS() and fire_FCCS() allow calculating potential fire behaviour for forest inventory plots.
Formulation of fuel characteristics and fire behaviour is an adaptation of the Fuel Characteristics Classifica-
tion System [FCCS; Prichard et al. (2013)]. In FCCS, fuelbed is divided into six strata, including canopy,
shrub, herbaceous vegetation, dead woody materials, leaf litter and ground fuels. All except ground fuels are
considered here. The intensity of burning depends on several factors, including topography, wind conditions,
fuel structure and its moisture content, which is determined from antecedent and current meteorological
conditions. A modification of the Rothermel’s (1972) model is used to calculate the intensity of surface fire
reaction (in kW/m2) and the rate of fire spread (in m/min) of surface fires assuming a steady-state fire.
Both quantities are dependent on fuel characteristics, windspeed and direction, and topographic slope and
aspect.
Fuel and fire behavior calculations provide the following results:
1) Fuel characteristics by stratum.
2) Surface fire behavior (i.e. reaction intensity. rate of spread, fireline intensity and flame length);
3) Crown fire behavior.
4) Fire potential ratings of surface fire behavior and crown fire behavior.
The following figure provide an overview of the steps to calculate surface/crown fire behavior and fire
potentials from fuel characteristics.
24.2
Input data
24.2.1
Forest plot data
As explained in section 2.4, medfate has been specially designed to work with forest inventory plots. The
tree/shrub cohort attributes required to apply allometric models are same as for chapter 21:
Symbol
Units
R
Description
trees
shrubs
SPi
SpeciesSpecies identity
Y
Y
Hi
cm
Height Average tree or shrub height
Y
Y
Ni
indůha−1
N
Density of tree individuals
Y
N
237

238
CHAPTER 24. FUEL CHARACTERISTICS AND FIRE BEHAVIOUR
Symbol
Units
R
Description
trees
shrubs
DBHi
cm
DBH
Tree diameter at breast height
Y
N
Coveri
%
Cover
Shrub percent cover
N
Y
Cohorts are not distinguished for the herbaceous stratum, and the variables needed are:
Symbol
Units
R
Description
Che
%
herbCover
Herbaceous percent cover
Hhe
cm
herbHeight
Mean herb height
Finally, the model also requires the percent cover of trees in the canopy (Cca). This is easily available from
forest inventory data, but could also be derived from the description of tree cohorts.
Fire behaviour functions require data in form of a forest object (see section 2.4.4).
24.2.2
Species parameters
The following functional parameters are required for each species:
Symbol
Units
R
Description
Lshape
Categorical
LeafShapeLeaf shape: “Broad”, “Needle”, “Linear”, “Scale”, “Spines” or
“Succulent”
Lsize
Categorical
LeafSize Leaf size: “Small” (< 225 mm), “Medium” (> 225 mm & <
2025 mm) or “Large” (> 2025 mm)
r6.35
r635
Ratio between the weight of leaves plus branches and the weight
of leaves alone for branches of 6.35 mm
ρwood
g · cm−3
WoodDensity
Density of wood tissue
ρleaf
g · cm−3
LeafDensity
Density of leaf tissue
σi
m2 · m−3
SAV
Surface-area-to-volume ratio of the small fuel (1h) fraction
(leaves and branches < 6.35mm)
h
kJ · kg−1
HeatContent
High fuel heat content.
LD
years
LeafDuration
Leaf duration (in years)
LI
%
PercentLignin
Percentage of lignin in leaves
Leaf shape and size categories are used to determine leaf litter fuel types.
24.2.3
Other inputs
Other inputs may be given by expert opinion or they may be calculated from another model. Specifically,
for each plant cohort (and for any day of application) the fire behaviour model requires:
• Pdead: Proportion of the plant that is dead.
• FMC: Fuel moisture content (in percent of dry weight).
Analogously, the same variables are needed for the herbaceous stratum.
• Pdead,he: Proportion of herb fuels that respond to humidity changes as 1-h dead fuels.
• FMClive,he: Fuel moisture content of live herb fuels (in percent of dry weight).

24.3. FUEL CHARACTERISTICS
239
Figure 24.1: Overview of the steps involved in fire behavior and fire potential calculations starting from fuel
properties
The model also needs the following input parameters:
• FMCdead: the moisture content of 1-h dead fuels (in percent of dry weight).
• U: Midflame windspeed (in m · s−1).
• S: Slope (in percent).
24.3
Fuel characteristics
24.3.1
Fuel strata
The Fuel Characteristics Classification System (FCCS) on which this document is based, defines six fuel
strata (Prichard et al. 2013):
• Canopy: Trees, snags and ladder fuels.
• Shrubs: Primary and secondary layers.
• Non-woody vegetation (herbs): grasses, sedges, rushes and forbs.
• Woody fuels: All downed and dead wood, sound wood, rotten wood and stumps.
• Litter-lichen-moss: Lichen, litter and moss layers.
• Ground fuels: Duff, basal accumulation and squirrel middens.
Shrubs, herbs and woody fuels are constitute the upper surface fuels, whereas herbs and woody fuels alone
consitute the lower surface fuels. FCCS summarizes and calculates characteristics for each fuelbed stratum
and layer. Our model estimates fuel loading and characteristics for canopy, shrub, non-woody vegetation,
as well as fine (1h) woody fuels and litter fuels. Larger woody fuels (10h or 100h) could be considered if
information about forest management actions is available. Ground fuels are not included here.
24.3.2
Cohort fuel loading
Here we consider as burnable fuels foliage and branches up to 6.35 mm = 0.25 in in diameter. The same
consideration applies to both trees and shrubs. They are calculated from forest objects using function
plant_fuel().
Tree cohorts

240
CHAPTER 24. FUEL CHARACTERISTICS AND FIRE BEHAVIOUR
Fine fuel loading for a tree cohort (Wi; in kg · m−2), including its leaves and branches with diameter up to
6.35 mm = 0.25 in, is calculated from foliar biomass (FBi, see eq. (21.2)) using:
Wi = r6.35,i · FBi
(24.1)
where r6.35,i is the ratio between the weight of leaves plus branches and the weight of leaves alone for branches
of 6.35 mm in diameter for the species of cohort i. The biomass corresponding to branches of less than <
6.35 mm (SBBi, also in kg · m−2) is obtained by subtraction:
SBBi = (r6.35,i −1) · FBi
(24.2)
Whereas Wi is the cohort loading variable influencing fire behavior, FBi and SBBi are cohort variables used
to estimate fine dead woody and leaf litter loadings.
Shrub cohorts
Our procedure to estimate shrub fuel loading differs from Prichard et al. (2013) because they calculate first
total biomass of the shrub species and then consider the percentage of total weight that corresponds to leaves
and small branches. In our case, we estimate fine fuel loading (Wi, in kg · m−2) and foliar biomass (FBi, in
kg · m−2) of shrubs from eqs. (21.6) and (21.7). Biomass of small branches (in kg · m−2) can be obtained
from :
SBBi = Wi −FBi
(24.3)
24.3.3
Vertical distribution of cohort fuels
Vertical distribution of fine fuels are distributed between the crown base height (Hcrown,i; in cm) and the
total height (Hi, in cm) following a truncated Gaussian distribution, as done for the distribution of
leaves (see section 2.4.6). Crown base height of trees is calculated as explained in 21.2.3. The loading of a
cohort that occurs within a given height interval of limits H1 and H2 is calculated as:
Wi(H1, H2) = Wi · pi(H1, H2)
(24.4)
where pi(H1, H2) is the proportion of the crown of cohort i that corresponds to the height interval (H1, H2).
24.3.4
Fuel bulk density profile
Knowing at which height fuels are placed, the fuel bulk density profile (Reinhardt et al. 2006) is defined
for any given interval (H1, H2) as the bulk density (kg/m3) of fine fuels corresponding to that interval:
BDP(H1, H2) =
P
i Wi(H1, H2)
H2 −H1
(24.5)
Canopy bulk density normally ranges between 0 and 0.4 kg/m3 (Scott & Reinhardt 2002). Sando & Wick
(1972) arbitrarily defined canopy base height as the lower vertical 0.3-m section with a weight greater than
0.01124kg/m3.
A user-defined threshold tBDP (in kg/m3) in 0.1-m sections is used to differentiate the
surface fuelbed from canopy fuels. Using this threshold the model calculates the following three heights
(Reinhardt et al. 2006):
• Shrub stratum base height, Hsb (in cm): the minimum height between 0 and 2 m where fuel bulk density
is larger than tBDP .
• Shrub stratum top height, Hst (in cm): the maximum height between 0 and 2 m where fuel bulk density
larger than tBDP . With this definition hs cannot be higher than 2 m (corresponding to fuel model 4
in Anderson 1982).

24.3. FUEL CHARACTERISTICS
241
• Canopy base height, Hcb (in cm): In terms of its consequences to crown fire initiation, canopy base
height can be defined as the lowest height above the ground at which there is sufficient canopy fuel to
propagate fire vertically through the canopy. It is calculated as the minimum height over Hst when
the bulk density starts again to be larger than tBDP .
• Canopy top height, Hct (in cm): the maximum height where bulk density is larger than tBDP .
• Canopy gap, Hgap (in cm): the difference between Hcb and Hst. The canopy gap is used to calculate
crown initiation potential.
Figure 24.2 illustrates the definition and analysis of the fuel bulk density profile for a given forest stand (see
function vprofile_fuelBulkDensity()). Following Mitsopoulos & Dimitrakopoulos (2007), a threshold
tBDP = 0.04 is used to determine shrub and canopy heights.
0
250
500
750
1000
0.00
0.05
0.10
0.15
Bulk density (kg/m3)
Height (cm)
Figure 24.2: Bulk density profile of an example forest
24.3.5
Fuel loading (w) and fuel depth (δ)
24.3.5.1
Canopy stratum
Canopy loading (in kg · m−2) is the sum of (tree and shrub) cohort loadings above 2 m (i.e. 200 cm):
wca =
X
i
wi,ca =
X
i
Wi(200, ∞)
(24.6)
where wi,ca is the canopy stratum loading of cohort i. Canopy depth (in m) is defined as the average of tree
(or shrub) crown lengths above 2 m, weighted by the loadings of cohorts in the canopy:
δca =
1
100 ·
P
i wi,ca · (Hi −Hb,i) · pi,ca
P
i wi,ca
(24.7)
where the proportion of a tree (or shrub) cohort in the canopy stratum is pi,ca = pi(200, ∞).

242
CHAPTER 24. FUEL CHARACTERISTICS AND FIRE BEHAVIOUR
24.3.5.2
Shrub stratum
Shrub loading (in kg · m−2) is the sum of (tree and shrub) cohort loadings between the ground and 2 m
(i.e. 200 cm):
wsh =
X
i
wi,sh =
X
i
Wi(0, 200)
(24.8)
where wi,sh is the shrub stratum loading of cohort i. The depth of the shrub stratum (in m) is defined as
the average of tree (or shrub) crown lengths below 2 m, weighted by the loadings of cohorts in the shrub
stratum:
δsh =
1
100 ·
P
i wi,sh · (Hi −Hb,i) · pi,sh
P
i wi,sh
(24.9)
where the proportion of a shrub (or tree) cohort in the shrub stratum is pi,sh = pi(0, 200).
24.3.5.3
Non-woody stratum
Herb percent cover and average herb height are transformed into herbaceous loading (kg · m−2) using (ref
piropinos):
whe = 0.014 · Che · (Hhe/100)
(24.10)
The depth of the herbaceous stratum (in m) is simply the mean height of herbs:
δhe = Hhe/100
(24.11)
24.3.5.4
Woody and litter strata
In FCCS (Prichard et al. 2013), woody surface loading includes several fuel sizes. However, when calculating
surface fire behavior wwo includes 100% of 1h fuels, 25% of 10h fuels and 12.5% of 100h fuels, which represents
the material available for flaming combustion. Obtaining loading estimates for 10h- and 100h-fuels is very
difficult without field fuel sampling. However, we might estimate 1h woody fuels and leaf litter from standing
biomass of small branches (< 6.35mm) and leaves for trees and shrubs. Hence, our treatment of surface
woody fuels includes only fine (1h) fuels.
Assuming a continuous input of litter, the variation in accumulated litter is described by a simple differential
equation (Birk & Simpson 1980):
dX
dt = L −k · X
(24.12)
where k is the decay constant, L is the rate of litterfall and X is the litter mass accumulated in the forest
floor. Assuming that litter mass has reached a steady state, X can be estimated as the ratio between L and
k. If litterfall is estimated as the total foliar biomass divided by leaf duration, the amount of steady state
leaf litter corresponding to each tree and srhub cohort can be estimated using:
wli,i =
FBi
LD(SPi) · ki
(24.13)
where FBi is the foliar biomass of cohort i, LD(SPi) is the species-specific average leaf duration (in years)
and ki is the rate of decay of leaves of cohort i, which is given by the regreession model of Meentemeyer
(1978):
ki = (−0.5365 + 0.00241 · AET) −(−0.01586 + 0.000056 · AET) · LI(SPi)
(24.14)
where LI(SPi) is the species-specific percentage of lignin content in leaves and AET is actual evapotranspi-
ration (default AET = 1000mm). Litter loadings are summed for four litter types (short pine needles, long
pine needles, other conifers, broadleaves). In the case of fine dead woody materials (small fallen branches),

24.3. FUEL CHARACTERISTICS
243
loading of small branches is taken as woody litter and it is assumed that small branch litterfall occurs at the
same time as leaf litterfall (i.e. according to leaf duration):
wwo =
X
i
wwo,i =
X
i
SBBi
LD(SPi) · kwo
(24.15)
where kwo = 0.95y−1 is a constant rate of decomposition for small branches.
In FCCS, the depth of woody and LLM strata are inputs. In our case the depth of the woody and litter
strata are estimated from the corresponding fuel loadings:
δwo
=
wwo/ρb,wo
(24.16)
δli
=
wli/ρb,li
(24.17)
where ρb,wo, ρb,li are the woody and litter bulk density (in kg · m−3), respectively. Litter bulk density ρb,li
is calculated as a weighted average of litter types:
ρb,li =
P
k ρb,k · wli,k
P
k ·wli,k
(24.18)
where k indicates litter type. The bulk density for litter types are [Prichard et al. (2013); Table 1]:
ρb,shortneedlepine
=
ρb,longneedlepine = ρb,otherconifer = 1.65lb · ft−3 = 26.43kg · m−3
(24.19)
ρb,hardwood
=
0.83lb · ft−3 = 13.30kg · m−3
(24.20)
24.3.6
Other fuel characteristics
All the following characteristics are calculated in metric units (although British units are indicated to qualify
specific values for compatibility).
24.3.6.1
Particle density (ρp)
Particle density is the ratio of dry weight over volume for fuel particles (in kg · m−3). When species have
different values, particle density averages for shrub and canopy strata can be obtained as:
ρp,sh
=
P
i wi,sh·ρp(SPi)
P
i wi,sh
(24.21)
ρp,ca
=
P
i wi,ca·ρp(SPi)
P
i wi,ca
(24.22)
where ρp(SPi) is the species-specific particle density (in kg · m−3), which can be obtained from wood tissue
(ρwood) and leaf tissue (ρleaf) densities, using r6.35 to weight them:
ρp(SPi) = 1000 · (ρleaf(SPi) · fleaves,vol + ρwood(SPi) · (1 −fleaves,vol))
(24.23)
where fleaves,vol is the volumetric fraction of leaves with respect to branchlets:
fleaves,vol =

1.0 + (r6.35(SPi) −1.0) · ρwood(SPi)
ρleaf(SPi)
−1
(24.24)
Dead woody and litter particle densities, i.e. ρp,wo and ρp,li, are obtained averaging wood tissue and leaf
tissue densities across cohorts:
ρp,wo
=
P
i wi·ρwood(SPi)
P
i wi
(24.25)
ρp,li
=
P
i wi·ρleaf (SPi)
P
i wi
(24.26)
(24.27)
Finally, herb particle density, ρp,he, is set to a default value ρp,he = 400kg · m−3 = 25lb · ft−3 (Prichard et
al. 2013).

244
CHAPTER 24. FUEL CHARACTERISTICS AND FIRE BEHAVIOUR
24.3.6.2
Particle volume (PV )
Particle volume is defined as the volume of particles per surface area (in m3·m−2). Is calculated as dry weight
loading divided by particle density. If species have different particle density values, the particle volume for
canopy (PVca) and shrub(PVsh) strata can be calculated using:
PVca
= P
i PVi,ca = P
i wi,ca/ρp(SPi)
(24.28)
PVsh
= P
i PVi,sh = P
i wi,sh/ρp(SPi)
(24.29)
where PVi,ca and PVi,sh are the particle volume of cohort i in the canopy and shrub strata, respectively.
The particle volume for woody and herb strata are simply:
PVwo
= wwo/ρp,wo
(24.30)
PVhe
= whe/ρp,he
(24.31)
The particle volume for the litter stratum is the sum of particle volume of litter components:
PVli =
X
i
PVli,k =
X
i
wli,k/ρp,li
(24.32)
24.3.6.3
Packing ratio (β)
The proportion of fuelbed stratum volume occupied by fuel particles is an important factor to predict fire
behavior. At low packing ratios (low particle density) fire intensity is limited by excessive heat loss. At high
packing ratios (high particle density), lack of oxygen limits combustion. The packing ratios for the canopy
and shrub stratum (βca and βsh; dimensionless) are given by:
βca
=
PVca
δca
(24.33)
βsh
=
PVsh
δsh
(24.34)
where wi,ca and wi,sh are the contribution of cohort i to canopy and shrub strata loading (in kg · m−2),
respectively, and ρp(SPi) is the particle density (in kg · m−3) of fuels in cohort i. The packing ratio for the
herbaceous, woody and litter strata are:
βhe
=
PVhe
δhe
(24.35)
βwo
=
PVwo
δwo
= ρb,wo
ρp,wo
(24.36)
βli
=
PVli
δli
= ρb,li
ρp,li
(24.37)
Note that the packing ratio expressions for woody and litter strata as a ratio of bulk and particle density
arises as a consequence of how fuel depth and particle volume are estimated.
24.3.6.4
Surface-area-to-volume ratio (σ)
The surface-area-to-volume ratio (in m2 · m−3) for the canopy or shrub strata are calculated using weighted
averages:
σca
=
P
i wi,ca · σ(SPi)
P
i wi,ca
(24.38)
σsh
=
P
i wi,sh · σ(SPi)
P
i wi,sh
(24.39)

24.3. FUEL CHARACTERISTICS
245
where wi,ca and wi,sh are the contribution of cohort i to canopy and shrub strata loading (in kg · m−2),
respectively, and σ(SPi) is the species-specific surface-area-to-volume ratio.
The surface-area-to-volume
ratio of herbs is assumed constant σhe = 11483m2 ·m−3 = 3500ft2 ·ft−3 and that of small (1-h) woody fuels
is σwo = 1601.05m2 · m−3 = 488ft2 · ft−3. The surface-area-to-volume ratio for the litter stratum is:
σli =
P
k wli,k · σk
P
k wli,k
(24.40)
and the surface-area-to-volume ratio for litter types are:
σshortneedlepine
= 6562m2 · m−3 = 2000ft2 · ft−3
(24.41)
σlongneedlepine
= 4921m2 · m−3 = 1500ft2 · ft−3
(24.42)
σotherconifer
= 8202m2 · m−3 = 2500ft2 · ft−3
(24.43)
σhardwood
= 8202m2 · m−3 = 2500ft2 · ft−3
(24.44)
24.3.6.5
Fuel area index (FAI)
The fuel area index (FAI) is the total fuel surface area per unit of ground area (unitless). It is analogous to
leave area index (LAI), and it is used to calculate FCCS fire potentials (Schaaf et al. 2007). For shrub and
canopy strata, FAI is calculated as:
FAIca
=
X
i
FAIi,ca =
X
i
PVi,ca · σ(SPi)
(24.45)
FAIsh
=
X
i
FAIi,sh =
X
i
PVi,sh · σ(SPi)
(24.46)
where FAIi,ca and FAIi,sh are the FAI of cohort i in the canopy and shrub strata, respectively. The FAI of
herbs and woody strata are given by:
FAIhe
=
PVhe · σhe
(24.47)
FAIwo
=
PVwo · σwo
(24.48)
For the litter layer, FAI is calculated as a sum of FAI for litter components:
FAIli =
X
k
FAIli,k =
X
k
PVli,k · σk
(24.49)
24.3.6.6
Moisture content (FMC)
Fuel moisture content (FMC in percent of dry weight) is averaged across cohorts composing the shrub or
canopy strata, to obtain FMClive,sh and FMClive,ca :
FMClive,sh
=
P
i wi,sh · FMCi
P
i wi,sh
(24.50)
FMClive,ca
=
P
i wi,ca · FMCi
P
i wi,ca
(24.51)
Live fuel moisture of herb stratum (FMClive,he) is an input. The moisture of dead plant in the canopy and
shrub layers (FMCdead,ca and FMCdead,sh), the moisture of dead herbs (FMCdead,he), as well as that of
litter (FMCli) and woody (FMCwo) strata are all assumed equal to the moisture of 1-h dead fuels, which
is an input of the model.

246
CHAPTER 24. FUEL CHARACTERISTICS AND FIRE BEHAVIOUR
24.3.6.7
Proportion of dead fuel (Pdead)
Woody and litter strata are dead fuels, but for canopy, shrub and herb strata the proportion of fuels that
are dead are variable. The proportion of dead fuels in the herbaceous stratum (Pdead,he) is an input of the
model, but for the shrub and canopy strata these are calculated from the proportion of dead fuels in each
cohort:
Pdead,sh
=
P
i wi,sh · Pdead,i
P
i wi,sh
(24.52)
Pdead,ca
=
P
i wi,ca · Pdead,i
P
i wi,ca
(24.53)
24.3.6.8
Low heat content (h)
The low fuel heat content of each surface fuel stratum (in kJ · kg−1) is used for the calculation of reaction
intensity. Heat content values are adjusted for live foliar moisture content in canopy, shrub and herb strata;
and are left to the default value for woody and litter strata:
hca
=
hca,def −(Mlive,ca/100) · V
(24.54)
hsh
=
hsh,def −(Mlive,sh/100) · V
(24.55)
hhe
=
hdef −(Mlive,he/100) · V
(24.56)
hwo
=
hli = hdef
(24.57)
where hdef = 18608kJ · kg−1 = 8000Btu · lb−1 is the default low heat content value for herbs, woody and
litter strata, and V = 2596kJ ·kg−1 = 1116Btu·lb is the latent heat of vaporisation of water. The default low
heat of contents for the canopy and shrub strata (hca,def and hsh,def) are calculated as a weighted average
across cohorts:
hca,def
=
P
i wi,ca · h(SPi)
P
i wi,ca
(24.58)
hsh,def
=
P
i wi,sh · h(SPi)
P
i wi,sh
(24.59)
where h(SPi) is a species-specific low heat content value.
24.3.6.9
Reactive volume (RV )
The volume per surface unit (m3 · m−2) that would be involved in flaming combustion.
RVsh
=
wshrub/ρp,sh
(24.60)
RVhe
=
whe/ρp,he
(24.61)
RVwo
=
wwo/ρp,wo
(24.62)
RVli
=
min(wli, wmax,li)/ρp,li
(24.63)
In the case of litter, the flame loading is limited by wmax,li, the maximum loading that would be consumed
in the flaming stage of combustion, calculated as a weighted average of litter types:
wmax,li =
P
k wmax,k · wli,k
P
k ·wli,k
(24.64)
where k indicates litter type. The maximum combustion loadings for litter types are [Prichard et al. (2013);
Table 2]:
wmax,shortneedlepine
=
wmax,otherconifer = 0.3248kg · m−2 = 2900lb · ac−1
(24.65)
wmax,longneedlepine
=
0.6496kg · m−2 = 5800lb · ac−1
(24.66)
wmax,hardwood
=
0.3472kg · m−2 = 3100lb · ac−1
(24.67)

24.4. SURFACE FIRE BEHAVIOR
247
24.3.7
Unit conversion of fuel characteristics
FCCS calculations employ empirical equations that were derived in British units system. Hence, all the fuel
characteristics and model inputs that are in metric units have to be translated into British units prior to fire
behaviour calculations:
• Loading: 1kg · m−2 = 0.204918lb · ft−2
• Depths: 1m = 3.2808399ft
• Particle density and bulk density: 1kg · m−3 = 0.06242796lb · ft−3
• Particle volume and reactive volume: 1m3 · m−2 = 3.2808399ft3 · ft−2
• Surface-to-area-volume ratio: 1m2 · m−3 = 0.3048ft2 · ft−3
• Heat content: 1kJ · kg−1 = 0.429922614Btu · lb−1
• Wind speed: 1m · s−1 = 2.23693629mph
24.4
Surface fire behavior
24.4.1
Surface rate of spread (R)
In the Rothermel (1972) model, surface rate of spread is defined as the ratio of heat source (i.e. the surface
fire energy propagated to unburned fuels) to surface fuel heat sink (i.e. the energy required to preheat
fuels). Owing to the difference in packing ratio between the litter stratum and the other surface fuels, litter-
dominated fuelbeds may have substantially different spread rates than other fuelbeds. For this reason, in
FCCS the rate of spread (in ft·min−1) is calculated separately for litter stratum and the final rate of spread
is the maximum of the rate of spread of all surface fuels and that of the litter stratum. Rate of spread is
also limited to a maximum based in windspeed and slope.
R = min(WindSlopeCap, max(Rsurf, Rlitter))
(24.68)
The surface fuel and litter fuel rates of spread are given by the application of Rothermel’s (1972) equation
to each case:
Rsurf
=
IR,surf · ξsurf · (1 + ϕW + ϕS)
qsurf
(24.69)
Rlitter
=
IR,litter · ξlitter · (1 + ϕW + ϕS)
qlitter
(24.70)
where IR,surf and IR,litter are the reaction intensities (in Btu · ft−2 · min−1), ξsurf and ξlitter are the
propagating flux ratios, qsurf and qlitter are the heat sinks. Finally, ϕW and ϕS are the slope and wind
modifiers. All of them are explained in the following sections. The maximum rate of spread calculated from
windspeed and slope is:
WindSlopeCap = 88 · U · (1 + ϕS)
(24.71)
where U is windspeed (in mph) and 88 is a conversion factor (from mph to ft/min).
24.4.1.1
Reaction intensity (IR)
Reaction intensity of surface fuels (in Btu · ft−2 · min−1) is calculated as the sum of component reaction
intensities of the four different surface fuel strata, whereas the reaction intensity in the litter uses this strata
alone:
IR,surf
=
IR,sh + IR,he + IR,wo + IR,li
(24.72)
IR,litter
=
IR,li
(24.73)

248
CHAPTER 24. FUEL CHARACTERISTICS AND FIRE BEHAVIOUR
Each component reaction intensity is calculated using:
IR,sh
=
(ηβ′
allsurf )Ash · Γ′
max,sh · wsh · hsh · ηF MC,sh · ηK,sh
(24.74)
IR,he
=
(ηβ′
lowsurf )Ahe · Γ′
max,he · whe · hhe · ηF MC,he · ηK,he
(24.75)
IR,wo
=
(ηβ′
lowsurf )Awo · Γ′
max,wo · wwo · hwo · ηF MC,wo · ηK,wo
(24.76)
IR,li
=
(ηβ′
litter)Ali · Γ′
max,li · wli · hli · ηF MC,li · ηK,li
(24.77)
In the above equations, wsh, whe, wwo and wli are the loadings of the corresponding shrub, herb, woody
and litter strata, respectively. These quantities were defined in previous sections, as were the corresponding
low heat fuel contents (hsh, hhe, hwo and hli). Mineral damping coefficient (ηK; dimensionless) is set to the
same value (corresponding to the conventional value for silica-free ash content of 1%) for all strata:
ηK,sh = ηK,he = ηK,wo = ηK,li = 0.42
(24.78)
In the following subsections, we describe the calculation of the remaining variables for each stratum: reac-
tion efficiency (ηβ′), Rothermel’s A parameter, maximum reaction velocity (Γ′
max) and moisture damping
coefficient (ηF MC).
24.4.1.2
Reaction efficiency (ηβ′)
Reaction efficiency (between 0 and 1) represents the damping effect of inefficiently packed fuels in the reaction
intensity. Because shrubs rarely burn without lower surface fuels, the reaction efficiency of the surface layer
(ηβ′
allsurf ) includes shrubs, herbs and woody fuels. Low surface fuels may carry flames without involving
shrubs, so are assumed to burn with a single reaction efficiency (ηβ′
lowsurf ) determined by the combined
characteristics of herb and woody fuel strata. Both are calculated similarly:
ηβ′
allsurf
=
β′
allsurf · e1−β′
allsurf
(24.79)
ηβ′
lowsurf
=
β′
lowsurf · e1−β′
lowsurf
(24.80)
where β′
allsurf and β′
lowsurf are the relative packing ratios corresponding to all surface fuels and low surface
fuels, respectively. Relative packing ratios (β′; dimensionless) are defined as the ratio of optimum depth
(δopt) to effective depth (δeff):
β′
allsurf
=
δopt,allsurf/δeff,allsurf
(24.81)
β′
lowsurf
=
δopt,lowsurf/δeff,lowsurf
(24.82)
Optimum depth is the depth (in ft) at which fuels are optimally packed for maximum reaction intensity:
δopt,allsurf
=
PVallsurf + OptAirV olallsurf
(24.83)
δopt,lowsurf
=
PVlowsurf + OptAirV ollowsurf
(24.84)
where PVallsurf and PVlowsurf are the volume of particles (in ft3 ·ft−2) for all surface fuels and low surface
fuels, respectively, given by:
PVallsurf
=
PVsh + PVhe + PVwo
(24.85)
PVlowsurf
=
PVhe + PVwo
(24.86)
OptAirV olallsurf and OptAirV olallsurf are the volume of air space (in ft3 ·ft−2) between fuel particles that
would result in maximum reaction intensity:
OptAirV olallsurf
=
45 · (RVsh + RVhe + RVwo)
(24.87)
OptAirV ollowsurf
=
45 · (RVhe + RVwo)
(24.88)

24.4. SURFACE FIRE BEHAVIOR
249
On the other hand, effective depths of all surface fuels and low surface fuels (in ft) are calculated as their
depth, weighted by the reactive volume (and percentage cover in FCCS):
δeff,allsurf
=
(RVsh · δsh) + (RVhe · δhe) + (RVwo · δwo)
RVsh + RVhe + RVwo
(24.89)
δeff,lowsurf
=
(RVhe · δhe) + (RVwo · δwo)
RVhe + RVwo
(24.90)
Reaction efficiency of the litter stratum is determined separately from the other strata. It is defined as the
average of reaction efficiency across litter types, calculated using loadings as weights:
ηβ′
litter =
P
k ηβ′
k · wli,k
P
k ·wli,k
(24.91)
where k indicates litter type. The reaction efficiencies of litter types are [Prichard et al. (2013); Table 2]:
ηβ′
shortneedlepine
=
ηβ′
otherconifer = 0.18
(24.92)
ηβ′
longneedlepine
=
0.27
(24.93)
ηβ′
hardwood
=
0.11
(24.94)
24.4.1.3
Rothermel’s A
A dimensionless coefficient that modifies reaction’s efficiency (eq. (24.80)) to account for lower sensitivity of
reaction efficiency to relative packing ratio in flash fuels:
Awo
=
Ali = 1.0
(24.95)
Ash
=
133 · σ−0.7913
sh
(24.96)
Ahe
=
133 · σ−0.7913
he
(24.97)
where σsh and σhe have to be expressed in ft2 · ft−3; Values 133 and −0.7913 are empirical constants
(Rothermel 1972).
24.4.1.4
Maximum reaction velocity (Γ′
max)
The reaction velocity (in min−1) that would exist at optimum fuelbed depth with no fuel moisture or mineral
content.
Γ′
max,sh
=
9.495 · σsh
σwo
(24.98)
Γ′
max,he
=
9.495 · σhe
σwo
(24.99)
Γ′
max,wo
=
9.495
(24.100)
Γ′
max,li
=
15
(24.101)
where σwo = 488ft2 · ft−3 = 1601.05m2 · m−3 is the surface-to-area-volume ratio typical of small woody
fuels. In Prichard et al. (2013) σsh is defined as the average of shrub foliar surface-to-area-volume ratio
and σwo, but in our case σ(SPi) for each species includes both leaves and small branches. Eq. (24.101)
represent a significant departure from Rothermel (1972) maximum reaction velocity, and are also different
from Sandberg et al. (2007).

250
CHAPTER 24. FUEL CHARACTERISTICS AND FIRE BEHAVIOUR
24.4.1.5
Moisture damping coefficient (ηF MC)
Moisture damping reduces reaction velocity and hence reaction intensity (eq. (24.73)). It is calculated for
each stratum using the following regression equations:
ηF MC,live,sh
=

1 −2.59 ·
FMClive,sh
Xlive,sh

+
"
5.11 ·
FMClive,sh
Xlive,sh
2#
−
"
3.52 ·
FMClive,sh
Xlive,sh
3#
(24.102)
ηF MC,dead,sh
=

1 −2.59 ·
FMCdead,sh
Xdead,sh

+
"
5.11 ·
FMCdead,sh
Xdead,sh
2#
−
"
3.52 ·
FMCdead,sh
Xdead,sh
3#
(24.103)
ηF MC,live,he
=

1 −2.59 ·
FMClive,he
Xlive,he

+
"
5.11 ·
FMClive,he
Xlive,he
2#
−
"
3.52 ·
FMClive,he
Xlive,he
3#
(24.104)
ηF MC,dead,he
=

1 −2.59 ·
FMCdead,he
Xdead,he

+
"
5.11 ·
FMCdead,he
Xdead,he
2#
−
"
3.52 ·
FMCdead,he
Xdead,he
3#
(24.105)
ηF MC,wo
=

1 −2.59 ·
FMCwo
Xwo

+
"
5.11 ·
FMCwo
Xwo
2#
−
"
3.52 ·
FMCwo
Xwo
3#
(24.106)
ηF MC,li
=

1 −2.59 ·
FMCli
Xli

+
"
5.11 ·
FMCli
Xli
2#
−
"
3.52 ·
FMCli
Xli
3#
(24.107)
where moisture contents of extinctions were arbitrarily set to Xdead,sh = Xdead,heXwo = Xli = 25, Xlive,sh =
180 and Xlive,he = 120 in Sandberg et al. (2007). As it can be seen in the equations above, in the case of
shrub and herb strata, moisture damping of live and dead fuels are differentiated. Average values are found
after accounting for the proportion of live and dead material:
ηF MC,sh
=
ηF MC,live,sh · (1 −Pdead,sh) + ηF MC,dead,sh · Pdead,sh
(24.108)
ηF MC,he
=
ηF MC,live,he · (1 −Pdead,he) + ηF MC,dead,he · Pdead,he
(24.109)
24.4.1.6
Propagating flux ratio (ξ)
The propagating flux ratio (dimensionless) is the proportion of the reaction intensity (eq. (24.73)) that
contributes to the forward rate of spread, estimated using an empirical regression:
ξsurf
=
0.03 + 2.5 · min

0.06, RVsh + RVhe + RVwo + RVli
δsurfheatsink

(24.110)
ξlitter
=
0.03 + 2.5 · min

0.06, RVli
δli

(24.111)
where δsurfheatsink is the depth of surface heat sink (in ft), which in Prichard et al. (2013) is calculated as
the sum of strata depths weighted by their relative cover. In our case we weighted stratum depths as in the
calculation of effective depth (δeff,allsurf), but considering all four strata:
δsurfheatsink = (RVsh · δsh) + (RVhe · δhe) + (RVwo · δwo) + (RVli · δli)
RVsh + RVhe + RVwo + RVli
(24.112)
24.4.2
Heat sink (q)
Like reaction intensity, the heat sink term (in Btu · ft−3) of the rate of spread equation is calculated in
FCCS for each fuel stratum and then summed:
qsurf
=
qsh + qhe + qwo + qli
(24.113)
qlitter
=
qli
(24.114)

24.4. SURFACE FIRE BEHAVIOR
251
where the heat sink for each stratum is:
qsh
=
ηβ′
surf · RVsh · ρp,sh · Qigsh
min(δsh, 1ft)
(24.115)
qhe
=
ηβ′
lowsurf · RVhe · ρp,he · Qighe
min(δhe, 1ft)
(24.116)
qwo
=
ηβ′
lowsurf · RVwo · ρp,wo · Qigwo
min(δwo, 1ft)
(24.117)
qli
=
ηβ′
li · RVli · ρp,li · Qigli
min(δli, 1ft)
(24.118)
Where ρp,sh, ρp,he, ρp,wo and ρp,li are the particle densities (in lb · ft−3) of each fuel stratum; and RVsh,
RVhe, RVwo, and RVli are the reactive volumes of each fuel stratum. Unlike in Sandberg et al. (2007), the
calculated heat sink is corrected by the reaction-efficiency term (ηβ′
surf , ηβ′
lowsurf or ηβ′
li), and the effective
depth of each stratum included is limited to 1ft, based on the assumption that it is not necessary to preheat
more than one 1ft of depth within a stratum to achieve ignition.
Heat of pre-ignition (Qig; in Btu · lb−1) is the amount of heat required to ignite 1lb of fuel. It is calculated
by stratum as a weighted average of live and dead fuels in shrubs and herbs.
Qigsh
=
Qiglive,sh · (1 −Pdead,sh) + Qigdead,sh · Pdead,sh
(24.119)
Qighe
=
Qiglive,he · (1 −Pdead,he) + Qigdead,he · Pdead,he
(24.120)
Whereas Qiglive,sh and Qiglive,he are corrected by fuel moisture, Qigdead,sh, Qigdead,he and the other strata
(Qigwo and Qigli) are assumed a constant value:
Qiglive,sh
=
250 + (V · (Mlive,sh/100))
(24.121)
Qiglive,he
=
250 + (V · (Mlive,he/100))
(24.122)
Qigdead,sh
=
Qigdead,he = Qigwo = Qigli = 250
(24.123)
where 250Btu/lb is the heat of preignition of dry cellulose and V = 1116Btu/lb is the latent heat of
vaporization.
24.4.3
Wind and slope coefficients (ϕW and ϕS)
Wind and slope coefficients modify the heat source term of the rate of spread equation. Owing to differences
in fuel characteristics and boundary conditions between the litter stratum and other surface fuel strata,
in FCCS wind and slope coefficients are calculated separately for the litter stratum. The wind and slope
coefficients terms in the rate fo spread equation are a weighted average of litter and surface wind and slope
coefficients using the relative contribution to reaction intensity as weights:
ϕW
=
(1 −IR,litter/IR,surf) · ϕW,surf + (IR,litter/IR,surf) · ϕW,litter
(24.124)
ϕS
=
(1 −IR,litter/IR,surf) · ϕS,surf + (IR,litter/IR,surf) · ϕS,litter
(24.125)
Wind coefficients are calculated using:
ϕW,surf
=
8.8 · β′−E
surf · (U/BMU)B
(24.126)
ϕW,litter
=
8.8 · β−E
litter · (U/BMU)B
(24.127)
where U is the input midflame windspeed (in ft·min−1), BMU = 352ft·min−1 is the benchmark midflame
windspeed, β′
surf is the relative packing ratio (eq. 24.82), B is the exponential response of wind coefficient
to windspeed (B = 1.2 in Sandberg et al. (2007)), and E is the exponential term representing the mild effect
of large fuels in reducing the accelerating effect of wind on fire spread by attenuating wind flow, given by:
E = 0.55 −0.2 ·
FAIsh + FAIhe
FAIsh + FAIhe + FAIwo
(24.128)

252
CHAPTER 24. FUEL CHARACTERISTICS AND FIRE BEHAVIOUR
E is assumed to be the same for both all surface fuels and litter fuels.
Slope coefficients are calculated using the empirical equation of Rothermel (1972), applied to all surface fuels
and litter fuels:
ϕS,surf
=
5.275 · (S/100)2 · (βsh + βhe + βwo)−0.3
(24.129)
ϕS,litter
=
5.275 · (S/100)2 · β−0.3
li
(24.130)
where S is the slope (in percent) and β is the packing ratio (not relative!) of fuels.
24.4.4
Fireline intensity (IB) and flame length (FL)
Byram’s fireline intensity (IB) is the rate of heat release per unit of fire edge (in Btu · ft−1 · min−1), and in
FCCS is calculated as (Albini 1976):
IB = IR,surf · (R · tR)
(24.131)
where IR,surf is the surface reaction intensity, R is the rate of spread and tR is the flame residence time,
which is defined as the time (in min) fuels contribute to propagating flux and is estimated as Albini (1976):
tR = 192 · (IR,sh · RTsh) + (IR,he · RThe) + (IR,wo · RTwo) + (IR,li · RTli)
IR,surf
(24.132)
where RT is the reaction thickness, the approximate thickness (in ft) of a fuel element shell that contributes
to reaction intensity. In FCCS, reaction thickness is estimated as RT = 0.0028ft for thermally thick fuel
elements (Sandberg et al. 2007). When the diameter of a fuel element is less than twice the reaction thickness,
the entire fuel element contributes to reaction intensity. Reaction thickness values for each stratum are given
by:
RTsh
=
min(0.0028, 2/σsh)
(24.133)
RThe
=
min(0.0028, 2/σhe)
(24.134)
RTwo
=
min(0.0028, 2/σwo)
(24.135)
RTli
=
min(0.0028, 2/σli)
(24.136)
Flame length is defined as the distance (in ft) between the flame tip and the midpoint of the flame depth
at the base of the flame, and is calculated (Byram 1959):
FL = 0.45 · (IB/60)0.46
(24.137)
where 60.0 is a factor to convert from Btu · ft−1 · min−1 to Btu · ft−1 · s−1.
24.5
Crown fire behavior
Crown fire behavior is difficult to model and actual rates of spread are not possible to predict. Here we
mainly follow the approach given in FCCS (Prichard et al. 2013), although in our case the canopy is not
subdivided into layers (overstory, midstory and understory).
24.5.1
Crown fire rate of spread (Rcrown)
The rate of spread of crown fires is estimated by using a modification of Rothermel’s equation:
Rcrown = IR,crown · ξcrown · WAF
qcrown
= (IR,surf + IR,ca) · ξcrown · WAF
qsurf + qca
(24.138)

24.5. CROWN FIRE BEHAVIOR
253
where IR,surf is the surface reaction intensity, IR,ca is the canopy reaction intensity, ξcrown is the propagating
flux ratio in the canopy, qsurf is the surface heat sink and qca is the canopy heat sink. Note that reaction
intensities and heat sinks of canopy and surface fuels are added for the application of Rothermel’s equation.
Other modifications include the exclusion of slope effects and the consideration of wind effects through a
wind adjusment factor (WAF).
Crown propagating flux ratio (ξcrown; in Btu·ft−3) represents the proportion of the crown reaction intensity
that contributes to crown fire’s forward rate of spread:
ξcrown = 1 −e(−F AIca
4·δca )
(24.139)
where FAIca is the fuel area index of the canopy, and δca is the canopy depth (in ft). Wind adjustment
factor (WAF) is defined as:
WAF =
U/
√
U 2 + V S2
BMU/
√
BMU 2 + V S2
(24.140)
where U is the input (midflame) windspeed (in ft · min−1), BMU = 352ft · min−1 is the benchmark
windspeed and V S = 900ft · min−1 is the vertical stack velocity.
The following two subsections detail the calculation of canopy reaction intensity (IR,ca) and canopy heat
sink (qca).
24.5.2
Canopy reaction intensity (IR,ca)
Reaction intensity of canopy fuels (in Btu · ft−2 · min−1) is estimated as:
IR,ca = (ηβ′ca)Aca · Γ′
max,ca · wca · hca · ηF MC,ca · ηK,ca
(24.141)
where Aca = 133·σ−0.7913
ca
is Rothermel’s A coefficient, Γ′
max,ca = 15min−1 is the maximum reaction velocity
of the canopy, wca is the loading of canopy fuels (in lb · ft−2), hca is the heat content of the canopy fuels (in
Btu · lb−1) and ηK,ca = 0.42 is the mineral damping coefficient of the canopy stratum. Moisture damping
coefficient for the canopy (ηF MC,ca) is estimated as done for shrub and herb strata:
ηF MC,live,ca
=

1 −2.59 ·
FMClive,ca
Xlive,ca

+
"
5.11 ·
FMClive,ca
Xlive,ca
2#
−
"
3.52 ·
FMClive,ca
Xlive,ca
3#
(24.142)
ηF MC,dead,ca
=

1 −2.59 ·
FMCdead,ca
Xdead,ca

+
"
5.11 ·
FMCdead,ca
Xdead,ca
2#
−
"
3.52 ·
FMCdead,ca
Xdead,ca
3#
(24.143)
ηF MC,ca
=
ηF MC,live,ca · (1 −Pdead,ca) + ηM,dead,ca · Pdead,ca
(24.144)
where moisture contents of extinctions were arbitrarily set to Xdead,ca = 25 and Xlive,ca = 180.
The reaction efficiency in the canopy (ηβ′canopy) represents the damping effect of inefficiently packed fuels in
the canopy:
ηβ′canopy = β′
canopy · e1−β′
canopy
(24.145)
where β′
canopy is the relative packing ratio in the canopy:
β′
canopy = δopt,canopy/δeff,canopy
(24.146)
where the effective depth is δeff,canopy = δca (in ft) and the optimum canopy depth is calculated using:
δopt,canopy = 0.4 · FAIca + βca · (δca · Cca/100)
(24.147)
where Cca is the percent cover of the canopy, FAIca is the fuel area index of the canopy, βca is the packing
ratio of canopy fuels and δca is the canopy depth (in ft).

254
CHAPTER 24. FUEL CHARACTERISTICS AND FIRE BEHAVIOUR
24.5.3
Canopy heat sink (qca)
Canopy heat sink (in Btu · ft−3) is estimated using:
qca = 0.5 · FAIca · RTca · ρp,ca · Qigca
(Cca/100) · δca
(24.148)
where Cca is the percent cover of the canopy, FAIca is the fuel area index of the canopy, RTca =
min(0.0028, 2/σca) is the reaction thickness of the canopy stratum (in ft), ρp,ca is the particle density of
the canopy (in lb · ft−3), δca is the canopy depth (in ft) and Qigca is the heat of pre-ignition of the canopy
stratum (in Btu · lb−1), which is calculated as a weighted average of live and dead fuels:
Qiglive,ca
=
250 + (V · (Mlive,ca/100))
(24.149)
Qigdead,ca
=
250
(24.150)
Qigca
=
Qiglive,ca · (1 −Pdead,ca) + Qigdead,ca · Pdead,ca
(24.151)
where 250Btu/lb is the heat of preignition of dry cellulose and V = 1116Btu/lb is the latent heat of
vaporization of water.
24.5.4
Fireline intensity (IB,crown) and flame length (FLcrown)
Byram’s fireline intensity for crown fires is estimated using:
IB,crown = IR,crown · (Rcrown · tR,crown)
(24.152)
where IR,crown is the crown reaction intensity (i.e. the sum of canopy and surface reaction intensities), Rcrown
is the rate of crown fire spread and tR,crown is the flame residence time, estimated as:
tR = 192 · RTca
(24.153)
where RTca = min(0.0028, 2/σca is the reaction thickness of the canopy. As for surface fires, flame length is
calculated using:
FLcrown = 0.45 · (IB,crown/60)0.46
(24.154)
where 60.0 is a factor to convert from Btu · ft−1 · min−1 to Btu · ft−1 · s−1.
24.6
Fire potentials
24.6.1
Surface fire behavior potentials
The surface fire behavior potential (SFP; between 0 and 9) is an index defined as the maximum of
spread potential (SP) and flame length (FL) potential indices (both between 0 and 9):
SFP = max(SP, FP)
(24.155)
Spread potential is derived from R (in ft · min−1), and flame length potential is derived from FL (in ft),
both quantities being calculated at benchmark environmental conditions:
SP
=
min
h
9, R1/2i
(24.156)
FP
=
min
h
9, FL1/2i
(24.157)

24.7. UNIT CONVERSION OF OUTPUTS
255
24.6.2
Crown fire behavior potentials
The crown fire summary potential (CPF) combines three subpotentials into a single index value between 0
and 9. It places more emphasis on crown fire initiation (IC) and rate of spread (RC) than to crown-to-crown
transmissivity (TC):
CFP = 0.4286 · (IC + (TC/3) + RC)
(24.158)
where 0.4286 is used to limit CPF between 0 and 9.
The crown fire initiation potential (IC) represents the likelihood of a surface fire torching into single or
multiple trees. IC is based on the work by Van Wagner. If FAIca = 0 then IC = 0. Otherwise it is
calculated as:
IC = min
"
9, 4 ·
IB/60
Ic
0.2#
(24.159)
where IB is the surface fireline intensity (60 is used to convert it to Btu · ft−1 · s−1) and Ic is Van Wagner’s
critical fireline intensity (Scott & Reinhardt 2002):
Ic = 0.288894658 · [0.01 · (Hgap/100) · (460 + 25.9 · Mlive,ca)]1.5
(24.160)
where Mlive,ca is the moisture content of the canopy (in percent of dry weight), 0.288894658 is used to
convert from kJ · m−1 · s−1 to Btu · ft−1 · s−1 and Hgap is the canopy gap (in cm) determined from the
analysis of the bulk density profile.
The crown-to-crown transmittivity potential (TC) is set to zero if FAIca < TFAI/(3 · π), where TFAI is a
threshold for FAI calculated as:
TFAI = Aq · e−0.0019·U
(24.161)
where Aq = 3.2868 if σca > 2000ft2 · ft−3 and Aq = 2.6296 otherwise. If FAIca > TFAI/(3 · π), then TC
is calculated as:
TC = min [9, 10 · TCq]
(24.162)
where TCq is the efficiency of crown-to-crown heat transfer, as a proportion of maximum efficiency at 100
% canopy cover:
TCq = (max(0.0, Cca · WAF −40))0.3
(100 · WAF −40)0.3
(24.163)
In this last equation 40 represents the threshold of canopy cover necessary to initiate dependent crown
spread, and 0.3 is a coefficient describing the assumed effect of crown cover on transmittivity at benchmark
windspeed. The canopy adjustment ratio WAF is added to modulate transmittivity depending on windspeed.
Finally, the crown fire rate of spread potential (RC) is defined as:
RC = min
h
9, 2.5 · R1/e
crown
i
(24.164)
where Rcrown is the rate of spread (in ft · min−1) of the crown fire.
24.7
Unit conversion of outputs
The following factors are used to express fire behavior outputs to metric units:
• Fire spread rates: 1ft · min−1 = 0.3048m · min−1
• Flame length: 1ft = 0.3048m
• Reaction intensity: 1Btu · ft−2 · min−1 = 11.3484kJ · m−2 · min−1
• Heat sink: 1Btu · ft−3 = 37.2589458kJ · m−3
• Fireline intensity: 1Btu · ft−1 · min−1 = 0.0576911555kW · m−1

256
CHAPTER 24. FUEL CHARACTERISTICS AND FIRE BEHAVIOUR

Appendix A
Inbuilt parameter estimation
A.1
Introduction
Package medfate has been designed to allow simulations requiring a minimum set of vegetation functional
parameters.
This entails that several other parameters have to be estimated automatically (via inbuilt
procedures) before starting simulations. Inbuilt parameter estimation is done in functions spwbInput(),
growthInput(), forest2spwbInput() and forest2growthInput(), with the user controlling the process
through the species parameter table input (e.g., SpParamsMED) and the object control (see default control
values in defaultControl()).
A.2
Strict, scaled and imputable parameters
Different kinds of vegetation functional parameters can be distinguished according to whether inbuilt pa-
rameter estimation is possible and how it is conducted:
• Strictly-required parameters are those for which there are no inbuilt estimation procedures imple-
mented in the initialization functions. Hence, either values in the species parameter table input are
non-missing or suitable values need to be specified before running simulation models. Since medfate
ver. 2.3, only plant/leaf classification parameters and plant size parameters are strict. The remaining
ones can be estimated from other parameters. This facilitates having a functional species parameter
table, because only a set of parameters have to be strictly filled, from either soft trait databases or
forest inventory data.
• Scaled parameters are functional parameters that cannot be defined at the species level, because
they need to be estimated taking into account the size and structure of the plant cohort. These are
not normally defined at the level of species parameter table. Specific control parameters are used to
determine how scaling is performed.
• Imputable parameters parameters are those for which the initialization routines can provide default
values or estimations derived from relationships with other parameters.
Parameter imputation is
conducted if control parameter fillMissingSpParams = TRUE. Sometimes, default parameter values
are also specified in the control object.
The following tables describe how the different functional parameters are dealt with, grouped by function.
Links are given to the chapter subsections where scaling and/or imputation procedures are described.
Plant/leaf classification
257

258
APPENDIX A. INBUILT PARAMETER ESTIMATION
Symbol
R
Description
Strict
Scaled
Imputable
GF
GrowthForm
Growth form, defined depending on the
treatment in forest inventory plots (Tree,
Shrub or Tree/Shrub)
Yes
No
No
LF
LifeForm Raunkiaer life form
Yes
No
No
Lshape
LeafShapeLeaf type (Linear, Needle, Broad, Scale,
Spines or Succulent)
Yes
No
No
Lsize
LeafSize Leaf size (Small, Medium, Large)
Yes
No
No
Lpheno
PhenologyType
Leaf phenology type
Yes
No
No
Plant size
Symbol
R
Description
Strict
Scaled
Imputable
Hmax
Hmed
Maximum plant height
Yes
No
No
Hmed
Hmed
Median plant height
Yes
No
No
Z50
Z50
Depth above which 50% of the fine root
mass is located
No
No
A.3.1
Z95
Z95
Depth above which 95% of the fine root
mass is located
Yes
No
No
Allometric coefficients
Symbol
R
Description
Strict
Scaled
Imputable
aash, bash
a_ash,
b_ash
Coefficients relating the square of shrub
height with shrub area
No
No
A.3.2
absh, bbsh
a_bsh,
b_bsh
Coefficients relating crown volume with dry
weight of shrub individuals
No
No
A.3.2
cr
cr
Ratio between crown length and total
height for shrubs
No
No
A.3.2
afbt, bfbt,
cfbt
a_fbt,
b_fbt,
c_fbt
Coefficients to calculate foliar biomass of
an individual tree
No
No
A.3.3
acr, b1cr,
b2cr, b3cr,
c1cr, c2cr
a_cr,
b_1cr,
b_2cr,
b_3cr,
c_1cr,
c_2cr
Coefficients to calculate crown ratio of trees
No
No
A.3.3
acw, bcw
a_cw,
b_cw
Regression coefficients used to calculate the
crown width of trees
No
No
A.3.3
fHD,min
fHDmin
Minimum height-to-diameter ratio
No
No
A.3.3
fHD,max
fHDmax
Maximum height-to-diameter ratio
No
No
A.3.3
Leaf phenology
Symbol
R
Description
Strict
Scaled
Imputable
LD
LeafDuration
Average duration of leaves
No
No
A.3.9
t0,eco
t0gdd
Degree days corresponding to leaf budburst
No
No
A.3.9
S∗
eco
Sgdd
Degree days corresponding to leaf budburst
No
No
A.3.9

A.2. STRICT, SCALED AND IMPUTABLE PARAMETERS
259
Symbol
R
Description
Strict
Scaled
Imputable
Teco
Tbgdd
Base temperature for the calculation of
degree days to leaf budburst
No
No
A.3.9
S∗
sen
Ssen
Degree days corresponding to leaf
senescence
No
No
A.3.9
Phsen
Phsen
Photoperiod corresponding to start
counting senescence degree-days
No
No
A.3.9
Tsen
Tbsen
Base temperature for the calculation of
degree days to leaf senescence
No
No
A.3.9
xsen
xsen
Discrete values, to allow for any
absent/proportional/more than
proportional effects of temperature on
senescence
No
No
A.3.9
ysen
ysen
Discrete values, to allow for any
absent/proportional/more than
proportional effects of photoperiod on
senescence
No
No
A.3.9
Plant anatomy
Symbol
R
Description
Strict
Scaled
Imputable
1/Hv
Al2As
Ratio of leaf area to sapwood area
No
No
A.3.7
RLR
Ar2Al
Fine root area to leaf area ratio
No
No
A.3.8
LW
LeafWidthLeaf width
No
No
A.3.4
SLA
SLA
Specific leaf area
No
No
A.3.4
ρleaf
LeafDensity
Leaf tissue density
No
No
A.3.5
ρwood
WoodDensity
Wood tissue density
No
No
A.3.5
ρfineroot
FineRootDensity
Fine root tissue density
No
No
A.3.5
fconduits
conduit2sapwood
Proportion of sapwood corresponding to
xylem conduits
No
No
A.3.7
SRL
SRL
Specific fine root length
No
No
A.3.6
RLD
RLD
Fine root length density
No
No
A.3.6
r6.35
r635
Ratio between the weight of leaves plus
branches and the weight of leaves alone for
branches of 6.35 mm
No
No
A.3.4
Radiation balance and water interception
Symbol
R
Description
Strict
Scaled
Imputable
kb
kDIR
Direct light extinction coefficient
No
No
A.3.11
kP AR
kPAR
PAR extinction coefficient
No
No
A.3.11
αSW R
alphaSWR Short-wave radiation leaf absorbance
coefficient
No
No
A.3.11
γSW R
gammaSWR Short-wave radiation leaf reflectance
(albedo)
No
No
A.3.11
swater
g
Crown water storage capacity
No
No
A.3.11
Hydraulics, transpiration, photosynthesis

260
APPENDIX A. INBUILT PARAMETER ESTIMATION
Symbol
R
Description
Strict
Scaled
Imputable
Tmax,LAI
Tmax_LAI Empirical coefficient relating LAI with the
ratio of maximum transpiration over
potential evapotranspiration
No
No
A.3.10
Tmax,sqLAI Tmax_LAIsq
Empirical coefficient relating squared LAI
with the ratio of maximum transpiration
over potential evapotranspiration
No
No
A.3.10
WUEmax
WUE
Water use efficiency at VPD = 1kPa and
without light or CO2 limitations
No
No
A.3.10
WUEP AR
WUE_par Coefficient describing the progressive decay
of WUE with lower light levels
No
No
A.3.10
WUECO2
WUE_co2 Coefficient for WUE dependency on
atmospheric CO2 concentration
No
No
A.3.10
WUEV P D
WUE_vpd Coefficient for WUE dependency on vapor
pressure deficit
No
No
A.3.10
Ψextract
Psi_Extract
The water potential at which plant
transpiration is 50% of its maximum
No
No
A.3.10
Ψcritic
Psi_Critic
The water potential corresponding to 50%
of stem xylem cavitation
No
No
A.3.16
gswmin
Gwmin
Minimum stomatal conductance to water
vapour
No
No
A.3.12
gswmax
Gwmax
Maximum stomatal conductance to water
vapour
No
No
A.3.12
Jmax,298
Jmax298 Maximum rate of electron transport at
298K
No
No
A.3.17
Vmax,298
Vmax298 Rubisco’s maximum carboxylation rate at
298K
No
No
A.3.17
Kstem,max,refKmax_stemxylem
Maximum stem sapwood reference
conductivity per leaf area unit
No
No
A.3.14
Kroot,max,refKmax_rootxylem
Maximum root sapwood reference
conductivity per leaf area unit
No
No
A.3.14
kleaf,max
VCleaf_kmax
Maximum leaf hydraulic conductance
No
A.4.2
A.3.15
kstem,max
VCstem_kmax
Maximum stem hydraulic conductance
No
A.4.1
No
kroot,max,s
VCroot_kmax
Maximum root hydraulic conductance for
each soil layer
No
A.4.3
No
krhizo,max,s VGrhizo_kmax
Maximum hydraulic conductance of the
rhizosphere for each soil layer
No
A.4.4
No
cleaf,
dleaf
VCleaf_c,
VCleaf_d
Parameters of the vulnerability curve for
leaves
No
No
A.3.16
cstem,
dstem
VCstem_c,
VCstem_d
Parameters of the vulnerability curve for
stem xylem
No
No
A.3.16
croot,
droot
VCroot_c,
VCroot_d
Parameters of the vulnerability curve for
root xylem
No
No
A.3.16
Plant water storage
Symbol
R
Description
Strict
Scaled
Imputable
ϵleaf
LeafEPS Modulus of elasticity of leaves
No
No
A.3.13
ϵstem
StemEPS Modulus of elasticity of symplastic xylem
tissue
No
No
A.3.13
π0,leaf
LeafPI0 Osmotic potential at full turgor of leaves
No
No
A.3.13

A.2. STRICT, SCALED AND IMPUTABLE PARAMETERS
261
Symbol
R
Description
Strict
Scaled
Imputable
π0,stem
StemPI0 Osmotic potential at full turgor of
symplastic xylem tissue
No
No
A.3.13
fapo,leaf
LeafAF
Apoplastic fraction in leaf tissues
No
No
A.3.13
fapo,stem
StemAF
Apoplastic fraction in stem tissues
No
No
A.3.13
Vleaf
Vleaf
Leaf water capacity per leaf area unit
No
A.4.5
No
Vsapwood
Vsapwood Sapwood water capacity per leaf area unit
No
A.4.5
No
Growth and mortality
Symbol
R
Description
Strict
Scaled
Imputable
Nleaf
Nleaf
Leaf nitrogen concentration per dry mass
No
No
A.3.18
Nsapwood
Nsapwood Sapwood nitrogen concentration per dry
mass
No
No
A.3.18
Nfineroot
NfinerootFine root nitrogen concentration per dry
mass
No
No
A.3.18
MRleaf
RERleaf Leaf respiration rate at 20 ºC
No
No
A.3.18
MRsapwood RERsapwood
Living sapwood (parenchymatic tissue)
respiration rate at 20 ºC
No
No
A.3.18
MRfineroot RERfineroot
Fine root respiration rate at 20 ºC
No
No
A.3.18
RGRleaf,maxRGRleafmax
Maximum leaf area daily growth rate,
relative to sapwood area
No
No
A.3.19
RGRcambium,max
RGRsapwoodmax
Maximum tree daily sapwood growth rate
relative to cambium perimeter length
No
No
A.3.19
RGRsapwood,max
RGRsapwoodmax
Maximum shrub daily sapwood growth rate
relative to sapwood area
No
No
A.3.19
RGRfineroot,max
RGRfinerootmax
Maximum daily fine root relative growth
rate
No
No
A.3.19
SRsapwood
SRsapwoodDaily sapwood senescence rate
No
No
A.3.20
SRfineroot
SRfineroot
Daily fine root senescence rate
No
No
A.3.20
RSSG
RSSG
Minimum relative starch for sapwood
growth
No
No
A.3.21
Cwood
WoodC
Wood carbon content per dry weight
No
No
A.3.22
Pmort,base
MortalityBaselineRate
Default deterministic proportion or
probability specifying the baseline
reduction of cohort’s density occurring in a
year
No
No
A.3.23
Recruitment
Symbol
R
Description
Strict
Scaled
Imputable
Hseed
SeedProductionHeight
Minimum height for seed production
No
No
A.3.24
TCMrecr
MinTempRecr
Minimum average temperature (Celsius) of
the coldest month for successful
recruitment
No
No
A.3.24
MIrecr
MinMoistureRecr
Minimum value of the moisture index for
successful recruitment
No
No
A.3.24
FPARrecr
MinFPARRecr
Minimum percentage of PAR at the ground
level for successful recruitment
No
No
A.3.24
DBHrecr
RecrTreeDBH
Recruitment DBH for trees
No
No
A.3.24

262
APPENDIX A. INBUILT PARAMETER ESTIMATION
Symbol
R
Description
Strict
Scaled
Imputable
Htree,recr
RecrTreeHeight
Recruitment height for trees
No
No
A.3.24
Ntree,recr
RecrTreeDensity
Recruitment density for trees
No
No
A.3.24
Covershrub,recr
RecrShrubCover
Recruitment cover for shrubs
No
No
A.3.24
Hshrub,recr
RecrShrubHeight
Recruitment height for shrubs
No
No
A.3.24
Z50recr
RecrZ50 Soil depth corresponding to 50% of fine
roots for recruitment
No
No
A.3.24
Z95recr
RecrZ95 Soil depth corresponding to 95% of fine
roots for recruitment
No
No
A.3.24
Flammability
Symbol
R
Description
Strict
Scaled
Imputable
ρp
PD
Density of fuel particles
No
No
A.3.25
σ
SAV
Surface-area-to-volume ratio of the small
fuel (1h) fraction (leaves and branches <
6.35mm)
No
No
A.3.25
h
HeatContent
High fuel heat content.
No
No
A.3.25
LI
PercentLignin
Percentage of lignin in leaves
No
No
A.3.25
A.3
Imputation of missing values
The following figure summarizes the percentage of missing values in SpParamsMED for different model pa-
rameters and the other model parameters used for the imputation of missing values:
A.3.1
Rooting depth
Parameter Z95 is a strict parameter, but Z50 can be imputated when missing, using the following formula:
Z50 = exp(log(Z95)/1.4)
(A.1)
A.3.2
Shrub allometric coefficients
Missing shrub allometric coefficients are filled using information from Raunkiaer’s life form and maximum
plant height (Hmax).
Life form
Hmax
aash
bash
absh
bbsh
cr
Chamaephyte
[any]
24.5888
1.1662
0.7963
0.3762
0.8076
Phanerophyte
< 300 cm
1.0083
1.8700
0.7900
0.6942
0.6630
Phanerophyte
> 300 cm
5.8458
1.4944
0.3596
0.7138
0.7190
(Hemi)cryptophyte
[any]
24.5888
1.1662
0.7963
0.3762
0.9500
Allometric coefficients were taken from De Cáceres et al. (2019).

A.3. IMPUTATION OF MISSING VALUES
263
Figure A.1: Representation of imputation relationships between model parameters.
The percentage of
missing parameter values increases from left to right. Left-most parameters are strict.

264
APPENDIX A. INBUILT PARAMETER ESTIMATION
A.3.3
Tree allometric coefficients
Missing tree allometric coefficients are replaced with values depending on whether the plant species is a
gymnosperm or an angiosperm:
Parameter
Gymnosperm
Angiosperm
afbt
0.1300
0.0527
bfbt
1.2285
1.5782
cfbt
-0.0147
-0.0066
acw
0.747
0.839
bcw
0.672
0.735
acr
1.995
1.506
b1cr
-0.649
-0.706
b2cr
-0.020
-0.078
b3cr
-0.00012
0.00018
c1cr
-0.004
-0.007
c2cr
-0.159
0.000
fHDmin
80
40
fHDmax
120
140
A.3.4
Leaf width, specific leaf area and fine foliar ratio
Leaf width (LW), specific leaf area (SLA) and the ratio between the weight of leaves plus branches and the
weight of leaves alone for branches of 6.35 mm (r6.35) are key anatomical parameters. When missing from
species parameter table, default estimates for these parameters are obtained from combinations of leaf shape
and leaf size:
Leaf shape
Leaf size
SLA
LW
r6.35
Broad
Large
16.039
6.898
2.278
Broad
Medium
11.499
3.054
2.359
Broad
Small
9.540
0.644
3.026
Linear
Large
5.522
0.639
3.261
Linear
Medium
4.144
0.639
3.261
Linear
Small
13.189
0.639
3.261
Needle
[any]
9.024
0.379
1.716
Scale
[any]
4.544
0.101
1.483
These estimates have been obtained by averaging species-level values across combinations of the categorical
variables.
A.3.5
Tissue density
Default values for the dry weight density of leaves and wood (in g · cm−3) are determined from taxonomic
family using an internal data set (medfate:::trait_family_means):
If the family is not any of those in the table, default values are ρleaf = 0.7 and ρwood = 0.652. The default
value for fine root density is always ρfineroot = 0.165.

A.3. IMPUTATION OF MISSING VALUES
265
Table A.15: Default leaf density and wood density values by taxonomic family.
LeafDensity
WoodDensity
Acanthaceae
0.2959003
0.5684693
Achariaceae
0.2552495
0.6052036
Acoraceae
0.1000000
NA
Actinidiaceae
0.4439776
0.4092320
Adoxaceae
0.3916194
0.5157416
Aextoxicaceae
NA
0.5666667
Aizoaceae
0.0824125
NA
Akaniaceae
NA
0.5547825
Alismataceae
0.1914208
NA
Altingiaceae
0.6833971
0.6010948
Amaranthaceae
0.2045831
0.6315739
Amaryllidaceae
0.1220704
NA
Amphorogynaceae
NA
0.6097400
Anacardiaceae
0.4568088
0.5685583
Anisophylleaceae
NA
0.6734780
Annonaceae
0.3757811
0.5642062
Aphloiaceae
0.4627060
0.6205200
Apiaceae
0.2874756
0.2561785
Apocynaceae
0.2981148
0.5683635
Aptandraceae
0.3318492
0.7076756
Aquifoliaceae
0.4812626
0.5579305
Araceae
0.1659746
NA
Araliaceae
0.3118821
0.4142687
Araucariaceae
0.3447902
0.4641456
Arecaceae
0.4393589
0.5913967
Aristolochiaceae
0.2681434
0.2900000
Asparagaceae
0.1425099
0.4254258
Asphodelaceae
0.5512472
0.3951990
Aspleniaceae
0.2644557
NA
Asteraceae
0.2511093
0.4822337
Asteropeiaceae
NA
0.7554862
Atherospermataceae
0.2451357
0.4767621
Athyriaceae
0.2270615
NA
Austrobaileyaceae
0.2620992
NA
Balanopaceae
NA
0.7348976
Balsaminaceae
0.3948094
NA
Begoniaceae
0.1626789
NA
Berberidaceae
0.3599453
0.7028850
Betulaceae
0.4446528
0.5381493
Bignoniaceae
0.3572590
0.6256030
Bixaceae
0.4400000
0.3546357
Blechnaceae
0.3147993
NA
Bonnetiaceae
0.2797829
0.8400000
Boraginaceae
0.2850462
0.4987559
Brassicaceae
0.2267605
0.4516377
Bromeliaceae
0.1677139
NA
Brunelliaceae
NA
0.3112500
Bruniaceae
NA
0.5636500
Burseraceae
0.4226787
0.5205008
Buxaceae
0.2706294
0.7314511
Cactaceae
0.1819372
0.6187500
Calophyllaceae
0.4065092
0.6067855
Calycanthaceae
0.3204073
0.6500550
Calyceraceae
0.1689366
NA
Campanulaceae
0.2396318
NA

266
APPENDIX A. INBUILT PARAMETER ESTIMATION
A.3.6
Specific root length and root length density
Default values for specific fine root length and fine root length density are 3870 cm · g−1 and 10 cm · cm−3,
respectively. [JUSTIFICATION MISSING]
A.3.7
Huber value and ratio of conduits to sapwood
Missing values for Al2As, the inverse of the Huber value (1/Hv) are determined from taxonomic family using
an internal data set (medfate:::trait_family_means):
If there is no information derived from taxonomic family for Al2As, a default value is given depending on
leaf shape and leaf size:
Leaf shape
Leaf size
Al2As
Broad
Large
4768.7
Broad
Medium
2446.1
Broad
Small
2284.9
Linear
Large
2156.0
Linear
Medium
2156.0
Linear
Small
2156.0
Needle
[any]
2751.7
Scale
[any]
1696.6
Missing values for fconduits, the fraction of sapwood corresponding to conduits are derived from taxonomic
family (see table above). If information from taxonomic family is missing, default values are fconduits = 0.7
(i.e. 30% of parenchyma) for angiosperms, and fconduits = 0.925 (i.e. 7.5% of parenchyma) for gymnosperms
(Plavcová & Jansen 2015).
A.3.8
Fine root to leaf area ratio
When missing, the fine root area to leaf area ratio is given a default value of RLR = 1 m2 · m−2.
A.3.9
Leaf phenology
When missing, leaf duration is assigned a value of 1 year for winter-deciduous species and 2.41 years for the
remaining leaf phenology types.
Default values for leaf phenological parameters are the same regardless of the leaf phenology type:
Phenology type
t0gdd
Sgdd
Tbgdd
Ssen
Phsen
Tbsen
xsen
ysen
One-flush
evergreen
50
200
0
8268
12.5
28.5
2
2
Winter deciduous
50
200
0
8268
12.5
28.5
2
2
Winter
semi-deciduous
50
200
0
8268
12.5
28.5
2
2
Drought deciduous
50
200
0
8268
12.5
28.5
2
2
Leaf senescence values were derived for deciduous broad-leaved forests by Delpierre et al. (2009).

A.3. IMPUTATION OF MISSING VALUES
267
Table A.16: Default leaf area to sapwood area (m2/m2) / Huber value (cm2/m2) and fraction of sapwood
corresponding to conduits by taxonomic family.
Al2As
Hv
conduit2sapwood
Acanthaceae
3070.43202
3.2568707
0.6300000
Adoxaceae
4889.57295
2.0451684
NA
Altingiaceae
5129.90090
1.9493554
0.8226667
Amaranthaceae
973.13500
10.2760665
NA
Amborellaceae
4255.31915
2.3500000
NA
Anacardiaceae
19581.70525
0.5106808
0.7155889
Annonaceae
10266.65654
0.9740269
0.5685000
Apiaceae
81.15013
123.2283950
NA
Apocynaceae
19766.80134
0.5058987
0.7112500
Aquifoliaceae
4886.36183
2.0465124
0.6528500
Araliaceae
3928.39877
2.5455664
0.7785000
Araucariaceae
3846.15385
2.6000000
0.9375000
Arecaceae
5492.53731
1.8206522
NA
Asteraceae
2421.76507
4.1292197
0.7219423
Atherospermataceae
2435.95630
4.1051640
0.7560000
Austrobaileyaceae
15384.61538
0.6500000
NA
Berberidaceae
570.06271
17.5419298
NA
Betulaceae
6158.73417
1.6237103
0.8444000
Bignoniaceae
12439.80827
0.8038709
0.6360476
Bixaceae
12274.01424
0.8147294
NA
Burseraceae
12218.54705
0.8184279
0.8204286
Buxaceae
NA
NA
0.8330000
Cactaceae
2554.61304
3.9144872
0.3636905
Calophyllaceae
2662.52127
3.7558385
0.7335000
Calycanthaceae
NA
NA
0.6535500
Cannabaceae
29406.04715
0.3400661
0.7598125
Capparaceae
37525.87992
0.2664828
0.7005000
Caprifoliaceae
7568.54261
1.3212583
NA
Cardiopteridaceae
NA
NA
0.6300000
Caryocaraceae
5183.13611
1.9293339
NA
Casuarinaceae
3647.15784
2.7418610
NA
Celastraceae
8199.20056
1.2196311
NA
Chrysobalanaceae
10531.83851
0.9495018
0.5876000
Cistaceae
2129.37624
4.6962109
NA
Clusiaceae
6707.44573
1.4908805
0.5005000
Cochlospermaceae
1757.46925
5.6900000
0.7070000
Combretaceae
23650.62103
0.4228219
0.6416667
Cordiaceae
10754.86431
0.9298118
0.6300000
Cornaceae
7478.58356
1.3371516
0.6740000
Coulaceae
10676.38668
0.9366465
0.6520000
Cunoniaceae
4781.22975
2.0915121
0.7110000
Cupressaceae
1793.78915
5.5747912
0.9242857
Dichapetalaceae
7505.55229
1.3323470
NA
Dilleniaceae
7707.14493
1.2974973
0.5432500
Dipterocarpaceae
NA
NA
0.7043750
Ebenaceae
5746.58263
1.7401647
0.6300000
Ehretiaceae
3401.36054
2.9400000
NA
Elaeagnaceae
NA
NA
0.5641000
Elaeocarpaceae
8949.89085
1.1173321
0.6970000
Ericaceae
2717.89086
3.6793236
0.7423400
Erythropalaceae
11359.73085
0.8803025
NA
Erythroxylaceae
16409.39633
0.6094069
NA
Escalloniaceae
NA
NA
0.5755000
Euphorbiaceae
9648.31966
1.0364499
0.6630417

268
APPENDIX A. INBUILT PARAMETER ESTIMATION
A.3.10
Basic transpiration and water-use efficiency
When the basic soil water balance model is used, Tmax,LAI and Tmax,sqLAI are species-specific parameters
that regulate the maximum transpiration of plant cohorts (see 6.1.1). When these parameters are missing
from SpParams table, they are given default values Tmax,LAI = 0.134 and Tmax,sqLAI = −0.006, according
to Granier et al. (1999).
When maximum water use efficiency (WUEmax) is missing, it is given a value of WUEmax = 7.55. By
default, the coefficient describing the decay of water use efficiency with lower light levels is given a default
value of WUEP AR = 0.2812, and the coefficient regulating the relationship between gross photosynthesis
and CO2 concentration is given a default WUECO2 = 0.0028.
When missing, the water potential corresponding to 50% of transpiration (Ψextract) is estimated by calcu-
lating the water potential corresponding to the loss leaf turgor (Ψtlp), using equation (10.10) from Bartlett
et al. (2012). The parameters of the leaf pressure-volume curve needed for applying equation (10.10) may
be themselves estimated (see A.3.13). Note that Ψtlp has been found to be highly correlated to Ψgs50, the
water potential corresponding to 50% of stomatal conductance (Bartlett et al. 2016).
A.3.11
Radiation balance and water interception
Default value for direct light extinction is kb = 0.8. Default values for diffuse radiation extinction, absorbance,
reflectance and water interception parameters depend on the leaf shape:
Leaf shape
kP AR
αSW R
γSW R
swater
Broad
0.55
0.70
0.18
0.5
Linear
0.45
0.70
0.15
0.8
Needle/Scale
0.50
0.70
0.14
1.0
where kP AR is the diffuse PAR extinction coefficient, αSW R is the short-wave radiation leaf absorbance
coefficient, γSW R is the short-wave radiation leaf reflectance (albedo) and swater is the crown water storage
capacity per LAI unit.
A.3.12
Stomatal conductance
Default values for minimum and maximum conductance to water vapour (gswmin and gswmax; in mol H2O ·
s−1 · m−2) were defined depending on taxonomic family, from Duursma et al. (2018) and Hoshika et al.
(2018), and stored in an internal data set (medfate:::trait_family_means):
If there is no information derived from taxonomic family, gswmin = 0.0049 and gswmax = 0.200.
A.3.13
Pressure-volume curves
Parameters of the pressure-volume curve (i.e. π0,stem and ϵstem) for leaf and stem symplastic tissue are
required for each species.
When parameters for stem tissue are missing, medfate estimates them from wood density following Christof-
fersen et al. (2016):
π0,stem = 0.52 −4.16 · ρwood
(A.2)
ϵstem =
p
1.02 · e8.5·ρwood −2.89
(A.3)
while the apoplastic fraction of stem is assumed fapo,stem = fconduits (see A.3.7).

A.3. IMPUTATION OF MISSING VALUES
269
Table A.20: Default minimum and maximum conductance to water vapour by taxonomic family.
Gswmin
Gswmax
Acanthaceae
NA
0.2500000
Altingiaceae
NA
0.5000000
Amaranthaceae
NA
0.0750000
Amaryllidaceae
0.0180400
NA
Anacardiaceae
0.0122299
0.3148333
Apiaceae
0.0015873
NA
Aquifoliaceae
0.0005740
0.2600000
Araliaceae
0.0003902
NA
Araucariaceae
0.0018786
NA
Arecaceae
0.0004500
NA
Aristolochiaceae
0.0035896
NA
Aspleniaceae
0.0082000
NA
Asteraceae
0.0105288
0.1275000
Balsaminaceae
0.0126573
NA
Berberidaceae
0.0016500
NA
Betulaceae
0.0029731
0.3965000
Boraginaceae
0.0057402
NA
Brassicaceae
0.0106600
NA
Cactaceae
0.0000243
NA
Calophyllaceae
NA
0.1350000
Cannabaceae
NA
0.3300000
Caryophyllaceae
0.0018519
NA
Cephalotaxaceae
0.0022700
NA
Cercidiphyllaceae
NA
0.4000000
Chrysobalanaceae
NA
0.1740000
Cistaceae
0.0082820
NA
Clethraceae
NA
0.2500000
Combretaceae
0.0131200
NA
Convolvulaceae
0.0041967
NA
Cordiaceae
0.0065600
NA
Cornaceae
NA
0.3000000
Crassulaceae
0.0022751
NA
Cupressaceae
0.0063192
0.0840000
Cyperaceae
0.0190600
NA
Dipterocarpaceae
NA
0.3874722
Ehretiaceae
NA
0.2900000
Elaeagnaceae
NA
0.1700000
Ericaceae
0.0041455
0.1723333
Euphorbiaceae
0.0026500
0.2616667
Fabaceae
0.0085178
0.3066667
Fagaceae
0.0060137
0.3127601
Geraniaceae
0.0043050
NA
Hamamelidaceae
NA
0.2600000
Juglandaceae
0.0039355
0.4900000
Krameriaceae
NA
0.1600000
Lamiaceae
0.0052377
0.7300000
Lauraceae
NA
0.2212500
Magnoliaceae
0.0038800
0.3075000
Malvaceae
0.0064056
0.5532500
Meliaceae
NA
0.1600000
Moraceae
0.0064020
0.3835000
Myristicaceae
NA
0.0880000
Myrtaceae
0.0078149
0.2310769
Oleaceae
0.0046740
NA
Onagraceae
0.0169506
NA

270
APPENDIX A. INBUILT PARAMETER ESTIMATION
Default values for leaf pressure-volume parameters, i.e. π0,leaf, ϵleaf and fapo,leaf, are determined from
taxonomic family using an internal data set (medfate:::trait_family_means):
If family-level values are missing, following Bartlett et al. (2012) average values for Mediterranean climate
leaves are taken as defaults, i.e. π0,leaf = −2 MPa, ϵleaf = 17, whereas a 29% leaf apoplastic fraction is
assumed (i.e. fapo,leaf = 0.29).
A.3.14
Stem and root maximum hydraulic conductivity
Tissue-level maximum conductivity parameters (i.e. Kstem,max,ref and Kroot,max,ref) are not direct param-
eters to simulation functions. Instead, theay are scaled to estimate stem- and root-level hydraulic conduc-
tances (i.e. kstem,max and kroot,max) using plant size (see A.4.1 and A.4.3 for details). Kstem,max,ref and
Kroot,max,ref are supplied via species parameter table and missing values can therefore occur.
Default values for Kstem,max,ref are determined from taxonomic family using an internal data set
(medfate:::trait_family_means):
If family-level values are missing, suitable Kstem,max,ref values are decided according to combinations of
taxon group (either Angiosperm or Gymnosperm), growth form (either tree or shrub) and leaf phenology
(Maherali et al. 2004):
Group
Growth form
Leaf phenology
Kstem,max,ref
Angiosperm
Tree
Winter-(semi)deciduous
1.58
Angiosperm
Shrub
Winter-(semi)deciduous
1.55
Angiosperm
Tree/Shrub
Evergreen
2.43
Gymnosperm
Tree
any
0.48
Gymnosperm
Shrub
any
0.24
Following Oliveras et al. (2003), missing values for Kroot,max,ref are assumed to be four-times the values
given or estimated for Kstem,max,ref.
A.3.15
Leaf maximum hydraulic conductance
Leaf maximum hydraulic conductance (kl,max, in mmol · m−2 · s−1 · MPa−1) is an input parameter that
should be provided for each species. When missing, leaf maximum hydraulic conductance can be estimated
from maximum stomatal conductance (gswmax), following Franks (2006) (original coefficients were modified
for better fit):
kl,max = (gswmax/0.015)1/1.3
(A.4)
Note that values for gswmax may also be imputed (see A.3.12).
A.3.16
Xylem vulnerability
Default values for Ψ50,stem are determined from taxonomic family using an internal data set (medfate:::trait_family_means
If family-level values is missing, a suitable estimate of Ψ50,stem the water potential corresponding to 50%
of conductance loss, can be obtained from Maherali et al. (2004) according to combinations of taxon group
(either Angiosperm or Gymnosperm), growth form (either tree or shrub) and leaf phenology:
Group
Growth form
Leaf phenology
Ψ50,stem
Angiosperm
Tree/Shrub
Winter-(semi)deciduous
-2.34

A.3. IMPUTATION OF MISSING VALUES
271
Group
Growth form
Leaf phenology
Ψ50,stem
Angiosperm
Tree
Evergreen
-1.51
Angiosperm
Shrub
Evergreen
-5.09
Gymnosperm
Tree
any
-4.17
Gymnosperm
Shrub
any
-8.95
Ψ50,stem estimates are taken for parameter Ψcritic, in the case of the basic water balance model.
Vulnerability curves in the advanced model need to be specified for leaves, stem and root segments via the
two parameters of the Weibull function (see 10.2). When any of the parameters of the stem vulnerability
curve is missing, a regression equation using data from Choat et al. (2012) can be used to estimate Ψ88,stem
from Ψ50,stem:
Ψ88,stem = −1.4264 + 1.2593 · Ψ50,stem
(A.5)
Finally, estimates for cstem and dstem are obtained from Ψ50,stem and Ψ88,stem via function hydraulics_psi2Weibull().
Vulnerability curves for root xylem are less common than for stem xylem.
If these values are missing,
Ψ50,stem is first estimated according to its definition and the stem vulnerability curve parameters, cstem and
dstem. Then, a relationship from Bartlett et al. (2016) is used to estimate Ψ50,root from Ψ50,stem:
Ψ50,root = 0.4892 + 0.742 · Ψ50,stem
(A.6)
Finally, Ψ88,stem and the Weibull vulnerability parameters are obtained as explained for stems.
Vulnerability curves for leaf xylem are also less common than for stem xylem. If these values are missing,
the water potential at turgor los point Ψtlp is first estimated from πleaf and ϵleaf according to eq. (10.10).
Then, a relationship calibrated with data from Bartlett et al. (2016) is used to estimate Ψ50,leaf from Ψtlp:
Ψ50,leaf = 0.2486 + 0.9944 · Ψtlp
(A.7)
Finally, Ψ88,leaf and the Weibull vulnerability parameters are obtained as explained for stems.
A.3.17
Photosynthesis rates
Rubisco’s maximum carboxylation rate at 25ºC (Vmax,298, in µmolCO2 · s−1 · m−2) is a required input
parameter for each species (Vmax298).
When missing, the work by Walker et al.
(2014) suggests that
suitable estimates can be derived from SLA and Narea, the latter being the nitrogen concentration per leaf
area:
Vmax,298 = e1.993+2.555·log(Narea)−0.372·log(SLA)+0.422·log(Narea)·log(SLA)
(A.8)
In turn, imputation for SLA is explained in A.3.4, whereas values for Narea are determined from Nleaf and
SLA, being Nleaf estimated as indicated in A.3.18. Would Nleaf and SLA values be both unavailable, a
default value of 100 µmolCO2 · s−1 · m−2 is used for Vmax,298 imputation.
When the maximum rate of electron transport at the same temperature (Jmax,298) is not provided by the
user, it can be estimated from Vmax,298 using (Walker et al. 2014):
Jmax,298 = e1.197+0.847·log(Vmax,298)
(A.9)

272
APPENDIX A. INBUILT PARAMETER ESTIMATION
Table A.21: Default leaf pressure-volume parameters by taxonomic family.
LeafPI0
LeafEPS
LeafAF
Acanthaceae
-3.395000
23.230000
0.1270000
Adoxaceae
-1.560000
12.790000
NA
Amaranthaceae
-2.250000
NA
NA
Anacardiaceae
-1.700000
12.760000
NA
Annonaceae
-2.160000
23.710000
NA
Apocynaceae
-2.390000
20.940000
NA
Aquifoliaceae
-2.300000
20.700000
0.4000000
Araliaceae
-1.528503
11.231462
0.4065000
Arecaceae
-3.400000
73.400000
0.2000000
Aspleniaceae
-1.240000
35.300000
NA
Asteraceae
-1.471389
14.491429
0.2435000
Atherospermataceae
-1.340000
8.380000
NA
Betulaceae
-1.246984
5.498667
NA
Bignoniaceae
-1.990000
17.610000
0.1770000
Boraginaceae
-1.140000
NA
NA
Brassicaceae
-1.485000
7.710000
0.2320000
Burseraceae
-1.435000
14.980000
NA
Cactaceae
NA
8.700000
NA
Cannabaceae
-1.580000
5.180000
NA
Capparaceae
-2.840000
14.750000
0.1723333
Caryocaraceae
-1.710000
11.340000
NA
Celastraceae
-2.600000
19.060000
NA
Combretaceae
-2.110000
6.830000
NA
Connaraceae
-2.250000
18.010000
NA
Convolvulaceae
-1.320000
NA
NA
Cordiaceae
-1.647500
11.295938
NA
Cucurbitaceae
-0.980000
NA
NA
Cupressaceae
-1.480000
12.600000
0.2720000
Dipterocarpaceae
-1.131429
23.630000
0.4634286
Dryopteridaceae
-1.425000
48.950000
NA
Ebenaceae
-2.110000
14.650000
NA
Ericaceae
-1.670000
14.382000
0.4660000
Erythroxylaceae
-1.916667
16.993333
NA
Euphorbiaceae
-1.260000
17.570000
0.4745000
Fabaceae
-1.641724
13.577917
0.2609091
Fagaceae
-1.994080
18.132800
0.2206667
Geraniaceae
-0.730000
3.740000
NA
Goodeniaceae
-1.500000
NA
NA
Grossulariaceae
-1.845000
NA
NA
Hydrophyllaceae
-1.260000
NA
NA
Irvingiaceae
-1.690000
38.380000
0.4760000
Lamiaceae
-1.184000
6.120000
0.2200000
Lauraceae
-2.074728
16.763373
0.1760000
Lindsaeaceae
-1.970000
7.340000
0.1700000
Lythraceae
-1.535000
6.055000
NA
Magnoliaceae
-1.430000
9.140000
0.1560000
Malpighiaceae
-1.540000
9.450000
NA
Malvaceae
-2.110000
17.730000
NA
Melastomataceae
-1.754000
12.306667
NA
Moraceae
-1.353563
13.575000
NA
Myrtaceae
-1.852385
14.462948
0.4006000
Nothofagaceae
-1.480000
8.380000
NA
Nyctaginaceae
-1.280000
NA
NA
Oleaceae
-2.060557
14.205556
NA
Onagraceae
-1.200000
NA
NA

A.3. IMPUTATION OF MISSING VALUES
273
Table A.22: Default maximum stem hydraulic conductivity by taxonomic family.
Kmax_stemxylem
Adoxaceae
4.0535575
Altingiaceae
0.5050000
Amaranthaceae
0.0819000
Amborellaceae
0.5400000
Anacardiaceae
4.0772016
Annonaceae
5.2706667
Apiaceae
0.5150000
Apocynaceae
2.5651667
Aquifoliaceae
0.2255757
Araliaceae
1.6809011
Araucariaceae
0.7322500
Asteraceae
0.4986571
Austrobaileyaceae
2.3000000
Berberidaceae
0.0873333
Betulaceae
2.8733374
Bignoniaceae
2.1014900
Bruniaceae
0.2515000
Burseraceae
3.4050000
Cactaceae
1.8688095
Calophyllaceae
0.8982857
Cannabaceae
4.3396105
Capparaceae
0.5572667
Caprifoliaceae
0.2521010
Caryocaraceae
1.7587273
Casuarinaceae
1.8954048
Cistaceae
0.3958482
Clusiaceae
0.5950000
Cochlospermaceae
7.7500000
Combretaceae
5.7436667
Convolvulaceae
2.2000000
Cordiaceae
4.4607389
Cornaceae
2.3439777
Cupressaceae
0.9325131
Daphniphyllaceae
0.4600000
Dennstaedtiaceae
21.9800000
Dilleniaceae
1.2500000
Dipterocarpaceae
8.8857143
Ebenaceae
1.5527759
Ehretiaceae
0.4100000
Ericaceae
0.6151806
Erythroxylaceae
0.5352000
Euphorbiaceae
3.3816717
Eupomatiaceae
1.1239700
Fabaceae
2.9075403
Fagaceae
2.5306061
Garryaceae
1.9333333
Gnetaceae
1.2900000
Iteaceae
0.4500000
Juglandaceae
4.2050000
Lamiaceae
4.8686077
Lauraceae
1.1201255
Lecythidaceae
6.5443450
Loranthaceae
0.2817696
Lythraceae
6.1800000
Malpighiaceae
11.0500000

274
APPENDIX A. INBUILT PARAMETER ESTIMATION
Table A.24: Default stem P50 values by taxonomic family.
P50
Adoxaceae
-3.0384833
Altingiaceae
-2.0370147
Amaranthaceae
-2.4252402
Amborellaceae
-3.0000000
Anacardiaceae
-2.6535235
Annonaceae
-2.5276068
Apiaceae
-5.7000000
Apocynaceae
-2.4864334
Aquifoliaceae
-3.6437782
Araliaceae
-1.6530859
Araucariaceae
-2.6183226
Arecaceae
-1.8100000
Asparagaceae
-1.6960000
Asteraceae
-3.2565860
Atherospermataceae
-3.0063333
Austrobaileyaceae
-0.4990000
Berberidaceae
-4.5000000
Betulaceae
-2.1017591
Bignoniaceae
-0.8616667
Boraginaceae
-3.5677066
Bruniaceae
-3.3883558
Burseraceae
-1.3054970
Buxaceae
-8.0000000
Cactaceae
-1.2875000
Calophyllaceae
-1.5400000
Calycanthaceae
-1.2808475
Canellaceae
-0.2320000
Cannabaceae
-1.5325304
Capparaceae
-2.3615234
Caprifoliaceae
-5.5144833
Caryocaraceae
-1.6766667
Casuarinaceae
-2.1750000
Celastraceae
-3.4679167
Chloranthaceae
-1.7228571
Chrysobalanaceae
-2.2000000
Cistaceae
-7.1951892
Cleomaceae
-2.1842678
Clusiaceae
-1.3172327
Cochlospermaceae
-1.4400000
Combretaceae
-1.8483333
Convolvulaceae
-1.5987102
Cordiaceae
-2.3307795
Cornaceae
-4.1378833
Cunoniaceae
-1.1500000
Cupressaceae
-8.3049767
Daphniphyllaceae
-0.5985705
Dennstaedtiaceae
-1.9900000
Dilleniaceae
-1.4112676
Dipterocarpaceae
-0.3628571
Dryopteridaceae
-2.5797602
Ebenaceae
-1.5093287
Ehretiaceae
-3.8200000
Ericaceae
-2.8142685
Euphorbiaceae
-1.4638127
Eupomatiaceae
-0.3950000

A.3. IMPUTATION OF MISSING VALUES
275
A.3.18
Maintenance respiration rates
When missing at the species parameter table, maintenance respiration rates for leaves, sapwood and fine roots
(RERleaf, RERsapwood and RERfineroot; all in g gluc · g dry−1 · day−1) are estimated from corresponding
tissue nitrogen concentrations (Nleaf, Nsapwood and Nfineroot; all in mg N · g dry−1) following the equations
given by Reich et al. (2008) (after appropriate unit conversion):
RERleaf
=
e0.691+1.639·log(Nleaf ))
(A.10)
RERsapwood
=
e1.024+1.344·log(Nsapwood))
(A.11)
RERfineroot
=
e0.980+1.352·log(Nfineroot))
(A.12)
where in the previous equations nitrogen concentrations are in mmol N · g dry−1 and respiration rates in
nmol CO2 · g dry−1 · s−1.
In turn, when tissue nitrogen concentrations are missing they are estimated from taxonomic family using an
internal data set (medfate:::trait_family_means):
When family values are also missing, default tissue-averaged nitrogen concentrations are given: Nleaf =
20.088, Nsapwood = 3.9791 and Nfineroot = 12.207.
Default control values (MRleaf = 0.00260274), sapwood (MRsapwood = 6.849315e −05) and fine roots
(MRfineroot0.002054795) were used in previous model versions, derived from Ogle & Pacala (2009), but
these are no longer used because of easier parameterization using tissue nitrogen concentration.
A.3.19
Relative growth rates
When missing at the species parameter table, maximum relative growth rates for leaves, sapwood and fine
roots are taken from control parameters. Default values are provided in 15.5.3.
A.3.20
Senescence rates
When missing at the species parameter table, senescence rates for sapwood and fine roots are taken from
control parameters.
A.3.21
Relative starch for sapwood growth
When missing at the species parameter table, the minimum relative starch for sapwood growth is taken from
control parameters. Default value is provided in 15.5.3.
A.3.22
Wood carbon
Default values for Cwood are determined from taxonomic family using an internal data set (medfate:::trait_family_means):
If family-level values are missing, default value of Cwood = 0.5 g C · g dry−1 is used.
A.3.23
Mortality baseline rate
When missing at the species parameter table, the mortality baseline rate is taken from control parameters.
Default value is provided in 15.5.3.

276
APPENDIX A. INBUILT PARAMETER ESTIMATION
Table A.26: Default nitrogen concentration per dry mass in different tissues by taxonomic family.
Nleaf
Nsapwood
Nfineroot
Acanthaceae
27.122403
NA
5.580000
Achariaceae
22.162815
NA
NA
Acoraceae
18.000000
NA
NA
Actinidiaceae
20.183321
NA
NA
Adoxaceae
20.566364
NA
11.013750
Aextoxicaceae
9.621429
NA
NA
Aizoaceae
14.800000
NA
NA
Alismataceae
27.287834
NA
NA
Alstroemeriaceae
19.402857
NA
NA
Altingiaceae
15.462547
NA
7.550000
Amaranthaceae
23.740694
NA
12.411441
Amaryllidaceae
28.734076
NA
11.440000
Amphorogynaceae
25.236766
NA
NA
Anacardiaceae
17.914439
NA
10.539737
Annonaceae
23.593695
NA
23.830391
Apiaceae
24.746891
NA
10.787434
Apocynaceae
21.754119
NA
16.845575
Aptandraceae
28.435524
NA
NA
Aquifoliaceae
14.645818
NA
14.324450
Araceae
22.255347
NA
NA
Araliaceae
18.093569
NA
20.500000
Araucariaceae
12.622035
NA
13.000000
Arecaceae
18.349681
NA
13.216667
Aristolochiaceae
31.726525
NA
NA
Asparagaceae
22.875870
NA
NA
Asphodelaceae
12.352222
NA
NA
Aspleniaceae
28.260000
NA
NA
Asteraceae
22.036543
NA
9.346061
Atherospermataceae
17.869722
NA
23.200000
Athyriaceae
26.901037
NA
NA
Aulacomniaceae
8.000000
NA
NA
Balsaminaceae
36.003950
NA
NA
Begoniaceae
34.200000
NA
NA
Berberidaceae
17.997372
NA
21.087500
Betulaceae
24.194029
14.505149
13.430951
Bignoniaceae
23.830902
6.575973
19.915047
Bixaceae
25.531043
NA
NA
Blechnaceae
11.749050
NA
NA
Bonnetiaceae
9.800000
NA
NA
Boraginaceae
23.032555
NA
NA
Brassicaceae
34.316821
NA
18.501306
Bromeliaceae
9.559591
NA
NA
Brunelliaceae
21.006960
NA
NA
Bruniaceae
7.781667
NA
NA
Burseraceae
19.028712
NA
10.964427
Butomaceae
42.600000
NA
NA
Buxaceae
22.691830
NA
NA
Cabombaceae
19.500000
NA
NA
Cactaceae
16.988641
NA
NA
Calophyllaceae
12.424790
NA
NA
Calycanthaceae
17.400000
NA
NA
Calyceraceae
43.000000
NA
NA
Campanulaceae
27.682767
NA
5.721013
Cannabaceae
28.941055
NA
NA
Cannaceae
39.700000
NA
NA

A.3. IMPUTATION OF MISSING VALUES
277
Table A.27: Default wood carbon content by taxonomic family.
WoodC
Acanthaceae
0.4242167
Altingiaceae
0.4435000
Amaranthaceae
0.4197662
Amaryllidaceae
0.4508400
Anacardiaceae
0.4566867
Annonaceae
0.4726000
Apiaceae
0.4413076
Apocynaceae
0.4924750
Aquifoliaceae
0.4400000
Araliaceae
0.4540667
Arecaceae
0.4556000
Asparagaceae
0.4631000
Asteraceae
0.4375956
Betulaceae
0.4721962
Bignoniaceae
0.4618077
Boraginaceae
0.4153500
Brassicaceae
0.4274775
Burseraceae
0.4548544
Calophyllaceae
0.4663000
Campanulaceae
0.4498475
Cannabaceae
0.4683583
Caprifoliaceae
0.4475552
Caryophyllaceae
0.4147683
Casuarinaceae
0.4200000
Celastraceae
0.4900000
Chrysobalanaceae
0.4886000
Cistaceae
0.4698925
Clethraceae
0.4400000
Combretaceae
0.4678282
Convolvulaceae
0.4200000
Cordiaceae
0.4652500
Corynocarpaceae
0.4520000
Cupressaceae
0.5006151
Cyperaceae
0.4639737
Dipterocarpaceae
0.4744750
Ebenaceae
0.4828000
Ehretiaceae
0.4500000
Elaeocarpaceae
0.4350000
Ericaceae
0.4865107
Euphorbiaceae
0.4715052
Fabaceae
0.4559793
Fagaceae
0.4642838
Gentianaceae
0.4654867
Geraniaceae
0.4381400
Haematococcaceae
0.4400000
Hypericaceae
0.4547167
Juglandaceae
0.4898900
Juncaceae
0.4238725
Juncaginaceae
0.4056355
Lamiaceae
0.4650444
Lauraceae
0.4677907
Lecythidaceae
0.4618750
Lentibulariaceae
0.4450200
Loganiaceae
0.4943000
Lythraceae
0.4219000

278
APPENDIX A. INBUILT PARAMETER ESTIMATION
A.3.24
Recruitment
Imputation of missing values for recruitment is specified via control parameters. Default values are provided
in 18.4.3.
A.3.25
Flammability
Default values for the surface-area-to-volume ratio (σ), fuel heat content (h) and lignin percent (LI) are
defined from leaf size and leaf shape as follows:
Leaf shape
Leaf size
σ
h
LI
Broad
Large
5740
19740
15.50
Broad
Medium
4039
19825
20.21
Broad
Small
4386
20062
22.32
Linear/Needle
Large
3620
18250
24.52
Linear/Needle
Medium
4758
21182
24.52
Linear/Needle
Small
6697
21888
18.55
Spines
[any]
6750
20433
14.55
Scale
[any]
1120
20504
14.55
Default value for the density of fuel particles (ρp) is 400 kg · m−3.
A.4
Scaling size-related parameters
A.4.1
Stem xylem maximum conductance
Estimation of maximum stem conductance (ks,max, in mmol · m−2 · s−1 · MPa−1) is done by function
hydraulics_maximumStemHydraulicConductance() and follows the work by Savage et al. (2010), Olson et
al. (2014) and Christoffersen et al. (2016). Calculations are based on tree height and two species-specific
parameters: maximum sapwood reference conductivity (Ks,max,ref) and the ratio of leaf area to sapwood
area (Al/As; Al2As in SpParamsMED), i.e. the inverse of the Huber value Hv.
The reference value for maximum sapwood conductivity Ks,max,ref is assumed to have been measured on a
terminal branch of a plant of known height Href. If our target plant is very different in height, the conduits of
terminal branches will have different radius and hence conductivity. We correct the reference conductivity to
the target plant height using the following empirical relationship, developed by Olson et al. (2014) between
tree height and diameter of conduits for angiosperms and the equation described by Christoffersen et al.
(2016):
2 · rint,H
=
101.257+(0.24·log10(H))
(A.13)
2 · rint,ref
=
101.257+(0.24·log10(Href ))
(A.14)
Ks,max,cor
=
Ks,max,ref · (rint,H/rint,ref)2
(A.15)
Where rint,H is the radius of conduits for a terminal branch of a tree of height H and rint,ref is the
corresponding radius for a tree of height Href (H and Href are measured in m). The form of the empirical
relationship by Olson et al. (2014) is:

A.4. SCALING SIZE-RELATED PARAMETERS
279
0.5
1.0
2.0
5.0
10.0
20.0
50.0
10
15
20
H [m]
Conduit radius (in micras)
Let’s consider an example for a Quercus ilex target tree of 4m height and where species-specific conductivity
Ks,max,ref = 0.77 is the apical value for trees of Href = 6.6 m (in medfate, values of Href are taken from
median height values; see parameter Hmed in SpParamsMED). The corrected conductivity for a tree of height
4 m will be a bit lower than that of the reference height:
xylem_kmax = 0.77
H = 400 # in cm
Href = 660 # in cm
f = hydraulics_referenceConductivityHeightFactor(Href, H);
f
## [1] 0.7863352
xylem_kmax_cor = xylem_kmax * f
xylem_kmax_cor
## [1] 0.6054781
Once the reference conductivity is corrected, the maximum stem conductance without accounting for conduit
taper is:
ks,max,notaper = 1000
0.018
Ks,max,cor · As
H · Al
(A.16)
where H is the tree height (here in m), As is the sapwood area, Al is the leaf area and 1000/0.018 is a factor
used to go from kg to mmol. The ratio Al/As = 1/Hv is a fixed species parameter in soil water balance
calculations (see parameter Al2As), but becomes variable when simulating plant growth. Let’s assume that
Quercus ilex the leaf to sapwood area ratio is Al/As = 2512. The maximum (leaf-specific) stem conductance
without taper (ks,max,notaper) for the tree of 4 m height is then:

280
APPENDIX A. INBUILT PARAMETER ESTIMATION
Al2As = 2512
kstemmax = hydraulics_maximumStemHydraulicConductance(xylem_kmax,
Href, Al2As, H, taper = FALSE)
kstemmax
## [1] 3.347698
In order to consider taper of xylem conduits we calculate the whole-tree conductance per unit leaf area
(ks,max,taper) as described in Christoffersen et al. (2016):
ks,max,taper = 1000
0.018 · Ks,max,pet · As
H · Al
· χtap:notap,ag(H)
(A.17)
where Ks,max,pet is the conductivity at the petiole level and χtap:notap,ag(H) is the taper factor accounting
for the decrease in the xylem conduits diameter with the height, from the petiole to base of the trunk,
which mitigates the negative effects of height on the hydraulic safety. The conductivity at the petiole level
is obtained from Ks,max,ref using again:
Ks,max,pet = Ks,max,ref · (rint,pet/rint,ref)2
(A.18)
where rint,pet is the radius of the petiole in the model of Savage et al. (2010). Christoffersen et al. (2016)
use rint,pet = 10 µm but we define it as the radius of apical conduits in a tree of 1 m height:
hydraulics_terminalConduitRadius(100.0)
## [1] 9.035871
χtap:notap,ag(H) is calculated as described in the Appendix 1 section of Christoffersen et al. (2016) (see also
Savage et al. (2010)). The following figure shows the value of χtap:notap,ag for different heights:
0.1
0.2
0.5
1.0
2.0
5.0
20.0
50.0
0
20
40
60
H [m]
Taper conductance factor

A.4. SCALING SIZE-RELATED PARAMETERS
281
Note that, since χtap:notap,ag(1) = 3.82 (indicated using grey dashed lines in the last figure), the equation of
maximum conductance with taper would give a higher conductance than the equation without taper for a
tree of 1 m height, which is supposed to have a conductance equal to conductivity. To solve this issue we
define the taper factor as χtap:notap,ag(H)/χtap:notap,ag(1):
ks,max,taper = 1000
0.018 · Ks,max,pet · As
H · Al
· χtap:notap,ag(H)
χtap:notap,ag(1)
(A.19)
The maximum stem conductance with taper (ks,max,taper) of a Q. ilex tree of 4 m height, calculated with
this second equation, is:
kstemmax_tap = hydraulics_maximumStemHydraulicConductance(xylem_kmax,
Href, Al2As, H, taper = TRUE)
kstemmax_tap
## [1] 4.764396
The next two plots show the variation of ks,max for Q. ilex depending on the tree height and with/without
considering taper of conduits. The plot on the right (both axes in log) show the slope of the dependency of
conductance with height in both cases:
0.5
1.0
2.0
5.0
10.0
20.0
50.0
2
4
6
8
10
H [m] (log)
Maximum stem conductance (mmol·m−2·s−1·MPa−1)
Taper
No taper
0.5
1.0
2.0
5.0
10.0
20.0
50.0
1
2
5
10
H [m] (log)
Maximum stem conductance (mmol·m−2·s−1·MPa−1) (log)
Taper
No taper
A.4.2
Leaf maximum hydraulic conductance
A.4.3
Root xylem maximum hydraulic conductance
To obtain maximum root xylem conductance (kr,max, in mmol · m−2 · s−1 · MPa−1), one option taken by
Christoffersen et al. (2016) is to assume that minimum stem resistance (inverse of maximum conductance)
represents a fixed proportion of the minimum total tree (stem+root) resistance. A value 0.625 (i.e. 62.5%)
suggested by these authors leads to maximum total tree conductance for our Q. ilex tree being:

282
APPENDIX A. INBUILT PARAMETER ESTIMATION
ktot = kstemmax*0.625
ktot
## [1] 2.092311
and the maximum root xylem conductance would be therefore:
krootmax = 1/((1/ktot)-(1/kstemmax))
krootmax
## [1] 5.579497
Now, we need to divide total maximum conductance of the root system xylem among soil layers we need
weights inversely proportional to the length of transport distances (Sperry et al. 2017). Vertical transport
lengths can be calculated from soil depths and radial spread can be calculated assuming cylinders with
volume proportional to the proportions of fine root biomass. Let’s assume a soil with three layers:
s = soil(defaultSoilParams(3))
d = s$dVec
d
## [1]
300
700 1000
The proportion of fine roots in each layer, assuming a linear dose response model, will be:
Z50 = 200
Z95 = 1500
v1 = root_ldrDistribution(Z50,Z95, d)
v1
##
[,1]
[,2]
[,3]
## [1,] 0.6661036 0.2784153 0.05548106
Having this information, the calculation of root length (i.e. the sum of vertical and radial lengths) to each
layer (Lj) is done using function root_coarseRootLengths():
rfc = c(20,50,70)
Vol = root_coarseRootSoilVolumeFromConductance(1.0, 2500,krootmax,
v1, d, rfc)
l = root_coarseRootLengthsFromVolume(Vol, v1, d, rfc)
l
## [1] 4503.445 3250.363 3085.055
where lengths are in mm. The proportion of total root xylem conductance corresponding to each layer (wj)
is given by root_xylemConductanceProportions():
w1 = hydraulics_rootxylemConductanceProportions(v1, l)
w1

A.4. SCALING SIZE-RELATED PARAMETERS
283
## [1] 0.09131268 0.15767645 0.75101087
Xylem conductance proportions can be quite different than the fine root biomass proportions. This is because
radial lengths are largest for the first top layers and vertical lengths are largest for the bottom layers. The
maximum root xylem conductances of each layer will be the product of maximum total conductance of root
xylem and weights:
w1*krootmax
## [1] 0.5094788 0.8797553 4.1902629
The maximum root xylem conductances of each layer would be:
krootmaxvec = w1*krootmax
krootmaxvec
## [1] 0.5094788 0.8797553 4.1902629
and the fraction of total xylem resistance due to stem would be:
(1/kstemmax)/((1/kstemmax)+(1/krootmax))
## [1] 0.625
In contrast with the approach of Christoffersen et al. (2016), in this approach the root maximum conductance
depends root length and distribution, and is not a fixed fraction of stem maximum conductance. Assuming
constant root length, then the proportion of total resistance due to the stem will increase with tree height
(Magnani et al. 2000):
0.5
1.0
2.0
5.0
10.0
50.0
0
20
40
60
80
100
H [m]
Percentage of total resistance due to stem

284
APPENDIX A. INBUILT PARAMETER ESTIMATION
where the horizontal gray line indicates the value of 62.5%. Of course rooting depth also increases with tree
age, but young trees have higher root-to-shoot ratios than older ones. Hence, a root maximum conductance
that is not fixed but increases with age seems a priori more realistic. Moreover, Christoffersen et al. (2016)
justify the value of 62.5% from a study which quantified total aboveground and belowground resistance in
tropical trees (Fisher et al. 2006) under near-saturated (wet season) conditions, but values of belowground
resistance reported in this study for wet conditions and trees of 30 m height are around 13%, which equals to
87% fraction of aboveground resistance. On the other hand, while rooting depths are limited by soil depth,
lateral root length increases with age and, hence, the model could be made more realistic if this is taken into
account and the curve above would probably saturate at lower percentages.
A.4.4
Rhizosphere maximum hydraulic conductance
Maximum rhizosphere conductance (krh,max, in mmol · m−2 · s−1 · MPa−1) is difficult to measure directly,
as it depends on the rhizosphere (i.e. fine root) surface in each soil layer, and will probably always be a
parameter to be calibrated. Instead of trying to estimate rhizosphere surface from root architecture (Sperry
et al. 1998), we follow Sperry et al. (2016) and determine the maximum rhizosphere conductance in each
layer from an inputed ‘average percentage rhizosphere resistance’. The percentage of continuum resistance
corresponding to the rhizosphere is calculated from the vulnerability curves of stem, root and rhizosphere at
the same water potential. The average resistance is found by evaluating the percentage for water potential
values between 0 and Ψcrit. The following figure illustrates how the supply function, for different soil water
potentials, is affected by increasing values of the average percentage of rhizosphere resistance:
0
1
2
3
4
5
6
7
0.0
0.5
1.0
1.5
2.0
2.5
Leaf Pressure (−MPa)
Flow rate  (mmol·m−2·s−1)
av. resist  5
av. resist  20
av. resist  35
av. resist  50
Sperry et al. (2016) found average percentages of rhizosphere resistance around 67%, but these exceptionally-
high values were probably a consequence of using an unsegmented supply function (i.e. single vulnerability
curve for roots, stem and leaves). If we specify a 15% of average resistance in the rhizosphere (see pa-
rameter averageFracRhizosphereResistance in function defaultControl()), the maximum rhizosphere
conductance values for the three layers are found calling:
krmax = rep(0,3)
krmax[1]= hydraulics_findRhizosphereMaximumConductance(15,

A.4. SCALING SIZE-RELATED PARAMETERS
285
s$VG_n[1],s$VG_alpha[1],
krootmax, rootc,rootd,
kstemmax, stemc, stemd,
kleafmax, leafc, leafd)
krmax[2] = hydraulics_findRhizosphereMaximumConductance(15,
s$VG_n[2],s$VG_alpha[2],
krootmax, rootc,rootd,
kstemmax, stemc, stemd,
kleafmax, leafc, leafd)
krmax[3] = hydraulics_findRhizosphereMaximumConductance(15,
s$VG_n[3],s$VG_alpha[3],
krootmax, rootc,rootd,
kstemmax, stemc, stemd,
kleafmax, leafc, leafd)
krmax
## [1] 85636744 85636744 85636744
The values are the same because the texture of the three layers is the same in this case. If we take into
account root distribution, actual maximum rhizosphere conductance values are:
krmax*v1
##
[,1]
[,2]
[,3]
## [1,] 57042945 23842581 4751218
A.4.5
Plant water storage capacity
The water storage capacity of sapwood tissue per leaf area unit (Vsapwood; in l · m−2) can be estimated as
the product of stem height (H in m) and Huber value (Hv; ratio of sapwood area to leaf area in m2 · m−2)
times a factor to account for the non-cylindrical shape (http://www.fao.org/forestry/17109/en/):
Vsapwood = 103 · 0.48 · H · Hv · Θsapwood
(A.20)
Θsapwood is sapwood porosity (cm3 of water per cm3 of sapwood tissue), which can be estimated from wood
density (ρwood; in g · cm−3):
Θsapwood = 1 −(ρwood/1.54)
(A.21)
where the density of wood substance can be assumed to be fixed and equal to 1.54 g · cm−3 (Dunlap 1914).
For example, wood densities ranging from 0.443 to 1.000 g · cm−3 result in sapwood porosity values between
0.35 and 0.71.
Water storage capacity of leaf tissue per leaf area unit (Vleaf; in l · m−2) can be estimated as the product of
specific leaf area (SLA; in m2 · kg−1) and leaf density (ρleaf; in g · cm−3):
Vleaf =
1
SLA · ρleaf
· Θleaf
(A.22)
Θleaf is leaf porosity (cm3 of water per cm3 of leaf tissue), which can be estimated from leaf density:
Θleaf = 1 −(ρleaf/1.54)
(A.23)
where the density of wood substance can be assumed to be fixed and equal to 1.54 g · cm−3 (Dunlap 1914).
For example, let’s calculate the stem and leaf water capacity for a Q. ilex tree of 15 m height:

286
APPENDIX A. INBUILT PARAMETER ESTIMATION
ld = 0.7
SLA = 5.870
moisture_leafWaterCapacity(SLA, ld)
## [1] 0.1327463
A.4.6
Horizontal root overlap
A.4.6.1
Basic water balance
A given plant cohort i will have its roots in layer s partitioned among different water pools. We thus need
to define fri,s,j, the (horizontal) proportion of fine roots of cohort i in layer s of the water pool j, with the
restriction that:
X
j
fri,s,j = 1 ∀i, s
(A.24)
It is important to realize that proper estimation of fri,s,j is challenging when we do not have explicit plant
coordinates, root lateral widths, etc. For this reason, an intuitive approach is followed here based on the
following two premises:
• The amount of overlap between roots of different plants should monotonically increase along with the
LAI of the stand (i.e. LAIlive
stand).
• The amount of overlap between roots of different plants at a given soil depth should increase/decrease
with the vertical proportion of roots at that depth.
The specific formulation we chose for fri,s,j is:
fri,s,j = fpool,j · (1 −exp(−foverlap · LAIlive
stand)) ·
 p
FRPi,s · FRPj,s
maxs(FRPi,s)
!
(A.25)
for all j ̸= i, where foverlap is an overlap factor (a control parameter called poolOverlapFactor). For j = i
then we simply have:
fri,s,i = 1 −
X
j
fri,s,j
(A.26)
Note that if foverlap = 0 then fri,s,j = 1 if j = i and zero otherwise (i.e. plants exploit their corresponding
water pools only.
For very large values of LAIlive
stand and/or foverlap we have that (1 −exp(−foverlap ·
LAIlive
stand)) = 0 and fri,s,j = fpool,j (neglecting vertical differences), so that plants exploit the each water
pool in the same proportion as the fraction of stand occupied by the pool (i.e. overlap is maximum).

Appendix B
Symbols
The following tables list all symbols used in this document, along with their units and definition. When
symbols are input for medfate model functions, the R name of those parameters in the package (either in
data frame SpParamsMED, soil input data frame, or the output of functions such as spwbInput()) is also
indicated.
B.1
Dimensions
Symbol
Units
R
Description
∆tstep
s
86400/ndailysteps
Subdaily temporal step
∆tsubstep
s
86400/(ndailysteps*nsubsteps)
Subdaily temporal substep
c
(count)
Number of plant cohorts
l
(count)
Number of vertical layers
∆z
m
verticalLayerSize/100
Width of vertical layers
S
(count)
Number of soil layers
ds
mm
widths
Width of soil layer s
Zs
mm
widths
Depth of soil layer s
Zsoil
mm
Overall soil depth
B.2
Soils
Symbol
Units
R
Description
Pclay,s
%
clay
Percent of clay in soil layer s
Psand,s
%
sand
Percent of sand in soil layer s
OMs
%
om
Percentage of organic mater per dry weight in soil layer s
BDs
g · cm−3
bd
Bulk density in soil layer s
Procks,s
%
rfc
Percentage of rock fragment content in soil layer s
θs
m3 · m−3
Volumetric moisture in soil layer s
Ψs
MPa
Water potential in soil layer s
Ψfc
MPa
Water potential at field capacity
As, Bs
Parameters of the Saxton pedotransfer functions for soil
layer s
θsat,s
m3 · m−3
VG_theta_sat
Volumetric moisture at saturation for soil layer s
287

288
APPENDIX B. SYMBOLS
Symbol
Units
R
Description
θfc,s
m3 · m−3
Volumetric moisture at field capacity (-0.033 MPa) for soil
layer s
θwp,s
m3 · m−3
Volumetric moisture at wilting point (-1.5 MPa) for soil
layer s
θres,s
m3 · m−3
VG_theta_res
Residual volumetric moisture for soil layer s
ns
VG_n
Parameter n of the Van Genuchten (1980) model for soil
layer s
αs
VG_alpha
Parameter α of the Van Genuchten (1980) model for soil
layer s
Ksat,s
mmol ·
s−1 · m−1 ·
MPa−1
Ksat
Saturated soil conductivity for soil layer s.
Kunsat,s
mmol ·
s−1 · m−1 ·
MPa−1
Kunsat
Unsaturated soil conductivity for soil layer s.
Pmacro,s
%
macro
Percentage of macroporosity corresponding to soil layer s.
γsoil
mm · day−1
Gsoil
The maximum daily evaporation from soil
Zsat
mm
Depth to saturation
Vs
mm
Water volume in soil layer s
Vsoil
mm
Overall water volume in the soil
Vfc,soil
mm
Water retention capacity of the whole soil
Ws
[0-1]
W
Proportion of moisture in relation to field capacity in soil
layer s
Wi,s
[0-1]
W
Proportion of moisture in relation to field capacity in soil
layer s within fraction of stand area covered by cohort i
Wrhizo,i,s
[0-1]
Proportion of moisture in relation to field capacity in soil
layer s within the rhizosphere of cohort i
Ssnow
mm
SWE
Snow water equivalent of the snow pack storage over the
soil surface
B.3
Plant/leaf classification
Symbol
Units
R
Description
GF
Categorical
GrowthForm
“Tree”, “Shrub” or “Tree/Shrub”
LF
Categorical
LifeForm
Raunkiaer life form
Lshape
Categorical
LeafShape
Leaf shape: “Broad”, “Needle”, “Linear”, “Scale”, “Spines”
or “Succulent”
Lsize
Categorical
LeafSize
Leaf size: “Small” (< 225 mm), “Medium” (> 225 mm &
< 2025 mm) or “Large” (> 2025 mm)
Lpheno
Categorical
PhenologyType
Leaf phenology type
B.4
Vegetation
Symbol
Units
R
Description
SPi
(count)
Species
Species identity of cohort i
Ash,i
cm2
Area occupied by an average shrub individual of cohort i

B.5. METEOROLOGY
289
Symbol
Units
R
Description
Bsh,i
kg
Fine-fuel biomass of an average shrub individual of cohort i
Hi
cm
Height
Average tree or shrub height of cohort i
Hcrown,i
cm
Crown base height (i.e. the height corresponding to the
first living branch) of cohort i
CCFi
Crown competition factor of cohort i
CWi
m
Crown width that a tree of cohort i would have in
open-ground conditions
CRi
[0-1]
CR
Crown ratio (i.e. ratio between crown length and plant
height) of cohort i
Ni
indůha−1
N
Density of tree individuals of cohort i
DBHi
cm
DBH
Diameter at breast height of trees in cohort i
Coveri
%
Cover
Percent cover of shrubs in cohort i
Hherb
%
herbHeight
Average height (in cm) of herbaceous vegetation
Coverherb
%
herbCover
Percent cover of herbaceous vegetation
FBi
kg · m−2
Foliar biomass of cohort i
FBtree,i
kg
Foliar biomass of a single tree of cohort i
ϕi
[0-1]
Fraction of maximum leaf area currently expanded for
cohort i
LAIlive
i
m2 · m−2
LAI_live
(Maximum) leaf area index (one-side leaf area per surface
area of the stand) of woody cohort i
LAIdead
i
m2 · m−2
LAI_dead
Dead leaf area index (one-side dead leaf area per surface
area of the stand) of woody cohort i
LAIϕ
i
m2 · m−2
LAI_expanded
Current expanded leaf area index (one-side expanded leaf
area per surface area of the stand) of woody cohort i
LAIall
i
m2 · m−2
Total leaf area index (live or dead) of woody cohort i
LAIlive
woody
m2 · m−2
Maximum leaf area index of living leaves of woody
vegetation in the stand
LAIdead
woody
m2 · m−2
Leaf area index of dead leaves of woody vegetation in the
stand
LAIϕ
woody
m2 · m−2
Current expanded leaf area index of live leaves of woody
vegetation in the stand
LAIwoody
m2 · m−2
Total leaf area index (live or dead) of woody vegetation in
the stand
LAIherb
m2 · m−2
Leaf area index of herbaceous vegetation in the stand
LAIstand
m2 · m−2
Total leaf area index of the stand
LAi
m2
Leaf area of an individual of cohort i
FRPi,s
[0-1]
V[i,s]
The proportion of fine roots of cohort i in soil layer s
FRAi,s
m2
Fine root area of cohort i in soil layer s
Lradial,i,s
m
Radial length of coarse roots of cohort i in soil layer s
Wi
kg · m−2
Fine fuel biomass of cohort i
Z50,i
mm
Z50
Depth above which 50% of the fine root mass of cohort i is
located
Z95,i
mm
Z95
Depth above which 95% of the fine root mass of cohort i is
located
B.5
Meteorology

290
APPENDIX B. SYMBOLS
Symbol
Units
R
Description
DOY
DOY
Day of the year
Tmean
◦C
MeanTemperatureMean daily temperature
Tmin
◦C
MinTemperature Minimum daily temperature
Tmax
◦C
MaxTemperature Maximum daily temperature
Tbase
◦C
Base temperature for calculation of GDD
RHmin
%
MinRelativeHumidity
Minimum daily relative humidity
RHmax
%
MaxRelativeHumidity
Maximum daily relative humidity
P
L · m−2 =
mm
Precipitation
Precipitation (including rainfall and snow)
Pr
L · m−2 =
mm
Rainfall
Liquid water precipitation (rainfall)
Ps
L · m−2 =
mm
Snow
Snow precipitation
PET
L · m−2 =
mm
PET
Potential evapotranspiration, preferably calculated using
Penman’s equation
Rad
MJ · m−2
Radiation
Solar radiation after accounting for clouds
u
m · s−1
WindSpeed
Wind speed
Patm
kPa
Atmospheric pressure
ρair
kg · m−3
Air density
Tatm
◦C
Tatm
Atmospheric (above-canopy) air temperature
Tcan
◦C
Tcan
Canopy air temperature
Tair,j
◦C
Tair
Air temperature in canopy layer j
Tsoil,s
◦C
Tsoil.s
Temperature of soil layer s
eatm
kPa
Atmospheric (above-canopy) water vapor pressure
eair,j
kPa
VPair
Water vapor pressure in canopy layer j
Catm
kPa
Catm
Atmospheric (above-canopy) CO2 concentration
Cair,j
kPa
VPair
CO2 concentration in canopy layer j
uj
m · s−1
Wind speed at canopy layer j
B.6
Anatomy
Symbol
Units
R
Description
Hv
m2 · m−2
1/Al2As
Huber value (ratio of sapwood area to leaf area)
LW
cm
LeafWidth
Leaf width
SLA
m2 · kg−1
SLA
Specific leaf area
ρleaf
g · cm−3
LeafDensity
Leaf tissue density
ρwood
g · cm−3
WoodDensity
Wood tissue density
ρfineroot
g · cm−3
FineRootDensityFine root tissue density
Θsapwood
m3 · m−3
Sapwood porosity (volume of empty spaces over total
volume)
Θleaf
m3 · m−3
Leaf porosity (volume of empty spaces over total volume)
SRL
cm · g−1
SRL
Specific root length
RLD
cm · cm−3
RLD
Fine root length density (i.e. density of root length per soil
volume)
r6.35
r635
Ratio between the weight of leaves plus branches and the
weight of leaves alone for branches of 6.35 mm

B.7. RADIATION
291
B.7
Radiation
Symbol
Units
R
Description
kP AR,i
(unitless)
kPAR
PAR extinction coefficient for cohort i
kSW R,i
(unitless)
SWR extinction coefficient for cohort i
kLW R
(unitless)
LWR extinction coefficient
kb
(unitless)
Extinction coefficient for direct light for cohort i
kd,i
(unitless)
Extinction coefficient for diffuse light for cohort i (equal to
kP AR,i or kSW R,i)
αSW R,i
[0-1]
alphaSWR
Short-wave radiation absorbance coefficient for cohort i
αP AR,i
[0-1]
PAR absorbance coefficient for cohort i
γSW R,i
[0-1]
gammaSWR
Short-wave radiation leaf reflectance (albedo) for cohort i
γSW R,soil
[0-1]
Short-wave radiation soil reflectance
γP AR,i
[0-1]
PAR leaf reflectance for cohort i
LP AR
ground
[0-1]
LgroundPAR
Fraction of PAR reaching the ground
LSW R
ground
[0-1]
LgroundSWR
Fraction of SWR reaching the ground
Ibeam
Wům−2
Instantaneous direct shortwave irrradiance from the
atmosphere
Idif
Wům−2
Instantaneous diffuse shortwave irrradiance from the
atmosphere
Latm
Wům−2
Instantaneous longwave radiation from the atmosphere
Ibeam,j
Wům−2
Instantaneous direct shortwave irrradiance at the top of
canopy layer j
Idif,j
Wům−2
Instantaneous diffuse shortwave irrradiance at the top of
canopy layer j
Ibeam,soil
Wům−2
Instantaneous direct shortwave irrradiance reaching the soil
Idif,soil
Wům−2
Instantaneous diffuse shortwave irrradiance reaching the
soil
LAIsunlit
i,j
m2ům−2
Leaf area index of sunlit leaves of cohort i in layer j.
LAIshade
i,j
m2ům−2
Leaf area index of shade leaves of cohort i in layer j.
Φsunlit
i,j
Wům−2
Short-wave radiation absorbed by sunlit leaves of cohort i
in layer j, per leaf area unit.
Φshade
i,j
Wům−2
Short-wave radiation absorbed by sunlit leaves of cohort i
in layer j, per leaf area unit.
Ksunlit
abs,i,j
Wům−2
Short-wave radiation absorbed by sunlit foliage of cohort i
in layer j, per ground area unit.
Kshade
abs,i,j
Wům−2
Short-wave radiation absorbed by sunlit foliage of cohort i
in layer j, per ground area unit.
B.8
Water balance
Symbol
Units
R
Description
Ps
mm
Snow
Precipitation as snow
Pr
mm
Rain
Precipitation as rainfall
Sm
mm
Snowmelt
Snowmelt
Prnet
mm
NetRain
Net rainfall
In
mm
Interception
Interception loss
Ru
mm
Runoff
Water exported from the stand as runoff
Ro
mm
Runon
Water imported to the stand as runon

292
APPENDIX B. SYMBOLS
Symbol
Units
R
Description
Dd
mm
DeepDrainage
Water exported from the stand as deep drainage
Es
mm
SoilEvaporationEvaporation from the soil surface
Trwoody
mm
Transpiration
Woody plant transpiration
Trherb
mm
HerbTranspiration
Herbaceous plant transpiration
Tri
mm
Transpiration of woody plant cohort i
B.9
Energy balance
Symbol
Units
R
Description
Kabs,can
W · m−2
SWRcan
Atmosphere shortwave radiation absorbed by the canopy
Kabs,j
W · m−2
Atmosphere shortwave radiation absorbed by canopy layer
j
Kabs,soil
W · m−2
SWRsoil
Atmosphere shortwave radiation absorbed by the soil
Lnet,can
W · m−2
LWRcan
Canopy net longwave radiation
Lnet,j
W · m−2
Net long-wave radiation of canopy layer j
Lnet,soil
W · m−2
LWRsoil
Soil net longwave radiation
Hcan,atm
W · m−2
Hcan
Turbulent heat exchange between the canopy and the
atmosphere
Hcan,soil
W · m−2
Hcansoil
Turbulent heat exchange between the canopy and the soil
Hj
W · m−2
Sensible heat flux between canopy layer j and the leaves it
contains
LEcan
W · m−2
LEcan
Energy released as latent heat from the canopy towards the
atmosphere
LEj
W · m−2
Energy released as latent heat by canopy layer j
LEsoil
W · m−2
LEsoil
Energy released as latent heat from the soil
TCLAI
J · m−2 ·
K−1
thermalcapacityLAI
Canopy thermal capacitance per LAI unit
TCcan
J · m−2 ·
K−1
Canopy thermal capacitance
TCj
J · m−2 ·
K−1
Thermal capacitance of canopy layer j
TCsoil,s
J · m−2 ·
K−1
Thermal capacitance of soil layer s
V HCsoil,s
J · m−3 ·
K−1
Volumetric heat capacity of soil in layer s
B.10
Forest hydrology
Symbol
Units
R
Description
PG
mm
Amount of rainfall needed to saturate the canopy for a
given event
Scanopy
mm
Cm
Canopy water storage capacity
ERratio
(unitless)
Ratio between evaporation rate and rainfall rate
Ccanopy
[0-1]
Canopy cover
PEsoil
mm
Evaporation demand from the soil
SEsoil
mm
Evaporation supply from the soil

B.11. PLANT HYDRAULICS
293
Symbol
Units
R
Description
tsoil
day
Time needed to evaporate the current water deficit in the
first soil layer
PETherb
mm
Potential evapotranspiration in the herb layer
B.11
Plant hydraulics
Symbol
Units
R
Description
Kstem,max,ref
kg · s−1 ·
m−1 ·
MPa−1
Kmax_stemxylem Maximum stem sapwood reference conductivity per leaf
area unit
Kroot,max,ref
kg · s−1 ·
m−1 ·
MPa−1
Kmax_rootxylem Maximum root sapwood reference conductivity per leaf
area unit
kstem,max
mmol ·
s−1 · m−2 ·
MPa−1
VCstem_kmax
Maximum whole-stem conductance (per leaf area unit)
kroot,max
mmol ·
s−1 · m−2 ·
MPa−1
VCroot_kmax
Maximum root conductance (per leaf area unit)
krhizo,max
mmol ·
s−1 · m−2 ·
MPa−1
Maximum rhizosphere conductance (per leaf area unit)
kleaf,max
mmol ·
s−1 · m−2 ·
MPa−1
VCleaf_kmax
Maximum leaf conductance (per leaf area unit)
cleaf, dleaf
(unitless),
MPa
VCleaf_c,
VCleaf_d
Parameters of the vulnerability curve for leaves
croot, droot
(unitless),
MPa
VCroot_c,
VCroot_d
Parameters of the vulnerability curve for root xylem
cstem, dstem
(unitless),
MPa
VCstem_c,
VCstem_d
Parameters of the vulnerability curve for stem xylem
Ψ
MPa
Water potential in a given water compartment/segment
ΨP
MPa
Turgor water potential in a given water
compartment/segment
ΨS
MPa
Osmotic (solute) water potential in a given water
compartment
Ψcav
MPa
Minimum water potential experienced by xylem in previous
steps (cavitation)
Ψcanopy
MPa
Canopy water potential
Ψleaf
MPa
Leaf water potential
Ψrootcrown
MPa
Water potential at the root crown
Ψstem
MPa
Water potential at the end (highest part) of the stem
PLC
[0-1]
Proportion of conductance loss
PLCstem
[0-1]
Proportion of conductance loss in stem xylem tissue
proot
[0-1]
pRootDisc
Relative root conductance leading to hydraulic
disconnection from a soil layer
Ei
mmol ·
s−1 · m−2
Steady-state water flow through a hydraulic segment i

294
APPENDIX B. SYMBOLS
Symbol
Units
R
Description
ki
mmol ·
s−1 · m−2 ·
MPa−1
Hydraulic conductance function for segment i
Ψup
MPa
Upstream water potential
Ψdown
MPa
Downstream water potential
B.12
Photosynthesis
Symbol
Units
R
Description
WUEmax
g C · mm−1
WUE
Water use efficiency at VPD = 1kPa and without light or
CO2 limitations
WUEP AR
WUE_par
Coefficient describing the progressive decay of WUE with
lower light levels
WUECO2
WUE_co2
Coefficient for WUE dependency on atmospheric CO2
concentration
WUEV P D
WUE_vpd
Coefficient for WUE dependency on vapor pressure deficit
Jmax
µmol e ·
m−2 · s−1
Jmax
Maximum rate of electron transport at current leaf
temperature
Vmax,298
µmol CO2 ·
s−1 · m−2
Vmax
Rubisco’s maximum carboxylation rate at current leaf
temperature
Jmax,298
µmol e ·
m−2 · s−1
Jmax298
Maximum rate of electron transport at 298K
Vmax,298
µmol CO2 ·
s−1 · m−2
Vmax298
Rubisco’s maximum carboxylation rate at 298K
Tleaf
◦C
Leaf temperature.
uleaf
m · s−1
Leaf-level wind speed.
V PDleaf
kPa
Leaf vapour pressure deficit.
gw
mol H2O ·
s−1 · m−2
Leaf diffusive conductance to water vapor
gc
mol CO2 ·
s−1 · m−2
Leaf diffusive conductance to carbon dioxide
gsw
mol H2O ·
s−1 · m−2
Leaf stomatal conductance to water vapour
gsw,min
mol H2O ·
s−1 · m−2
Gswmin
Minimum stomatal conductance to water vapour
gsw,max
mol H2O ·
s−1 · m−2
Gswmax
Maximum stomatal conductance to water vapour
Φleaf
P AR
W · m−2
Photosynthetically active radiation absorbed per leaf area
Qleaf
P AR
µmol photon·
m−2 · s−1
PAR photon flux density per leaf area
Ac
µmol CO2 ·
s−1 · m−2
Rubisco-limited photosynthesis rate
Ae
µmol CO2 ·
s−1 · m−2
Electron transport-limited photosynthesis rate
A
µmol CO2 ·
s−1 · m−2
Leaf gross photosynthesis rate
An
µmol CO2 ·
s−1 · m−2
Leaf net photosynthesis rate

B.13. PLANT WATER CONTENT
295
B.13
Plant water content
Symbol
Units
R
Description
LFMCmax
%
maxFMC
Maximum live fuel moisture content, corresponding to fine
fuels (< 6.35 mm twigs and leaves).
ϵleaf
MPa
LeafEPS
Modulus of elasticity of leaves
ϵstem
MPa
StemEPS
Modulus of elasticity of symplastic xylem tissue
π0,leaf
MPa
LeafPI0
Osmotic potential at full turgor of leaves
π0,stem
MPa
StemPI0
Osmotic potential at full turgor of symplastic xylem tissue
RWC
[0-1]
Relative water content
RWCsym
[0-1]
Relative water content in the symplasm fraction of a tissue
RWCapo
[0-1]
Relative water content in the apoplasm fraction of a tissue
Vsegment
l · m−2
Water capacity of a segment (leaf or stem)
Vleaf
l · m−2
Vleaf
Leaf water capacity per leaf area unit
Vsapwood
l · m−2
Vsapwood
Sapwood water capacity per leaf area unit
B.14
Stomatal regulation
Symbol
Units
R
Description
θ1(Ψleaf),
θ2(Ψleaf)
[0-1]
Cost functions 1 and 2
β(Ψleaf)
[0-1]
Gain function
Profit1(Ψleaf),
Profit2(Ψleaf)
[0-1]
Profit functions 1 and 2
Esunlit
mmol ·
s−1 · m−2
Instantaneous transpiration flow rate for sunlit leaves
Eshade
mmol ·
s−1 · m−2
Instantaneous transpiration flow rate for shade leaves
B.15
Carbon pools
Symbol
Units
R
Description
Vstorage,leaf,i
L · ind−1
Leaf (carbon) storage volume for an individual of cohort i
Vstorage,sapwood,iL · ind−1
Sapwood (carbon) storage volume for an individual of
cohort i
SSleaf,i
mol gluc ·
L−1
SugarLeaf
Sugar concentration in leaves of cohort i
SSsapwood,i
mol gluc ·
L−1
SugarSapwood
Sugar concentration in sapwood of cohort i
STleaf,i
mol gluc ·
L−1
StarchLeaf
Starch concentration in leaves of cohort i
STsapwood,i
mol gluc ·
L−1
StarchSapwood
Starch concentration in sapwood of cohort i
Splant
mol gluc ·
ind−1
Total labile carbon storage in a plant individual

296
APPENDIX B. SYMBOLS
Symbol
Units
R
Description
Bleaf
g dry·ind−1
Leaf dry biomass in a plant individual (for respiration
costs)
Bsapwood
g dry·ind−1
Sapwood dry biomass in a plant individual
Bliving,sapwood
g dry·ind−1
Sapwood dry biomass corresponding to (living)
parenchymatic tissues in a plant individual (for respiration
costs)
Bfineroot
g dry·ind−1
Fine root dry biomass in a plant individual (for respiration
costs)
B.16
Carbon balance
Symbol
Units
R
Description
Mleaf
mol gluc ·
day−1
Leaf daily maintenance respiration in a plant individual
Msapwood
mol gluc ·
day−1
Sapwood daily maintenance respiration in a plant
individual
Mfineroot
mol gluc ·
day−1
Fine root daily maintenance respiration in a plant
individual
MRleaf
g gluc ·
g dry−1 ·
day−1
RERleaf
Leaf respiration rate at 20 ºC
MRsapwood
g gluc ·
g dry−1 ·
day−1
RERsapwood
Living sapwood (parenchymatic tissue) respiration rate at
20 ºC
MRfineroot
g gluc ·
g dry−1 ·
day−1
RERfineroot
Fine root respiration rate at 20 ºC
Gleaf
mol gluc ·
day−1
Leaf daily growth respiration in a plant individual
Gsapwood
mol gluc ·
day−1
Sapwood daily growth respiration in a plant individual
Gfineroot
mol gluc ·
day−1
Fine root daily growth respiration in a plant individual
Fphloem
mol gluc ·
day−1
Daily phloem transport of sugars from leaves to sapwood
SCleaf
mol gluc ·
day−1
Daily conversion from leaf sugar to leaf starch
SCsapwood
mol gluc ·
day−1
Daily conversion from sapwood sugar to sapwood starch
TSleaf
mol gluc ·
day−1
Daily translocation of leaf sugars (prior to senescence)
TSsapwood
mol gluc ·
day−1
Daily translocation of sapwood sugars (prior to senescence)
TTleaf
mol gluc ·
day−1
Daily translocation of leaf starch (prior to senescence)
REleaf
mol gluc ·
day−1
Daily root exudation of leaf carbon
REsapwood
mol gluc ·
day−1
Daily root exudation of sapwood carbon

B.17. GROWTH, SENESCENCE AND MORTALITY
297
B.17
Growth, senescence and mortality
Symbol
Units
R
Description
RGRleaf,max
m2 · cm−2 ·
day−1
RGRleafmax
Maximum leaf area daily growth rate, relative to sapwood
area
RGRsapwood,maxcm2 ·cm−2 ·
day−1
RGRsapwoodmax
Maximum daily sapwood relative growth rate (in sapwood
area basis)
RGRfineroot,maxg dry ·
g dry−1 ·
day−1
RGRfinerootmax Maximum daily fine root relative growth rate
LAtarget
m2
Leaf area allocation target
∆LAalloc
m2
Leaf area increase dictated by the difference between leaf
area allocation target and current leaf area
∆LAsource
m2
Leaf area increase according to leaf metabolic carbon
availability
∆LAsink
m2
Leaf area increase dictated by sink limitations (leaf relative
growth rate and relative cell expansion rate)
∆LA
m2
Actual leaf area increase
∆SAsource
cm2
Sapwood area increase according to sapwood storage
carbon availability
∆SAsink
cm2
Sapwood area increase dictated by sink limitations
∆SA
cm2
Actual sapwood area increase
Bfineroot,target g dry
Fine root biomass allocation target
∆Bfineroot,alloc g dry
Fine root biomass increase dictated by the difference
between fine root biomass allocation target and current
fine root biomass
∆Bfineroot,sourceg dry
Fine root biomass increase according to sapwood metabolic
carbon availability
∆Bfineroot,sink g dry
Fine root biomass increase dictated by sink limitations (fine
root relative growth rate and relative cell expansion rate)
∆Bfineroot
g dry
Actual fine root biomass increase
Adams, H.D., Park Williams, A., Xu, C., Rauscher, S.A., Jiang, X. & McDowell, N.G. (2013). Empirical
and process-based approaches to climate-induced forest mortality models. Frontiers in Plant Science, 4,
1–5.
Adams, H.D., Zeppel, M.J.B., Anderegg, W.R.L., Hartmann, H., Landhäusser, S.M., Tissue, D.T., et al.
(2017). A multi-species synthesis of physiological mechanisms in drought-induced tree mortality. Nature
Ecology and Evolution, 1, 1285–1291.
Albini, F.A. (1976). Estimating wildfire behavior and effects. For. Serv. Gen. Tech. Rep. INT-30, 4235,
44 ST–Guidelines and sample protocol for sampli.
Albini, F. & Baughman, R. (1979). Estimating windspeeds for predicting wildland fire behavior. USDA
Forest Service, Intermountain Forest and Range Experiment Station, Research Paper, INT-RP-221.
Ameztegui, A., Cabon, A., De Caceres, M. & Coll, L. (2017).
Managing stand density to enhance the
adaptability of Scots pine stands to climate change: A modelling approach. Ecological Modelling, 356,
141–150.
Anderegg, W.R.L., Wolf, A., Arango-Velez, A., Choat, B., Chmura, D.J., Jansen, S., et al. (2018). Woody
plants optimise stomatal behaviour relative to hydraulic risk. Ecology Letters, 21, 968–977.
Anten, N.P.R. & Bastiaans, L. (2016). The use of canopy models to analyze light competition among plants.
In: Canopy photosynthesis: From basics to application (eds.
Hikosaka, K., Niinemets, Ü. & Anten,
N.P.R.). Springer, pp. 379–398.
Bär, A., Michaletz, S.T. & Mayr, S. (2019). Fire effects on tree physiology. New Phytologist, 223, 1728–1741.
Bartlett, M.K., Klein, T., Jansen, S., Choat, B. & Sack, L. (2016). The correlations and sequence of plant

298
APPENDIX B. SYMBOLS
stomatal, hydraulic, and wilting responses to drought. Proceedings of the National Academy of Sciences
of the United States of America, 113, 13098–13103.
Bartlett, M.K., Scoffoni, C. & Sack, L. (2012). The determinants of leaf turgor loss point and prediction of
drought tolerance of species and biomes: A global meta-analysis. Ecology letters, 15, 393–405.
Bernacchi, C.J., Singsaas, E.L., Pimentel, C., Portis, A.R. & Long, S.P. (2001). Improved temperature
response functions for models of Rubisco-limited photosynthesis. Plant, Cell and Environment, 24, 253–
259.
Best, M.J., Pryor, M., Clark, D.B., Rooney, G.G., Essery, R.L.H., Ménard, C.B., et al.
(2011).
The
Joint UK Land Environment Simulator (JULES), model description – Part 1: Energy and water fluxes.
Geoscientific Model Development, 4, 677–699.
Birk, E.M. & Simpson, R.W. (1980). Steady state and the continuous input model of litter accumulation
and decompostion in Australian eucalypt forests. Ecology, 61, 481–485.
Blackman, C.J., Pfautsch, S., Choat, B., Delzon, S., Gleason, S.M. & Duursma, R.A. (2016). Toward an
index of desiccation time to tree mortality under drought. Plant Cell and Environment, 39, 2342–2345.
Bonan, G. (2019). Climate change and terrestrial ecosystem modeling. Cambridge University Press, Cam-
bridge, UK.
Bonan, G.B., Williams, M., Fisher, R.A. & Oleson, K.W. (2014). Modeling stomatal conductance in the earth
system: Linking leaf water-use efficiency and water transport along the soil-plant-atmosphere continuum.
Geoscientific Model Development, 7, 2193–2222.
Boughton, W. (1989).
A review of the USDA SCS curve number method.
Australian Journal of Soil
Research, 27, 511–523.
Bugmann, H., Seidl, R., Hartig, F., Bohn, F., Brůna, J., Cailleret, M., et al.
(2019).
Tree mortality
submodels drive simulated long-term forest dynamics: Assessing 15 models from the stand to global
scale. Ecosphere, 10, e02616.
Bullock, J.M., Mallada González, L., Tamme, R., Götzenberger, L., White, S.M., Pärtel, M., et al. (2017).
A synthesis of empirical plant dispersal kernels. Journal of Ecology, 105, 6–19.
Butler, B.W. & Dickinson, M.B. (2010). Tree Injury and Mortality in Fires: Developing Process-Based
Models. Fire Ecology, 6, 55–79.
Byram, G.M. (1959).
Combustion of forest fuels.
In: Forest fire: Control and use (ed.
Davis, K.P.).
McGraw-Hill, New York, pp. 61–89.
Cabon, A., Fernández-de-Uña, L., Gea-Izquierdo, G., Meinzer, F.C., Woodruff, D.R., Martínez-Vilalta, J.,
et al. (2020a). Water potential control of turgor-driven tracheid enlargement in Scots pine at its xeric
distribution edge. New Phytologist, 225, 209–221.
Cabon, A., Peters, R.L., Fonti, P., Martínez-Vilalta, J. & De Cáceres, M. (2020b). Temperature and water
potential co-limit stem cambial activity along a steep elevational gradient. New Phytologist, 226, 1325–
1340.
Campbell, G.S. & Norman, J.M. (1998). An introduction to environmental biophysics. Springer-Verlag, New
York.
Cannell, M.G.R. & Thornley, J.H.M. (2000). Modelling the Components of Plant Respiration: Some Guiding
Principles. Annals of Botany, 85, 45–54.
Carsel, R.F. & Parrish, R.S. (1988). Developing joint probability distributions of soil water retention char-
acteristics. Water Resources Research, 24, 755–769.
Cho, N., Kang, S., Agossou, C., Kim, E. & Lim, J.-H. (2022). Modeling temporal variations of non-structural
carbohydrate (NSC) storages across biomes. Forest Ecology and Management, 508, 120033.
Choat, B., Jansen, S., Brodribb, T.J., Cochard, H., Delzon, S., Bhaskar, R., et al. (2012). Global convergence
in the vulnerability of forests to drought. Nature, 491, 752–755.
Christoffersen, B.O., Gloor, M., Fauset, S., Fyllas, N.M., Galbraith, D.R., Baker, T.R., et al. (2016). Linking
hydraulic traits to tropical forest function in a size-structured and trait-driven model (TFS v.1-Hydro).
Geoscientific Model Development Discussions, 9, 4227–4255.
Chuine, I., Garcia de Cortazar-Atauri, I., Kramer, K. & Hänninen, H. (2013). Plant Development Models.
In: Phenology: An Integrative Environmental Science (ed. Schwartz, M.D.). Springer Science, Dordrecht,
pp. 275–293.
Clark, J.S., Macklin, E. & Wood, L. (1998). Stages and spatial scales of recruitment limitation in Southern
Appalachian forests. Ecological Monographs, 68, 213–235.

B.17. GROWTH, SENESCENCE AND MORTALITY
299
Cochard, H., Pimont, F., Ruffault, J. & Martin-StPaul, N. (2021). SurEau: A mechanistic model of plant
water relations under extreme drought. Annals of Forest Science, 78.
Collatz, G.J., Ball, J.T., Grivet, C. & Berry, J.A. (1991). Physiological and environmental regulation of
stomatal conductance, photosynthesis and transpiration: A model that includes a laminar boundary
layer. Agricultural and Forest Meteorology, 54, 107–136.
Collins, D.B.G. & Bras, R.L. (2007). Plant rooting strategies in water-limited ecosystems. Water Resources
Research, 43, W06407.
Cox, P.M., Betts, R.A., Bunton, C.B., Essery, R.L.H., Rowntree, P.R. & Smith, J. (1999). The impact of
new land surface physics on the GCM simulation of climate and climate sensitivity. Climate Dynamics,
15, 183–203.
De Cáceres, M., Casals, P., Gabriel, E. & Castro, X. (2019). Scaling-up individual-level allometric equations
to predict stand-level fuel loading in Mediterranean shrublands. Annals of Forest Science, 76, 87.
De Cáceres, M., Martínez-Vilalta, J., Coll, L., Llorens, P., Casals, P., Poyatos, R., et al. (2015). Coupling
a water balance model with forest inventory data to predict drought stress: The role of forest structural
changes vs. Climate changes. Agricultural and Forest Meteorology, 213, 77–90.
De Cáceres, M., Martin-StPaul, N., Turco, M., Cabon, A. & Granda, V. (2018). Estimating daily meteoro-
logical data and downscaling climate models over landscapes. Environmental Modelling & Software, 108,
186–196.
De Cáceres, M., Mencuccini, M., Martin-StPaul, N., Limousin, J.-M., Coll, L., Poyatos, R., et al. (2021).
Unravelling the effect of species mixing on water use and drought stress in Mediterranean forests: A
modelling approach. Agricultural and Forest Meteorology, 296, 108233.
De Cáceres, M., Molowny-Horas, R., Cabon, A., Martínez-Vilalta, J., Mencuccini, M., García-Valdés, R.,
et al. (2023). MEDFATE 2.9.3: A trait-enabled model to simulate Mediterranean forest function and
dynamics at regional scales. Geoscientific Model Development, 16, 3165–3201.
De Pury, D.G.G. & Farquhar, G.D. (1997). Simple scaling of photosynthesis from leaves to canopies without
the errors of big-leaf models. Plant, Cell and Environment, 20, 537–557.
Deguchi, A., Hattori, S. & Park, H.-T. (2006). The influence of seasonal changes in canopy structure on
interception loss: Application of the revised Gash model. Journal of Hydrology, 318, 80–102.
Delpierre, N., Dufrêne, E., Soudani, K., Ulrich, E., Cecchini, S., Boé, J., et al. (2009). Modelling interannual
and spatial variability of leaf senescence for three deciduous tree species in France. Agricultural and Forest
Meteorology, 149, 938–948.
Dharssi, I., Vidale, P.L., Verhoef, A., MacPherson, B., Jones, C. & Best, M. (2009). New soil physical
properties implemented in the Unified Model at PS18, 9–12.
Dietze, M.C., Sala, A., Carbone, M.S., Czimczik, C.I., Mantooth, J.A., Richardson, A.D., et al. (2014).
Nonstructural Carbon in Woody Plants. Annual Review of Plant Biology, 65, 667–687.
Dunlap, F. (1914). Density of wood substance and porosity of wood. Journal of Agricultural Research, II,
423–428.
Duursma, R.A., Blackman, C.J., Lopéz, R., Martin-StPaul, N.K., Cochard, H. & Medlyn, B.E. (2018). On
the minimum leaf conductance: Its role in models of plant water use, and ecological and environmental
controls. New Phytologist, 221, 693–705.
Espelta, J.M., Barbati, A., Quevedo, L., Tárrega, R., Navascués, P., Bonfil, C., et al. (2012). Post-Fire
Management of Mediterranean Broadleaved Forests.
In: Post-Fire Management and Restoration of
Southern European Forests, Managing Forest Ecosystems (eds. Moreira, F., Arianoutsou, M., Corona, P.
& De las Heras, J.). Springer Netherlands, Dordrecht, pp. 171–194.
Espelta, J.M., Habrouk, A. & Retana, J. (2006).
Response to natural and simulated browsing of two
Mediterranean oaks with contrasting leaf habit after a wildfire. Annals of Forest Science, 63, 441–447.
Espelta, J.M., Sabaté, S. & Retana, J. (1999).
Resprouting Dynamics.
In: Ecology of Mediterranean
Evergreen Oak Forests, Ecological Studies (eds. Rodà, F., Retana, J., Gracia, C.A. & Bellot, J.). Springer,
Berlin, Heidelberg, pp. 61–73.
Fatichi, S., Leuzinger, S. & Körner, C. (2014).
Moving beyond photosynthesis: From carbon source to
sink-driven vegetation modeling. New Phytologist, 201, 1086–1095.
Federer, C. (1982). Transpirational supply and demand: Plant, soil, and atmospheric effects evaluated by
simulation. Water Resources Research, 18, 355–362.
Fisher, R.A., Williams, M., Do Vale, L.R., Da Costa, A.L. & Meir, P. (2006). Evidence from Amazonian

300
APPENDIX B. SYMBOLS
forests is consistent with a model of isohydric control of leaf water potential. Plant, Cell and Environment,
29, 151–165.
Flerchinger, G.N., Xiao, W., Sauer, T.J. & Yu, Q. (2009). Simulation of within-canopy radiation exchange.
NJAS - Wageningen Journal of Life Sciences, 57, 5–15.
Först, P., Werner, F. & Delgado, A. (2002). On the pressure dependence of the viscosity of aqueous sugar
solutions. Rheologica Acta, 41, 369–374.
Francés, F., Vélez, J.I. & Vélez, J.J. (2007).
Split-parameter structure for the automatic calibration of
distributed hydrological models. Journal of Hydrology, 332, 226–240.
Franks, P.J. (2006). Higher rates of leaf gas exchange are associated with higher leaf hydrodynamic pressure
gradients. Plant, Cell and Environment, 29, 584–592.
Friend, A.D., Eckes-Shephard, A.H., Fonti, P., Rademacher, T.T., Rathgeber, C.B.K., Richardson, A.D.,
et al. (2019). On the need to consider wood formation processes in global vegetation models and a
suggested approach. Annals of Forest Science, 76, 49.
Friend, A.D., Stevens, A.K., Knox, R.G. & Cannell, M.G.R. (1997). A process-based, terrestrial biosphere
model of ecosystem dynamics (Hybrid v3.0). Ecological Modelling, 95, 249–287.
Fyllas, N.M. & Troumbis, A.Y. (2009). Simulating vegetation shifts in north-eastern Mediterranean mountain
forests under climatic change scenarios. Global Ecology and Biogeography, 18, 64–77.
García-Jiménez, R., Palmero-Iniesta, M. & Espelta, J. (2017). Contrasting Effects of Fire Severity on the
Regeneration of Pinus halepensis Mill. And Resprouter Species in Recently Thinned Thickets. Forests,
8, 55.
Gash, J., Lloyd, C. & Lachaud, G. (1995). Estimating sparse forest rainfall interception with an analytical
model. Journal of Hydrology, 170.
Genuchten, M.V. (1980). A closed-form equation for predicting the hydraulic conductivity of unsaturated
soils. Soil science society of America journal, 44, 892–898.
Gifford, R.M. (2003). Plant respiration in productivity models: Conceptualisation, representation and issues
for global terrestrial carbon-cycle research. Functional Plant Biology, 30, 171–186.
Granier, A., Bréda, N., Biron, P. & Villette, S. (1999). A lumped water balance model to evaluate duration
and intensity of drought constraints in forest stands. Ecological Modelling, 116, 269–283.
Granier, A., Reichstein, M., Bréda, N., Janssens, I.A., Falge, E., Ciais, P., et al. (2007). Evidence for soil
water control on carbon and water dynamics in European forests during the extremely dry year: 2003.
Agricultural and Forest Meteorology, 143, 123–145.
Green, H.W. & Ampt, G.A. (1911). Studies on Soil Physics. The Journal of Agricultural Science, 4, 1–24.
Guillemot, J., Martin-Stpaul, N.K., Dufrêne, E., François, C., Soudani, K., Ourcival, J.M., et al. (2015). The
dynamic of the annual carbon allocation to wood in European tree species is consistent with a combined
source-sink limitation of growth: Implications for modelling. Biogeosciences, 12, 2773–2790.
Hammond, W.M., Yu, Kailiang.L., Wilson, L.A., Will, R.E., Anderegg, W.R.L. & Adams, H.D. (2019). Dead
or dying? Quantifying the point of no return from hydraulic failure in drought-induced tree mortality.
New Phytologist.
Hasenauer, H. & Monserud, R.A. (1996). A crown ratio model for Austrian Forests. Forest Ecology and
Management, 84, 49–60.
Haverkamp, R., Vauclin, M., Touma, J., Wierenga, P.J. & Vachaud, G. (1977). A Comparison of Numerical
Simulation Models For One-Dimensional Infiltration. Soil Science Society of America Journal, 41, 285–
294.
Hawkes, C. (2000).
Woody plant mortality algorithms: Description, problems and progress.
Ecological
Modelling, 126, 225–248.
Hikosaka, K., Kumagai, T. & Ito, A. (2016). Modeling Canopy Photosynthesis. pp. 239–268.
Hölttä, T., Cochard, H., Nikinmaa, E. & Mencuccini, M. (2009). Capacitive effect of cavitation in xylem
conduits: Results from a dynamic model. Plant, Cell and Environment, 32, 10–21.
Hölttä, T., Lintunen, A., Chan, T., Mäkelä, A. & Nikinmaa, E. (2017). A steady-state stomatal model of
balanced leaf gas exchange, hydraulics and maximal source-sink flux. Tree physiology, 37, 851–868.
Hood, S.M., Varner, J.M., Van Mantgem, P. & Cansler, C.A. (2018). Fire and tree death: Understanding
and improving modeling of fire-induced tree mortality. Environmental Research Letters, 13.
Hoshika, Y., Osada, Y., Marco, A. de, Peñuelas, J. & Paoletti, E. (2018). Global diurnal and nocturnal
parameters of stomatal conductance in woody plants and major crops. Global Ecology and Biogeography,

B.17. GROWTH, SENESCENCE AND MORTALITY
301
27, 257–275.
Jarvis, N.J., Jansson, P-E., Dik, P.E. & Messing, I. (1991). Modelling water and solute transport in macro-
porous soil. I. Model description and sensitivity analysis. Journal of Soil Science, 42, 59–70.
Karavani, A., De Cáceres, M., Martínez de Aragón, J., Bonet, J.A. & de-Miguel, S. (2018). Effect of climatic
and soil moisture conditions on mushroom productivity and related ecosystem services in Mediterranean
pine stands facing climate change. Agricultural and Forest Meteorology, 248, 432–440.
Katul, G.G., Mahrt, L., Poggi, D. & Sanz, C. (2004). One- and two-equation models for canopy turbulence.
Boundary-Layer Meteorology, 113, 81–109.
Keane, R., Austin, M., Field, C. & Huth, A. (2001). Tree mortality in gap models: Application to climate
change. Climatic Change, 51, 509–540.
Kergoat, L. (1998). A model for hydrological equilibrium of leaf area index on a global scale. Journal of
Hydrology, 212-213, 268–286.
Körner, C. (2015). Paradigm shift in plant growth control. Current Opinion in Plant Biology, 25, 107–114.
Körner, C. (2019). No need for pipes when the well is dry-a comment on hydraulic failure in trees. Tree
physiology, 39, 695–700.
Krajicek, J., Brinkman, K. & Gingrich, S. (1961). Crown competition-a measure of density. Forest Science,
7, 35–42.
Kursar, T.A., Engelbrecht, B.M.J., Burke, A., Tyree, M.T., El Omari, B. & Giraldo, J.P. (2009). Tolerance
to low leaf water status of tropical tree seedlings is related to drought performance and distribution.
Functional Ecology, 23, 93–102.
Lai, C., Katul, G., Oren, R., Ellsworth, D. & Schäfer, K. (2000). Modeling CO2 and water vapor turbulent
flux distributions within a forest canopy. Journal of Geophysical Research: Atmospheres, 105, 26333–
26351.
Landsberg, J.J. & Waring, R.H. (1997). A generalised model of forest productivity using simplified concepts
of radiation-use efficiency, carbon balance and partitioning. Forest Ecology and Management, 95, 209–
228.
Larsbo, M., Roulier, S., Stenemo, F., Kasteel, R. & Jarvis, N. (2005). An Improved Dual-Permeability
Model of Water Flow and Solute Transport in the Vadose Zone. Vadose Zone Journal, 4, 398–406.
Leij, F.J., Alves, W.J., Genuchten, M.Th.V. & Williams, J.R. (1996).
The UNSODA Unsaturated Soil
Hydraulic Database User’s Manual Version 1.0.
Leuning, R. (2002). Temperature dependence of two parameters in a photosynthesis model. Plant, Cell and
Environment, 25, 1205–1210.
Lindner, M., Sievänen, R. & Pretzsch, H. (1997). Improving the simulation of stand structure in a forest
gap model. Forest Ecology and Management, 95, 183–195.
Liu, S. (2001). Evaluation of the Liu model for predicting rainfall interception in forests world-wide. Hydro-
logical Processes, 15, 2341–2360.
Lloret, F., Siscart, D. & Dalmases, C. (2004). Canopy recovery after drought dieback in holm-oak Mediter-
ranean forests of Catalonia (NE Spain). Global Change Biology, 10, 2092–2099.
Ma, Y. & Liu, H. (2019). An Advanced Multiple-Layer Canopy Model in the WRF Model With Large-
Eddy Simulations to Simulate Canopy Flows and Scalar Transport Under Different Stability Conditions.
Journal of Advances in Modeling Earth Systems, 11, 2330–2351.
Magnani, F., Mencuccini, M. & Grace, J. (2000). Age-related decline in stand productivity: The role of
structural acclimation under hydraulic constraints. Plant, Cell and Environment, 23, 251–263.
Maherali, H., Pockman, W. & Jackson, R. (2004). Adaptive variation in the vulnerability of woody plants
to xylem cavitation. Ecology, 85, 2184–2199.
Manoli, G., Huang, C., Bonetti, S., Domec, J., Marani, M. & Katul, G. (2017). Competition for light and
water in a coupled soil-plant system. Advances in Water Resources, 108, 216–230.
Martinez-Vilalta, J., Anderegg, W.R.L., Sapes, G. & Sala, A. (2019). Greater focus on water pools may
improve our ability to understand and anticipate drought-induced mortality in plants. New Phytologist,
223, 22–32.
Martínez-Vilalta, J., Sala, A., Asensio, D., Galiano, L., Hoch, G., Palacio, S., et al. (2016). Dynamics
of non-structural carbohydrates in terrestrial plants: A global synthesis.
Ecological Monographs, 86,
495–516.
Martin-StPaul, N., Delzon, S. & Cochard, H. (2017). Plant resistance to drought depends on timely stomatal

302
APPENDIX B. SYMBOLS
closure. Ecology Letters, 20, 1437–1447.
Massman, W. (1987). A comparative study of some mathematical models of the mean wind structure and
aerodynamic drag of plant canopies. Boundary-Layer Meteorology, 40, 179–197.
McDowell, N.G. (2011). Mechanisms linking drought, hydraulics, carbon metabolism, and vegetation mor-
tality. Plant Physiology, 155, 1051–1059.
McDowell, N.G., Sapes, G., Pivovaroff, A., Adams, H.D., Allen, C.D., Anderegg, W.R.L., et al. (2022).
Mechanisms of woody-plant mortality under rising drought, CO2 and vapour pressure deficit. Nature
Reviews Earth & Environment, 0123456789, 294–308.
McDowell, N., Pockman, W.T., Allen, C.D., Breshears, D.D., Cobb, N., Kolb, T., et al. (2008). Mechanisms
of plant survival and mortality during drought: Why do some plants survive while others succumb to
drought? The New Phytologist, 178, 719–39.
McMurtrie, R.E., Rook, D.A. & Kelliher, F.M. (1990). Modelling the yield of Pinus radiata on a site limited
by water and nitrogen. Forest Ecology and Management, 30, 381–413.
Medlyn, B.E., Loustau, D. & Delzon, S. (2002). Temperature response of parameters of a biochemically based
model of photosynthesis. I. Seasonal changes in mature maritime pine (Pinus pinaster Ait.). Plant, Cell
and Environment, 25, 1155–1165.
Mencuccini, M. & Grace, J. (1995). Climate influences the leaf area/sapwood area ratio in Scots pine. Tree
Physiology, 15, 1–10.
Michaletz, S.T. & Johnson, E.A. (2006). A heat transfer model of crown scorch in forest fires. Canadian
Journal of Forest Research, 36, 2839–2851.
Michaletz, S.T. & Johnson, E.A. (2008). A biophysical process model of tree mortality in surface fires.
Canadian Journal of Forest Research, 38, 2013–2029.
Miralles, D.G., Gash, J.H., Holmes, T.R.H., Jeu, R.A.M. de & Dolman, A.J. (2010). Global canopy inter-
ception from satellite observations. Journal of Geophysical Research, 115, D16122.
Mitsopoulos, I.D. & Dimitrakopoulos, A.P. (2007). Allometric equations for crown fuel biomass of Aleppo
pine (Pinus halepensis Mill.) in Greece. International Journal of Wildland Fire, 16, 642–647.
Moreira, B., Tormo, J. & Pausas, J.G. (2012). To resprout or not to resprout: Factors driving intraspecific
variability in resprouting. Oikos, 121, 1577–1584.
Mouillot, F., Rambal, S. & Joffre, R. (2002).
Simulating climate change impacts on fire frequency and
vegetation dynamics in a Mediterranean-type ecosystem. Global Change Biology, 8, 423–437.
Mouillot, F., Rambal, S. & Lavorel, S. (2001).
A generic process-based SImulator for meditERRanean
landscApes (SIERRA): Design and validation exercises. Forest Ecology and Management, 147, 75–97.
Nathan, R., Klein, E., Robledo-Arnuncio, J.J. & Revilla, E. (2012). Dispersal kernels: review. In: Dispersal
Ecology and Evolution (eds. Clobert, J., Baguette, M., Benton, T.G. & Bullock, J.M.). Oxford University
Press, pp. 186–210.
Nathan, R., Safriel, U.N. & Noy-Meir, I. (2001). Field validation and sensitivity analysis of a mechanistic
model for tree seed dispersal by wind. Ecology, 82, 374–388.
Ogle, K. & Pacala, S.W. (2009).
A modeling framework for inferring tree growth and allocation from
physiological, morphological and allometric traits. Tree Physiology, 29, 587–605.
Oliveras, I., Martínez-Vilalta, J., Jimenez-Ortiz, T., Lledó, M.J., Escarré, A. & Piñol, J. (2003). Hydraulic
architecture of Pinus halepensis, P . Pinea and Tetraclinis articulata in a dune ecosystem of Eastern
Spain. Plant Ecology, 131–141.
Olson, M.E., Anfodillo, T., Rosell, J.A., Petit, G., Crivellaro, A., Isnard, S., et al.
(2014).
Universal
hydraulics of the flowering plants: Vessel diameter scales with stem length across angiosperm lineages,
habits and climates. Ecology Letters, 17, 988–997.
Ostendorf, B. & Reynolds, J.F. (1993). Relationships between a terrain-based hydrologic model and patch-
scale vegetation patterns in an arctic tundra landscape. Landscape Ecology, 8, 229–237.
Pausas, J.G., Pratt, R.B., Keeley, J.E., Jacobsen, A.L., Ramirez, A.R., Vilagrosa, A., et al. (2016). Towards
understanding resprouting at the global scale. New Phytologist, 209, 945–954.
Pimont, F., Dupuy, J.L. & Rigolot, E. (2018). A simple model for shrub-strata-fuel dynamics in Quercus
coccifera L. communities. Annals of Forest Science, 75, 1–9.
Plavcová, L. & Jansen, S. (2015). The Role of Xylem Parenchyma in the Storage and Utilization of Nonstruc-
tural Carbohydrates. In: Functional and Ecological Xylem Anatomy. Springer International Publishing,
Cham, pp. 209–234.

B.17. GROWTH, SENESCENCE AND MORTALITY
303
Prentice, I.C., Sykes, M.T. & Cramer, W. (1993). A simulation model for the transient effects of climate
change on forest landscapes. Ecological Modelling, 65, 51–70.
Prescott, C.E., Grayston, S.J., Helmisaari, H.-S., Kaštovská, E., Körner, C., Lambers, H., et al. (2020).
Surplus Carbon Drives Allocation and Plant–Soil Interactions. Trends in Ecology & Evolution, 35, 1110–
1118.
Price, D., Zimmermann, N. & Meer, P.V.D. (2001). Regeneration in gap models: Priority issues for studying
forest responses to climate change. Climatic Change, 51, 475–508.
Prichard, S.J., Sandberg, D.V., Ottmar, R.D., Eberhardt, E., Andreu, A., Eagle, P., et al. (2013). Classifi-
cation System Version 3.0: Technical Documentation.
Rahimi, A.A., Sepaskhah, A.R. & Ahmadi, S.H. (2011). Evaluation of different methods for the prediction
of saturated hydraulic conductivity in tilled and untilled soils. Archives of Agronomy and Soil Science,
57, 899–914.
Rasche, L., Fahse, L., Zingg, A. & Bugmann, H. (2012). Enhancing gap model accuracy by modeling dynamic
height growth and dynamic maximum tree height. Ecological Modelling, 232, 133–143.
Reich, P.B., Tjoelker, M.G., Pregitzer, K.S., Wright, I.J., Oleksyn, J. & Machado, J.L. (2008). Scaling of
respiration to nitrogen in leaves, stems and roots of higher land plants. Ecology Letters, 11, 793–801.
Reinhardt, E., Lutes, D. & Scott, J. (2006). FuelCalc: A method for estimating fuel characteristics.
Retana, J., Riba, M., Castell, C. & Espelta, J.M. (1992). Regeneration by sprouting of holm-oak (Quercus
ilex) stands exploited by selection thinning. Vegetatio, 99, 355–364.
Richardson, A.D., Carbone, M.S., Keenan, T.F., Czimczik, C.I., Hollinger, D.Y., Murakami, P., et al.
(2013). Seasonal dynamics and age of stemwood nonstructural carbohydrates in temperate forest trees.
New Phytologist, 197, 850–861.
Ritchie, J. (1972). Model for predicting evaporation from a row crop with incomplete cover. Water resources
research, 8, 1204–1213.
Rolo, V. & Moreno, G. (2019). Shrub encroachment and climate change increase the exposure to drought
of Mediterranean wood-pastures. Science of The Total Environment, 660, 550–558.
Rothermel, R.C. (1972). A mathematical model for predicting fire spread in wildland fuels. USDA Forest
Service Research Paper INT USA.
Rötzer, T., Häberle, K.H., Kallenbach, C., Matyssek, R., Schütze, G. & Pretzsch, H. (2017). Tree species
and size drive water consumption of beech/spruce forests - a simulation study highlighting growth under
water limitation. Plant and Soil, 418, 337–356.
Ruffault, J., Martin-StPaul, N.K., Duffet, C., Goge, F. & Mouillot, F. (2014). Projecting future drought in
Mediterranean forests: Bias correction of climate models matters! Theoretical and Applied Climatology,
117, 113–122.
Ruffault, J., Martin-StPaul, N.K., Rambal, S. & Mouillot, F. (2013).
Differential regional responses in
drought length, intensity and timing to recent climate changes in a Mediterranean forested ecosystem.
Climatic Change, 117, 103–117.
Ruffault, J., Pimont, F., Cochard, H., Dupuy, J.-L. & Martin-StPaul, N. (2022). SurEau-Ecos v2.0: A
trait-based plant hydraulics model for simulations of plant water status and drought-induced mortality
at the ecosystem level. Geoscientific Model Development, 15, 5593–5626.
Sandberg, D.V., Riccardi, C.L. & Schaaf, M.D. (2007). Reformulation of Rothermel’s wildland fire behaviour
model for heterogeneous fuelbeds. Canadian Journal of Forest Research, 37, 2438–2455.
Sando, R.W. & Wick, C.H. (1972). A method of evaluating crown fuels in forest stands. Research Paper
NC-84. USDA Forest Service Research Paper NC-84, 10 pp.
Savage, V.M., Bentley, L.P., Enquist, B.J., Sperry, J.S., Smith, D.D., Reich, P.B., et al.
(2010).
Hy-
draulic trade-offs and space filling enable better predictions of vascular structure and function in plants.
Proceedings of the National Academy of Sciences of the United States of America, 107, 22722–7.
Saxton, K.E. & Rawls, W.J. (2006). Soil water characteristic estimates by texture and organic matter for
hydrologic solutions. Soil Science Society of America Journal, 70, 1569.
Saxton, K.E., Rawls, W.J., Romberger, J.S. & Papendick, R.I. (1986). Estimating generalized soil-water
characteristics from texture. Soil Science Society of America Journal, 50, 1031–1036.
Schaaf, M.D., Sandberg, D.V., Schreuder, M.D. & Riccardi, C.L. (2007). A conceptual framework for ranking
crown fire potential in wildland fuelbeds. Canadian Journal of Forest Research, 37, 2464–2478.
Schenk, H.J. & Jackson, R.B. (2002). Rooting depths, lateral root spreads and below-ground/above-ground

304
APPENDIX B. SYMBOLS
allometries of plants in water-limited ecosystems. Journal of Ecology, 90, 480–494.
Schume, H., Jost, G. & Hager, H. (2004). Soil water depletion and recharge patterns in mixed and pure
forest stands of European beech and Norway spruce. Journal of Hydrology, 289, 258–274.
Scott, J.H. & Reinhardt, E.D. (2002). Estimating canopy fuels in conifer forests. Fire Management Today,
62, 45–50.
Sellers, P.J. (1985). Canopy reflectance, photosynthesis and transpiration. International Journal of Remote
Sensing, 6, 1335–1372.
Shinozaki, K., Yoda, K., Hozumi, K. & Kira, T. (1964). A quantitative analysis of plant form - the pipe
model theory. I. Basic analysis. Japanese Journal of Ecology, 14, 97–105.
Sitch, S., Smith, B., Prentice, I.C., Arneth, a., Bondeau, a., Cramer, W., et al. (2003).
Evaluation of
ecosystem dynamics, plant geography and terrestrial carbon cycling in the LPJ dynamic global vegetation
model. Global Change Biology, 9, 161–185.
Snell, R.S. (2014). Simulating long-distance seed dispersal in a dynamic vegetation model. Global Ecology
and Biogeography, 23, 89–98.
Sperry, J.S., Adler, F.R., Campbell, G.S. & Comstock, J.P. (1998).
Limitation of plant water use by
rhizosphere and xylem conductance: Results from a model. Plant, Cell & Environment, 21, 347–359.
Sperry, J.S. & Love, D.M. (2015). What plant hydraulics can tell us about responses to climate-change
droughts. New Phytologist, 207, 14–27.
Sperry, J.S., Venturas, M.D., Anderegg, W.R.L., Mencuccini, M., Mackay, D.S., Wang, Y., et al. (2017).
Predicting stomatal responses to the environment from the optimization of photosynthetic gain and
hydraulic cost. Plant, Cell & Environment, 40, 816–830.
Sperry, J.S., Wang, Y., Wolfe, B.T., Mackay, D.S., Anderegg, W.R.L., Mcdowell, N.G., et al.
(2016).
Pragmatic hydraulic theory predicts stomatal responses to climatic water deficits. New Phytologist, 212,
577–589.
Spicer, R. (2005).
Senescence in Secondary Xylem: Heartwood Formation as an Active Developmental
Program. Vascular Transport in Plants, 457–475.
Spitters, C.J.T., Toussaint, H.A.J.M. & Goudriaan, J. (1986). Separating the diffuse and direct components
of global radiation and its implications for modeling canopy photosynthesis. I. Components of incoming
radiation. Agricultural and Forest Meteorology, 38, 231–242.
Stephan, K., Miller, M. & Dickinson, M.B. (2010). First-Order Fire Effects on Herbs and Shrubs: Present
Knowledge and Process Modeling Needs. Fire Ecology, 6, 95–114.
Stolf, R., Thurler, Á., Oliveira, O., Bacchi, S. & Reichardt, K. (2011). Method to estimate soil macroporosity
and microporosity based on sand content and bulk density. Revista Brasileira de Ciencias do Solo, 35,
447–459.
Tjoelker, M.G., Oleksyn, J. & Reich, P.B. (2001). Modelling respiration of vegetation: Evidence for a general
temperature-dependent Q10. Global Change Biology, 7, 223–230.
Tóth, B., Weynants, M., Nemes, A., Makó, A., Bilas, G. & Tóth, G. (2015). New generation of hydraulic
pedotransfer functions for Europe. European Journal of Soil Science, 66, 226–238.
Tyree, M.T. & Yang, S. (1990).
Water-storage capacity of Thuja, Tsuga and Acer stems measured by
dehydration isotherms - The contribution of capillary water and cavitation. Planta, 182, 420–426.
Urli, M., Porte, A.J., Cochard, H., Guengant, Y., Burlett, R. & Delzon, S. (2013). Xylem embolism threshold
for catastrophic hydraulic failure in angiosperm trees. Tree Physiology, 33, 672–683.
Van Lier, Q.D.J., Neto, D.D. & Metselaar, K. (2009). Modeling of transpiration reduction in van genuchten-
mualem type soils. Water Resources Research, 45, 1–9.
Walker, A.P., Beckerman, A.P., Gu, L., Kattge, J., Cernusak, L.A., Domingues, T.F., et al. (2014). The
relationship of leaf photosynthetic traits - Vcmax and Jmax - to leaf nitrogen, leaf phosphorus, and
specific leaf area: A meta-analysis and modeling study. Ecology and Evolution, 4, 3218–3235.
Watanabe, T. & Mizutani, K. (1996). Model study on micrometeorological aspects of rainfall interception
over an evergreen broad-leaved. Agricultural and Forest Meteorology, 80, 195–214.
Wehrli, A., Weisberg, P.J., Schönenberger, W., Brang, P. & Bugmann, H. (2007). Improving the estab-
lishment submodel of a forest patch model to assess the long-term protective effect of mountain forests.
European Journal of Forest Research, 126, 131–145.
Wigmosta, M.S. & Lettenmaier, D.P. (1999). A comparison of simplified methods for routing topographically
driven subsurface flow. Water Resources Research, 35, 255–264.

B.17. GROWTH, SENESCENCE AND MORTALITY
305
Wigmosta, M., Vail, L. & Lettenmaier, D. (1994). A distributed hydrology-vegetation model for complex
terrain. Water Resources Research, 30, 1665–1679.
Wolf, A., Anderegg, W.R.L. & Pacala, S.W. (2016). Optimal stomatal behavior with competition for water
and risk of hydraulic impairment. Proceedings of the National Academy of Sciences, 113, E7222–E7230.
