SEM Baseline — Bioclim Subset (654 species) — Phylotraits Context

Scope
- Traits‑only pwSEM baselines on the bioclim‑eligible subset (≥3 cleaned occurrences). These are the same baselines as the expanded600 run since dataset and method did not change; reproduced here for convenience within the phylotraits summaries.

Dataset and Method
- Trait CSV (bioclim subset): artifacts/model_data_bioclim_subset.csv
- Generated by Stage‑1 bioclim‑first pipeline; species summary at data/bioclim_extractions_bioclim_first/summary_stats/species_bioclim_summary.csv
- SEM runner: src/Stage_4_SEM_Analysis/run_sem_pwsem.R (pwSEM + mgcv)
- CV protocol: repeated, stratified 10×5 CV; fold‑internal standardization; LES and SIZE recomputed in‑fold
- Canonical flags (per axis):
  - L: nonlinear GAM (rf_plus), deconstruct size for L, ti(logLA,logH), ti(logH,logSSD)
  - T: linear with SIZE
  - M: deconstructed SIZE
  - R: linear with SIZE
  - N: deconstructed SIZE + LES:logSSD

Results — CV R² (mean ± sd)
- L: 0.283 ± 0.103 (n=652)
- T: 0.216 ± 0.071 (n=654)
- M: 0.357 ± 0.121 (n=651)
- R: 0.165 ± 0.092 (n=642)
- N: 0.444 ± 0.081 (n=639)

Reproduction (exact commands)
- L (GAM rf_plus):
  R_EXTRA_LIBS="/home/olier/ellenberg/.Rlib" \
  Rscript src/Stage_4_SEM_Analysis/run_sem_pwsem.R \
    --input_csv artifacts/model_data_bioclim_subset.csv \
    --target L --repeats 5 --folds 10 --stratify true --standardize true \
    --cluster Family --group_var Myco_Group_Final \
    --les_components negLMA,Nmass --add_predictor logLA \
    --nonlinear true --nonlinear_variant rf_plus --deconstruct_size_L true \
    --add_interaction "ti(logLA,logH),ti(logH,logSSD)" \
    --out_dir artifacts/stage4_sem_pwsem_bioclim_subset
- T (linear with SIZE):
  R_EXTRA_LIBS="/home/olier/ellenberg/.Rlib" \
  Rscript src/Stage_4_SEM_Analysis/run_sem_pwsem.R \
    --input_csv artifacts/model_data_bioclim_subset.csv \
    --target T --repeats 5 --folds 10 --stratify true --standardize true \
    --cluster Family --group_var Myco_Group_Final \
    --les_components negLMA,Nmass --add_predictor logLA \
    --nonlinear false \
    --out_dir artifacts/stage4_sem_pwsem_bioclim_subset
- M (deconstructed SIZE):
  R_EXTRA_LIBS="/home/olier/ellenberg/.Rlib" \
  Rscript src/Stage_4_SEM_Analysis/run_sem_pwsem.R \
    --input_csv artifacts/model_data_bioclim_subset.csv \
    --target M --repeats 5 --folds 10 --stratify true --standardize true \
    --cluster Family --group_var Myco_Group_Final \
    --les_components negLMA,Nmass --add_predictor logLA \
    --deconstruct_size true \
    --out_dir artifacts/stage4_sem_pwsem_bioclim_subset
- R (linear with SIZE):
  R_EXTRA_LIBS="/home/olier/ellenberg/.Rlib" \
  Rscript src/Stage_4_SEM_Analysis/run_sem_pwsem.R \
    --input_csv artifacts/model_data_bioclim_subset.csv \
    --target R --repeats 5 --folds 10 --stratify true --standardize true \
    --cluster Family --group_var Myco_Group_Final \
    --les_components negLMA,Nmass --add_predictor logLA \
    --out_dir artifacts/stage4_sem_pwsem_bioclim_subset
- N (deconstructed SIZE + LES:logSSD):
  R_EXTRA_LIBS="/home/olier/ellenberg/.Rlib" \
  Rscript src/Stage_4_SEM_Analysis/run_sem_pwsem.R \
    --input_csv artifacts/model_data_bioclim_subset.csv \
    --target N --repeats 5 --folds 10 --stratify true --standardize true \
    --cluster Family --group_var Myco_Group_Final \
    --les_components negLMA,Nmass --add_predictor logLA \
    --deconstruct_size true --add_interaction LES:logSSD \
    --out_dir artifacts/stage4_sem_pwsem_bioclim_subset

Artifacts
- Metrics JSON: artifacts/stage4_sem_pwsem_bioclim_subset/sem_pwsem_{L|T|M|R|N}_metrics.json
- Predictions: artifacts/stage4_sem_pwsem_bioclim_subset/sem_pwsem_{L|T|M|R|N}_preds.csv

Generated: 2025‑09‑13
