# Stage 2.9 — T-Axis (Temperature) XGBoost Tier 1

**Date:** 2025-10-29 (Tier 1 with corrected phylo)  
**Model:** XGBoost with 10-fold CV  
**Dataset:** 1,084 species (Tier 1 hyperparameter tuning)  
**Target:** EIVEres-T (EIVE Temperature indicator)

---

## Performance Snapshot

**Optimal Configuration:**
- Learning rate: 0.03
- Trees: 1500
- Max depth: 6
- GPU: CUDA

**Cross-Validation Metrics (10-fold):**
- R²: 0.809 ± 0.043
- RMSE: 0.575 ± 0.081
- MAE: 0.380 ± 0.036
- Accuracy ±1 rank: 97.0% ± 1.2%
- Accuracy ±2 ranks: 99.4% ± 0.8%

---

## Top 15 SHAP Predictors

| Rank | Feature | SHAP | Category |
|------|---------|------|----------|
| 1 | wc2.1_30s_bio_10_q05 | 0.2791 | Climate |
| 2 | wc2.1_30s_bio_5_q05 | 0.1115 | Climate |
| 3 | wc2.1_30s_bio_1_q05 | 0.1018 | Climate |
| 4 | wc2.1_30s_bio_5.1_q05 | 0.0561 | Climate |
| 5 | EIVEres-M | 0.0508 | Cross-axis EIVE |
| 6 | BEDD.1_q05 | 0.0337 | Climate |
| 7 | nitrogen_0_5cm_q50 | 0.0327 | Soil |
| 8 | BEDD_q50 | 0.0315 | Climate |
| 9 | wc2.1_30s_bio_9_q95 | 0.0293 | Climate |
| 10 | soc_5_15cm_q50 | 0.0288 | Soil |
| 11 | wc2.1_30s_bio_10_q50 | 0.0267 | Climate |
| 12 | nitrogen_5_15cm_q50 | 0.0232 | Soil |
| 13 | EIVEres-L | 0.0210 | Cross-axis EIVE |
| 14 | TX.1_q05 | 0.0208 | Climate |
| 15 | logSM | 0.0207 | Functional trait |

---

## Phylogenetic Predictor Status

**p_phylo_T: RANK #19 (SHAP = 0.0158)**

⚠ MODERATE - Phylogenetic signal present

**Context:** This run uses Tier 1 p_phylo calculated on a tree pruned to 1,075 species (matching the modeling population). This context-appropriate phylogenetic predictor captures the phylogenetic signal relevant to the 1,084-species subset used for hyperparameter tuning.

---

## Ecological Interpretation

**Temperature indicator prediction** is dominated by:
1. **Direct climate variables** (BIO10, BIO5, BIO1 ranks 1-3): Temperature preferences directly reflect climatic conditions
2. **Weak phylogenetic signal** (p_phylo_T rank 19): Temperature adaptation is more environmentally determined than phylogenetically conserved

The low phylogenetic importance is biologically meaningful - temperature preferences show less phylogenetic conservatism than other traits, being strongly driven by current environmental conditions.

---

## Files

**Model outputs:** `model_data/outputs/stage2_xgb/T_1084_tier1_20251029/`
- `xgb_T_cv_grid.csv` - Grid search results (9 combinations)
- `xgb_T_cv_metrics.json` - Best configuration metrics  
- `xgb_T_shap_importance.csv` - Feature importance rankings
- `xgb_T_model.json` - Trained model (best config)

**Input data:** `model_data/inputs/stage2_features/T_features_1084_tier1_20251029.csv`

---

## Next Steps

**For Tier 2 production (11,680 species):**
1. Use optimal hyperparameters: lr=0.03, trees=1500
2. Switch to Tier 2 p_phylo: `model_data/outputs/p_phylo_11680_20251028.csv`
3. Predict missing EIVE values for production dataset

---

**Status:** ✓ COMPLETED  
**Hyperparameters:** OPTIMIZED for Tier 2
