<!DOCTYPE html>
<html lang="en" data-theme="organic">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Plant Encyclopedia{% endblock %}</title>
    <link rel="stylesheet" href="/assets/css/styles.css">

    <!-- Prevent flash of wrong theme -->
    <script>
        (function() {
            const stored = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const theme = stored || (prefersDark ? 'organic-dark' : 'organic');
            document.documentElement.dataset.theme = theme;
            if (theme === 'organic-dark') document.documentElement.classList.add('dark');
        })();
    </script>

    <script src="/assets/js/htmx.min.js" defer></script>
    <script src="/assets/js/alpine.min.js" defer></script>
</head>
<body class="min-h-screen bg-base-200" hx-boost="true">
    <nav class="navbar bg-base-100 shadow-lg">
        <div class="container mx-auto max-w-6xl">
            <div class="flex-1">
                <a href="/" class="btn btn-ghost text-xl font-semibold">
                    <svg class="w-6 h-6 stroke-current" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z"/>
                        <path d="M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12"/>
                    </svg>
                    Plant Encyclopedia
                </a>
            </div>
            <div class="flex-none gap-2">
                <a href="/search" class="btn btn-ghost rounded-xl">
                    <svg class="w-5 h-5 stroke-current" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="11" cy="11" r="8"/>
                        <path d="m21 21-4.3-4.3"/>
                    </svg>
                    Search
                </a>
                <a href="/guild/builder" class="btn btn-ghost rounded-xl">
                    <svg class="w-5 h-5 stroke-current" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="18" cy="18" r="3"/>
                        <circle cx="6" cy="6" r="3"/>
                        <path d="M13 6h3a2 2 0 0 1 2 2v7"/>
                        <path d="M11 18H8a2 2 0 0 1-2-2V9"/>
                    </svg>
                    Guild Builder
                </a>

                <!-- Theme toggle -->
                <button
                    x-data="{ dark: localStorage.getItem('theme') === 'organic-dark' }"
                    x-init="$watch('dark', val => {
                        document.documentElement.dataset.theme = val ? 'organic-dark' : 'organic';
                        document.documentElement.classList.toggle('dark', val);
                        localStorage.setItem('theme', val ? 'organic-dark' : 'organic');
                    })"
                    @click="dark = !dark"
                    class="btn btn-ghost btn-circle">
                    <!-- Sun icon (shown in dark mode) -->
                    <svg x-show="dark" class="w-5 h-5 stroke-current" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="4"/>
                        <path d="M12 2v2"/>
                        <path d="M12 20v2"/>
                        <path d="m4.93 4.93 1.41 1.41"/>
                        <path d="m17.66 17.66 1.41 1.41"/>
                        <path d="M2 12h2"/>
                        <path d="M20 12h2"/>
                        <path d="m6.34 17.66-1.41 1.41"/>
                        <path d="m19.07 4.93-1.41 1.41"/>
                    </svg>
                    <!-- Moon icon (shown in light mode) -->
                    <svg x-show="!dark" class="w-5 h-5 stroke-current" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/>
                    </svg>
                </button>
            </div>
        </div>
    </nav>

    <main id="main-content" class="container mx-auto max-w-6xl px-4 py-8">
        {% block content %}{% endblock %}
    </main>

    <footer class="footer footer-center p-6 bg-base-300 text-base-content mt-auto">
        <div>
            <p class="text-base-content/60">11,711 European Plants with Ecological Data</p>
        </div>
    </footer>
</body>
</html>
