{% extends "base.html" %}

{% block title %}{{ scientific_name }} Encyclopedia - Plant Encyclopedia{% endblock %}

{% block content %}
<article class="max-w-4xl mx-auto">
    <!-- Header Card -->
    <header class="card bg-base-100 shadow-md rounded-2xl mb-8">
        <div class="card-body p-6 md:p-8">
            <div class="flex flex-col md:flex-row md:items-start justify-between gap-6">
                <!-- Plant Identity -->
                <div class="flex-1">
                    <h1 class="text-3xl md:text-4xl font-semibold text-base-content">
                        <em>{{ scientific_name }}</em>
                    </h1>
                    {% if vernacular_name.is_some() %}
                    <p class="text-xl text-base-content/60 mt-2">
                        {{ vernacular_name.as_ref().unwrap() }}
                    </p>
                    {% endif %}
                    <div class="flex items-center gap-3 mt-4">
                        <span class="badge bg-base-200 text-base-content/70 border-0">
                            {{ family }}
                        </span>
                        <span class="text-sm text-base-content/40">{{ wfo_id }}</span>
                    </div>
                </div>

                <!-- Location Selector -->
                <div class="flex flex-col items-start md:items-end gap-2">
                    <label class="text-sm text-base-content/60 font-medium">
                        <svg class="w-4 h-4 inline-block mr-1 stroke-current" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/>
                            <circle cx="12" cy="10" r="3"/>
                        </svg>
                        Your garden location
                    </label>
                    <div class="flex items-center gap-2">
                        <select name="location"
                                class="select select-bordered select-sm rounded-xl bg-base-200 focus:bg-base-100 min-w-[180px]"
                                hx-get="/plant/{{ wfo_id }}/encyclopedia"
                                hx-target="#encyclopedia-content"
                                hx-swap="innerHTML"
                                hx-indicator="#location-spinner">
                            <option value="london" {% if location == "london" %}selected{% endif %}>London, UK</option>
                            <option value="singapore" {% if location == "singapore" %}selected{% endif %}>Singapore</option>
                            <option value="helsinki" {% if location == "helsinki" %}selected{% endif %}>Helsinki, Finland</option>
                        </select>
                        <span id="location-spinner" class="htmx-indicator">
                            <span class="loading loading-spinner loading-sm text-primary"></span>
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Encyclopedia Content -->
    <div id="encyclopedia-content">
        <div class="card bg-base-100 shadow-md rounded-2xl">
            <div class="card-body p-6 md:p-8">
                <div class="prose prose-lg max-w-none
                            prose-headings:text-base-content prose-headings:font-semibold
                            prose-h1:text-2xl prose-h1:border-b prose-h1:border-base-200 prose-h1:pb-3 prose-h1:mb-6
                            prose-h2:text-xl prose-h2:mt-8 prose-h2:mb-4 prose-h2:text-primary
                            prose-h3:text-lg prose-h3:mt-6 prose-h3:mb-3
                            prose-h4:text-base prose-h4:mt-4 prose-h4:mb-2 prose-h4:text-base-content/80
                            prose-p:text-base-content/85 prose-p:leading-relaxed
                            prose-strong:text-base-content prose-strong:font-semibold
                            prose-em:text-base-content/90
                            prose-li:text-base-content/85 prose-li:marker:text-primary
                            prose-a:text-primary prose-a:no-underline hover:prose-a:underline
                            prose-table:text-sm
                            prose-th:bg-base-200 prose-th:text-base-content prose-th:font-semibold prose-th:py-3 prose-th:px-4
                            prose-td:py-2 prose-td:px-4 prose-td:text-base-content/80
                            prose-tr:border-base-200
                            prose-hr:border-base-200 prose-hr:my-8
                            prose-blockquote:border-primary prose-blockquote:bg-base-200/50 prose-blockquote:rounded-r-xl prose-blockquote:py-2
                            prose-code:text-primary prose-code:bg-base-200 prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded prose-code:text-sm prose-code:font-normal prose-code:before:content-none prose-code:after:content-none
                            prose-ul:my-4 prose-ol:my-4">
                    {{ content_html|safe }}
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation Footer -->
    <nav class="flex items-center justify-between mt-8">
        <a href="/search" class="btn btn-ghost rounded-xl gap-2 text-base-content/70 hover:text-base-content">
            <svg class="w-5 h-5 stroke-current" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="m15 18-6-6 6-6"/>
            </svg>
            Back to Search
        </a>
        <a href="/" class="btn btn-ghost rounded-xl gap-2 text-base-content/70 hover:text-base-content">
            <svg class="w-5 h-5 stroke-current" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                <polyline points="9 22 9 12 15 12 15 22"/>
            </svg>
            Home
        </a>
    </nav>
</article>
{% endblock %}
